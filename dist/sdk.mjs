const t=[{sepal_length:5.1,sepal_width:3.5,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.7,sepal_width:3.2,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:4.6,sepal_width:3.1,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.6,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:5.4,sepal_width:3.9,petal_length:1.7,petal_width:.4,species:"setosa"},{sepal_length:4.6,sepal_width:3.4,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5,sepal_width:3.4,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:4.4,sepal_width:2.9,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5.4,sepal_width:3.7,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3.4,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3,petal_length:1.4,petal_width:.1,species:"setosa"},{sepal_length:4.3,sepal_width:3,petal_length:1.1,petal_width:.1,species:"setosa"},{sepal_length:5.8,sepal_width:4,petal_length:1.2,petal_width:.2,species:"setosa"},{sepal_length:5.7,sepal_width:4.4,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:5.4,sepal_width:3.9,petal_length:1.3,petal_width:.4,species:"setosa"},{sepal_length:5.1,sepal_width:3.5,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5.7,sepal_width:3.8,petal_length:1.7,petal_width:.3,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.5,petal_width:.3,species:"setosa"},{sepal_length:5.4,sepal_width:3.4,petal_length:1.7,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.7,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:4.6,sepal_width:3.6,petal_length:1,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.3,petal_length:1.7,petal_width:.5,species:"setosa"},{sepal_length:4.8,sepal_width:3.4,petal_length:1.9,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.4,petal_length:1.6,petal_width:.4,species:"setosa"},{sepal_length:5.2,sepal_width:3.5,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5.2,sepal_width:3.4,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.7,sepal_width:3.2,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3.1,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:5.4,sepal_width:3.4,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:5.2,sepal_width:4.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5.5,sepal_width:4.2,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5,sepal_width:3.2,petal_length:1.2,petal_width:.2,species:"setosa"},{sepal_length:5.5,sepal_width:3.5,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.6,petal_length:1.4,petal_width:.1,species:"setosa"},{sepal_length:4.4,sepal_width:3,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.4,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.5,petal_length:1.3,petal_width:.3,species:"setosa"},{sepal_length:4.5,sepal_width:2.3,petal_length:1.3,petal_width:.3,species:"setosa"},{sepal_length:4.4,sepal_width:3.2,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.5,petal_length:1.6,petal_width:.6,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.9,petal_width:.4,species:"setosa"},{sepal_length:4.8,sepal_width:3,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.6,sepal_width:3.2,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:5.3,sepal_width:3.7,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:7,sepal_width:3.2,petal_length:4.7,petal_width:1.4,species:"versicolor"},{sepal_length:6.4,sepal_width:3.2,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:6.9,sepal_width:3.1,petal_length:4.9,petal_width:1.5,species:"versicolor"},{sepal_length:5.5,sepal_width:2.3,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:6.5,sepal_width:2.8,petal_length:4.6,petal_width:1.5,species:"versicolor"},{sepal_length:5.7,sepal_width:2.8,petal_length:4.5,petal_width:1.3,species:"versicolor"},{sepal_length:6.3,sepal_width:3.3,petal_length:4.7,petal_width:1.6,species:"versicolor"},{sepal_length:4.9,sepal_width:2.4,petal_length:3.3,petal_width:1,species:"versicolor"},{sepal_length:6.6,sepal_width:2.9,petal_length:4.6,petal_width:1.3,species:"versicolor"},{sepal_length:5.2,sepal_width:2.7,petal_length:3.9,petal_width:1.4,species:"versicolor"},{sepal_length:5,sepal_width:2,petal_length:3.5,petal_width:1,species:"versicolor"},{sepal_length:5.9,sepal_width:3,petal_length:4.2,petal_width:1.5,species:"versicolor"},{sepal_length:6,sepal_width:2.2,petal_length:4,petal_width:1,species:"versicolor"},{sepal_length:6.1,sepal_width:2.9,petal_length:4.7,petal_width:1.4,species:"versicolor"},{sepal_length:5.6,sepal_width:2.9,petal_length:3.6,petal_width:1.3,species:"versicolor"},{sepal_length:6.7,sepal_width:3.1,petal_length:4.4,petal_width:1.4,species:"versicolor"},{sepal_length:5.6,sepal_width:3,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.8,sepal_width:2.7,petal_length:4.1,petal_width:1,species:"versicolor"},{sepal_length:6.2,sepal_width:2.2,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.6,sepal_width:2.5,petal_length:3.9,petal_width:1.1,species:"versicolor"},{sepal_length:5.9,sepal_width:3.2,petal_length:4.8,petal_width:1.8,species:"versicolor"},{sepal_length:6.1,sepal_width:2.8,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:6.3,sepal_width:2.5,petal_length:4.9,petal_width:1.5,species:"versicolor"},{sepal_length:6.1,sepal_width:2.8,petal_length:4.7,petal_width:1.2,species:"versicolor"},{sepal_length:6.4,sepal_width:2.9,petal_length:4.3,petal_width:1.3,species:"versicolor"},{sepal_length:6.6,sepal_width:3,petal_length:4.4,petal_width:1.4,species:"versicolor"},{sepal_length:6.8,sepal_width:2.8,petal_length:4.8,petal_width:1.4,species:"versicolor"},{sepal_length:6.7,sepal_width:3,petal_length:5,petal_width:1.7,species:"versicolor"},{sepal_length:6,sepal_width:2.9,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.7,sepal_width:2.6,petal_length:3.5,petal_width:1,species:"versicolor"},{sepal_length:5.5,sepal_width:2.4,petal_length:3.8,petal_width:1.1,species:"versicolor"},{sepal_length:5.5,sepal_width:2.4,petal_length:3.7,petal_width:1,species:"versicolor"},{sepal_length:5.8,sepal_width:2.7,petal_length:3.9,petal_width:1.2,species:"versicolor"},{sepal_length:6,sepal_width:2.7,petal_length:5.1,petal_width:1.6,species:"versicolor"},{sepal_length:5.4,sepal_width:3,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:6,sepal_width:3.4,petal_length:4.5,petal_width:1.6,species:"versicolor"},{sepal_length:6.7,sepal_width:3.1,petal_length:4.7,petal_width:1.5,species:"versicolor"},{sepal_length:6.3,sepal_width:2.3,petal_length:4.4,petal_width:1.3,species:"versicolor"},{sepal_length:5.6,sepal_width:3,petal_length:4.1,petal_width:1.3,species:"versicolor"},{sepal_length:5.5,sepal_width:2.5,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:5.5,sepal_width:2.6,petal_length:4.4,petal_width:1.2,species:"versicolor"},{sepal_length:6.1,sepal_width:3,petal_length:4.6,petal_width:1.4,species:"versicolor"},{sepal_length:5.8,sepal_width:2.6,petal_length:4,petal_width:1.2,species:"versicolor"},{sepal_length:5,sepal_width:2.3,petal_length:3.3,petal_width:1,species:"versicolor"},{sepal_length:5.6,sepal_width:2.7,petal_length:4.2,petal_width:1.3,species:"versicolor"},{sepal_length:5.7,sepal_width:3,petal_length:4.2,petal_width:1.2,species:"versicolor"},{sepal_length:5.7,sepal_width:2.9,petal_length:4.2,petal_width:1.3,species:"versicolor"},{sepal_length:6.2,sepal_width:2.9,petal_length:4.3,petal_width:1.3,species:"versicolor"},{sepal_length:5.1,sepal_width:2.5,petal_length:3,petal_width:1.1,species:"versicolor"},{sepal_length:6.3,sepal_width:3.3,petal_length:6,petal_width:2.5,species:"virginica"},{sepal_length:5.8,sepal_width:2.7,petal_length:5.1,petal_width:1.9,species:"virginica"},{sepal_length:7.1,sepal_width:3,petal_length:5.9,petal_width:2.1,species:"virginica"},{sepal_length:6.3,sepal_width:2.9,petal_length:5.6,petal_width:1.8,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.8,petal_width:2.2,species:"virginica"},{sepal_length:7.6,sepal_width:3,petal_length:6.6,petal_width:2.1,species:"virginica"},{sepal_length:4.9,sepal_width:2.5,petal_length:4.5,petal_width:1.7,species:"virginica"},{sepal_length:7.3,sepal_width:2.9,petal_length:6.3,petal_width:1.8,species:"virginica"},{sepal_length:6.7,sepal_width:2.5,petal_length:5.8,petal_width:1.8,species:"virginica"},{sepal_length:7.2,sepal_width:3.6,petal_length:6.1,petal_width:2.5,species:"virginica"},{sepal_length:6.5,sepal_width:3.2,petal_length:5.1,petal_width:2,species:"virginica"},{sepal_length:6.4,sepal_width:2.7,petal_length:5.3,petal_width:1.9,species:"virginica"},{sepal_length:6.8,sepal_width:3,petal_length:5.5,petal_width:2.1,species:"virginica"},{sepal_length:5.7,sepal_width:2.5,petal_length:5,petal_width:2,species:"virginica"},{sepal_length:5.8,sepal_width:2.8,petal_length:5.1,petal_width:2.4,species:"virginica"},{sepal_length:6.4,sepal_width:3.2,petal_length:5.3,petal_width:2.3,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.5,petal_width:1.8,species:"virginica"},{sepal_length:7.7,sepal_width:3.8,petal_length:6.7,petal_width:2.2,species:"virginica"},{sepal_length:7.7,sepal_width:2.6,petal_length:6.9,petal_width:2.3,species:"virginica"},{sepal_length:6,sepal_width:2.2,petal_length:5,petal_width:1.5,species:"virginica"},{sepal_length:6.9,sepal_width:3.2,petal_length:5.7,petal_width:2.3,species:"virginica"},{sepal_length:5.6,sepal_width:2.8,petal_length:4.9,petal_width:2,species:"virginica"},{sepal_length:7.7,sepal_width:2.8,petal_length:6.7,petal_width:2,species:"virginica"},{sepal_length:6.3,sepal_width:2.7,petal_length:4.9,petal_width:1.8,species:"virginica"},{sepal_length:6.7,sepal_width:3.3,petal_length:5.7,petal_width:2.1,species:"virginica"},{sepal_length:7.2,sepal_width:3.2,petal_length:6,petal_width:1.8,species:"virginica"},{sepal_length:6.2,sepal_width:2.8,petal_length:4.8,petal_width:1.8,species:"virginica"},{sepal_length:6.1,sepal_width:3,petal_length:4.9,petal_width:1.8,species:"virginica"},{sepal_length:6.4,sepal_width:2.8,petal_length:5.6,petal_width:2.1,species:"virginica"},{sepal_length:7.2,sepal_width:3,petal_length:5.8,petal_width:1.6,species:"virginica"},{sepal_length:7.4,sepal_width:2.8,petal_length:6.1,petal_width:1.9,species:"virginica"},{sepal_length:7.9,sepal_width:3.8,petal_length:6.4,petal_width:2,species:"virginica"},{sepal_length:6.4,sepal_width:2.8,petal_length:5.6,petal_width:2.2,species:"virginica"},{sepal_length:6.3,sepal_width:2.8,petal_length:5.1,petal_width:1.5,species:"virginica"},{sepal_length:6.1,sepal_width:2.6,petal_length:5.6,petal_width:1.4,species:"virginica"},{sepal_length:7.7,sepal_width:3,petal_length:6.1,petal_width:2.3,species:"virginica"},{sepal_length:6.3,sepal_width:3.4,petal_length:5.6,petal_width:2.4,species:"virginica"},{sepal_length:6.4,sepal_width:3.1,petal_length:5.5,petal_width:1.8,species:"virginica"},{sepal_length:6,sepal_width:3,petal_length:4.8,petal_width:1.8,species:"virginica"},{sepal_length:6.9,sepal_width:3.1,petal_length:5.4,petal_width:2.1,species:"virginica"},{sepal_length:6.7,sepal_width:3.1,petal_length:5.6,petal_width:2.4,species:"virginica"},{sepal_length:6.9,sepal_width:3.1,petal_length:5.1,petal_width:2.3,species:"virginica"},{sepal_length:5.8,sepal_width:2.7,petal_length:5.1,petal_width:1.9,species:"virginica"},{sepal_length:6.8,sepal_width:3.2,petal_length:5.9,petal_width:2.3,species:"virginica"},{sepal_length:6.7,sepal_width:3.3,petal_length:5.7,petal_width:2.5,species:"virginica"},{sepal_length:6.7,sepal_width:3,petal_length:5.2,petal_width:2.3,species:"virginica"},{sepal_length:6.3,sepal_width:2.5,petal_length:5,petal_width:1.9,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.2,petal_width:2,species:"virginica"},{sepal_length:6.2,sepal_width:3.4,petal_length:5.4,petal_width:2.3,species:"virginica"},{sepal_length:5.9,sepal_width:3,petal_length:5.1,petal_width:1.8,species:"virginica"}],e=[{f1:-.1583,f2:-.0026,f3:.0185,f4:-.0088,label:"spiral_A"},{f1:-.002,f2:.0338,f3:-.0175,f4:.0011,label:"spiral_B"},{f1:-.0305,f2:.0301,f3:.0252,f4:.0295,label:"spiral_A"},{f1:.0282,f2:-.0213,f3:-.0468,f4:.066,label:"spiral_B"},{f1:.1138,f2:.0041,f3:.0057,f4:-.0177,label:"spiral_A"},{f1:-.01,f2:-.0369,f3:.0532,f4:.0208,label:"spiral_B"},{f1:-.018,f2:.0673,f3:-.005,f4:.0937,label:"spiral_A"},{f1:-.0215,f2:-.0712,f3:1e-4,f4:-.034,label:"spiral_B"},{f1:.007,f2:.0289,f3:.0239,f4:.0783,label:"spiral_A"},{f1:-.0357,f2:-.0678,f3:.034,f4:-.0119,label:"spiral_B"},{f1:.007,f2:.0329,f3:-.0423,f4:-.0065,label:"spiral_A"},{f1:-.0135,f2:.0161,f3:-.0326,f4:-.0335,label:"spiral_B"},{f1:-.0223,f2:-.055,f3:-.0192,f4:-.0831,label:"spiral_A"},{f1:.0383,f2:-.0284,f3:.0415,f4:-.0842,label:"spiral_B"},{f1:-.0396,f2:-.041,f3:.0375,f4:-.1003,label:"spiral_A"},{f1:-.0381,f2:-.0696,f3:.0239,f4:.0365,label:"spiral_B"},{f1:-.0057,f2:-.0453,f3:-.0362,f4:-.0021,label:"spiral_A"},{f1:-.0134,f2:-.041,f3:.0103,f4:-.0033,label:"spiral_B"},{f1:.0476,f2:.0042,f3:-.0295,f4:-.0178,label:"spiral_A"},{f1:-.0652,f2:-.0543,f3:-.0475,f4:-.0251,label:"spiral_B"},{f1:.072,f2:-.049,f3:.0636,f4:.0313,label:"spiral_A"},{f1:-.0158,f2:.0077,f3:-.0057,f4:-.0185,label:"spiral_B"},{f1:.0026,f2:.0226,f3:.0514,f4:.0209,label:"spiral_A"},{f1:.0345,f2:.0112,f3:.0097,f4:-.0149,label:"spiral_B"},{f1:-.015,f2:-.0158,f3:.0084,f4:-.018,label:"spiral_A"},{f1:-.036,f2:.0323,f3:-.0014,f4:-.048,label:"spiral_B"},{f1:-.0218,f2:.0401,f3:-.0069,f4:.058,label:"spiral_A"},{f1:-.0405,f2:.0126,f3:.0453,f4:-.0182,label:"spiral_B"},{f1:.0136,f2:-.0469,f3:-.0311,f4:-.0277,label:"spiral_A"},{f1:-.0111,f2:-.0301,f3:-.0348,f4:-.0628,label:"spiral_B"},{f1:-.0823,f2:.0437,f3:.0712,f4:.0022,label:"spiral_A"},{f1:.0113,f2:.0896,f3:-.0734,f4:-.0644,label:"spiral_B"},{f1:-.0049,f2:.045,f3:.0398,f4:.0025,label:"spiral_A"},{f1:-.1087,f2:-.0107,f3:-.0561,f4:-.0098,label:"spiral_B"},{f1:.0076,f2:.1035,f3:.0667,f4:.0278,label:"spiral_A"},{f1:-.1047,f2:-.0477,f3:-.0927,f4:-.0152,label:"spiral_B"},{f1:-.0327,f2:.0033,f3:.0503,f4:.0045,label:"spiral_A"},{f1:-.0663,f2:-.0726,f3:-.0834,f4:-.073,label:"spiral_B"},{f1:.0685,f2:-.0092,f3:.0875,f4:.0928,label:"spiral_A"},{f1:-.0506,f2:-.0479,f3:-.0061,f4:.0329,label:"spiral_B"},{f1:-.0292,f2:.0132,f3:.051,f4:-.0272,label:"spiral_A"},{f1:-.0047,f2:-.0475,f3:-.0346,f4:-.0039,label:"spiral_B"},{f1:.0222,f2:.007,f3:-.0152,f4:-.0339,label:"spiral_A"},{f1:-.0571,f2:-.0878,f3:-.0667,f4:.0061,label:"spiral_B"},{f1:.0108,f2:.0116,f3:-.0294,f4:.0251,label:"spiral_A"},{f1:-.0468,f2:.0134,f3:-.0576,f4:.0011,label:"spiral_B"},{f1:-.0241,f2:.0844,f3:.0998,f4:-.0184,label:"spiral_A"},{f1:-.0466,f2:-.0799,f3:-.0381,f4:-.0086,label:"spiral_B"},{f1:.0613,f2:.0222,f3:.0679,f4:-.0242,label:"spiral_A"},{f1:-.0358,f2:-.0309,f3:-.0315,f4:.0634,label:"spiral_B"},{f1:-.0044,f2:.0496,f3:.053,f4:-.0628,label:"spiral_A"},{f1:-.0043,f2:-.0753,f3:-.0648,f4:-.0126,label:"spiral_B"},{f1:.0277,f2:-.0103,f3:.1224,f4:.0182,label:"spiral_A"},{f1:-.0406,f2:.0781,f3:-.0554,f4:.0535,label:"spiral_B"},{f1:-.0221,f2:.0716,f3:.0495,f4:-.0448,label:"spiral_A"},{f1:.0417,f2:-.0906,f3:-.0192,f4:.0413,label:"spiral_B"},{f1:.0356,f2:.0377,f3:.1111,f4:-.0274,label:"spiral_A"},{f1:-.0156,f2:-.0302,f3:-.0663,f4:.0899,label:"spiral_B"},{f1:.0995,f2:.1391,f3:.0533,f4:-.0056,label:"spiral_A"},{f1:-.0778,f2:-.004,f3:-.0131,f4:.0551,label:"spiral_B"},{f1:.0786,f2:.007,f3:.0341,f4:-.1071,label:"spiral_A"},{f1:-.0531,f2:-.0569,f3:-.0938,f4:.0111,label:"spiral_B"},{f1:.0113,f2:.0247,f3:.0296,f4:-.023,label:"spiral_A"},{f1:.0271,f2:-.0738,f3:.0054,f4:.0874,label:"spiral_B"},{f1:.0738,f2:.0612,f3:.0361,f4:-.0488,label:"spiral_A"},{f1:-.0078,f2:-.0616,f3:-.0032,f4:.0641,label:"spiral_B"},{f1:.0275,f2:.0752,f3:.0033,f4:-.0645,label:"spiral_A"},{f1:-.0174,f2:-.0767,f3:-.0667,f4:-.0051,label:"spiral_B"},{f1:.0182,f2:.067,f3:.0592,f4:-.1191,label:"spiral_A"},{f1:-.0303,f2:-.0518,f3:-.0092,f4:.0744,label:"spiral_B"},{f1:.0043,f2:.0793,f3:.079,f4:-.0416,label:"spiral_A"},{f1:-.0299,f2:-.0169,f3:.047,f4:.0418,label:"spiral_B"},{f1:-.0082,f2:.0956,f3:.0941,f4:-.0532,label:"spiral_A"},{f1:-.049,f2:-.0758,f3:-.0993,f4:.0367,label:"spiral_B"},{f1:-.0399,f2:.1066,f3:.0491,f4:-.1036,label:"spiral_A"},{f1:-.0139,f2:-.0624,f3:-.0099,f4:.0618,label:"spiral_B"},{f1:.0071,f2:.0493,f3:.0489,f4:-.0581,label:"spiral_A"},{f1:-.0039,f2:-.0872,f3:.0521,f4:.0402,label:"spiral_B"},{f1:.0065,f2:.0996,f3:.0387,f4:-.1065,label:"spiral_A"},{f1:.0767,f2:-.1157,f3:-.0448,f4:.0864,label:"spiral_B"},{f1:.0165,f2:.1032,f3:.0117,f4:-.0509,label:"spiral_A"},{f1:-.0154,f2:-.1267,f3:-.0387,f4:.1164,label:"spiral_B"},{f1:.0275,f2:.1236,f3:-.0123,f4:-.0878,label:"spiral_A"},{f1:.009,f2:-.155,f3:.0199,f4:.0694,label:"spiral_B"},{f1:-.0095,f2:.1685,f3:.104,f4:-.084,label:"spiral_A"},{f1:.0212,f2:.0028,f3:.0594,f4:.0794,label:"spiral_B"},{f1:.016,f2:.0934,f3:-.0069,f4:-.1064,label:"spiral_A"},{f1:.0631,f2:-.0025,f3:.0441,f4:.1127,label:"spiral_B"},{f1:-.0388,f2:.1356,f3:-.0316,f4:-.019,label:"spiral_A"},{f1:-.0406,f2:-.1502,f3:.0554,f4:.0419,label:"spiral_B"},{f1:-.0685,f2:.0488,f3:-.0322,f4:-.1657,label:"spiral_A"},{f1:.0528,f2:-.1272,f3:.0277,f4:.0787,label:"spiral_B"},{f1:.0254,f2:.138,f3:-.0417,f4:-.126,label:"spiral_A"},{f1:-.0216,f2:-.0715,f3:.002,f4:.0611,label:"spiral_B"},{f1:.0198,f2:.125,f3:-.0049,f4:-.134,label:"spiral_A"},{f1:-.0395,f2:-.0668,f3:-.0067,f4:.1072,label:"spiral_B"},{f1:.0313,f2:.1463,f3:-.1003,f4:-.062,label:"spiral_A"},{f1:-.0104,f2:-.0754,f3:.0372,f4:.079,label:"spiral_B"},{f1:.0091,f2:.1267,f3:-.0893,f4:-.0959,label:"spiral_A"},{f1:.0058,f2:-.0711,f3:.0793,f4:.041,label:"spiral_B"},{f1:-.0028,f2:.0494,f3:-.0869,f4:-.0333,label:"spiral_A"},{f1:-.0578,f2:-.1181,f3:.109,f4:.1503,label:"spiral_B"},{f1:-.0115,f2:.1105,f3:-.0449,f4:-.0644,label:"spiral_A"},{f1:.0062,f2:-.1468,f3:.0897,f4:.0697,label:"spiral_B"},{f1:-.0599,f2:.079,f3:-.0553,f4:-.007,label:"spiral_A"},{f1:.0522,f2:.0084,f3:.1034,f4:.126,label:"spiral_B"},{f1:-.0856,f2:.1103,f3:-.1369,f4:.0317,label:"spiral_A"},{f1:.0383,f2:-.0814,f3:.1166,f4:.0946,label:"spiral_B"},{f1:-.0763,f2:.111,f3:-.1998,f4:-.1181,label:"spiral_A"},{f1:.0506,f2:-.0673,f3:.0484,f4:-.0082,label:"spiral_B"},{f1:-.0271,f2:.097,f3:-.0662,f4:-.0062,label:"spiral_A"},{f1:.0221,f2:-.1082,f3:.125,f4:.0718,label:"spiral_B"},{f1:-.1407,f2:.1186,f3:-.0441,f4:.0173,label:"spiral_A"},{f1:.1252,f2:-.0919,f3:.0728,f4:.021,label:"spiral_B"},{f1:-.0973,f2:.1365,f3:-.0358,f4:-.0843,label:"spiral_A"},{f1:.0704,f2:-.1191,f3:.1351,f4:.009,label:"spiral_B"},{f1:-.0367,f2:.0455,f3:-.0988,f4:-.0414,label:"spiral_A"},{f1:.0486,f2:-.026,f3:.1186,f4:.0374,label:"spiral_B"},{f1:-.0956,f2:.1331,f3:-.112,f4:-.0745,label:"spiral_A"},{f1:.0441,f2:-.0205,f3:.1487,f4:.0152,label:"spiral_B"},{f1:-.1136,f2:.106,f3:-.1465,f4:-.003,label:"spiral_A"},{f1:.0921,f2:-.0555,f3:.1222,f4:.0362,label:"spiral_B"},{f1:-.1026,f2:.126,f3:-.1558,f4:-.029,label:"spiral_A"},{f1:.0409,f2:-.1225,f3:.1298,f4:.0467,label:"spiral_B"},{f1:-.0347,f2:.0034,f3:-.0705,f4:.0015,label:"spiral_A"},{f1:.1276,f2:-.1328,f3:.1286,f4:.0213,label:"spiral_B"},{f1:-.0636,f2:.1047,f3:-.1684,f4:.0716,label:"spiral_A"},{f1:-.0214,f2:-.0421,f3:.0757,f4:.0195,label:"spiral_B"},{f1:-.0882,f2:.0148,f3:-.1319,f4:-.0189,label:"spiral_A"},{f1:.0871,f2:-.0513,f3:.1821,f4:.0266,label:"spiral_B"},{f1:-.1006,f2:.0666,f3:-.1917,f4:.0238,label:"spiral_A"},{f1:.2014,f2:-.1256,f3:.233,f4:.0154,label:"spiral_B"},{f1:-.1418,f2:.0923,f3:-.1534,f4:.0695,label:"spiral_A"},{f1:.1157,f2:.0027,f3:.1401,f4:-.0339,label:"spiral_B"},{f1:-.0676,f2:.1054,f3:-.1182,f4:.0151,label:"spiral_A"},{f1:.098,f2:-.067,f3:.1344,f4:-.0512,label:"spiral_B"},{f1:-.139,f2:.1258,f3:-.1063,f4:.0737,label:"spiral_A"},{f1:.0774,f2:-.1165,f3:.1157,f4:-.0342,label:"spiral_B"},{f1:-.0653,f2:.1184,f3:-.1345,f4:.135,label:"spiral_A"},{f1:.0968,f2:-.069,f3:.1752,f4:-.0461,label:"spiral_B"},{f1:-.1427,f2:.0923,f3:-.0961,f4:.1074,label:"spiral_A"},{f1:.1928,f2:.0048,f3:.087,f4:-.0726,label:"spiral_B"},{f1:-.1213,f2:.0827,f3:-.1543,f4:.1282,label:"spiral_A"},{f1:.2176,f2:-.0882,f3:.1075,f4:-.0537,label:"spiral_B"},{f1:-.1516,f2:.0112,f3:-.0918,f4:.1506,label:"spiral_A"},{f1:.0933,f2:-.0743,f3:.1069,f4:-.1097,label:"spiral_B"},{f1:-.1554,f2:.0461,f3:-.132,f4:.094,label:"spiral_A"},{f1:.14,f2:-.0653,f3:.0738,f4:-.1059,label:"spiral_B"},{f1:-.1849,f2:.0491,f3:-.0636,f4:.1047,label:"spiral_A"},{f1:.1777,f2:9e-4,f3:.0906,f4:-.131,label:"spiral_B"},{f1:-.1225,f2:.0106,f3:-.0723,f4:.1207,label:"spiral_A"},{f1:.1819,f2:-.075,f3:.127,f4:-.1017,label:"spiral_B"},{f1:-.0466,f2:.05,f3:-.1318,f4:.1639,label:"spiral_A"},{f1:.1743,f2:-.0532,f3:.0994,f4:-.1784,label:"spiral_B"},{f1:-.1464,f2:.0813,f3:-.0526,f4:.1302,label:"spiral_A"},{f1:.1418,f2:-.0135,f3:.0739,f4:-.1281,label:"spiral_B"},{f1:-.1484,f2:.0372,f3:-.1217,f4:.1117,label:"spiral_A"},{f1:.1538,f2:-.107,f3:.0962,f4:-.1383,label:"spiral_B"},{f1:-.1898,f2:.0781,f3:-.1123,f4:.1492,label:"spiral_A"},{f1:.1615,f2:-.0235,f3:.1109,f4:-.1385,label:"spiral_B"},{f1:-.1939,f2:.0437,f3:-.1124,f4:.1968,label:"spiral_A"},{f1:.1544,f2:-.0779,f3:.0822,f4:-.2096,label:"spiral_B"},{f1:-.1736,f2:-.0354,f3:.0034,f4:.1601,label:"spiral_A"},{f1:.1344,f2:.0288,f3:-.025,f4:-.1601,label:"spiral_B"},{f1:-.1926,f2:-.0242,f3:.0061,f4:.1222,label:"spiral_A"},{f1:.0984,f2:-.0597,f3:-.0273,f4:-.1305,label:"spiral_B"},{f1:-.1189,f2:.0594,f3:-.1022,f4:.1495,label:"spiral_A"},{f1:.1914,f2:-.0016,f3:.0253,f4:-.1865,label:"spiral_B"},{f1:-.1573,f2:-2e-4,f3:-.0041,f4:.0854,label:"spiral_A"},{f1:.2051,f2:.0171,f3:-.0199,f4:-.1888,label:"spiral_B"},{f1:-.1871,f2:-.0558,f3:.004,f4:.1578,label:"spiral_A"},{f1:.1493,f2:-.0031,f3:-.0311,f4:-.1374,label:"spiral_B"},{f1:-.2038,f2:-.0313,f3:.0045,f4:.2151,label:"spiral_A"},{f1:.1895,f2:-.0484,f3:-.0322,f4:-.1383,label:"spiral_B"},{f1:-.1971,f2:-.0064,f3:.0661,f4:.1499,label:"spiral_A"},{f1:.187,f2:.0497,f3:-5e-4,f4:-.1977,label:"spiral_B"},{f1:-.1156,f2:-.0343,f3:.0445,f4:.2297,label:"spiral_A"},{f1:.1654,f2:.038,f3:-.1164,f4:-.1096,label:"spiral_B"},{f1:-.18,f2:-.0706,f3:.1207,f4:.1467,label:"spiral_A"},{f1:.1205,f2:.079,f3:-.1034,f4:-.1964,label:"spiral_B"},{f1:-.1859,f2:-.1146,f3:.071,f4:.1466,label:"spiral_A"},{f1:.1845,f2:.1035,f3:-.1533,f4:-.1941,label:"spiral_B"},{f1:-.1293,f2:-.0695,f3:.1022,f4:.195,label:"spiral_A"},{f1:.1535,f2:.0141,f3:-.1721,f4:-.2032,label:"spiral_B"},{f1:-.176,f2:-.0593,f3:.1925,f4:.1959,label:"spiral_A"},{f1:.1813,f2:.1348,f3:-.109,f4:-.0714,label:"spiral_B"},{f1:-.2039,f2:-.045,f3:.1499,f4:.1457,label:"spiral_A"},{f1:.2341,f2:.0436,f3:-.1069,f4:-.1318,label:"spiral_B"},{f1:-.196,f2:-.0622,f3:.0834,f4:.1088,label:"spiral_A"},{f1:.1569,f2:.0089,f3:-.1641,f4:-.0966,label:"spiral_B"},{f1:-.1698,f2:-.0442,f3:.1823,f4:.1616,label:"spiral_A"},{f1:.1527,f2:.082,f3:-.1719,f4:-.1041,label:"spiral_B"},{f1:-.1509,f2:-.0781,f3:.0916,f4:.1271,label:"spiral_A"},{f1:.1898,f2:.1119,f3:-.1585,f4:-.1247,label:"spiral_B"},{f1:-.1539,f2:.0394,f3:.1521,f4:.0949,label:"spiral_A"},{f1:.2322,f2:.1013,f3:-.1169,f4:-.0802,label:"spiral_B"},{f1:-.106,f2:-.0972,f3:.1487,f4:.0887,label:"spiral_A"},{f1:.1907,f2:.1408,f3:-.1443,f4:-.1143,label:"spiral_B"},{f1:-.163,f2:-.0547,f3:.2045,f4:.1315,label:"spiral_A"},{f1:.1444,f2:.1464,f3:-.1622,f4:-.024,label:"spiral_B"},{f1:-.1637,f2:-.1131,f3:.2669,f4:.0835,label:"spiral_A"},{f1:.1959,f2:.1356,f3:-.1622,f4:-.0439,label:"spiral_B"},{f1:-.1106,f2:-.1404,f3:.1982,f4:.0271,label:"spiral_A"},{f1:.1983,f2:.2157,f3:-.2632,f4:-.0439,label:"spiral_B"},{f1:-.222,f2:-.1616,f3:.2171,f4:.0579,label:"spiral_A"},{f1:.17,f2:.1465,f3:-.2215,f4:-.0404,label:"spiral_B"},{f1:-.1761,f2:-.123,f3:.2509,f4:-.0459,label:"spiral_A"},{f1:.0756,f2:.1118,f3:-.2346,f4:-.0175,label:"spiral_B"},{f1:-.1437,f2:-.1598,f3:.2123,f4:.0185,label:"spiral_A"},{f1:.2198,f2:.1568,f3:-.1461,f4:.0276,label:"spiral_B"},{f1:-.1589,f2:-.1181,f3:.2359,f4:-.0471,label:"spiral_A"},{f1:.1109,f2:.1543,f3:-.2026,f4:.0901,label:"spiral_B"},{f1:-.074,f2:-.1981,f3:.2032,f4:-.04,label:"spiral_A"},{f1:.212,f2:.158,f3:-.2038,f4:-.0138,label:"spiral_B"},{f1:-.1206,f2:-.2134,f3:.218,f4:-.0858,label:"spiral_A"},{f1:.1118,f2:.214,f3:-.2012,f4:.0723,label:"spiral_B"},{f1:-.0932,f2:-.1916,f3:.1853,f4:-.0766,label:"spiral_A"},{f1:.1548,f2:.2124,f3:-.2673,f4:.1108,label:"spiral_B"},{f1:-.1397,f2:-.1917,f3:.1956,f4:-.0414,label:"spiral_A"},{f1:.1151,f2:.1353,f3:-.1733,f4:.0583,label:"spiral_B"},{f1:-.1182,f2:-.2353,f3:.2065,f4:-.1243,label:"spiral_A"},{f1:.0331,f2:.2055,f3:-.2384,f4:.0624,label:"spiral_B"},{f1:-.1366,f2:-.1602,f3:.2474,f4:-.1713,label:"spiral_A"},{f1:.1429,f2:.2235,f3:-.2084,f4:.0207,label:"spiral_B"},{f1:-.1204,f2:-.1546,f3:.1333,f4:-.1294,label:"spiral_A"},{f1:.1081,f2:.1617,f3:-.1685,f4:.1137,label:"spiral_B"},{f1:.0055,f2:-.1678,f3:.1838,f4:-.1924,label:"spiral_A"},{f1:.0907,f2:.2346,f3:-.179,f4:.1729,label:"spiral_B"},{f1:-.0456,f2:-.2087,f3:.1078,f4:-.1932,label:"spiral_A"},{f1:.1258,f2:.2035,f3:-.1276,f4:.1357,label:"spiral_B"},{f1:-.1086,f2:-.1272,f3:.156,f4:-.1814,label:"spiral_A"},{f1:.0665,f2:.2038,f3:-.1306,f4:.1901,label:"spiral_B"},{f1:-.1,f2:-.2143,f3:.1631,f4:-.2228,label:"spiral_A"},{f1:.0286,f2:.2048,f3:-.1239,f4:.1949,label:"spiral_B"},{f1:-.1526,f2:-.28,f3:.1028,f4:-.256,label:"spiral_A"},{f1:.0114,f2:.1642,f3:-.1398,f4:.0938,label:"spiral_B"},{f1:-.0148,f2:-.2923,f3:.0781,f4:-.1804,label:"spiral_A"},{f1:.0502,f2:.2431,f3:-.0899,f4:.2982,label:"spiral_B"},{f1:-.0647,f2:-.2226,f3:.1005,f4:-.1369,label:"spiral_A"},{f1:.1199,f2:.2336,f3:-.0953,f4:.1909,label:"spiral_B"},{f1:-.0018,f2:-.1918,f3:.0907,f4:-.2643,label:"spiral_A"},{f1:.0263,f2:.2254,f3:-.0906,f4:.2556,label:"spiral_B"},{f1:-.0559,f2:-.2202,f3:.0427,f4:-.1304,label:"spiral_A"},{f1:.035,f2:.2553,f3:-.0366,f4:.2015,label:"spiral_B"},{f1:-.0906,f2:-.2742,f3:.0138,f4:-.2584,label:"spiral_A"},{f1:-.0048,f2:.2617,f3:-.0337,f4:.2041,label:"spiral_B"},{f1:-.0386,f2:-.2902,f3:-1e-4,f4:-.1692,label:"spiral_A"},{f1:.0497,f2:.2626,f3:-.0525,f4:.3209,label:"spiral_B"},{f1:.002,f2:-.2309,f3:.0297,f4:-.309,label:"spiral_A"},{f1:-.0058,f2:.2669,f3:-.0958,f4:.2235,label:"spiral_B"},{f1:6e-4,f2:-.2788,f3:-.0107,f4:-.2644,label:"spiral_A"},{f1:-.0312,f2:.2074,f3:.0046,f4:.312,label:"spiral_B"},{f1:.0098,f2:-.2475,f3:-.0525,f4:-.2287,label:"spiral_A"},{f1:-.0484,f2:.2634,f3:-.0159,f4:.217,label:"spiral_B"},{f1:.055,f2:-.2707,f3:-.1102,f4:-.3433,label:"spiral_A"},{f1:-.0475,f2:.2845,f3:.0669,f4:.274,label:"spiral_B"},{f1:-.0482,f2:-.2344,f3:-.0552,f4:-.3137,label:"spiral_A"},{f1:.0487,f2:.295,f3:.038,f4:.1671,label:"spiral_B"},{f1:.1225,f2:-.2509,f3:-.0761,f4:-.2824,label:"spiral_A"},{f1:-.0127,f2:.2832,f3:.0616,f4:.2494,label:"spiral_B"},{f1:.089,f2:-.275,f3:-.1093,f4:-.2465,label:"spiral_A"},{f1:-.0227,f2:.2532,f3:.1074,f4:.2209,label:"spiral_B"},{f1:.0316,f2:-.2937,f3:-.1104,f4:-.2303,label:"spiral_A"},{f1:-.0578,f2:.2226,f3:.138,f4:.0841,label:"spiral_B"},{f1:.0841,f2:-.233,f3:-.1127,f4:-.1792,label:"spiral_A"},{f1:-.0834,f2:.2635,f3:.1527,f4:.1801,label:"spiral_B"},{f1:.0731,f2:-.2572,f3:-.1002,f4:-.2829,label:"spiral_A"},{f1:-.0643,f2:.2717,f3:.1328,f4:.2099,label:"spiral_B"},{f1:.0364,f2:-.24,f3:-.1593,f4:-.1439,label:"spiral_A"},{f1:-.076,f2:.2532,f3:.1866,f4:.178,label:"spiral_B"},{f1:.1478,f2:-.2032,f3:-.2521,f4:-.204,label:"spiral_A"},{f1:-.0602,f2:.286,f3:.2148,f4:.2247,label:"spiral_B"},{f1:.1418,f2:-.3041,f3:-.2238,f4:-.1737,label:"spiral_A"},{f1:-.0969,f2:.3109,f3:.2452,f4:.1303,label:"spiral_B"},{f1:.0625,f2:-.2187,f3:-.1662,f4:-.1743,label:"spiral_A"},{f1:-.1636,f2:.2591,f3:.1736,f4:.2252,label:"spiral_B"},{f1:.0479,f2:-.2745,f3:-.199,f4:-.185,label:"spiral_A"},{f1:-.2216,f2:.2405,f3:.2364,f4:.1735,label:"spiral_B"},{f1:.162,f2:-.2387,f3:-.1968,f4:-.1341,label:"spiral_A"},{f1:-.1109,f2:.1986,f3:.2699,f4:.1413,label:"spiral_B"},{f1:.1254,f2:-.2286,f3:-.3157,f4:-.1849,label:"spiral_A"},{f1:-.1511,f2:.1995,f3:.2736,f4:.1026,label:"spiral_B"},{f1:.1768,f2:-.1513,f3:-.2095,f4:-.093,label:"spiral_A"},{f1:-.1243,f2:.1955,f3:.2712,f4:.0784,label:"spiral_B"},{f1:.1375,f2:-.1985,f3:-.3321,f4:-.0956,label:"spiral_A"},{f1:-.1734,f2:.2154,f3:.2573,f4:.0521,label:"spiral_B"},{f1:.178,f2:-.1591,f3:-.2949,f4:-.0814,label:"spiral_A"},{f1:-.1972,f2:.306,f3:.2873,f4:-.0184,label:"spiral_B"},{f1:.1831,f2:-.205,f3:-.3182,f4:-.037,label:"spiral_A"},{f1:-.1633,f2:.2371,f3:.3498,f4:.1294,label:"spiral_B"},{f1:.2427,f2:-.227,f3:-.3259,f4:-.0021,label:"spiral_A"},{f1:-.2168,f2:.2212,f3:.3181,f4:-.0079,label:"spiral_B"},{f1:.1804,f2:-.1837,f3:-.352,f4:.009,label:"spiral_A"},{f1:-.175,f2:.221,f3:.2831,f4:.0629,label:"spiral_B"},{f1:.2611,f2:-.1309,f3:-.3175,f4:.0246,label:"spiral_A"},{f1:-.1895,f2:.2149,f3:.3104,f4:-.0602,label:"spiral_B"},{f1:.2343,f2:-.1417,f3:-.3454,f4:.0447,label:"spiral_A"},{f1:-.1848,f2:.1619,f3:.2221,f4:-.0617,label:"spiral_B"},{f1:.2521,f2:-.1971,f3:-.3081,f4:.138,label:"spiral_A"},{f1:-.22,f2:.1252,f3:.187,f4:-.038,label:"spiral_B"},{f1:.2986,f2:-.123,f3:-.2094,f4:.0901,label:"spiral_A"},{f1:-.2409,f2:.1337,f3:.2566,f4:-.1976,label:"spiral_B"},{f1:.2446,f2:-.1385,f3:-.3504,f4:.1879,label:"spiral_A"},{f1:-.265,f2:.1761,f3:.2406,f4:-.1571,label:"spiral_B"},{f1:.2383,f2:-.1438,f3:-.2279,f4:.0729,label:"spiral_A"},{f1:-.3411,f2:.1707,f3:.2911,f4:-.1834,label:"spiral_B"},{f1:.3396,f2:-.1577,f3:-.2431,f4:.16,label:"spiral_A"},{f1:-.2763,f2:.1743,f3:.1754,f4:-.1883,label:"spiral_B"},{f1:.298,f2:-.1943,f3:-.2195,f4:.1581,label:"spiral_A"},{f1:-.3258,f2:.0534,f3:.2253,f4:-.1911,label:"spiral_B"},{f1:.2101,f2:-.1814,f3:-.2965,f4:.1359,label:"spiral_A"},{f1:-.3197,f2:.0827,f3:.246,f4:-.1975,label:"spiral_B"},{f1:.2643,f2:-.0526,f3:-.2329,f4:.2265,label:"spiral_A"},{f1:-.3059,f2:.1637,f3:.223,f4:-.2671,label:"spiral_B"},{f1:.2769,f2:-.0737,f3:-.1877,f4:.1776,label:"spiral_A"},{f1:-.2463,f2:.0916,f3:.1608,f4:-.1944,label:"spiral_B"},{f1:.349,f2:-.095,f3:-.2157,f4:.2078,label:"spiral_A"},{f1:-.3507,f2:.0709,f3:.1849,f4:-.2901,label:"spiral_B"},{f1:.2953,f2:-.1279,f3:-.1276,f4:.2515,label:"spiral_A"},{f1:-.382,f2:.0911,f3:.265,f4:-.2312,label:"spiral_B"},{f1:.2643,f2:-.0441,f3:-.2005,f4:.2726,label:"spiral_A"},{f1:-.322,f2:.0469,f3:.142,f4:-.3375,label:"spiral_B"},{f1:.3014,f2:-.0392,f3:-.1206,f4:.2523,label:"spiral_A"},{f1:-.2885,f2:.0563,f3:.0976,f4:-.2935,label:"spiral_B"},{f1:.3221,f2:-.0198,f3:-.0829,f4:.3607,label:"spiral_A"},{f1:-.3257,f2:.0563,f3:.0771,f4:-.2525,label:"spiral_B"},{f1:.3203,f2:-.0026,f3:-.1079,f4:.3224,label:"spiral_A"},{f1:-.2843,f2:.0992,f3:.127,f4:-.2871,label:"spiral_B"},{f1:.3488,f2:-.0203,f3:-.0567,f4:.2935,label:"spiral_A"},{f1:-.3242,f2:-.003,f3:.0668,f4:-.3559,label:"spiral_B"},{f1:.4114,f2:.086,f3:.024,f4:.3394,label:"spiral_A"},{f1:-.3913,f2:.0144,f3:.0324,f4:-.3413,label:"spiral_B"},{f1:.3427,f2:.0059,f3:.0133,f4:.3299,label:"spiral_A"},{f1:-.3418,f2:-.0932,f3:.0472,f4:-.3251,label:"spiral_B"},{f1:.4231,f2:.0283,f3:.0601,f4:.336,label:"spiral_A"},{f1:-.3076,f2:.0251,f3:.0239,f4:-.3093,label:"spiral_B"},{f1:.3974,f2:.001,f3:.0309,f4:.3359,label:"spiral_A"},{f1:-.3627,f2:.0098,f3:-.0814,f4:-.3742,label:"spiral_B"},{f1:.365,f2:.0269,f3:.0966,f4:.3062,label:"spiral_A"},{f1:-.3715,f2:-.0394,f3:-.0154,f4:-.3886,label:"spiral_B"},{f1:.3965,f2:-.0018,f3:.0912,f4:.377,label:"spiral_A"},{f1:-.3941,f2:.006,f3:-.0082,f4:-.2595,label:"spiral_B"},{f1:.3204,f2:.0739,f3:.1224,f4:.3761,label:"spiral_A"},{f1:-.3718,f2:.0108,f3:-.078,f4:-.294,label:"spiral_B"},{f1:.3312,f2:.1078,f3:.1431,f4:.2798,label:"spiral_A"},{f1:-.3315,f2:-.0492,f3:-.0936,f4:-.3228,label:"spiral_B"},{f1:.3124,f2:.1168,f3:.1825,f4:.3217,label:"spiral_A"},{f1:-.3429,f2:-.1099,f3:-.1794,f4:-.3529,label:"spiral_B"},{f1:.3167,f2:.0447,f3:.1698,f4:.3025,label:"spiral_A"},{f1:-.287,f2:-.0564,f3:-.1625,f4:-.3017,label:"spiral_B"},{f1:.3504,f2:.0763,f3:.1919,f4:.3647,label:"spiral_A"},{f1:-.3254,f2:-.1172,f3:-.1908,f4:-.3104,label:"spiral_B"},{f1:.3074,f2:.0585,f3:.1969,f4:.2488,label:"spiral_A"},{f1:-.3956,f2:-.1463,f3:-.2223,f4:-.2438,label:"spiral_B"},{f1:.3555,f2:.1186,f3:.2299,f4:.2771,label:"spiral_A"},{f1:-.273,f2:-.1663,f3:-.2833,f4:-.2181,label:"spiral_B"},{f1:.2545,f2:.1231,f3:.3065,f4:.2028,label:"spiral_A"},{f1:-.3125,f2:-.0938,f3:-.2638,f4:-.2219,label:"spiral_B"},{f1:.3363,f2:.1483,f3:.3139,f4:.1857,label:"spiral_A"},{f1:-.3111,f2:-.1421,f3:-.311,f4:-.1988,label:"spiral_B"},{f1:.2622,f2:.1956,f3:.3332,f4:.1892,label:"spiral_A"},{f1:-.3192,f2:-.1737,f3:-.2958,f4:-.1849,label:"spiral_B"},{f1:.3427,f2:.2551,f3:.4416,f4:.0971,label:"spiral_A"},{f1:-.3255,f2:-.1742,f3:-.3327,f4:-.1875,label:"spiral_B"},{f1:.353,f2:.1726,f3:.2488,f4:.1652,label:"spiral_A"},{f1:-.3028,f2:-.182,f3:-.3311,f4:-.1583,label:"spiral_B"},{f1:.3169,f2:.2112,f3:.3084,f4:.1778,label:"spiral_A"},{f1:-.2692,f2:-.1749,f3:-.3557,f4:-.0934,label:"spiral_B"},{f1:.3126,f2:.2777,f3:.3475,f4:.0773,label:"spiral_A"},{f1:-.2554,f2:-.2136,f3:-.387,f4:-.1706,label:"spiral_B"},{f1:.2619,f2:.1945,f3:.2915,f4:.1123,label:"spiral_A"},{f1:-.1817,f2:-.2565,f3:-.3903,f4:-.095,label:"spiral_B"},{f1:.2647,f2:.2733,f3:.3902,f4:.0222,label:"spiral_A"},{f1:-.2501,f2:-.3238,f3:-.4579,f4:-.053,label:"spiral_B"},{f1:.2857,f2:.2334,f3:.3931,f4:.0457,label:"spiral_A"},{f1:-.3148,f2:-.2838,f3:-.3368,f4:.0596,label:"spiral_B"},{f1:.2676,f2:.2343,f3:.3867,f4:-.0017,label:"spiral_A"},{f1:-.2303,f2:-.3382,f3:-.42,f4:.0795,label:"spiral_B"},{f1:.1879,f2:.3125,f3:.3409,f4:-.0807,label:"spiral_A"},{f1:-.2469,f2:-.3025,f3:-.3427,f4:.0895,label:"spiral_B"},{f1:.2092,f2:.3673,f3:.3606,f4:-.0502,label:"spiral_A"},{f1:-.2263,f2:-.2981,f3:-.353,f4:.1336,label:"spiral_B"},{f1:.2132,f2:.3038,f3:.3301,f4:-.0485,label:"spiral_A"},{f1:-.2273,f2:-.2577,f3:-.3848,f4:.1057,label:"spiral_B"},{f1:.2274,f2:.3771,f3:.3679,f4:-.1666,label:"spiral_A"},{f1:-.2245,f2:-.2846,f3:-.4,f4:.1053,label:"spiral_B"},{f1:.1706,f2:.2733,f3:.4422,f4:-.1578,label:"spiral_A"},{f1:-.1664,f2:-.3415,f3:-.3244,f4:.1496,label:"spiral_B"},{f1:.1808,f2:.3889,f3:.3386,f4:-.2267,label:"spiral_A"},{f1:-.1665,f2:-.3288,f3:-.3294,f4:.1823,label:"spiral_B"},{f1:.1524,f2:.3148,f3:.3283,f4:-.2237,label:"spiral_A"},{f1:-.1868,f2:-.2513,f3:-.3038,f4:.2365,label:"spiral_B"},{f1:.0988,f2:.3682,f3:.2467,f4:-.2542,label:"spiral_A"},{f1:-.1666,f2:-.3672,f3:-.3101,f4:.2496,label:"spiral_B"},{f1:.0893,f2:.339,f3:.2846,f4:-.3337,label:"spiral_A"},{f1:-.1666,f2:-.4188,f3:-.3276,f4:.2523,label:"spiral_B"},{f1:.2099,f2:.4328,f3:.2625,f4:-.3305,label:"spiral_A"},{f1:-.1557,f2:-.2988,f3:-.339,f4:.3857,label:"spiral_B"},{f1:.172,f2:.4183,f3:.2463,f4:-.3809,label:"spiral_A"},{f1:-.1243,f2:-.3966,f3:-.2186,f4:.3612,label:"spiral_B"},{f1:.1186,f2:.3879,f3:.1966,f4:-.409,label:"spiral_A"},{f1:-.0655,f2:-.3648,f3:-.2492,f4:.3174,label:"spiral_B"},{f1:.1773,f2:.3624,f3:.1938,f4:-.3188,label:"spiral_A"},{f1:-.1317,f2:-.3894,f3:-.195,f4:.291,label:"spiral_B"},{f1:.1192,f2:.3736,f3:.1618,f4:-.3855,label:"spiral_A"},{f1:-.0535,f2:-.3855,f3:-.1907,f4:.3595,label:"spiral_B"},{f1:.074,f2:.4251,f3:.2012,f4:-.3913,label:"spiral_A"},{f1:-.0364,f2:-.4766,f3:-.1067,f4:.3954,label:"spiral_B"},{f1:.0046,f2:.4087,f3:.1197,f4:-.3375,label:"spiral_A"},{f1:-.1145,f2:-.3933,f3:-.109,f4:.3906,label:"spiral_B"},{f1:.0448,f2:.4455,f3:.0893,f4:-.3302,label:"spiral_A"},{f1:-.0314,f2:-.3745,f3:-.1358,f4:.4463,label:"spiral_B"},{f1:.0977,f2:.434,f3:.1182,f4:-.3959,label:"spiral_A"},{f1:-.0678,f2:-.3808,f3:-.0764,f4:.4338,label:"spiral_B"},{f1:-.056,f2:.4379,f3:.0455,f4:-.4113,label:"spiral_A"},{f1:-.075,f2:-.3751,f3:.057,f4:.4772,label:"spiral_B"},{f1:-.0425,f2:.4192,f3:.0127,f4:-.3805,label:"spiral_A"},{f1:-.0062,f2:-.4694,f3:-.0028,f4:.3526,label:"spiral_B"},{f1:-.0084,f2:.4146,f3:-.0057,f4:-.4274,label:"spiral_A"},{f1:-.0273,f2:-.384,f3:.0358,f4:.3848,label:"spiral_B"},{f1:.0334,f2:.3619,f3:.0268,f4:-.4547,label:"spiral_A"},{f1:.0631,f2:-.4209,f3:.1056,f4:.4041,label:"spiral_B"},{f1:-.0498,f2:.4018,f3:-.0847,f4:-.4047,label:"spiral_A"},{f1:.0501,f2:-.4065,f3:.14,f4:.4092,label:"spiral_B"},{f1:-.0782,f2:.4669,f3:-.156,f4:-.3995,label:"spiral_A"},{f1:.0735,f2:-.4055,f3:.1166,f4:.3564,label:"spiral_B"},{f1:-.0385,f2:.3907,f3:-.1722,f4:-.4681,label:"spiral_A"},{f1:.1045,f2:-.3862,f3:.1882,f4:.3656,label:"spiral_B"},{f1:-.0442,f2:.4299,f3:-.2096,f4:-.3841,label:"spiral_A"},{f1:.0425,f2:-.3986,f3:.1961,f4:.3911,label:"spiral_B"},{f1:-.0349,f2:.3365,f3:-.2217,f4:-.3746,label:"spiral_A"},{f1:.1414,f2:-.3264,f3:.201,f4:.3537,label:"spiral_B"},{f1:-.1117,f2:.4707,f3:-.1805,f4:-.2982,label:"spiral_A"},{f1:.0981,f2:-.3989,f3:.291,f4:.3775,label:"spiral_B"},{f1:-.1147,f2:.4095,f3:-.2492,f4:-.3656,label:"spiral_A"},{f1:.1271,f2:-.4457,f3:.2772,f4:.3779,label:"spiral_B"},{f1:-.1686,f2:.4789,f3:-.3078,f4:-.3452,label:"spiral_A"},{f1:.1625,f2:-.3782,f3:.2517,f4:.3537,label:"spiral_B"},{f1:-.233,f2:.3971,f3:-.3266,f4:-.3494,label:"spiral_A"},{f1:.1911,f2:-.3921,f3:.3464,f4:.3419,label:"spiral_B"},{f1:-.1092,f2:.4029,f3:-.2573,f4:-.2404,label:"spiral_A"},{f1:.1724,f2:-.4475,f3:.3061,f4:.2809,label:"spiral_B"},{f1:-.24,f2:.4614,f3:-.4038,f4:-.2921,label:"spiral_A"},{f1:.2384,f2:-.3388,f3:.3279,f4:.2329,label:"spiral_B"},{f1:-.2026,f2:.4144,f3:-.3688,f4:-.2126,label:"spiral_A"},{f1:.2182,f2:-.3829,f3:.3499,f4:.2523,label:"spiral_B"},{f1:-.2874,f2:.3095,f3:-.4172,f4:-.1451,label:"spiral_A"},{f1:.2451,f2:-.3902,f3:.3993,f4:.1881,label:"spiral_B"},{f1:-.2148,f2:.3178,f3:-.4574,f4:-.1171,label:"spiral_A"},{f1:.2229,f2:-.3789,f3:.3972,f4:.1648,label:"spiral_B"},{f1:-.2441,f2:.3023,f3:-.5083,f4:-.1837,label:"spiral_A"},{f1:.2845,f2:-.3352,f3:.4267,f4:.1447,label:"spiral_B"},{f1:-.2756,f2:.3513,f3:-.3898,f4:-.1023,label:"spiral_A"},{f1:.2492,f2:-.3732,f3:.3673,f4:.1106,label:"spiral_B"},{f1:-.3092,f2:.3606,f3:-.4534,f4:-.0799,label:"spiral_A"},{f1:.3033,f2:-.3179,f3:.3863,f4:.0974,label:"spiral_B"},{f1:-.3477,f2:.3477,f3:-.4341,f4:-.0512,label:"spiral_A"},{f1:.3161,f2:-.4033,f3:.4297,f4:.0707,label:"spiral_B"},{f1:-.3526,f2:.268,f3:-.4609,f4:.0455,label:"spiral_A"},{f1:.3041,f2:-.3704,f3:.4973,f4:.0072,label:"spiral_B"},{f1:-.3442,f2:.3371,f3:-.4887,f4:.0982,label:"spiral_A"},{f1:.311,f2:-.3325,f3:.3928,f4:.0145,label:"spiral_B"},{f1:-.3455,f2:.3156,f3:-.3716,f4:.092,label:"spiral_A"},{f1:.3173,f2:-.3012,f3:.462,f4:-.0603,label:"spiral_B"},{f1:-.3982,f2:.2637,f3:-.4277,f4:.1446,label:"spiral_A"},{f1:.3097,f2:-.3234,f3:.5069,f4:-.1063,label:"spiral_B"},{f1:-.3495,f2:.2287,f3:-.431,f4:.2276,label:"spiral_A"},{f1:.3171,f2:-.245,f3:.3933,f4:-.1631,label:"spiral_B"},{f1:-.3467,f2:.2054,f3:-.4333,f4:.2446,label:"spiral_A"},{f1:.4495,f2:-.2571,f3:.4051,f4:-.1853,label:"spiral_B"},{f1:-.4785,f2:.2492,f3:-.4494,f4:.2545,label:"spiral_A"},{f1:.4647,f2:-.2598,f3:.41,f4:-.1754,label:"spiral_B"},{f1:-.4768,f2:.2058,f3:-.4537,f4:.2927,label:"spiral_A"},{f1:.4174,f2:-.2203,f3:.4124,f4:-.26,label:"spiral_B"},{f1:-.3691,f2:.3016,f3:-.4441,f4:.3119,label:"spiral_A"},{f1:.4451,f2:-.1821,f3:.3491,f4:-.3087,label:"spiral_B"},{f1:-.3932,f2:.0986,f3:-.4006,f4:.2841,label:"spiral_A"},{f1:.512,f2:-.2084,f3:.3499,f4:-.2908,label:"spiral_B"},{f1:-.4775,f2:.1843,f3:-.315,f4:.386,label:"spiral_A"},{f1:.3832,f2:-.1708,f3:.4237,f4:-.2743,label:"spiral_B"},{f1:-.4799,f2:.1571,f3:-.2579,f4:.3737,label:"spiral_A"},{f1:.5119,f2:-.1342,f3:.3425,f4:-.3666,label:"spiral_B"},{f1:-.442,f2:.2216,f3:-.2483,f4:.3458,label:"spiral_A"},{f1:.4319,f2:-.1491,f3:.2427,f4:-.4403,label:"spiral_B"},{f1:-.4398,f2:.1432,f3:-.2001,f4:.3865,label:"spiral_A"},{f1:.4815,f2:-.1075,f3:.2487,f4:-.4934,label:"spiral_B"},{f1:-.5205,f2:.1445,f3:-.2077,f4:.4265,label:"spiral_A"},{f1:.4357,f2:-.1631,f3:.1304,f4:-.4145,label:"spiral_B"},{f1:-.5286,f2:.0675,f3:-.1072,f4:.438,label:"spiral_A"},{f1:.3971,f2:-.1786,f3:.162,f4:-.41,label:"spiral_B"},{f1:-.4795,f2:.1069,f3:-.2123,f4:.4291,label:"spiral_A"},{f1:.5176,f2:-.143,f3:.1725,f4:-.5145,label:"spiral_B"},{f1:-.5403,f2:.021,f3:-.1201,f4:.555,label:"spiral_A"},{f1:.463,f2:-.0445,f3:.1094,f4:-.4236,label:"spiral_B"},{f1:-.4401,f2:.1127,f3:-.1188,f4:.4039,label:"spiral_A"},{f1:.4923,f2:.052,f3:.1017,f4:-.4939,label:"spiral_B"},{f1:-.5445,f2:.0344,f3:-.0689,f4:.4812,label:"spiral_A"},{f1:.5487,f2:-.0601,f3:.0327,f4:-.5255,label:"spiral_B"},{f1:-.4858,f2:-.0056,f3:-.0831,f4:.5287,label:"spiral_A"},{f1:.4139,f2:-.0391,f3:-.0042,f4:-.5322,label:"spiral_B"},{f1:-.4436,f2:-.0724,f3:.0019,f4:.481,label:"spiral_A"},{f1:.4564,f2:.0126,f3:.0082,f4:-.48,label:"spiral_B"},{f1:-.4712,f2:-.0172,f3:.0941,f4:.5253,label:"spiral_A"},{f1:.4233,f2:.018,f3:-.1281,f4:-.5526,label:"spiral_B"},{f1:-.5146,f2:.0082,f3:.0492,f4:.4536,label:"spiral_A"},{f1:.5828,f2:.0663,f3:-.0796,f4:-.4911,label:"spiral_B"},{f1:-.5143,f2:-.0209,f3:.1753,f4:.4834,label:"spiral_A"},{f1:.5359,f2:.1252,f3:-.1593,f4:-.5037,label:"spiral_B"},{f1:-.5405,f2:-.1107,f3:.1392,f4:.4458,label:"spiral_A"},{f1:.574,f2:.1101,f3:-.1868,f4:-.5142,label:"spiral_B"},{f1:-.4668,f2:-.114,f3:.221,f4:.4002,label:"spiral_A"},{f1:.5617,f2:.0999,f3:-.1859,f4:-.4007,label:"spiral_B"},{f1:-.5158,f2:-.1653,f3:.2129,f4:.3339,label:"spiral_A"},{f1:.6112,f2:.2334,f3:-.2963,f4:-.4499,label:"spiral_B"},{f1:-.4955,f2:-.1562,f3:.2691,f4:.4137,label:"spiral_A"},{f1:.4682,f2:.1308,f3:-.2757,f4:-.3828,label:"spiral_B"},{f1:-.483,f2:-.2398,f3:.3493,f4:.4017,label:"spiral_A"},{f1:.4301,f2:.1878,f3:-.3477,f4:-.4097,label:"spiral_B"},{f1:-.561,f2:-.1761,f3:.268,f4:.4287,label:"spiral_A"},{f1:.5483,f2:.175,f3:-.2523,f4:-.451,label:"spiral_B"},{f1:-.493,f2:-.2392,f3:.3854,f4:.3172,label:"spiral_A"},{f1:.4405,f2:.1762,f3:-.3957,f4:-.4203,label:"spiral_B"},{f1:-.4779,f2:-.1246,f3:.4944,f4:.2988,label:"spiral_A"},{f1:.4913,f2:.2569,f3:-.4095,f4:-.3321,label:"spiral_B"},{f1:-.527,f2:-.2941,f3:.4463,f4:.267,label:"spiral_A"},{f1:.5105,f2:.2811,f3:-.3884,f4:-.2907,label:"spiral_B"},{f1:-.4844,f2:-.261,f3:.4665,f4:.266,label:"spiral_A"},{f1:.4056,f2:.217,f3:-.4994,f4:-.2804,label:"spiral_B"},{f1:-.4767,f2:-.2585,f3:.4274,f4:.2421,label:"spiral_A"},{f1:.5352,f2:.3069,f3:-.447,f4:-.2504,label:"spiral_B"},{f1:-.479,f2:-.2906,f3:.5007,f4:.2165,label:"spiral_A"},{f1:.419,f2:.2913,f3:-.5121,f4:-.2085,label:"spiral_B"},{f1:-.4917,f2:-.2961,f3:.5706,f4:.1699,label:"spiral_A"},{f1:.344,f2:.3044,f3:-.4796,f4:-.2238,label:"spiral_B"},{f1:-.4076,f2:-.3553,f3:.4095,f4:.0511,label:"spiral_A"},{f1:.4961,f2:.3144,f3:-.5221,f4:-.0661,label:"spiral_B"},{f1:-.4284,f2:-.2442,f3:.5894,f4:.0939,label:"spiral_A"},{f1:.4048,f2:.4743,f3:-.5289,f4:-.0427,label:"spiral_B"},{f1:-.4414,f2:-.3453,f3:.5741,f4:.055,label:"spiral_A"},{f1:.3709,f2:.4398,f3:-.525,f4:-.04,label:"spiral_B"},{f1:-.3568,f2:-.3321,f3:.5902,f4:.0342,label:"spiral_A"},{f1:.3454,f2:.3147,f3:-.5816,f4:-.0163,label:"spiral_B"},{f1:-.4138,f2:-.403,f3:.5052,f4:-.0445,label:"spiral_A"},{f1:.3486,f2:.3901,f3:-.505,f4:.0073,label:"spiral_B"},{f1:-.3618,f2:-.4421,f3:.4981,f4:-.0756,label:"spiral_A"},{f1:.3289,f2:.3951,f3:-.5747,f4:-.0013,label:"spiral_B"},{f1:-.3611,f2:-.4906,f3:.5582,f4:-.1221,label:"spiral_A"},{f1:.2991,f2:.4991,f3:-.5004,f4:.1858,label:"spiral_B"},{f1:-.3052,f2:-.4442,f3:.5809,f4:-.158,label:"spiral_A"},{f1:.3267,f2:.4174,f3:-.5841,f4:.1738,label:"spiral_B"},{f1:-.3299,f2:-.4681,f3:.5267,f4:-.1332,label:"spiral_A"},{f1:.2932,f2:.4658,f3:-.5964,f4:.1683,label:"spiral_B"},{f1:-.3351,f2:-.4155,f3:.4713,f4:-.2565,label:"spiral_A"},{f1:.2495,f2:.4738,f3:-.4875,f4:.2719,label:"spiral_B"},{f1:-.3397,f2:-.4178,f3:.5147,f4:-.2449,label:"spiral_A"},{f1:.322,f2:.4768,f3:-.5749,f4:.256,label:"spiral_B"},{f1:-.2531,f2:-.4801,f3:.4626,f4:-.3524,label:"spiral_A"},{f1:.2832,f2:.5316,f3:-.3956,f4:.3419,label:"spiral_B"},{f1:-.2305,f2:-.4914,f3:.4313,f4:-.3753,label:"spiral_A"},{f1:.2516,f2:.4182,f3:-.432,f4:.3579,label:"spiral_B"},{f1:-.2808,f2:-.4342,f3:.4291,f4:-.3594,label:"spiral_A"},{f1:.2468,f2:.5536,f3:-.4424,f4:.3736,label:"spiral_B"},{f1:-.2378,f2:-.5741,f3:.3057,f4:-.4762,label:"spiral_A"},{f1:.2212,f2:.5516,f3:-.3615,f4:.4515,label:"spiral_B"},{f1:-.1764,f2:-.5586,f3:.3026,f4:-.4767,label:"spiral_A"},{f1:.1923,f2:.5217,f3:-.4408,f4:.3879,label:"spiral_B"},{f1:-.21,f2:-.464,f3:.3525,f4:-.5303,label:"spiral_A"},{f1:.1831,f2:.5615,f3:-.343,f4:.4384,label:"spiral_B"},{f1:-.1778,f2:-.6136,f3:.2996,f4:-.4855,label:"spiral_A"},{f1:.1966,f2:.5301,f3:-.2425,f4:.5212,label:"spiral_B"},{f1:-.1806,f2:-.565,f3:.3089,f4:-.4738,label:"spiral_A"},{f1:.1552,f2:.562,f3:-.288,f4:.5027,label:"spiral_B"},{f1:-.0792,f2:-.503,f3:.1896,f4:-.4988,label:"spiral_A"},{f1:.0187,f2:.5688,f3:-.2473,f4:.5607,label:"spiral_B"},{f1:-.1022,f2:-.5928,f3:.1615,f4:-.586,label:"spiral_A"},{f1:.0816,f2:.5446,f3:-.1561,f4:.5242,label:"spiral_B"},{f1:-.0356,f2:-.6684,f3:.1162,f4:-.5759,label:"spiral_A"},{f1:.0157,f2:.6201,f3:-.1193,f4:.5024,label:"spiral_B"},{f1:-.0388,f2:-.5466,f3:.1075,f4:-.5753,label:"spiral_A"},{f1:.0567,f2:.5918,f3:-.1214,f4:.5734,label:"spiral_B"},{f1:.0393,f2:-.604,f3:.0128,f4:-.5661,label:"spiral_A"},{f1:.1255,f2:.5734,f3:-.0056,f4:.6501,label:"spiral_B"},{f1:-.0705,f2:-.6358,f3:.0262,f4:-.5888,label:"spiral_A"},{f1:.0422,f2:.6008,f3:.0173,f4:.5303,label:"spiral_B"},{f1:.0941,f2:-.5809,f3:-.0477,f4:-.6051,label:"spiral_A"},{f1:-.0529,f2:.6087,f3:.1097,f4:.547,label:"spiral_B"},{f1:.0618,f2:-.6128,f3:-.0544,f4:-.6056,label:"spiral_A"},{f1:.0237,f2:.6488,f3:-5e-4,f4:.6096,label:"spiral_B"},{f1:.0278,f2:-.5978,f3:-.1714,f4:-.5316,label:"spiral_A"},{f1:-.0654,f2:.5013,f3:.1456,f4:.4958,label:"spiral_B"},{f1:.0171,f2:-.5651,f3:-.2197,f4:-.5144,label:"spiral_A"},{f1:-.0792,f2:.6092,f3:.1997,f4:.5203,label:"spiral_B"},{f1:.1017,f2:-.5946,f3:-.2244,f4:-.5778,label:"spiral_A"},{f1:-.098,f2:.5486,f3:.2201,f4:.5324,label:"spiral_B"},{f1:.137,f2:-.5894,f3:-.2595,f4:-.5697,label:"spiral_A"},{f1:-.1276,f2:.6171,f3:.2304,f4:.5985,label:"spiral_B"},{f1:.1304,f2:-.5696,f3:-.3646,f4:-.5605,label:"spiral_A"},{f1:-.1922,f2:.4818,f3:.4001,f4:.5283,label:"spiral_B"},{f1:.2037,f2:-.5662,f3:-.3136,f4:-.5118,label:"spiral_A"},{f1:-.2088,f2:.6273,f3:.3879,f4:.4453,label:"spiral_B"},{f1:.1835,f2:-.4796,f3:-.4158,f4:-.404,label:"spiral_A"},{f1:-.0967,f2:.5266,f3:.3495,f4:.4283,label:"spiral_B"},{f1:.2097,f2:-.4879,f3:-.384,f4:-.427,label:"spiral_A"},{f1:-.2438,f2:.597,f3:.3845,f4:.4625,label:"spiral_B"},{f1:.2787,f2:-.5552,f3:-.4426,f4:-.4913,label:"spiral_A"},{f1:-.1896,f2:.5833,f3:.4722,f4:.4354,label:"spiral_B"},{f1:.312,f2:-.5396,f3:-.5478,f4:-.3681,label:"spiral_A"},{f1:-.2542,f2:.5819,f3:.4991,f4:.3911,label:"spiral_B"},{f1:.2433,f2:-.5632,f3:-.547,f4:-.2826,label:"spiral_A"},{f1:-.2637,f2:.5341,f3:.5157,f4:.3027,label:"spiral_B"},{f1:.4192,f2:-.5154,f3:-.4682,f4:-.3594,label:"spiral_A"},{f1:-.3232,f2:.5494,f3:.4842,f4:.3216,label:"spiral_B"},{f1:.3004,f2:-.4858,f3:-.5326,f4:-.3133,label:"spiral_A"},{f1:-.3401,f2:.5235,f3:.5461,f4:.2808,label:"spiral_B"},{f1:.2952,f2:-.5337,f3:-.5901,f4:-.2751,label:"spiral_A"},{f1:-.3499,f2:.5685,f3:.5558,f4:.2153,label:"spiral_B"},{f1:.3673,f2:-.5654,f3:-.5405,f4:-.2364,label:"spiral_A"},{f1:-.373,f2:.5347,f3:.5624,f4:.1636,label:"spiral_B"},{f1:.3415,f2:-.427,f3:-.5554,f4:-.1036,label:"spiral_A"},{f1:-.352,f2:.4184,f3:.7094,f4:.0432,label:"spiral_B"},{f1:.4707,f2:-.4544,f3:-.619,f4:-.0327,label:"spiral_A"},{f1:-.4434,f2:.4467,f3:.6424,f4:.1378,label:"spiral_B"},{f1:.391,f2:-.5045,f3:-.6059,f4:-.064,label:"spiral_A"},{f1:-.382,f2:.5064,f3:.6321,f4:.0943,label:"spiral_B"},{f1:.442,f2:-.4451,f3:-.638,f4:.0443,label:"spiral_A"},{f1:-.4232,f2:.4678,f3:.6377,f4:.0328,label:"spiral_B"},{f1:.4158,f2:-.3809,f3:-.6264,f4:.1226,label:"spiral_A"},{f1:-.4739,f2:.3919,f3:.6297,f4:-.1214,label:"spiral_B"},{f1:.4207,f2:-.5127,f3:-.5799,f4:.1152,label:"spiral_A"},{f1:-.5166,f2:.4111,f3:.6134,f4:-.0507,label:"spiral_B"},{f1:.4744,f2:-.3977,f3:-.6311,f4:.1946,label:"spiral_A"},{f1:-.467,f2:.4102,f3:.5922,f4:-.1106,label:"spiral_B"},{f1:.5604,f2:-.4031,f3:-.5702,f4:.1743,label:"spiral_A"},{f1:-.5221,f2:.3213,f3:.5322,f4:-.2189,label:"spiral_B"},{f1:.5518,f2:-.3232,f3:-.5259,f4:.248,label:"spiral_A"},{f1:-.4787,f2:.3556,f3:.6748,f4:-.2637,label:"spiral_B"},{f1:.5437,f2:-.3386,f3:-.5152,f4:.2825,label:"spiral_A"},{f1:-.5506,f2:.3514,f3:.5226,f4:-.2889,label:"spiral_B"},{f1:.5517,f2:-.308,f3:-.5575,f4:.2852,label:"spiral_A"},{f1:-.5901,f2:.3532,f3:.5282,f4:-.3188,label:"spiral_B"},{f1:.5472,f2:-.2198,f3:-.5096,f4:.4709,label:"spiral_A"},{f1:-.5634,f2:.2465,f3:.5119,f4:-.35,label:"spiral_B"},{f1:.5461,f2:-.2569,f3:-.4226,f4:.3999,label:"spiral_A"},{f1:-.5748,f2:.2524,f3:.4952,f4:-.4141,label:"spiral_B"},{f1:.5292,f2:-.2571,f3:-.5411,f4:.4391,label:"spiral_A"},{f1:-.5341,f2:.2649,f3:.4711,f4:-.4141,label:"spiral_B"},{f1:.5762,f2:-.2404,f3:-.4254,f4:.4989,label:"spiral_A"},{f1:-.6081,f2:.1986,f3:.4226,f4:-.4516,label:"spiral_B"},{f1:.5702,f2:-.1655,f3:-.4002,f4:.4253,label:"spiral_A"},{f1:-.601,f2:.1744,f3:.3777,f4:-.5393,label:"spiral_B"},{f1:.5927,f2:-.1911,f3:-.3617,f4:.5552,label:"spiral_A"},{f1:-.6521,f2:.2188,f3:.3838,f4:-.5747,label:"spiral_B"},{f1:.6841,f2:-.189,f3:-.3411,f4:.5517,label:"spiral_A"},{f1:-.6266,f2:.1339,f3:.3404,f4:-.5746,label:"spiral_B"},{f1:.6354,f2:-.1015,f3:-.2931,f4:.6661,label:"spiral_A"},{f1:-.6662,f2:.0894,f3:.1832,f4:-.645,label:"spiral_B"},{f1:.678,f2:-.1111,f3:-.2156,f4:.5911,label:"spiral_A"},{f1:-.6089,f2:.1434,f3:.1754,f4:-.5918,label:"spiral_B"},{f1:.6422,f2:-.0634,f3:-.2023,f4:.6396,label:"spiral_A"},{f1:-.676,f2:.0939,f3:.1929,f4:-.6799,label:"spiral_B"},{f1:.5876,f2:-.0417,f3:-.1145,f4:.7064,label:"spiral_A"},{f1:-.6731,f2:.1173,f3:.099,f4:-.7327,label:"spiral_B"},{f1:.6216,f2:-.0783,f3:-.1176,f4:.7134,label:"spiral_A"},{f1:-.6578,f2:.0295,f3:.0863,f4:-.6449,label:"spiral_B"},{f1:.6821,f2:-.006,f3:-.0174,f4:.6673,label:"spiral_A"},{f1:-.6756,f2:.0592,f3:-.0292,f4:-.6401,label:"spiral_B"},{f1:.6304,f2:5e-4,f3:.0435,f4:.6588,label:"spiral_A"},{f1:-.7875,f2:-.0304,f3:-.0247,f4:-.6671,label:"spiral_B"},{f1:.5817,f2:.0395,f3:.0465,f4:.6178,label:"spiral_A"},{f1:-.6779,f2:-.0483,f3:-.1431,f4:-.7385,label:"spiral_B"},{f1:.7571,f2:.0445,f3:.1264,f4:.6492,label:"spiral_A"},{f1:-.6552,f2:-.0651,f3:-.1439,f4:-.6645,label:"spiral_B"},{f1:.6894,f2:.0664,f3:.1535,f4:.6427,label:"spiral_A"},{f1:-.7367,f2:-.1086,f3:-.0537,f4:-.6411,label:"spiral_B"},{f1:.7116,f2:.0779,f3:.2565,f4:.6427,label:"spiral_A"},{f1:-.7036,f2:-.1006,f3:-.1271,f4:-.5779,label:"spiral_B"},{f1:.7456,f2:.1732,f3:.2702,f4:.5682,label:"spiral_A"},{f1:-.6412,f2:-.1466,f3:-.2759,f4:-.5761,label:"spiral_B"},{f1:.6484,f2:.1165,f3:.3085,f4:.5863,label:"spiral_A"},{f1:-.6195,f2:-.1628,f3:-.3019,f4:-.5848,label:"spiral_B"},{f1:.7162,f2:.1736,f3:.3442,f4:.6606,label:"spiral_A"},{f1:-.6798,f2:-.2214,f3:-.3729,f4:-.5016,label:"spiral_B"},{f1:.6445,f2:.2242,f3:.3601,f4:.5774,label:"spiral_A"},{f1:-.5917,f2:-.1775,f3:-.4039,f4:-.5917,label:"spiral_B"},{f1:.6575,f2:.2228,f3:.4956,f4:.4679,label:"spiral_A"},{f1:-.6381,f2:-.1274,f3:-.4487,f4:-.506,label:"spiral_B"},{f1:.6004,f2:.2586,f3:.4475,f4:.5116,label:"spiral_A"},{f1:-.6985,f2:-.2709,f3:-.4712,f4:-.4183,label:"spiral_B"},{f1:.6077,f2:.283,f3:.5654,f4:.4485,label:"spiral_A"},{f1:-.6329,f2:-.2288,f3:-.5279,f4:-.5157,label:"spiral_B"},{f1:.5998,f2:.3497,f3:.5529,f4:.5079,label:"spiral_A"},{f1:-.6017,f2:-.2243,f3:-.5142,f4:-.4435,label:"spiral_B"},{f1:.6578,f2:.408,f3:.6095,f4:.3622,label:"spiral_A"},{f1:-.6095,f2:-.2778,f3:-.4989,f4:-.3616,label:"spiral_B"},{f1:.5499,f2:.3023,f3:.6372,f4:.3656,label:"spiral_A"},{f1:-.595,f2:-.3474,f3:-.6774,f4:-.2456,label:"spiral_B"},{f1:.5708,f2:.4127,f3:.6356,f4:.2932,label:"spiral_A"},{f1:-.6136,f2:-.4531,f3:-.6642,f4:-.2458,label:"spiral_B"},{f1:.5797,f2:.4125,f3:.7459,f4:.1497,label:"spiral_A"},{f1:-.6582,f2:-.4286,f3:-.6609,f4:-.2696,label:"spiral_B"},{f1:.6163,f2:.4761,f3:.7425,f4:.2291,label:"spiral_A"},{f1:-.5854,f2:-.4674,f3:-.6028,f4:-.2079,label:"spiral_B"},{f1:.5012,f2:.4221,f3:.6871,f4:.1747,label:"spiral_A"},{f1:-.4986,f2:-.4216,f3:-.6429,f4:-.1112,label:"spiral_B"},{f1:.6001,f2:.4791,f3:.6774,f4:-7e-4,label:"spiral_A"},{f1:-.5202,f2:-.4171,f3:-.7459,f4:-.086,label:"spiral_B"},{f1:.4901,f2:.45,f3:.756,f4:-.0622,label:"spiral_A"},{f1:-.4652,f2:-.5075,f3:-.6743,f4:.0023,label:"spiral_B"},{f1:.4913,f2:.5,f3:.6121,f4:-.0897,label:"spiral_A"},{f1:-.4958,f2:-.4537,f3:-.7054,f4:.0746,label:"spiral_B"},{f1:.4588,f2:.601,f3:.726,f4:-.0628,label:"spiral_A"},{f1:-.425,f2:-.5763,f3:-.6977,f4:.1,label:"spiral_B"},{f1:.4016,f2:.4831,f3:.6769,f4:-.1872,label:"spiral_A"},{f1:-.4338,f2:-.5227,f3:-.642,f4:.1161,label:"spiral_B"},{f1:.4444,f2:.5904,f3:.6794,f4:-.1816,label:"spiral_A"},{f1:-.4218,f2:-.5379,f3:-.664,f4:.1839,label:"spiral_B"},{f1:.3961,f2:.5839,f3:.686,f4:-.2337,label:"spiral_A"},{f1:-.4219,f2:-.5867,f3:-.6368,f4:.2446,label:"spiral_B"},{f1:.4103,f2:.5926,f3:.6752,f4:-.2807,label:"spiral_A"},{f1:-.3903,f2:-.6385,f3:-.7321,f4:.3128,label:"spiral_B"},{f1:.3099,f2:.6432,f3:.6536,f4:-.3765,label:"spiral_A"},{f1:-.3875,f2:-.6446,f3:-.6077,f4:.4108,label:"spiral_B"},{f1:.4002,f2:.636,f3:.5809,f4:-.4023,label:"spiral_A"},{f1:-.3512,f2:-.6199,f3:-.6419,f4:.4005,label:"spiral_B"},{f1:.2375,f2:.7242,f3:.6061,f4:-.4794,label:"spiral_A"},{f1:-.3276,f2:-.6384,f3:-.5763,f4:.3972,label:"spiral_B"},{f1:.286,f2:.6187,f3:.5874,f4:-.5138,label:"spiral_A"},{f1:-.2644,f2:-.657,f3:-.5502,f4:.5417,label:"spiral_B"},{f1:.3438,f2:.7496,f3:.4677,f4:-.5884,label:"spiral_A"},{f1:-.3108,f2:-.712,f3:-.4843,f4:.4874,label:"spiral_B"},{f1:.2688,f2:.7392,f3:.4696,f4:-.5023,label:"spiral_A"},{f1:-.2925,f2:-.678,f3:-.4165,f4:.5165,label:"spiral_B"},{f1:.1914,f2:.7401,f3:.4692,f4:-.5902,label:"spiral_A"},{f1:-.2742,f2:-.6382,f3:-.4472,f4:.5359,label:"spiral_B"},{f1:.1566,f2:.6931,f3:.3299,f4:-.5974,label:"spiral_A"},{f1:-.2341,f2:-.7213,f3:-.4249,f4:.5737,label:"spiral_B"},{f1:.2292,f2:.7498,f3:.3557,f4:-.6888,label:"spiral_A"},{f1:-.2327,f2:-.7335,f3:-.2376,f4:.626,label:"spiral_B"},{f1:.1821,f2:.6828,f3:.2895,f4:-.6361,label:"spiral_A"},{f1:-.142,f2:-.7212,f3:-.2905,f4:.7289,label:"spiral_B"},{f1:.1483,f2:.7419,f3:.2482,f4:-.7235,label:"spiral_A"},{f1:-.1266,f2:-.7837,f3:-.2205,f4:.7209,label:"spiral_B"},{f1:.0654,f2:.7234,f3:.2281,f4:-.7238,label:"spiral_A"},{f1:-.093,f2:-.7731,f3:-.1939,f4:.7103,label:"spiral_B"},{f1:.0812,f2:.767,f3:.0969,f4:-.6951,label:"spiral_A"},{f1:-.0625,f2:-.6715,f3:-.0913,f4:.8091,label:"spiral_B"},{f1:.0509,f2:.7463,f3:.0058,f4:-.7256,label:"spiral_A"},{f1:-.0016,f2:-.7424,f3:-.068,f4:.7058,label:"spiral_B"},{f1:.0258,f2:.7318,f3:.0168,f4:-.7407,label:"spiral_A"},{f1:-.0435,f2:-.7463,f3:-.0497,f4:.7491,label:"spiral_B"},{f1:-.0152,f2:.7742,f3:-.0431,f4:-.7693,label:"spiral_A"},{f1:.0935,f2:-.7479,f3:.0588,f4:.7884,label:"spiral_B"},{f1:-.0544,f2:.8272,f3:-.1374,f4:-.716,label:"spiral_A"},{f1:.0936,f2:-.7584,f3:.0538,f4:.7776,label:"spiral_B"},{f1:-.0784,f2:.7146,f3:-.159,f4:-.8163,label:"spiral_A"},{f1:.1499,f2:-.7299,f3:.1785,f4:.6946,label:"spiral_B"},{f1:-.158,f2:.7169,f3:-.2229,f4:-.7656,label:"spiral_A"},{f1:.1441,f2:-.8065,f3:.1797,f4:.732,label:"spiral_B"},{f1:-.0814,f2:.6758,f3:-.2883,f4:-.687,label:"spiral_A"},{f1:.0864,f2:-.7438,f3:.2687,f4:.7313,label:"spiral_B"},{f1:-.1342,f2:.7154,f3:-.3487,f4:-.7041,label:"spiral_A"},{f1:.1273,f2:-.7145,f3:.2931,f4:.7397,label:"spiral_B"},{f1:-.1574,f2:.749,f3:-.361,f4:-.7576,label:"spiral_A"},{f1:.2106,f2:-.7859,f3:.4081,f4:.6521,label:"spiral_B"},{f1:-.235,f2:.7299,f3:-.4398,f4:-.648,label:"spiral_A"},{f1:.2123,f2:-.7808,f3:.3953,f4:.604,label:"spiral_B"},{f1:-.2455,f2:.7668,f3:-.4758,f4:-.5579,label:"spiral_A"},{f1:.2697,f2:-.6241,f3:.4678,f4:.6902,label:"spiral_B"},{f1:-.25,f2:.7083,f3:-.4763,f4:-.6052,label:"spiral_A"},{f1:.2893,f2:-.7328,f3:.5487,f4:.4862,label:"spiral_B"},{f1:-.3437,f2:.7021,f3:-.5677,f4:-.5899,label:"spiral_A"},{f1:.2817,f2:-.6941,f3:.5573,f4:.5529,label:"spiral_B"},{f1:-.3056,f2:.6259,f3:-.5495,f4:-.5603,label:"spiral_A"},{f1:.3351,f2:-.6194,f3:.6165,f4:.4879,label:"spiral_B"},{f1:-.3165,f2:.7379,f3:-.5992,f4:-.4068,label:"spiral_A"},{f1:.3744,f2:-.6521,f3:.6899,f4:.4382,label:"spiral_B"},{f1:-.385,f2:.6204,f3:-.5757,f4:-.3853,label:"spiral_A"},{f1:.4448,f2:-.6334,f3:.6868,f4:.4368,label:"spiral_B"},{f1:-.4093,f2:.6935,f3:-.7409,f4:-.4028,label:"spiral_A"},{f1:.376,f2:-.5868,f3:.7422,f4:.3626,label:"spiral_B"},{f1:-.4382,f2:.6465,f3:-.7734,f4:-.3222,label:"spiral_A"},{f1:.492,f2:-.7054,f3:.755,f4:.3701,label:"spiral_B"},{f1:-.4758,f2:.6512,f3:-.7506,f4:-.2682,label:"spiral_A"},{f1:.4697,f2:-.6585,f3:.7539,f4:.3115,label:"spiral_B"},{f1:-.4808,f2:.6101,f3:-.7597,f4:-.2007,label:"spiral_A"},{f1:.4523,f2:-.6217,f3:.8136,f4:.2361,label:"spiral_B"},{f1:-.4808,f2:.5903,f3:-.7722,f4:-.0899,label:"spiral_A"},{f1:.4987,f2:-.567,f3:.7934,f4:.1494,label:"spiral_B"},{f1:-.5832,f2:.5608,f3:-.7525,f4:-.0661,label:"spiral_A"},{f1:.5889,f2:-.5477,f3:.7909,f4:.0202,label:"spiral_B"},{f1:-.6077,f2:.6118,f3:-.8336,f4:-.0085,label:"spiral_A"},{f1:.5602,f2:-.5477,f3:.8398,f4:.019,label:"spiral_B"},{f1:-.6151,f2:.5587,f3:-.8131,f4:.023,label:"spiral_A"},{f1:.5794,f2:-.6301,f3:.8194,f4:-.0755,label:"spiral_B"},{f1:-.6104,f2:.5359,f3:-.8259,f4:.0885,label:"spiral_A"},{f1:.6264,f2:-.5192,f3:.7836,f4:-.1502,label:"spiral_B"},{f1:-.6344,f2:.5514,f3:-.7318,f4:.1895,label:"spiral_A"},{f1:.6586,f2:-.4424,f3:.6871,f4:-.1923,label:"spiral_B"},{f1:-.6572,f2:.4858,f3:-.709,f4:.2439,label:"spiral_A"},{f1:.6673,f2:-.4414,f3:.747,f4:-.1498,label:"spiral_B"},{f1:-.6587,f2:.473,f3:-.7834,f4:.3267,label:"spiral_A"},{f1:.6215,f2:-.4775,f3:.7746,f4:-.3169,label:"spiral_B"},{f1:-.7747,f2:.4867,f3:-.6967,f4:.3718,label:"spiral_A"},{f1:.6,f2:-.4248,f3:.7587,f4:-.274,label:"spiral_B"},{f1:-.6406,f2:.3875,f3:-.6392,f4:.4269,label:"spiral_A"},{f1:.6512,f2:-.4588,f3:.6555,f4:-.4721,label:"spiral_B"},{f1:-.7233,f2:.4036,f3:-.6188,f4:.4836,label:"spiral_A"},{f1:.7503,f2:-.4551,f3:.654,f4:-.4375,label:"spiral_B"},{f1:-.7141,f2:.2542,f3:-.6132,f4:.5398,label:"spiral_A"},{f1:.6344,f2:-.323,f3:.6392,f4:-.5243,label:"spiral_B"},{f1:-.751,f2:.3352,f3:-.644,f4:.5641,label:"spiral_A"},{f1:.7454,f2:-.3178,f3:.6174,f4:-.5158,label:"spiral_B"},{f1:-.7754,f2:.2778,f3:-.5507,f4:.6282,label:"spiral_A"},{f1:.7091,f2:-.2986,f3:.5164,f4:-.5741,label:"spiral_B"},{f1:-.7826,f2:.2395,f3:-.4259,f4:.6425,label:"spiral_A"},{f1:.813,f2:-.2276,f3:.4822,f4:-.6648,label:"spiral_B"},{f1:-.8013,f2:.2408,f3:-.4623,f4:.6821,label:"spiral_A"},{f1:.7418,f2:-.1521,f3:.4012,f4:-.6651,label:"spiral_B"},{f1:-.7828,f2:.1824,f3:-.4033,f4:.7024,label:"spiral_A"},{f1:.7585,f2:-.2132,f3:.313,f4:-.7494,label:"spiral_B"},{f1:-.8729,f2:.1423,f3:-.3459,f4:.7815,label:"spiral_A"},{f1:.7841,f2:-.1487,f3:.3181,f4:-.7883,label:"spiral_B"},{f1:-.7524,f2:.1954,f3:-.2913,f4:.7998,label:"spiral_A"},{f1:.7772,f2:-.0761,f3:.2909,f4:-.7633,label:"spiral_B"},{f1:-.7718,f2:.1296,f3:-.2541,f4:.8176,label:"spiral_A"},{f1:.8315,f2:-.1157,f3:.2201,f4:-.8179,label:"spiral_B"},{f1:-.8553,f2:.0393,f3:-.1338,f4:.7831,label:"spiral_A"},{f1:.7797,f2:-.0906,f3:.1916,f4:-.825,label:"spiral_B"},{f1:-.7877,f2:.0383,f3:-.1352,f4:.8239,label:"spiral_A"},{f1:.8701,f2:-.1095,f3:.1377,f4:-.8436,label:"spiral_B"},{f1:-.8228,f2:-.0164,f3:-.0851,f4:.8819,label:"spiral_A"},{f1:.803,f2:-.022,f3:.0549,f4:-.8304,label:"spiral_B"},{f1:-.8542,f2:-.0115,f3:.002,f4:.7901,label:"spiral_A"},{f1:.8409,f2:.0598,f3:.001,f4:-.8077,label:"spiral_B"},{f1:-.7852,f2:-.0139,f3:.0656,f4:.8699,label:"spiral_A"},{f1:.8159,f2:.0389,f3:-.0348,f4:-.9082,label:"spiral_B"},{f1:-.8699,f2:-.09,f3:.1124,f4:.7973,label:"spiral_A"},{f1:.888,f2:.0707,f3:-.1275,f4:-.8543,label:"spiral_B"},{f1:-.8741,f2:-.1937,f3:.2461,f4:.8102,label:"spiral_A"},{f1:.8229,f2:.1213,f3:-.1334,f4:-.8001,label:"spiral_B"},{f1:-.9021,f2:-.2113,f3:.2913,f4:.8595,label:"spiral_A"},{f1:.8634,f2:.1354,f3:-.2861,f4:-.8226,label:"spiral_B"},{f1:-.7806,f2:-.1883,f3:.3214,f4:.794,label:"spiral_A"},{f1:.811,f2:.1934,f3:-.2051,f4:-.7326,label:"spiral_B"},{f1:-.7726,f2:-.1389,f3:.348,f4:.713,label:"spiral_A"},{f1:.8013,f2:.1867,f3:-.3653,f4:-.7215,label:"spiral_B"},{f1:-.7506,f2:-.2201,f3:.3926,f4:.68,label:"spiral_A"},{f1:.7651,f2:.2214,f3:-.4575,f4:-.7295,label:"spiral_B"},{f1:-.9177,f2:-.2881,f3:.4435,f4:.7233,label:"spiral_A"},{f1:.8206,f2:.206,f3:-.4919,f4:-.6851,label:"spiral_B"},{f1:-.7605,f2:-.2414,f3:.5289,f4:.6108,label:"spiral_A"},{f1:.8789,f2:.2979,f3:-.4899,f4:-.5755,label:"spiral_B"},{f1:-.8191,f2:-.2144,f3:.6307,f4:.5906,label:"spiral_A"},{f1:.8018,f2:.3273,f3:-.5962,f4:-.605,label:"spiral_B"},{f1:-.7665,f2:-.3814,f3:.6127,f4:.5668,label:"spiral_A"},{f1:.8483,f2:.2865,f3:-.5968,f4:-.5654,label:"spiral_B"},{f1:-.8081,f2:-.4068,f3:.6736,f4:.503,label:"spiral_A"},{f1:.7689,f2:.4313,f3:-.7367,f4:-.5272,label:"spiral_B"},{f1:-.7812,f2:-.4013,f3:.7241,f4:.4558,label:"spiral_A"},{f1:.7321,f2:.4488,f3:-.7231,f4:-.4928,label:"spiral_B"},{f1:-.7792,f2:-.4465,f3:.8004,f4:.4487,label:"spiral_A"},{f1:.6932,f2:.4628,f3:-.7022,f4:-.4085,label:"spiral_B"},{f1:-.7349,f2:-.4466,f3:.78,f4:.3073,label:"spiral_A"},{f1:.74,f2:.3936,f3:-.7876,f4:-.3706,label:"spiral_B"},{f1:-.7225,f2:-.5033,f3:.8375,f4:.3515,label:"spiral_A"},{f1:.7134,f2:.495,f3:-.7263,f4:-.3394,label:"spiral_B"},{f1:-.662,f2:-.5024,f3:.8533,f4:.1619,label:"spiral_A"},{f1:.667,f2:.5835,f3:-.8227,f4:-.2766,label:"spiral_B"},{f1:-.6608,f2:-.5821,f3:.8255,f4:.1932,label:"spiral_A"},{f1:.7117,f2:.596,f3:-.88,f4:-.2695,label:"spiral_B"},{f1:-.6825,f2:-.6478,f3:.9164,f4:.1637,label:"spiral_A"},{f1:.6677,f2:.5748,f3:-.8119,f4:-.087,label:"spiral_B"},{f1:-.5333,f2:-.5648,f3:.8676,f4:.0306,label:"spiral_A"},{f1:.6568,f2:.5861,f3:-.9426,f4:-.0433,label:"spiral_B"},{f1:-.5103,f2:-.6116,f3:.9201,f4:.0455,label:"spiral_A"},{f1:.6644,f2:.59,f3:-.8809,f4:.0502,label:"spiral_B"},{f1:-.5604,f2:-.6049,f3:.8605,f4:-.0266,label:"spiral_A"},{f1:.6136,f2:.5798,f3:-.7953,f4:.1506,label:"spiral_B"},{f1:-.5497,f2:-.733,f3:.871,f4:-.1903,label:"spiral_A"},{f1:.552,f2:.7293,f3:-.9409,f4:.2108,label:"spiral_B"},{f1:-.4731,f2:-.6569,f3:.8643,f4:-.191,label:"spiral_A"},{f1:.4763,f2:.768,f3:-.8752,f4:.2198,label:"spiral_B"},{f1:-.5114,f2:-.6812,f3:.748,f4:-.2157,label:"spiral_A"},{f1:.5521,f2:.6477,f3:-.835,f4:.2784,label:"spiral_B"},{f1:-.5004,f2:-.7722,f3:.7777,f4:-.4158,label:"spiral_A"},{f1:.4133,f2:.7287,f3:-.7572,f4:.3377,label:"spiral_B"},{f1:-.5341,f2:-.7203,f3:.7238,f4:-.3447,label:"spiral_A"},{f1:.5508,f2:.7764,f3:-.8576,f4:.4511,label:"spiral_B"},{f1:-.4484,f2:-.7952,f3:.7329,f4:-.4343,label:"spiral_A"},{f1:.3807,f2:.8323,f3:-.7744,f4:.508,label:"spiral_B"},{f1:-.3878,f2:-.7598,f3:.6964,f4:-.4759,label:"spiral_A"},{f1:.3797,f2:.7607,f3:-.6911,f4:.5658,label:"spiral_B"},{f1:-.4107,f2:-.8711,f3:.7387,f4:-.5497,label:"spiral_A"},{f1:.4663,f2:.8058,f3:-.709,f4:.5938,label:"spiral_B"},{f1:-.3016,f2:-.7849,f3:.6343,f4:-.6741,label:"spiral_A"},{f1:.3304,f2:.8372,f3:-.6198,f4:.6625,label:"spiral_B"},{f1:-.3325,f2:-.8256,f3:.5639,f4:-.5978,label:"spiral_A"},{f1:.2906,f2:.8512,f3:-.6124,f4:.7173,label:"spiral_B"},{f1:-.2998,f2:-.8457,f3:.5487,f4:-.7604,label:"spiral_A"},{f1:.2886,f2:.8824,f3:-.4317,f4:.7481,label:"spiral_B"},{f1:-.2593,f2:-.8371,f3:.4591,f4:-.7216,label:"spiral_A"},{f1:.2281,f2:.894,f3:-.4602,f4:.7371,label:"spiral_B"},{f1:-.2083,f2:-.8626,f3:.4121,f4:-.8247,label:"spiral_A"},{f1:.2034,f2:.8808,f3:-.4021,f4:.8466,label:"spiral_B"},{f1:-.1787,f2:-.8831,f3:.3956,f4:-.8264,label:"spiral_A"},{f1:.1646,f2:.8517,f3:-.3499,f4:.7916,label:"spiral_B"},{f1:-.17,f2:-.8477,f3:.2728,f4:-.8791,label:"spiral_A"},{f1:.1137,f2:.9376,f3:-.2127,f4:.9027,label:"spiral_B"},{f1:-.0416,f2:-.8555,f3:.2333,f4:-.8602,label:"spiral_A"},{f1:.1598,f2:.9457,f3:-.244,f4:.8608,label:"spiral_B"},{f1:-.0297,f2:-.948,f3:.142,f4:-.9073,label:"spiral_A"},{f1:.0257,f2:.9312,f3:-.2014,f4:.8643,label:"spiral_B"},{f1:-8e-4,f2:-.9117,f3:.0987,f4:-.9386,label:"spiral_A"},{f1:.0623,f2:.8892,f3:-.0904,f4:.8069,label:"spiral_B"},{f1:-.0222,f2:-.9273,f3:-.0051,f4:-.9037,label:"spiral_A"},{f1:.0554,f2:.9291,f3:-.0853,f4:.9064,label:"spiral_B"},{f1:.046,f2:-.9082,f3:-.1076,f4:-.9616,label:"spiral_A"},{f1:-.0218,f2:.9017,f3:-.0237,f4:.9368,label:"spiral_B"},{f1:.0117,f2:-.8688,f3:-.0659,f4:-.8483,label:"spiral_A"},{f1:-.0853,f2:1.0097,f3:.0934,f4:.8953,label:"spiral_B"},{f1:.1316,f2:-1.0444,f3:-.1608,f4:-.9296,label:"spiral_A"},{f1:-.0927,f2:.9381,f3:.1657,f4:.9728,label:"spiral_B"},{f1:.1371,f2:-.8878,f3:-.2331,f4:-.9219,label:"spiral_A"},{f1:-.1055,f2:.8822,f3:.246,f4:.8309,label:"spiral_B"},{f1:.1616,f2:-.8911,f3:-.2837,f4:-.9434,label:"spiral_A"},{f1:-.1284,f2:1.0206,f3:.2967,f4:.9278,label:"spiral_B"},{f1:.1784,f2:-.8606,f3:-.3725,f4:-.8171,label:"spiral_A"},{f1:-.2071,f2:.9565,f3:.4237,f4:.8531,label:"spiral_B"},{f1:.2237,f2:-.9156,f3:-.4165,f4:-.672,label:"spiral_A"},{f1:-.2677,f2:.9188,f3:.4365,f4:.8137,label:"spiral_B"},{f1:.2698,f2:-.9455,f3:-.5387,f4:-.7951,label:"spiral_A"},{f1:-.2248,f2:.8717,f3:.5332,f4:.784,label:"spiral_B"},{f1:.1962,f2:-.8684,f3:-.6058,f4:-.7692,label:"spiral_A"},{f1:-.2562,f2:.891,f3:.5022,f4:.7551,label:"spiral_B"},{f1:.3262,f2:-.8832,f3:-.6573,f4:-.6758,label:"spiral_A"},{f1:-.3656,f2:.8682,f3:.6697,f4:.6836,label:"spiral_B"},{f1:.3127,f2:-.8443,f3:-.6822,f4:-.6822,label:"spiral_A"},{f1:-.4159,f2:.8868,f3:.7052,f4:.6395,label:"spiral_B"},{f1:.3432,f2:-.8492,f3:-.7346,f4:-.594,label:"spiral_A"},{f1:-.36,f2:.8975,f3:.6678,f4:.59,label:"spiral_B"},{f1:.4135,f2:-.8713,f3:-.7589,f4:-.512,label:"spiral_A"},{f1:-.4681,f2:.879,f3:.8194,f4:.6747,label:"spiral_B"},{f1:.5034,f2:-.8452,f3:-.7491,f4:-.5132,label:"spiral_A"},{f1:-.526,f2:.7727,f3:.7774,f4:.5014,label:"spiral_B"},{f1:.4835,f2:-.7666,f3:-.854,f4:-.3322,label:"spiral_A"},{f1:-.5415,f2:.7676,f3:.833,f4:.4457,label:"spiral_B"},{f1:.5217,f2:-.8047,f3:-.8098,f4:-.3551,label:"spiral_A"},{f1:-.4844,f2:.7571,f3:.894,f4:.374,label:"spiral_B"},{f1:.5655,f2:-.7892,f3:-.8962,f4:-.227,label:"spiral_A"},{f1:-.5192,f2:.7611,f3:.8473,f4:.3534,label:"spiral_B"},{f1:.5916,f2:-.7503,f3:-.8988,f4:-.2563,label:"spiral_A"},{f1:-.5854,f2:.7762,f3:.9304,f4:.3069,label:"spiral_B"},{f1:.5696,f2:-.6672,f3:-.9062,f4:-.1116,label:"spiral_A"},{f1:-.5603,f2:.7098,f3:.9637,f4:.2321,label:"spiral_B"},{f1:.633,f2:-.6876,f3:-.9486,f4:-.0276,label:"spiral_A"},{f1:-.5544,f2:.7432,f3:.97,f4:.0872,label:"spiral_B"},{f1:.6559,f2:-.7361,f3:-.9479,f4:-.0176,label:"spiral_A"},{f1:-.6248,f2:.6262,f3:1.0229,f4:.0366,label:"spiral_B"},{f1:.6478,f2:-.6619,f3:-.9401,f4:.0606,label:"spiral_A"},{f1:-.7073,f2:.6452,f3:.9477,f4:-.1438,label:"spiral_B"},{f1:.6848,f2:-.5972,f3:-1.0194,f4:.1419,label:"spiral_A"},{f1:-.7541,f2:.6312,f3:.9577,f4:-.1226,label:"spiral_B"},{f1:.7598,f2:-.5901,f3:-.9205,f4:.176,label:"spiral_A"},{f1:-.7589,f2:.6044,f3:.9236,f4:-.1669,label:"spiral_B"},{f1:.8087,f2:-.5485,f3:-.9311,f4:.1979,label:"spiral_A"},{f1:-.6986,f2:.4895,f3:.9215,f4:-.2825,label:"spiral_B"},{f1:.8098,f2:-.5537,f3:-.9119,f4:.3688,label:"spiral_A"},{f1:-.7785,f2:.5419,f3:.943,f4:-.264,label:"spiral_B"},{f1:.8857,f2:-.4252,f3:-.8628,f4:.4218,label:"spiral_A"},{f1:-.8318,f2:.5344,f3:.8274,f4:-.4426,label:"spiral_B"},{f1:.8114,f2:-.5244,f3:-.8785,f4:.473,label:"spiral_A"},{f1:-.8486,f2:.6006,f3:.8066,f4:-.4264,label:"spiral_B"},{f1:.9041,f2:-.4715,f3:-.8361,f4:.5182,label:"spiral_A"},{f1:-.8212,f2:.4423,f3:.8559,f4:-.5296,label:"spiral_B"},{f1:.8581,f2:-.356,f3:-.7938,f4:.5595,label:"spiral_A"},{f1:-.9097,f2:.4609,f3:.7271,f4:-.5867,label:"spiral_B"},{f1:.8614,f2:-.417,f3:-.7111,f4:.6781,label:"spiral_A"},{f1:-.8446,f2:.3739,f3:.6769,f4:-.6602,label:"spiral_B"},{f1:.847,f2:-.3923,f3:-.6761,f4:.7467,label:"spiral_A"},{f1:-.898,f2:.3566,f3:.6484,f4:-.7232,label:"spiral_B"},{f1:.9906,f2:-.3727,f3:-.6631,f4:.7632,label:"spiral_A"},{f1:-.912,f2:.379,f3:.6249,f4:-.7552,label:"spiral_B"},{f1:.9878,f2:-.2333,f3:-.5294,f4:.8092,label:"spiral_A"},{f1:-.9817,f2:.301,f3:.5339,f4:-.799,label:"spiral_B"},{f1:1.018,f2:-.2553,f3:-.4984,f4:.9439,label:"spiral_A"},{f1:-.9346,f2:.2878,f3:.4873,f4:-.8586,label:"spiral_B"},{f1:.9354,f2:-.2252,f3:-.4795,f4:.9432,label:"spiral_A"},{f1:-.862,f2:.1597,f3:.3544,f4:-.888,label:"spiral_B"},{f1:1.0328,f2:-.1827,f3:-.3707,f4:.9095,label:"spiral_A"},{f1:-.9574,f2:.1658,f3:.3561,f4:-1.0035,label:"spiral_B"},{f1:1.0032,f2:-.1607,f3:-.3014,f4:.9052,label:"spiral_A"},{f1:-.9805,f2:.198,f3:.2622,f4:-.8669,label:"spiral_B"},{f1:1.0071,f2:-.1667,f3:-.2371,f4:.9192,label:"spiral_A"},{f1:-.9858,f2:.1211,f3:.2285,f4:-.9936,label:"spiral_B"},{f1:.9751,f2:-.064,f3:-.184,f4:1.0063,label:"spiral_A"},{f1:-.924,f2:.0512,f3:.1391,f4:-.9634,label:"spiral_B"},{f1:1.0403,f2:-.0405,f3:-.0368,f4:.9685,label:"spiral_A"},{f1:-.9962,f2:.0603,f3:.0614,f4:-1.0184,label:"spiral_B"},{f1:.9896,f2:.0334,f3:-.0654,f4:1.0667,label:"spiral_A"},{f1:-.9409,f2:.0054,f3:.0311,f4:-1.0329,label:"spiral_B"}];function r(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function n(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function i(t){let e,i,a;function s(t,r,n=0,l=t.length){if(n<l){if(0!==e(r,r))return l;do{const e=n+l>>>1;i(t[e],r)<0?n=e+1:l=e}while(n<l)}return n}return 2!==t.length?(e=r,i=(e,n)=>r(t(e),n),a=(e,r)=>t(e)-r):(e=t===r||t===n?t:l,i=t,a=t),{left:s,center:function(t,e,r=0,n=t.length){const i=s(t,e,r,n-1);return i>r&&a(t[i-1],e)>-a(t[i],e)?i-1:i},right:function(t,r,n=0,l=t.length){if(n<l){if(0!==e(r,r))return l;do{const e=n+l>>>1;i(t[e],r)<=0?n=e+1:l=e}while(n<l)}return n}}}function l(){return 0}const a=i(r).right;function s(t,e){let r,n=0,i=0,l=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(r=e-i,i+=r/++n,l+=r*(e-i));else{let a=-1;for(let s of t)null!=(s=e(s,++a,t))&&(s=+s)>=s&&(r=s-i,i+=r/++n,l+=r*(s-i))}if(n>1)return l/(n-1)}function o(t,e){let r,n;if(void 0===e)for(const e of t)null!=e&&(void 0===r?e>=e&&(r=n=e):(r>e&&(r=e),n<e&&(n=e)));else{let i=-1;for(let l of t)null!=(l=e(l,++i,t))&&(void 0===r?l>=l&&(r=n=l):(r>l&&(r=l),n<l&&(n=l)))}return[r,n]}i(function(t){return null===t?NaN:+t}).center;class f extends Map{constructor(t,e=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,r]of t)this.set(e,r)}get(t){return super.get(u(this,t))}has(t){return super.has(u(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},r){const n=e(r);t.has(n)&&(r=t.get(n),t.delete(n));return r}(this,t))}}function u({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function h(t){return null!==t&&"object"==typeof t?t.valueOf():t}const c=Math.sqrt(50),p=Math.sqrt(10),d=Math.sqrt(2);function g(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),l=n/Math.pow(10,i),a=l>=c?10:l>=p?5:l>=d?2:1;let s,o,f;return i<0?(f=Math.pow(10,-i)/a,s=Math.round(t*f),o=Math.round(e*f),s/f<t&&++s,o/f>e&&--o,f=-f):(f=Math.pow(10,i)*a,s=Math.round(t/f),o=Math.round(e/f),s*f<t&&++s,o*f>e&&--o),o<s&&.5<=r&&r<2?g(t,e,2*r):[s,o,f]}function m(t,e,r){if(!((r=+r)>0))return[];if((t=+t)===(e=+e))return[t];const n=e<t,[i,l,a]=n?g(e,t,r):g(t,e,r);if(!(l>=i))return[];const s=l-i+1,o=new Array(s);if(n)if(a<0)for(let t=0;t<s;++t)o[t]=(l-t)/-a;else for(let t=0;t<s;++t)o[t]=(l-t)*a;else if(a<0)for(let t=0;t<s;++t)o[t]=(i+t)/-a;else for(let t=0;t<s;++t)o[t]=(i+t)*a;return o}function _(t,e,r){return g(t=+t,e=+e,r=+r)[2]}function b(t,e,r){r=+r;const n=(e=+e)<(t=+t),i=n?_(e,t,r):_(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function w(t,e){let r;if(void 0===e)for(const e of t)null!=e&&(r<e||void 0===r&&e>=e)&&(r=e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(r<i||void 0===r&&i>=i)&&(r=i)}return r}function y(t,e){let r;if(void 0===e)for(const e of t)null!=e&&(r>e||void 0===r&&e>=e)&&(r=e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(r>i||void 0===r&&i>=i)&&(r=i)}return r}function v(t,e){let r=0,n=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++r,n+=e);else{let i=-1;for(let l of t)null!=(l=e(l,++i,t))&&(l=+l)>=l&&(++r,n+=l)}if(r)return n/r}function x(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=0|Math.max(0,Math.ceil((e-t)/r)),l=new Array(i);++n<i;)l[n]=t+n*r;return l}function A(t){return t}var M=1e-6;function B(t){return"translate("+t+",0)"}function S(t){return"translate(0,"+t+")"}function k(t){return e=>+t(e)}function E(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),r=>+t(r)+e}function N(){return!this.__axis}function C(t,e){var r=[],n=null,i=null,l=6,a=6,s=3,o="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,f=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",h=1===t||3===t?B:S;function c(c){var p=null==n?e.ticks?e.ticks.apply(e,r):e.domain():n,d=null==i?e.tickFormat?e.tickFormat.apply(e,r):A:i,g=Math.max(l,0)+s,m=e.range(),_=+m[0]+o,b=+m[m.length-1]+o,w=(e.bandwidth?E:k)(e.copy(),o),y=c.selection?c.selection():c,v=y.selectAll(".domain").data([null]),x=y.selectAll(".tick").data(p,e).order(),B=x.exit(),S=x.enter().append("g").attr("class","tick"),C=x.select("line"),R=x.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(S),C=C.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",f*l)),R=R.merge(S.append("text").attr("fill","currentColor").attr(u,f*g).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),c!==y&&(v=v.transition(c),x=x.transition(c),C=C.transition(c),R=R.transition(c),B=B.transition(c).attr("opacity",M).attr("transform",function(t){return isFinite(t=w(t))?h(t+o):this.getAttribute("transform")}),S.attr("opacity",M).attr("transform",function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:w(t))+o)})),B.remove(),v.attr("d",4===t||2===t?a?"M"+f*a+","+_+"H"+o+"V"+b+"H"+f*a:"M"+o+","+_+"V"+b:a?"M"+_+","+f*a+"V"+o+"H"+b+"V"+f*a:"M"+_+","+o+"H"+b),x.attr("opacity",1).attr("transform",function(t){return h(w(t)+o)}),C.attr(u+"2",f*l),R.attr(u,f*g).text(d),y.filter(N).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),y.each(function(){this.__axis=w})}return c.scale=function(t){return arguments.length?(e=t,c):e},c.ticks=function(){return r=Array.from(arguments),c},c.tickArguments=function(t){return arguments.length?(r=null==t?[]:Array.from(t),c):r.slice()},c.tickValues=function(t){return arguments.length?(n=null==t?null:Array.from(t),c):n&&n.slice()},c.tickFormat=function(t){return arguments.length?(i=t,c):i},c.tickSize=function(t){return arguments.length?(l=a=+t,c):l},c.tickSizeInner=function(t){return arguments.length?(l=+t,c):l},c.tickSizeOuter=function(t){return arguments.length?(a=+t,c):a},c.tickPadding=function(t){return arguments.length?(s=+t,c):s},c.offset=function(t){return arguments.length?(o=+t,c):o},c}function R(t){return C(1,t)}function z(t){return C(3,t)}function I(t){return C(4,t)}var P={value:()=>{}};function O(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new j(n)}function j(t){this._=t}function T(t,e){for(var r,n=0,i=t.length;n<i;++n)if((r=t[n]).name===e)return r.value}function $(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=P,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}j.prototype=O.prototype={constructor:j,on:function(t,e){var r,n,i=this._,l=(n=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),a=-1,s=l.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(r=(t=l[a]).type)i[r]=$(i[r],t.name,e);else if(null==e)for(r in i)i[r]=$(i[r],t.name,null);return this}for(;++a<s;)if((r=(t=l[a]).type)&&(r=T(i[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new j(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,i=new Array(r),l=0;l<r;++l)i[l]=arguments[l+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(l=0,r=(n=this._[t]).length;l<r;++l)n[l].value.apply(e,i)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,l=n.length;i<l;++i)n[i].value.apply(e,r)}};var D="http://www.w3.org/1999/xhtml",V={svg:"http://www.w3.org/2000/svg",xhtml:D,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function F(t){var e=t+="",r=e.indexOf(":");return r>=0&&"xmlns"!==(e=t.slice(0,r))&&(t=t.slice(r+1)),V.hasOwnProperty(e)?{space:V[e],local:t}:t}function L(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===D&&e.documentElement.namespaceURI===D?e.createElement(t):e.createElementNS(r,t)}}function q(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function U(t){var e=F(t);return(e.local?q:L)(e)}function H(){}function Y(t){return null==t?H:function(){return this.querySelector(t)}}function X(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function G(){return[]}function W(t){return null==t?G:function(){return this.querySelectorAll(t)}}function K(t){return function(){return this.matches(t)}}function Q(t){return function(e){return e.matches(t)}}var J=Array.prototype.find;function Z(){return this.firstElementChild}var tt=Array.prototype.filter;function et(){return Array.from(this.children)}function rt(t){return new Array(t.length)}function nt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function it(t,e,r,n,i,l){for(var a,s=0,o=e.length,f=l.length;s<f;++s)(a=e[s])?(a.__data__=l[s],n[s]=a):r[s]=new nt(t,l[s]);for(;s<o;++s)(a=e[s])&&(i[s]=a)}function lt(t,e,r,n,i,l,a){var s,o,f,u=new Map,h=e.length,c=l.length,p=new Array(h);for(s=0;s<h;++s)(o=e[s])&&(p[s]=f=a.call(o,o.__data__,s,e)+"",u.has(f)?i[s]=o:u.set(f,o));for(s=0;s<c;++s)f=a.call(t,l[s],s,l)+"",(o=u.get(f))?(n[s]=o,o.__data__=l[s],u.delete(f)):r[s]=new nt(t,l[s]);for(s=0;s<h;++s)(o=e[s])&&u.get(p[s])===o&&(i[s]=o)}function at(t){return t.__data__}function st(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function ot(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ft(t){return function(){this.removeAttribute(t)}}function ut(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ht(t,e){return function(){this.setAttribute(t,e)}}function ct(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function pt(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function dt(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function gt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mt(t){return function(){this.style.removeProperty(t)}}function _t(t,e,r){return function(){this.style.setProperty(t,e,r)}}function bt(t,e,r){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function wt(t,e){return t.style.getPropertyValue(e)||gt(t).getComputedStyle(t,null).getPropertyValue(e)}function yt(t){return function(){delete this[t]}}function vt(t,e){return function(){this[t]=e}}function xt(t,e){return function(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function At(t){return t.trim().split(/^|\s+/)}function Mt(t){return t.classList||new Bt(t)}function Bt(t){this._node=t,this._names=At(t.getAttribute("class")||"")}function St(t,e){for(var r=Mt(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function kt(t,e){for(var r=Mt(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function Et(t){return function(){St(this,t)}}function Nt(t){return function(){kt(this,t)}}function Ct(t,e){return function(){(e.apply(this,arguments)?St:kt)(this,t)}}function Rt(){this.textContent=""}function zt(t){return function(){this.textContent=t}}function It(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Pt(){this.innerHTML=""}function Ot(t){return function(){this.innerHTML=t}}function jt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Tt(){this.nextSibling&&this.parentNode.appendChild(this)}function $t(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Dt(){return null}function Vt(){var t=this.parentNode;t&&t.removeChild(this)}function Ft(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Lt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qt(t){return function(){var e=this.__on;if(e){for(var r,n=0,i=-1,l=e.length;n<l;++n)r=e[n],t.type&&r.type!==t.type||r.name!==t.name?e[++i]=r:this.removeEventListener(r.type,r.listener,r.options);++i?e.length=i:delete this.__on}}}function Ut(t,e,r){return function(){var n,i=this.__on,l=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,s=i.length;a<s;++a)if((n=i[a]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=l,n.options=r),void(n.value=e);this.addEventListener(t.type,l,r),n={type:t.type,name:t.name,value:e,listener:l,options:r},i?i.push(n):this.__on=[n]}}function Ht(t,e,r){var n=gt(t),i=n.CustomEvent;"function"==typeof i?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Yt(t,e){return function(){return Ht(this,t,e)}}function Xt(t,e){return function(){return Ht(this,t,e.apply(this,arguments))}}nt.prototype={constructor:nt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Bt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Gt=[null];function Wt(t,e){this._groups=t,this._parents=e}function Kt(){return new Wt([[document.documentElement]],Gt)}function Qt(t){return"string"==typeof t?new Wt([[document.querySelector(t)]],[document.documentElement]):new Wt([[t]],Gt)}function Jt(t){return Qt(U(t).call(document.documentElement))}function Zt(t){return"string"==typeof t?new Wt([document.querySelectorAll(t)],[document.documentElement]):new Wt([X(t)],Gt)}function te(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ee(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function re(){}Wt.prototype=Kt.prototype={constructor:Wt,select:function(t){"function"!=typeof t&&(t=Y(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var l,a,s=e[i],o=s.length,f=n[i]=new Array(o),u=0;u<o;++u)(l=s[u])&&(a=t.call(l,l.__data__,u,s))&&("__data__"in l&&(a.__data__=l.__data__),f[u]=a);return new Wt(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return X(t.apply(this,arguments))}}(t):W(t);for(var e=this._groups,r=e.length,n=[],i=[],l=0;l<r;++l)for(var a,s=e[l],o=s.length,f=0;f<o;++f)(a=s[f])&&(n.push(t.call(a,a.__data__,f,s)),i.push(a));return new Wt(n,i)},selectChild:function(t){return this.select(null==t?Z:function(t){return function(){return J.call(this.children,t)}}("function"==typeof t?t:Q(t)))},selectChildren:function(t){return this.selectAll(null==t?et:function(t){return function(){return tt.call(this.children,t)}}("function"==typeof t?t:Q(t)))},filter:function(t){"function"!=typeof t&&(t=K(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var l,a=e[i],s=a.length,o=n[i]=[],f=0;f<s;++f)(l=a[f])&&t.call(l,l.__data__,f,a)&&o.push(l);return new Wt(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,at);var r,n=e?lt:it,i=this._parents,l=this._groups;"function"!=typeof t&&(r=t,t=function(){return r});for(var a=l.length,s=new Array(a),o=new Array(a),f=new Array(a),u=0;u<a;++u){var h=i[u],c=l[u],p=c.length,d=st(t.call(h,h&&h.__data__,u,i)),g=d.length,m=o[u]=new Array(g),_=s[u]=new Array(g);n(h,c,m,_,f[u]=new Array(p),d,e);for(var b,w,y=0,v=0;y<g;++y)if(b=m[y]){for(y>=v&&(v=y+1);!(w=_[v])&&++v<g;);b._next=w||null}}return(s=new Wt(s,i))._enter=o,s._exit=f,s},enter:function(){return new Wt(this._enter||this._groups.map(rt),this._parents)},exit:function(){return new Wt(this._exit||this._groups.map(rt),this._parents)},join:function(t,e,r){var n=this.enter(),i=this,l=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==r?l.remove():r(l),n&&i?n.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,l=n.length,a=Math.min(i,l),s=new Array(i),o=0;o<a;++o)for(var f,u=r[o],h=n[o],c=u.length,p=s[o]=new Array(c),d=0;d<c;++d)(f=u[d]||h[d])&&(p[d]=f);for(;o<i;++o)s[o]=r[o];return new Wt(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n,i=t[e],l=i.length-1,a=i[l];--l>=0;)(n=i[l])&&(a&&4^n.compareDocumentPosition(a)&&a.parentNode.insertBefore(n,a),a=n);return this},sort:function(t){function e(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}t||(t=ot);for(var r=this._groups,n=r.length,i=new Array(n),l=0;l<n;++l){for(var a,s=r[l],o=s.length,f=i[l]=new Array(o),u=0;u<o;++u)(a=s[u])&&(f[u]=a);f.sort(e)}return new Wt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,l=n.length;i<l;++i){var a=n[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i,l=e[r],a=0,s=l.length;a<s;++a)(i=l[a])&&t.call(i,i.__data__,a,l);return this},attr:function(t,e){var r=F(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==e?r.local?ut:ft:"function"==typeof e?r.local?dt:pt:r.local?ct:ht)(r,e))},style:function(t,e,r){return arguments.length>1?this.each((null==e?mt:"function"==typeof e?bt:_t)(t,e,null==r?"":r)):wt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?yt:"function"==typeof e?xt:vt)(t,e)):this.node()[t]},classed:function(t,e){var r=At(t+"");if(arguments.length<2){for(var n=Mt(this.node()),i=-1,l=r.length;++i<l;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof e?Ct:e?Et:Nt)(r,e))},text:function(t){return arguments.length?this.each(null==t?Rt:("function"==typeof t?It:zt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Pt:("function"==typeof t?jt:Ot)(t)):this.node().innerHTML},raise:function(){return this.each(Tt)},lower:function(){return this.each($t)},append:function(t){var e="function"==typeof t?t:U(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var r="function"==typeof t?t:U(t),n=null==e?Dt:"function"==typeof e?e:Y(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function(){return this.each(Vt)},clone:function(t){return this.select(t?Lt:Ft)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,r){var n,i,l=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");return r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),{type:t,name:e}})}(t+""),a=l.length;if(!(arguments.length<2)){for(s=e?Ut:qt,n=0;n<a;++n)this.each(s(l[n],e,r));return this}var s=this.node().__on;if(s)for(var o,f=0,u=s.length;f<u;++f)for(n=0,o=s[f];n<a;++n)if((i=l[n]).type===o.type&&i.name===o.name)return o.value},dispatch:function(t,e){return this.each(("function"==typeof e?Xt:Yt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n,i=t[e],l=0,a=i.length;l<a;++l)(n=i[l])&&(yield n)}};var ne=.7,ie=1/ne,le="\\s*([+-]?\\d+)\\s*",ae="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",se="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oe=/^#([0-9a-f]{3,8})$/,fe=new RegExp(`^rgb\\(${le},${le},${le}\\)$`),ue=new RegExp(`^rgb\\(${se},${se},${se}\\)$`),he=new RegExp(`^rgba\\(${le},${le},${le},${ae}\\)$`),ce=new RegExp(`^rgba\\(${se},${se},${se},${ae}\\)$`),pe=new RegExp(`^hsl\\(${ae},${se},${se}\\)$`),de=new RegExp(`^hsla\\(${ae},${se},${se},${ae}\\)$`),ge={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function me(){return this.rgb().formatHex()}function _e(){return this.rgb().formatRgb()}function be(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=oe.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?we(e):3===r?new xe(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?ye(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?ye(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=fe.exec(t))?new xe(e[1],e[2],e[3],1):(e=ue.exec(t))?new xe(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=he.exec(t))?ye(e[1],e[2],e[3],e[4]):(e=ce.exec(t))?ye(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=pe.exec(t))?Ee(e[1],e[2]/100,e[3]/100,1):(e=de.exec(t))?Ee(e[1],e[2]/100,e[3]/100,e[4]):ge.hasOwnProperty(t)?we(ge[t]):"transparent"===t?new xe(NaN,NaN,NaN,0):null}function we(t){return new xe(t>>16&255,t>>8&255,255&t,1)}function ye(t,e,r,n){return n<=0&&(t=e=r=NaN),new xe(t,e,r,n)}function ve(t,e,r,n){return 1===arguments.length?((i=t)instanceof re||(i=be(i)),i?new xe((i=i.rgb()).r,i.g,i.b,i.opacity):new xe):new xe(t,e,r,null==n?1:n);var i}function xe(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function Ae(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}`}function Me(){const t=Be(this.opacity);return`${1===t?"rgb(":"rgba("}${Se(this.r)}, ${Se(this.g)}, ${Se(this.b)}${1===t?")":`, ${t})`}`}function Be(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Se(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ke(t){return((t=Se(t))<16?"0":"")+t.toString(16)}function Ee(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Re(t,e,r,n)}function Ne(t){if(t instanceof Re)return new Re(t.h,t.s,t.l,t.opacity);if(t instanceof re||(t=be(t)),!t)return new Re;if(t instanceof Re)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),l=Math.max(e,r,n),a=NaN,s=l-i,o=(l+i)/2;return s?(a=e===l?(r-n)/s+6*(r<n):r===l?(n-e)/s+2:(e-r)/s+4,s/=o<.5?l+i:2-l-i,a*=60):s=o>0&&o<1?0:a,new Re(a,s,o,t.opacity)}function Ce(t,e,r,n){return 1===arguments.length?Ne(t):new Re(t,e,r,null==n?1:n)}function Re(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function ze(t){return(t=(t||0)%360)<0?t+360:t}function Ie(t){return Math.max(0,Math.min(1,t||0))}function Pe(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)}te(re,be,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:me,formatHex:me,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ne(this).formatHsl()},formatRgb:_e,toString:_e}),te(xe,ve,ee(re,{brighter(t){return t=null==t?ie:Math.pow(ie,t),new xe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ne:Math.pow(ne,t),new xe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new xe(Se(this.r),Se(this.g),Se(this.b),Be(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ae,formatHex:Ae,formatHex8:function(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}${ke(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Me,toString:Me})),te(Re,Ce,ee(re,{brighter(t){return t=null==t?ie:Math.pow(ie,t),new Re(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ne:Math.pow(ne,t),new Re(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new xe(Pe(t>=240?t-240:t+120,i,n),Pe(t,i,n),Pe(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Re(ze(this.h),Ie(this.s),Ie(this.l),Be(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Be(this.opacity);return`${1===t?"hsl(":"hsla("}${ze(this.h)}, ${100*Ie(this.s)}%, ${100*Ie(this.l)}%${1===t?")":`, ${t})`}`}}));var Oe=t=>()=>t;function je(t){return 1===(t=+t)?Te:function(e,r){return r-e?function(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}(e,r,t):Oe(isNaN(e)?r:e)}}function Te(t,e){var r=e-t;return r?function(t,e){return function(r){return t+r*e}}(t,r):Oe(isNaN(t)?e:t)}var $e=function t(e){var r=je(e);function n(t,e){var n=r((t=ve(t)).r,(e=ve(e)).r),i=r(t.g,e.g),l=r(t.b,e.b),a=Te(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=l(e),t.opacity=a(e),t+""}}return n.gamma=t,n}(1);function De(t,e){e||(e=[]);var r,n=t?Math.min(e.length,t.length):0,i=e.slice();return function(l){for(r=0;r<n;++r)i[r]=t[r]*(1-l)+e[r]*l;return i}}function Ve(t,e){var r,n=e?e.length:0,i=t?Math.min(n,t.length):0,l=new Array(i),a=new Array(n);for(r=0;r<i;++r)l[r]=Xe(t[r],e[r]);for(;r<n;++r)a[r]=e[r];return function(t){for(r=0;r<i;++r)a[r]=l[r](t);return a}}function Fe(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Le(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function qe(t,e){var r,n={},i={};for(r in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)r in t?n[r]=Xe(t[r],e[r]):i[r]=e[r];return function(t){for(r in n)i[r]=n[r](t);return i}}var Ue=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,He=new RegExp(Ue.source,"g");function Ye(t,e){var r,n,i,l=Ue.lastIndex=He.lastIndex=0,a=-1,s=[],o=[];for(t+="",e+="";(r=Ue.exec(t))&&(n=He.exec(e));)(i=n.index)>l&&(i=e.slice(l,i),s[a]?s[a]+=i:s[++a]=i),(r=r[0])===(n=n[0])?s[a]?s[a]+=n:s[++a]=n:(s[++a]=null,o.push({i:a,x:Le(r,n)})),l=He.lastIndex;return l<e.length&&(i=e.slice(l),s[a]?s[a]+=i:s[++a]=i),s.length<2?o[0]?function(t){return function(e){return t(e)+""}}(o[0].x):function(t){return function(){return t}}(e):(e=o.length,function(t){for(var r,n=0;n<e;++n)s[(r=o[n]).i]=r.x(t);return s.join("")})}function Xe(t,e){var r,n,i=typeof e;return null==e||"boolean"===i?Oe(e):("number"===i?Le:"string"===i?(r=be(e))?(e=r,$e):Ye:e instanceof be?$e:e instanceof Date?Fe:(n=e,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(e)?Ve:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?qe:Le:De))(t,e)}function Ge(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}var We,Ke=180/Math.PI,Qe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Je(t,e,r,n,i,l){var a,s,o;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(o=t*r+e*n)&&(r-=t*o,n-=e*o),(s=Math.sqrt(r*r+n*n))&&(r/=s,n/=s,o/=s),t*n<e*r&&(t=-t,e=-e,o=-o,a=-a),{translateX:i,translateY:l,rotate:Math.atan2(e,t)*Ke,skewX:Math.atan(o)*Ke,scaleX:a,scaleY:s}}function Ze(t,e,r,n){function i(t){return t.length?t.pop()+" ":""}return function(l,a){var s=[],o=[];return l=t(l),a=t(a),function(t,n,i,l,a,s){if(t!==i||n!==l){var o=a.push("translate(",null,e,null,r);s.push({i:o-4,x:Le(t,i)},{i:o-2,x:Le(n,l)})}else(i||l)&&a.push("translate("+i+e+l+r)}(l.translateX,l.translateY,a.translateX,a.translateY,s,o),function(t,e,r,l){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),l.push({i:r.push(i(r)+"rotate(",null,n)-2,x:Le(t,e)})):e&&r.push(i(r)+"rotate("+e+n)}(l.rotate,a.rotate,s,o),function(t,e,r,l){t!==e?l.push({i:r.push(i(r)+"skewX(",null,n)-2,x:Le(t,e)}):e&&r.push(i(r)+"skewX("+e+n)}(l.skewX,a.skewX,s,o),function(t,e,r,n,l,a){if(t!==r||e!==n){var s=l.push(i(l)+"scale(",null,",",null,")");a.push({i:s-4,x:Le(t,r)},{i:s-2,x:Le(e,n)})}else 1===r&&1===n||l.push(i(l)+"scale("+r+","+n+")")}(l.scaleX,l.scaleY,a.scaleX,a.scaleY,s,o),l=a=null,function(t){for(var e,r=-1,n=o.length;++r<n;)s[(e=o[r]).i]=e.x(t);return s.join("")}}}var tr,er,rr=Ze(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Qe:Je(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),nr=Ze(function(t){return null==t?Qe:(We||(We=document.createElementNS("http://www.w3.org/2000/svg","g")),We.setAttribute("transform",t),(t=We.transform.baseVal.consolidate())?Je((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Qe)},", ",")",")"),ir=0,lr=0,ar=0,sr=0,or=0,fr=0,ur="object"==typeof performance&&performance.now?performance:Date,hr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function cr(){return or||(hr(pr),or=ur.now()+fr)}function pr(){or=0}function dr(){this._call=this._time=this._next=null}function gr(t,e,r){var n=new dr;return n.restart(t,e,r),n}function mr(){cr(),++ir;for(var t,e=tr;e;)(t=or-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ir}function _r(){or=(sr=ur.now())+fr,ir=lr=0;try{mr()}finally{ir=0,function(){var t,e,r=tr,n=1/0;for(;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:tr=e);er=t,wr(n)}(),or=0}}function br(){var t=ur.now(),e=t-sr;e>1e3&&(fr-=e,sr=t)}function wr(t){ir||(lr&&(lr=clearTimeout(lr)),t-or>24?(t<1/0&&(lr=setTimeout(_r,t-ur.now()-fr)),ar&&(ar=clearInterval(ar))):(ar||(sr=ur.now(),ar=setInterval(br,1e3)),ir=1,hr(_r)))}function yr(t,e,r){var n=new dr;return e=null==e?0:+e,n.restart(r=>{n.stop(),t(r+e)},e,r),n}dr.prototype=gr.prototype={constructor:dr,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?cr():+r)+(null==e?0:+e),this._next||er===this||(er?er._next=this:tr=this,er=this),this._call=t,this._time=r,wr()},stop:function(){this._call&&(this._call=null,this._time=1/0,wr())}};var vr=O("start","end","cancel","interrupt"),xr=[];function Ar(t,e,r,n,i,l){var a=t.__transition;if(a){if(r in a)return}else t.__transition={};!function(t,e,r){var n,i=t.__transition;function l(t){r.state=1,r.timer.restart(a,r.delay,r.time),r.delay<=t&&a(t-r.delay)}function a(l){var f,u,h,c;if(1!==r.state)return o();for(f in i)if((c=i[f]).name===r.name){if(3===c.state)return yr(a);4===c.state?(c.state=6,c.timer.stop(),c.on.call("interrupt",t,t.__data__,c.index,c.group),delete i[f]):+f<e&&(c.state=6,c.timer.stop(),c.on.call("cancel",t,t.__data__,c.index,c.group),delete i[f])}if(yr(function(){3===r.state&&(r.state=4,r.timer.restart(s,r.delay,r.time),s(l))}),r.state=2,r.on.call("start",t,t.__data__,r.index,r.group),2===r.state){for(r.state=3,n=new Array(h=r.tween.length),f=0,u=-1;f<h;++f)(c=r.tween[f].value.call(t,t.__data__,r.index,r.group))&&(n[++u]=c);n.length=u+1}}function s(e){for(var i=e<r.duration?r.ease.call(null,e/r.duration):(r.timer.restart(o),r.state=5,1),l=-1,a=n.length;++l<a;)n[l].call(t,i);5===r.state&&(r.on.call("end",t,t.__data__,r.index,r.group),o())}function o(){for(var n in r.state=6,r.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=r,r.timer=gr(l,0,r.time)}(t,r,{name:e,index:n,group:i,on:vr,tween:xr,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:0})}function Mr(t,e){var r=Sr(t,e);if(r.state>0)throw new Error("too late; already scheduled");return r}function Br(t,e){var r=Sr(t,e);if(r.state>3)throw new Error("too late; already running");return r}function Sr(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function kr(t,e){var r,n,i,l=t.__transition,a=!0;if(l){for(i in e=null==e?null:e+"",l)(r=l[i]).name===e?(n=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(n?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete l[i]):a=!1;a&&delete t.__transition}}function Er(t,e){var r,n;return function(){var i=Br(this,t),l=i.tween;if(l!==r)for(var a=0,s=(n=r=l).length;a<s;++a)if(n[a].name===e){(n=n.slice()).splice(a,1);break}i.tween=n}}function Nr(t,e,r){var n,i;if("function"!=typeof r)throw new Error;return function(){var l=Br(this,t),a=l.tween;if(a!==n){i=(n=a).slice();for(var s={name:e,value:r},o=0,f=i.length;o<f;++o)if(i[o].name===e){i[o]=s;break}o===f&&i.push(s)}l.tween=i}}function Cr(t,e,r){var n=t._id;return t.each(function(){var t=Br(this,n);(t.value||(t.value={}))[e]=r.apply(this,arguments)}),function(t){return Sr(t,n).value[e]}}function Rr(t,e){var r;return("number"==typeof e?Le:e instanceof be?$e:(r=be(e))?(e=r,$e):Ye)(t,e)}function zr(t){return function(){this.removeAttribute(t)}}function Ir(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pr(t,e,r){var n,i,l=r+"";return function(){var a=this.getAttribute(t);return a===l?null:a===n?i:i=e(n=a,r)}}function Or(t,e,r){var n,i,l=r+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===l?null:a===n?i:i=e(n=a,r)}}function jr(t,e,r){var n,i,l;return function(){var a,s,o=r(this);if(null!=o)return(a=this.getAttribute(t))===(s=o+"")?null:a===n&&s===i?l:(i=s,l=e(n=a,o));this.removeAttribute(t)}}function Tr(t,e,r){var n,i,l;return function(){var a,s,o=r(this);if(null!=o)return(a=this.getAttributeNS(t.space,t.local))===(s=o+"")?null:a===n&&s===i?l:(i=s,l=e(n=a,o));this.removeAttributeNS(t.space,t.local)}}function $r(t,e){var r,n;function i(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&function(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}(t,i)),r}return i._value=e,i}function Dr(t,e){var r,n;function i(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&function(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}(t,i)),r}return i._value=e,i}function Vr(t,e){return function(){Mr(this,t).delay=+e.apply(this,arguments)}}function Fr(t,e){return e=+e,function(){Mr(this,t).delay=e}}function Lr(t,e){return function(){Br(this,t).duration=+e.apply(this,arguments)}}function qr(t,e){return e=+e,function(){Br(this,t).duration=e}}var Ur=Kt.prototype.constructor;function Hr(t){return function(){this.style.removeProperty(t)}}var Yr=0;function Xr(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function Gr(){return++Yr}var Wr=Kt.prototype;function Kr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Xr.prototype={constructor:Xr,select:function(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=Y(t));for(var n=this._groups,i=n.length,l=new Array(i),a=0;a<i;++a)for(var s,o,f=n[a],u=f.length,h=l[a]=new Array(u),c=0;c<u;++c)(s=f[c])&&(o=t.call(s,s.__data__,c,f))&&("__data__"in s&&(o.__data__=s.__data__),h[c]=o,Ar(h[c],e,r,c,h,Sr(s,r)));return new Xr(l,this._parents,e,r)},selectAll:function(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=W(t));for(var n=this._groups,i=n.length,l=[],a=[],s=0;s<i;++s)for(var o,f=n[s],u=f.length,h=0;h<u;++h)if(o=f[h]){for(var c,p=t.call(o,o.__data__,h,f),d=Sr(o,r),g=0,m=p.length;g<m;++g)(c=p[g])&&Ar(c,e,r,g,p,d);l.push(p),a.push(o)}return new Xr(l,a,e,r)},selectChild:Wr.selectChild,selectChildren:Wr.selectChildren,filter:function(t){"function"!=typeof t&&(t=K(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var l,a=e[i],s=a.length,o=n[i]=[],f=0;f<s;++f)(l=a[f])&&t.call(l,l.__data__,f,a)&&o.push(l);return new Xr(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,l=Math.min(n,i),a=new Array(n),s=0;s<l;++s)for(var o,f=e[s],u=r[s],h=f.length,c=a[s]=new Array(h),p=0;p<h;++p)(o=f[p]||u[p])&&(c[p]=o);for(;s<n;++s)a[s]=e[s];return new Xr(a,this._parents,this._name,this._id)},selection:function(){return new Ur(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,r=Gr(),n=this._groups,i=n.length,l=0;l<i;++l)for(var a,s=n[l],o=s.length,f=0;f<o;++f)if(a=s[f]){var u=Sr(a,e);Ar(a,t,r,f,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Xr(n,this._parents,t,r)},call:Wr.call,nodes:Wr.nodes,node:Wr.node,size:Wr.size,empty:Wr.empty,each:Wr.each,on:function(t,e){var r=this._id;return arguments.length<2?Sr(this.node(),r).on.on(t):this.each(function(t,e,r){var n,i,l=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?Mr:Br;return function(){var a=l(this,t),s=a.on;s!==n&&(i=(n=s).copy()).on(e,r),a.on=i}}(r,t,e))},attr:function(t,e){var r=F(t),n="transform"===r?nr:Rr;return this.attrTween(t,"function"==typeof e?(r.local?Tr:jr)(r,n,Cr(this,"attr."+t,e)):null==e?(r.local?Ir:zr)(r):(r.local?Or:Pr)(r,n,e))},attrTween:function(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;var n=F(t);return this.tween(r,(n.local?$r:Dr)(n,e))},style:function(t,e,r){var n="transform"==(t+="")?rr:Rr;return null==e?this.styleTween(t,function(t,e){var r,n,i;return function(){var l=wt(this,t),a=(this.style.removeProperty(t),wt(this,t));return l===a?null:l===r&&a===n?i:i=e(r=l,n=a)}}(t,n)).on("end.style."+t,Hr(t)):"function"==typeof e?this.styleTween(t,function(t,e,r){var n,i,l;return function(){var a=wt(this,t),s=r(this),o=s+"";return null==s&&(this.style.removeProperty(t),o=s=wt(this,t)),a===o?null:a===n&&o===i?l:(i=o,l=e(n=a,s))}}(t,n,Cr(this,"style."+t,e))).each(function(t,e){var r,n,i,l,a="style."+e,s="end."+a;return function(){var o=Br(this,t),f=o.on,u=null==o.value[a]?l||(l=Hr(e)):void 0;f===r&&i===u||(n=(r=f).copy()).on(s,i=u),o.on=n}}(this._id,t)):this.styleTween(t,function(t,e,r){var n,i,l=r+"";return function(){var a=wt(this,t);return a===l?null:a===n?i:i=e(n=a,r)}}(t,n,e),r).on("end.style."+t,null)},styleTween:function(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,function(t,e,r){var n,i;function l(){var l=e.apply(this,arguments);return l!==i&&(n=(i=l)&&function(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}(t,l,r)),n}return l._value=e,l}(t,e,null==r?"":r))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Cr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,r;function n(){var n=t.apply(this,arguments);return n!==r&&(e=(r=n)&&function(t){return function(e){this.textContent=t.call(this,e)}}(n)),e}return n._value=t,n}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n,i=Sr(this.node(),r).tween,l=0,a=i.length;l<a;++l)if((n=i[l]).name===t)return n.value;return null}return this.each((null==e?Er:Nr)(r,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Vr:Fr)(e,t)):Sr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Lr:qr)(e,t)):Sr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Br(this,t).ease=e}}(e,t)):Sr(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var r=e.apply(this,arguments);if("function"!=typeof r)throw new Error;Br(this,t).ease=r}}(this._id,t))},end:function(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(l,a){var s={value:a},o={value:function(){0===--i&&l()}};r.each(function(){var r=Br(this,n),i=r.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(o)),r.on=e}),0===i&&l()})},[Symbol.iterator]:Wr[Symbol.iterator]};var Qr={time:null,delay:0,duration:250,ease:Kr};function Jr(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Zr(t,e){if(!isFinite(t)||0===t)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function tn(t){return(t=Zr(Math.abs(t)))?t[1]:NaN}Kt.prototype.interrupt=function(t){return this.each(function(){kr(this,t)})},Kt.prototype.transition=function(t){var e,r;t instanceof Xr?(e=t._id,t=t._name):(e=Gr(),(r=Qr).time=cr(),t=null==t?null:t+"");for(var n=this._groups,i=n.length,l=0;l<i;++l)for(var a,s=n[l],o=s.length,f=0;f<o;++f)(a=s[f])&&Ar(a,t,e,f,s,r||Jr(a,e));return new Xr(n,this._parents,t,e)};var en,rn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function nn(t){if(!(e=rn.exec(t)))throw new Error("invalid format: "+t);var e;return new ln({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ln(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function an(t,e){var r=Zr(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}nn.prototype=ln.prototype,ln.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var sn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>an(100*t,e),r:an,s:function(t,e){var r=Zr(t,e);if(!r)return en=void 0,t.toPrecision(e);var n=r[0],i=r[1],l=i-(en=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=n.length;return l===a?n:l>a?n+new Array(l-a+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+Zr(t,Math.max(0,e+l-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function on(t){return t}var fn,un,hn,cn=Array.prototype.map,pn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function dn(t){var e,r,n=void 0===t.grouping||void 0===t.thousands?on:(e=cn.call(t.grouping,Number),r=t.thousands+"",function(t,n){for(var i=t.length,l=[],a=0,s=e[0],o=0;i>0&&s>0&&(o+s+1>n&&(s=Math.max(1,n-o)),l.push(t.substring(i-=s,i+s)),!((o+=s+1)>n));)s=e[a=(a+1)%e.length];return l.reverse().join(r)}),i=void 0===t.currency?"":t.currency[0]+"",l=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?on:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(cn.call(t.numerals,String)),o=void 0===t.percent?"%":t.percent+"",f=void 0===t.minus?"":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t,e){var r=(t=nn(t)).fill,h=t.align,c=t.sign,p=t.symbol,d=t.zero,g=t.width,m=t.comma,_=t.precision,b=t.trim,w=t.type;"n"===w?(m=!0,w="g"):sn[w]||(void 0===_&&(_=12),b=!0,w="g"),(d||"0"===r&&"="===h)&&(d=!0,r="0",h="=");var y=(e&&void 0!==e.prefix?e.prefix:"")+("$"===p?i:"#"===p&&/[boxX]/.test(w)?"0"+w.toLowerCase():""),v=("$"===p?l:/[%p]/.test(w)?o:"")+(e&&void 0!==e.suffix?e.suffix:""),x=sn[w],A=/[defgprs%]/.test(w);function M(t){var e,i,l,o=y,p=v;if("c"===w)p=x(t)+p,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:x(Math.abs(t),_),b&&(t=function(t){t:for(var e,r=t.length,n=1,i=-1;n<r;++n)switch(t[n]){case".":i=e=n;break;case"0":0===i&&(i=n),e=n;break;default:if(!+t[n])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),M&&0===+t&&"+"!==c&&(M=!1),o=(M?"("===c?c:f:"-"===c||"("===c?"":c)+o,p=("s"!==w||isNaN(t)||void 0===en?"":pn[8+en/3])+p+(M&&"("===c?")":""),A)for(e=-1,i=t.length;++e<i;)if(48>(l=t.charCodeAt(e))||l>57){p=(46===l?a+t.slice(e+1):t.slice(e))+p,t=t.slice(0,e);break}}m&&!d&&(t=n(t,1/0));var B=o.length+t.length+p.length,S=B<g?new Array(g-B+1).join(r):"";switch(m&&d&&(t=n(S+t,S.length?g-p.length:1/0),S=""),h){case"<":t=o+t+p+S;break;case"=":t=o+S+t+p;break;case"^":t=S.slice(0,B=S.length>>1)+o+t+p+S.slice(B);break;default:t=S+o+t+p}return s(t)}return _=void 0===_?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_)),M.toString=function(){return t+""},M}return{format:h,formatPrefix:function(t,e){var r=3*Math.max(-8,Math.min(8,Math.floor(tn(e)/3))),n=Math.pow(10,-r),i=h(((t=nn(t)).type="f",t),{suffix:pn[8+r/3]});return function(t){return i(n*t)}}}}function gn(t){return Math.max(0,-tn(Math.abs(t)))}function mn(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(tn(e)/3)))-tn(Math.abs(t)))}function _n(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,tn(e)-tn(t))+1}function bn(t,e){return t.parent===e.parent?1:2}function wn(t,e){return t+e.x}function yn(t,e){return Math.max(t,e.y)}function vn(){var t=bn,e=1,r=1,n=!1;function i(i){var l,a=0;i.eachAfter(function(e){var r=e.children;r?(e.x=function(t){return t.reduce(wn,0)/t.length}(r),e.y=function(t){return 1+t.reduce(yn,0)}(r)):(e.x=l?a+=t(e,l):0,e.y=0,l=e)});var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),o=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),f=s.x-t(s,o)/2,u=o.x+t(o,s)/2;return i.eachAfter(n?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*r}:function(t){t.x=(t.x-f)/(u-f)*e,t.y=(1-(i.y?t.y/i.y:1))*r})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(n=!1,e=+t[0],r=+t[1],i):n?null:[e,r]},i.nodeSize=function(t){return arguments.length?(n=!0,e=+t[0],r=+t[1],i):n?[e,r]:null},i}function xn(t){var e=0,r=t.children,n=r&&r.length;if(n)for(;--n>=0;)e+=r[n].value;else e=1;t.value=e}function An(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Bn)):void 0===e&&(e=Mn);for(var r,n,i,l,a,s=new En(t),o=[s];r=o.pop();)if((i=e(r.data))&&(a=(i=Array.from(i)).length))for(r.children=i,l=a-1;l>=0;--l)o.push(n=i[l]=new En(i[l])),n.parent=r,n.depth=r.depth+1;return s.eachBefore(kn)}function Mn(t){return t.children}function Bn(t){return Array.isArray(t)?t[1]:null}function Sn(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function kn(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function En(t){this.data=t,this.depth=this.height=0,this.parent=null}function Nn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}fn=dn({thousands:",",grouping:[3],currency:["$",""]}),un=fn.format,hn=fn.formatPrefix,En.prototype=An.prototype={constructor:En,count:function(){return this.eachAfter(xn)},each:function(t,e){let r=-1;for(const n of this)t.call(e,n,++r,this);return this},eachAfter:function(t,e){for(var r,n,i,l=this,a=[l],s=[],o=-1;l=a.pop();)if(s.push(l),r=l.children)for(n=0,i=r.length;n<i;++n)a.push(r[n]);for(;l=s.pop();)t.call(e,l,++o,this);return this},eachBefore:function(t,e){for(var r,n,i=this,l=[i],a=-1;i=l.pop();)if(t.call(e,i,++a,this),r=i.children)for(n=r.length-1;n>=0;--n)l.push(r[n]);return this},find:function(t,e){let r=-1;for(const n of this)if(t.call(e,n,++r,this))return n},sum:function(t){return this.eachAfter(function(e){for(var r=+t(e.data)||0,n=e.children,i=n&&n.length;--i>=0;)r+=n[i].value;e.value=r})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,r=function(t,e){if(t===e)return t;var r=t.ancestors(),n=e.ancestors(),i=null;t=r.pop(),e=n.pop();for(;t===e;)i=t,t=r.pop(),e=n.pop();return i}(e,t),n=[e];e!==r;)e=e.parent,n.push(e);for(var i=n.length;t!==r;)n.splice(i,0,t),t=t.parent;return n},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(r){r!==t&&e.push({source:r.parent,target:r})}),e},copy:function(){return An(this).eachBefore(Sn)},[Symbol.iterator]:function*(){var t,e,r,n,i=this,l=[i];do{for(t=l.reverse(),l=[];i=t.pop();)if(yield i,e=i.children)for(r=0,n=e.length;r<n;++r)l.push(e[r])}while(l.length)}};const Cn=Symbol("implicit");function Rn(){var t=new f,e=[],r=[],n=Cn;function i(i){let l=t.get(i);if(void 0===l){if(n!==Cn)return n;t.set(i,l=e.push(i)-1)}return r[l%r.length]}return i.domain=function(r){if(!arguments.length)return e.slice();e=[],t=new f;for(const n of r)t.has(n)||t.set(n,e.push(n)-1);return i},i.range=function(t){return arguments.length?(r=Array.from(t),i):r.slice()},i.unknown=function(t){return arguments.length?(n=t,i):n},i.copy=function(){return Rn(e,r).unknown(n)},Nn.apply(i,arguments),i}function zn(){var t,e,r=Rn().unknown(void 0),n=r.domain,i=r.range,l=0,a=1,s=!1,o=0,f=0,u=.5;function h(){var r=n().length,h=a<l,c=h?a:l,p=h?l:a;t=(p-c)/Math.max(1,r-o+2*f),s&&(t=Math.floor(t)),c+=(p-c-t*(r-o))*u,e=t*(1-o),s&&(c=Math.round(c),e=Math.round(e));var d=x(r).map(function(e){return c+t*e});return i(h?d.reverse():d)}return delete r.unknown,r.domain=function(t){return arguments.length?(n(t),h()):n()},r.range=function(t){return arguments.length?([l,a]=t,l=+l,a=+a,h()):[l,a]},r.rangeRound=function(t){return[l,a]=t,l=+l,a=+a,s=!0,h()},r.bandwidth=function(){return e},r.step=function(){return t},r.round=function(t){return arguments.length?(s=!!t,h()):s},r.padding=function(t){return arguments.length?(o=Math.min(1,f=+t),h()):o},r.paddingInner=function(t){return arguments.length?(o=Math.min(1,t),h()):o},r.paddingOuter=function(t){return arguments.length?(f=+t,h()):f},r.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),h()):u},r.copy=function(){return zn(n(),[l,a]).round(s).paddingInner(o).paddingOuter(f).align(u)},Nn.apply(h(),arguments)}function In(t){return+t}var Pn=[0,1];function On(t){return t}function jn(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:(r=isNaN(e)?NaN:.5,function(){return r});var r}function Tn(t,e,r){var n=t[0],i=t[1],l=e[0],a=e[1];return i<n?(n=jn(i,n),l=r(a,l)):(n=jn(n,i),l=r(l,a)),function(t){return l(n(t))}}function $n(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),l=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=jn(t[s],t[s+1]),l[s]=r(e[s],e[s+1]);return function(e){var r=a(t,e,1,n)-1;return l[r](i[r](e))}}function Dn(){var t,e,r,n,i,l,a=Pn,s=Pn,o=Xe,f=On;function u(){var t,e,r,o=Math.min(a.length,s.length);return f!==On&&(t=a[0],e=a[o-1],t>e&&(r=t,t=e,e=r),f=function(r){return Math.max(t,Math.min(e,r))}),n=o>2?$n:Tn,i=l=null,h}function h(e){return null==e||isNaN(e=+e)?r:(i||(i=n(a.map(t),s,o)))(t(f(e)))}return h.invert=function(r){return f(e((l||(l=n(s,a.map(t),Le)))(r)))},h.domain=function(t){return arguments.length?(a=Array.from(t,In),u()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),o=Ge,u()},h.clamp=function(t){return arguments.length?(f=!!t||On,u()):f!==On},h.interpolate=function(t){return arguments.length?(o=t,u()):o},h.unknown=function(t){return arguments.length?(r=t,h):r},function(r,n){return t=r,e=n,u()}}function Vn(t,e,r,n){var i,l=b(t,e,r);switch((n=nn(null==n?",f":n)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(i=mn(l,a))||(n.precision=i),hn(n,a);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=_n(l,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=gn(l))||(n.precision=i-2*("%"===n.type))}return un(n)}function Fn(){var t=Dn()(On,On);return t.copy=function(){return e=t,Fn().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},Nn.apply(t,arguments),function(t){var e=t.domain;return t.ticks=function(t){var r=e();return m(r[0],r[r.length-1],null==t?10:t)},t.tickFormat=function(t,r){var n=e();return Vn(n[0],n[n.length-1],null==t?10:t,r)},t.nice=function(r){null==r&&(r=10);var n,i,l=e(),a=0,s=l.length-1,o=l[a],f=l[s],u=10;for(f<o&&(i=o,o=f,f=i,i=a,a=s,s=i);u-- >0;){if((i=_(o,f,r))===n)return l[a]=o,l[s]=f,e(l);if(i>0)o=Math.floor(o/i)*i,f=Math.ceil(f/i)*i;else{if(!(i<0))break;o=Math.ceil(o*i)/i,f=Math.floor(f*i)/i}n=i}return t},t}(t)}function Ln(t,e,r){this.k=t,this.x=e,this.y=r}Ln.prototype={constructor:Ln,scale:function(t){return 1===t?this:new Ln(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Ln(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Ln.prototype;var qn=Object.freeze({__proto__:null,FormatSpecifier:ln,InternMap:f,Node:En,ZoomTransform:Ln,ascending:r,axisBottom:z,axisLeft:I,axisTop:R,bisect:a,bisectRight:a,bisector:i,cluster:vn,color:be,create:Jt,creator:U,descending:n,deviation:function(t,e){const r=s(t,e);return r?Math.sqrt(r):r},dispatch:O,easeCubic:Kr,easeCubicInOut:Kr,extent:o,get format(){return un},formatLocale:dn,get formatPrefix(){return hn},formatSpecifier:nn,hierarchy:An,hsl:Ce,interpolate:Xe,interpolateDate:Fe,interpolateNumber:Le,interpolateNumberArray:De,interpolateObject:qe,interpolateRgb:$e,interpolateRound:Ge,interpolateString:Ye,interpolateTransformCss:rr,interpolateTransformSvg:nr,interrupt:kr,matcher:K,max:w,mean:v,min:y,namespace:F,namespaces:V,now:cr,precisionFixed:gn,precisionPrefix:mn,precisionRound:_n,range:x,rgb:ve,scaleBand:zn,scaleImplicit:Cn,scaleLinear:Fn,scaleOrdinal:Rn,select:Qt,selectAll:Zt,selection:Kt,selector:Y,selectorAll:W,style:wt,tickFormat:Vn,tickIncrement:_,tickStep:b,ticks:m,timeout:yr,timer:gr,timerFlush:mr,variance:s,window:gt}),Un="$";function Hn(){}function Yn(t,e){var r=new Hn;if(t instanceof Hn)t.each(function(t,e){r.set(e,t)});else if(Array.isArray(t)){var n,i=-1,l=t.length;if(null==e)for(;++i<l;)r.set(i,t[i]);else for(;++i<l;)r.set(e(n=t[i],i,t),n)}else if(t)for(var a in t)r.set(a,t[a]);return r}function Xn(){}Hn.prototype=Yn.prototype={constructor:Hn,has:function(t){return Un+t in this},get:function(t){return this[Un+t]},set:function(t,e){return this[Un+t]=e,this},remove:function(t){var e=Un+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Un&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Un&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Un&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Un&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Un&&++t;return t},empty:function(){for(var t in this)if(t[0]===Un)return!1;return!0},each:function(t){for(var e in this)e[0]===Un&&t(this[e],e.slice(1),this)}};var Gn=Yn.prototype;Xn.prototype={constructor:Xn,has:Gn.has,add:function(t){return this[Un+(t+="")]=t,this},remove:Gn.remove,clear:Gn.clear,values:Gn.keys,size:Gn.size,empty:Gn.empty,each:Gn.each};var Wn="http://www.w3.org/1999/xhtml",Kn={svg:"http://www.w3.org/2000/svg",xhtml:Wn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qn(t){var e=t+="",r=e.indexOf(":");return r>=0&&"xmlns"!==(e=t.slice(0,r))&&(t=t.slice(r+1)),Kn.hasOwnProperty(e)?{space:Kn[e],local:t}:t}function Jn(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===Wn&&e.documentElement.namespaceURI===Wn?e.createElement(t):e.createElementNS(r,t)}}function Zn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ti(t){var e=Qn(t);return(e.local?Zn:Jn)(e)}function ei(){}function ri(t){return null==t?ei:function(){return this.querySelector(t)}}function ni(){return[]}function ii(t){return new Array(t.length)}function li(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}li.prototype={constructor:li,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ai(t,e,r,n,i,l){for(var a,s=0,o=e.length,f=l.length;s<f;++s)(a=e[s])?(a.__data__=l[s],n[s]=a):r[s]=new li(t,l[s]);for(;s<o;++s)(a=e[s])&&(i[s]=a)}function si(t,e,r,n,i,l,a){var s,o,f,u={},h=e.length,c=l.length,p=new Array(h);for(s=0;s<h;++s)(o=e[s])&&(p[s]=f="$"+a.call(o,o.__data__,s,e),f in u?i[s]=o:u[f]=o);for(s=0;s<c;++s)(o=u[f="$"+a.call(t,l[s],s,l)])?(n[s]=o,o.__data__=l[s],u[f]=null):r[s]=new li(t,l[s]);for(s=0;s<h;++s)(o=e[s])&&u[p[s]]===o&&(i[s]=o)}function oi(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function fi(t){return function(){this.removeAttribute(t)}}function ui(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hi(t,e){return function(){this.setAttribute(t,e)}}function ci(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function pi(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function di(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function gi(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mi(t){return function(){this.style.removeProperty(t)}}function _i(t,e,r){return function(){this.style.setProperty(t,e,r)}}function bi(t,e,r){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function wi(t){return function(){delete this[t]}}function yi(t,e){return function(){this[t]=e}}function vi(t,e){return function(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function xi(t){return t.trim().split(/^|\s+/)}function Ai(t){return t.classList||new Mi(t)}function Mi(t){this._node=t,this._names=xi(t.getAttribute("class")||"")}function Bi(t,e){for(var r=Ai(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function Si(t,e){for(var r=Ai(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function ki(t){return function(){Bi(this,t)}}function Ei(t){return function(){Si(this,t)}}function Ni(t,e){return function(){(e.apply(this,arguments)?Bi:Si)(this,t)}}function Ci(){this.textContent=""}function Ri(t){return function(){this.textContent=t}}function zi(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ii(){this.innerHTML=""}function Pi(t){return function(){this.innerHTML=t}}function Oi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ji(){this.nextSibling&&this.parentNode.appendChild(this)}function Ti(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $i(){return null}function Di(){var t=this.parentNode;t&&t.removeChild(this)}function Vi(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Fi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}Mi.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Li={};"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Li={mouseenter:"mouseover",mouseleave:"mouseout"}));function qi(t,e,r){return t=Ui(t,e,r),function(e){var r=e.relatedTarget;r&&(r===this||8&r.compareDocumentPosition(this))||t.call(this,e)}}function Ui(t,e,r){return function(n){try{t.call(this,this.__data__,e,r)}finally{}}}function Hi(t){return function(){var e=this.__on;if(e){for(var r,n=0,i=-1,l=e.length;n<l;++n)r=e[n],t.type&&r.type!==t.type||r.name!==t.name?e[++i]=r:this.removeEventListener(r.type,r.listener,r.capture);++i?e.length=i:delete this.__on}}}function Yi(t,e,r){var n=Li.hasOwnProperty(t.type)?qi:Ui;return function(i,l,a){var s,o=this.__on,f=n(e,l,a);if(o)for(var u=0,h=o.length;u<h;++u)if((s=o[u]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=f,s.capture=r),void(s.value=e);this.addEventListener(t.type,f,r),s={type:t.type,name:t.name,value:e,listener:f,capture:r},o?o.push(s):this.__on=[s]}}function Xi(t,e,r){var n=gi(t),i=n.CustomEvent;"function"==typeof i?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Gi(t,e){return function(){return Xi(this,t,e)}}function Wi(t,e){return function(){return Xi(this,t,e.apply(this,arguments))}}var Ki=[null];function Qi(t,e){this._groups=t,this._parents=e}function Ji(){return new Qi([[document.documentElement]],Ki)}function Zi(t){return"string"==typeof t?new Qi([[document.querySelector(t)]],[document.documentElement]):new Qi([[t]],Ki)}function tl(){var t=function(){return"n"},e=function(){return[0,0]},r=function(){return" "},n=document.body,i=h(),l=null,a=null,s=null;function o(t){l=function(t){var e=t.node();return e?"svg"===e.tagName.toLowerCase()?e:e.ownerSVGElement:null}(t),l&&(a=l.createSVGPoint(),n.appendChild(i))}o.show=function(){var i=Array.prototype.slice.call(arguments);i[i.length-1]instanceof SVGElement&&(s=i.pop());var l,a=r.apply(this,i),h=e.apply(this,i),p=t.apply(this,i),d=c(),g=u.length,m=document.documentElement.scrollTop||n.scrollTop,_=document.documentElement.scrollLeft||n.scrollLeft;for(d.html(a).style("opacity",1).style("pointer-events","all");g--;)d.classed(u[g],!1);return l=f.get(p).apply(this),d.classed(p,!0).style("top",l.top+h[0]+m+"px").style("left",l.left+h[1]+_+"px"),o},o.hide=function(){return c().style("opacity",0).style("pointer-events","none"),o},o.attr=function(t,e){if(arguments.length<2&&"string"==typeof t)return c().attr(t);var r=Array.prototype.slice.call(arguments);return Ji.prototype.attr.apply(c(),r),o},o.style=function(t,e){if(arguments.length<2&&"string"==typeof t)return c().style(t);var r=Array.prototype.slice.call(arguments);return Ji.prototype.style.apply(c(),r),o},o.direction=function(e){return arguments.length?(t=null==e?e:d(e),o):t},o.offset=function(t){return arguments.length?(e=null==t?t:d(t),o):e},o.html=function(t){return arguments.length?(r=null==t?t:d(t),o):r},o.rootElement=function(t){return arguments.length?(n=null==t?t:d(t),o):n},o.destroy=function(){return i&&(c().remove(),i=null),o};var f=Yn({n:function(){var t=p(this);return{top:t.n.y-i.offsetHeight,left:t.n.x-i.offsetWidth/2}},s:function(){var t=p(this);return{top:t.s.y,left:t.s.x-i.offsetWidth/2}},e:function(){var t=p(this);return{top:t.e.y-i.offsetHeight/2,left:t.e.x}},w:function(){var t=p(this);return{top:t.w.y-i.offsetHeight/2,left:t.w.x-i.offsetWidth}},nw:function(){var t=p(this);return{top:t.nw.y-i.offsetHeight,left:t.nw.x-i.offsetWidth}},ne:function(){var t=p(this);return{top:t.ne.y-i.offsetHeight,left:t.ne.x}},sw:function(){var t=p(this);return{top:t.sw.y,left:t.sw.x-i.offsetWidth}},se:function(){var t=p(this);return{top:t.se.y,left:t.se.x}}}),u=f.keys();function h(){var t=Zi(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function c(){return null==i&&(i=h(),n.appendChild(i)),Zi(i)}function p(t){for(var e=s||t;null==e.getScreenCTM&&null!=e.parentNode;)e=e.parentNode;var r={},n=e.getScreenCTM(),i=e.getBBox(),l=i.width,o=i.height,f=i.x,u=i.y;return a.x=f,a.y=u,r.nw=a.matrixTransform(n),a.x+=l,r.ne=a.matrixTransform(n),a.y+=o,r.se=a.matrixTransform(n),a.x-=l,r.sw=a.matrixTransform(n),a.y-=o/2,r.w=a.matrixTransform(n),a.x+=l,r.e=a.matrixTransform(n),a.x-=l/2,a.y-=o/2,r.n=a.matrixTransform(n),a.y+=o,r.s=a.matrixTransform(n),r}function d(t){return"function"==typeof t?t:function(){return t}}return o}function el(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function rl(t,e){return Math.sqrt(el(t,e))}function nl(t,e){const r=function(t){const e=[];for(let r=0;r<t;r++){const r=[];e.push(r);for(let e=0;e<t;e++)r.push(0)}return e}(t.length);for(let n=0;n<t.length;n++)for(let i=0;i<=n;i++)r[n][i]=e(t[n],t[i]),r[i][n]=r[n][i];return r}function il(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ll(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if("function"==typeof e){var r=function t(){var r=!1;try{r=this instanceof t}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),r}Qi.prototype=Ji.prototype={constructor:Qi,select:function(t){"function"!=typeof t&&(t=ri(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var l,a,s=e[i],o=s.length,f=n[i]=new Array(o),u=0;u<o;++u)(l=s[u])&&(a=t.call(l,l.__data__,u,s))&&("__data__"in l&&(a.__data__=l.__data__),f[u]=a);return new Qi(n,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?ni:function(){return this.querySelectorAll(t)}}(t));for(var e=this._groups,r=e.length,n=[],i=[],l=0;l<r;++l)for(var a,s=e[l],o=s.length,f=0;f<o;++f)(a=s[f])&&(n.push(t.call(a,a.__data__,f,s)),i.push(a));return new Qi(n,i)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var l,a=e[i],s=a.length,o=n[i]=[],f=0;f<s;++f)(l=a[f])&&t.call(l,l.__data__,f,a)&&o.push(l);return new Qi(n,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),u=-1,this.each(function(t){d[++u]=t}),d;var r,n=e?si:ai,i=this._parents,l=this._groups;"function"!=typeof t&&(r=t,t=function(){return r});for(var a=l.length,s=new Array(a),o=new Array(a),f=new Array(a),u=0;u<a;++u){var h=i[u],c=l[u],p=c.length,d=t.call(h,h&&h.__data__,u,i),g=d.length,m=o[u]=new Array(g),_=s[u]=new Array(g);n(h,c,m,_,f[u]=new Array(p),d,e);for(var b,w,y=0,v=0;y<g;++y)if(b=m[y]){for(y>=v&&(v=y+1);!(w=_[v])&&++v<g;);b._next=w||null}}return(s=new Qi(s,i))._enter=o,s._exit=f,s},enter:function(){return new Qi(this._enter||this._groups.map(ii),this._parents)},exit:function(){return new Qi(this._exit||this._groups.map(ii),this._parents)},join:function(t,e,r){var n=this.enter(),i=this,l=this.exit();return n="function"==typeof t?t(n):n.append(t+""),null!=e&&(i=e(i)),null==r?l.remove():r(l),n&&i?n.merge(i).order():i},merge:function(t){for(var e=this._groups,r=t._groups,n=e.length,i=r.length,l=Math.min(n,i),a=new Array(n),s=0;s<l;++s)for(var o,f=e[s],u=r[s],h=f.length,c=a[s]=new Array(h),p=0;p<h;++p)(o=f[p]||u[p])&&(c[p]=o);for(;s<n;++s)a[s]=e[s];return new Qi(a,this._parents)},order:function(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n,i=t[e],l=i.length-1,a=i[l];--l>=0;)(n=i[l])&&(a&&4^n.compareDocumentPosition(a)&&a.parentNode.insertBefore(n,a),a=n);return this},sort:function(t){function e(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}t||(t=oi);for(var r=this._groups,n=r.length,i=new Array(n),l=0;l<n;++l){for(var a,s=r[l],o=s.length,f=i[l]=new Array(o),u=0;u<o;++u)(a=s[u])&&(f[u]=a);f.sort(e)}return new Qi(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,l=n.length;i<l;++i){var a=n[i];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i,l=e[r],a=0,s=l.length;a<s;++a)(i=l[a])&&t.call(i,i.__data__,a,l);return this},attr:function(t,e){var r=Qn(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==e?r.local?ui:fi:"function"==typeof e?r.local?di:pi:r.local?ci:hi)(r,e))},style:function(t,e,r){return arguments.length>1?this.each((null==e?mi:"function"==typeof e?bi:_i)(t,e,null==r?"":r)):function(t,e){return t.style.getPropertyValue(e)||gi(t).getComputedStyle(t,null).getPropertyValue(e)}(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?wi:"function"==typeof e?vi:yi)(t,e)):this.node()[t]},classed:function(t,e){var r=xi(t+"");if(arguments.length<2){for(var n=Ai(this.node()),i=-1,l=r.length;++i<l;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof e?Ni:e?ki:Ei)(r,e))},text:function(t){return arguments.length?this.each(null==t?Ci:("function"==typeof t?zi:Ri)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Ii:("function"==typeof t?Oi:Pi)(t)):this.node().innerHTML},raise:function(){return this.each(ji)},lower:function(){return this.each(Ti)},append:function(t){var e="function"==typeof t?t:ti(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var r="function"==typeof t?t:ti(t),n=null==e?$i:"function"==typeof e?e:ri(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function(){return this.each(Di)},clone:function(t){return this.select(t?Fi:Vi)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,r){var n,i,l=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");return r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),{type:t,name:e}})}(t+""),a=l.length;if(!(arguments.length<2)){for(s=e?Yi:Hi,null==r&&(r=!1),n=0;n<a;++n)this.each(s(l[n],e,r));return this}var s=this.node().__on;if(s)for(var o,f=0,u=s.length;f<u;++f)for(n=0,o=s[f];n<a;++n)if((i=l[n]).type===o.type&&i.name===o.name)return o.value},dispatch:function(t,e){return this.each(("function"==typeof e?Wi:Gi)(t,e))}};var al={};const sl=Object.prototype.toString;function ol(t){const e=sl.call(t);return e.endsWith("Array]")&&!e.includes("Big")}var fl=ll(Object.freeze({__proto__:null,isAnyArray:ol}));var ul,hl=ll(Object.freeze({__proto__:null,default:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ol(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!ol(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ol(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,l=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(l<=n||l>t.length||!Number.isInteger(l))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<l;s++)t[s]<a&&(a=t[s]);return a}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ol(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,l=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(l<=n||l>t.length||!Number.isInteger(l))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],s=n+1;s<l;s++)t[s]>a&&(a=t[s]);return a}(t);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var l=r.min,a=void 0===l?r.autoMinMax?n:0:l,s=r.max,o=void 0===s?r.autoMinMax?i:1:s;if(a>=o)throw new RangeError("min option must be smaller than max option");for(var f=(o-a)/(i-n),u=0;u<t.length;u++)e[u]=(t[u]-n)*f+a;return e}}));function cl(){if(ul)return al;ul=1,Object.defineProperty(al,"__esModule",{value:!0});var t=fl,e=hl;const r=" ".repeat(2),n=" ".repeat(4);function i(t,e={}){const{maxRows:i=15,maxColumns:a=10,maxNumSize:s=8,padMinus:o="auto"}=e;return`${t.constructor.name} {\n${r}[\n${n}${function(t,e,r,i,a){const{rows:s,columns:o}=t,f=Math.min(s,e),u=Math.min(o,r),h=[];if("auto"===a){a=!1;t:for(let e=0;e<f;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){a=!0;break t}}for(let e=0;e<f;e++){let r=[];for(let n=0;n<u;n++)r.push(l(t.get(e,n),i,a));h.push(`${r.join(" ")}`)}u!==o&&(h[h.length-1]+=` ... ${o-r} more columns`);f!==s&&h.push(`... ${s-e} more rows`);return h.join(`\n${n}`)}(t,i,a,s,o)}\n${r}]\n${r}rows: ${t.rows}\n${r}columns: ${t.columns}\n}`}function l(t,e,r){return(t>=0&&r?` ${a(t,e-1)}`:a(t,e)).padEnd(e)}function a(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function s(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function o(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function u(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function h(e,r){if(!t.isAnyArray(r))throw new TypeError("row indices must be an array");for(let t=0;t<r.length;t++)if(r[t]<0||r[t]>=e.rows)throw new RangeError("row indices are out of range")}function c(e,r){if(!t.isAnyArray(r))throw new TypeError("column indices must be an array");for(let t=0;t<r.length;t++)if(r[t]<0||r[t]>=e.columns)throw new RangeError("column indices are out of range")}function p(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(g("startRow",e),g("endRow",r),g("startColumn",n),g("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function d(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function g(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function m(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class _{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new y(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new y(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new y(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new y(t,e)}static ones(t,e){return new y(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let i=new y(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:i=1e3,random:l=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(n>=i)throw new RangeError("min must be smaller than max");let a=i-n,s=new y(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(l()*a);s.set(r,t,e)}return s}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),l=this.zeros(e,r);for(let e=0;e<i;e++)l.set(e,e,t[e]);return l}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new y(r,n);for(let l=0;l<r;l++)for(let r=0;r<n;r++)i.set(l,r,Math.min(t.get(l,r),e.get(l,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let l=0;l<r;l++)for(let r=0;r<n;r++)i.set(l,r,Math.max(t.get(l,r),e.get(l,r)));return i}static checkMatrix(t){return _.isMatrix(t)?t:new y(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let l=r+1;l<t.columns;l++)t.set(n,l,t.get(n,l)-t.get(e,l)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,l=!1;for(;i<r&&!1===l;)1===t.get(n,i)?l=!0:i++;for(let r=0;r<n;r++){let l=t.get(r,i);for(let a=i;a<e;a++){let e=t.get(r,a)-l*t.get(n,a);t.set(r,a,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new y(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){s(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return y.rowVector(this.getRow(t))}setRow(t,e){s(this,t),e=f(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){s(this,t),s(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){o(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return y.columnVector(this.getColumn(t))}setColumn(t,e){o(this,t),e=u(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){o(this,t),o(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){s(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){o(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){m(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){m(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(s(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){s(this,t),m(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(s(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){s(this,t),m(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(o(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){o(this,t),m(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(o(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){o(this,t),m(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){_.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=y.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new y(e,n),l=new Float64Array(r);for(let a=0;a<n;a++){for(let e=0;e<r;e++)l[e]=t.get(e,a);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*l[n];i.set(t,a,e)}}return i}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=y.eye(this.rows),r=this;for(let n=t;n>=1;n/=2)1&n&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=y.checkMatrix(t);let e=new y(2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),l=t.get(0,1),a=this.get(1,0),s=t.get(1,0),o=this.get(1,1),f=t.get(1,1),u=(r+o)*(n+f),h=(a+o)*n,c=r*(l-f),p=o*(s-n),d=(r+i)*f,g=u+p-d+(i-o)*(s+f),m=c+d,_=h+p,b=u-h+c+(a-r)*(n+l);return e.set(0,0,g),e.set(0,1,m),e.set(1,0,_),e.set(1,1,b),e}strassen3x3(t){t=y.checkMatrix(t);let e=new y(3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),l=this.get(1,0),a=this.get(1,1),s=this.get(1,2),o=this.get(2,0),f=this.get(2,1),u=this.get(2,2),h=t.get(0,0),c=t.get(0,1),p=t.get(0,2),d=t.get(1,0),g=t.get(1,1),m=t.get(1,2),_=t.get(2,0),b=t.get(2,1),w=t.get(2,2),v=(r-l)*(-c+g),x=(-r+l+a)*(h-c+g),A=(l+a)*(-h+c),M=r*h,B=(-r+o+f)*(h-p+m),S=(-r+o)*(p-m),k=(o+f)*(-h+p),E=(-i+f+u)*(g+_-b),N=(i-u)*(g-b),C=i*_,R=(f+u)*(-_+b),z=(-i+a+s)*(m+_-w),I=(i-s)*(m-w),P=(a+s)*(-_+w),O=M+C+n*d,j=(r+n+i-l-a-f-u)*g+x+A+M+E+C+R,T=M+B+k+(r+n+i-a-s-o-f)*m+C+z+P,$=v+a*(-h+c+d-g-m-_+w)+x+M+C+z+I,D=v+x+A+M+s*b,V=C+z+I+P+l*p,F=M+B+S+f*(-h+p+d-g-m-_+b)+E+N+C,L=E+N+C+R+o*c,q=M+B+S+k+u*w;return e.set(0,0,O),e.set(0,1,j),e.set(0,2,T),e.set(1,0,$),e.set(1,1,D),e.set(1,2,V),e.set(2,0,F),e.set(2,1,L),e.set(2,2,q),e}mmulStrassen(t){t=y.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,l=t.columns;function a(t,e,r){let n=t.rows,i=t.columns;if(n===e&&i===r)return t;{let n=_.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${l} matrix: dimensions do not match.`);let s=Math.max(r,i),o=Math.max(n,l);return e=a(e,s,o),function t(e,r,n,i){if(n<=512||i<=512)return e.mmul(r);n%2==1&&i%2==1?(e=a(e,n+1,i+1),r=a(r,n+1,i+1)):n%2==1?(e=a(e,n+1,i),r=a(r,n+1,i)):i%2==1&&(e=a(e,n,i+1),r=a(r,n,i+1));let l=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),o=e.subMatrix(0,l-1,0,s-1),f=r.subMatrix(0,l-1,0,s-1),u=e.subMatrix(0,l-1,s,e.columns-1),h=r.subMatrix(0,l-1,s,r.columns-1),c=e.subMatrix(l,e.rows-1,0,s-1),p=r.subMatrix(l,r.rows-1,0,s-1),d=e.subMatrix(l,e.rows-1,s,e.columns-1),g=r.subMatrix(l,r.rows-1,s,r.columns-1),m=t(_.add(o,d),_.add(f,g),l,s),b=t(_.add(c,d),f,l,s),w=t(o,_.sub(h,g),l,s),y=t(d,_.sub(p,f),l,s),v=t(_.add(o,u),g,l,s),x=t(_.sub(c,o),_.add(f,h),l,s),A=t(_.sub(u,d),_.add(p,g),l,s),M=_.add(m,y);M.sub(v),M.add(A);let B=_.add(w,v),S=_.add(b,y),k=_.sub(m,b);k.add(w),k.add(x);let E=_.zeros(2*M.rows,2*M.columns);return E=E.setSubMatrix(M,0,0),E=E.setSubMatrix(B,M.rows,0),E=E.setSubMatrix(S,0,M.columns),E=E.setSubMatrix(k,M.rows,M.columns),E.subMatrix(0,n-1,0,i-1)}(e,t=a(t,s,o),s,o)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:n=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(r>=n)throw new RangeError("min must be smaller than max");let i=new y(this.rows,this.columns);for(let t=0;t<this.rows;t++){const l=this.getRow(t);l.length>0&&e(l,{min:r,max:n,output:l}),i.setRow(t,l)}return i}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:n=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(r>=n)throw new RangeError("min must be smaller than max");let i=new y(this.rows,this.columns);for(let t=0;t<this.columns;t++){const l=this.getColumn(t);l.length&&e(l,{min:r,max:n,output:l}),i.setColumn(t,l)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=y.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,l=new y(e*n,r*i);for(let a=0;a<e;a++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let s=0;s<i;s++)l.set(n*a+r,i*e+s,this.get(a,e)*t.get(r,s));return l}kroneckerSum(t){if(t=y.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(y.eye(r,r)),i=y.eye(e,e).kroneckerProduct(t);return n.add(i)}transpose(){let t=new y(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=b){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=b){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){p(this,t,e,r,n);let i=new y(e-t+1,n-r+1);for(let l=t;l<=e;l++)for(let e=r;e<=n;e++)i.set(l-t,e-r,this.get(l,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new y(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let l=e;l<=r;l++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,l-e,this.get(t[i],l))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new y(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let l=e;l<=r;l++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(l-e,i,this.get(l,t[i]))}return n}setSubMatrix(t,e,r){if((t=y.checkMatrix(t)).isEmpty())return this;p(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){h(this,t),c(this,e);let r=new y(t.length,e.length);for(let n=0;n<t.length;n++){let i=t[n];for(let t=0;t<e.length;t++){let l=e[t];r.set(n,t,this.get(i,l))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new y(this.rows,this.columns))}static copy(t,e){for(const[r,n,i]of t.entries())e.set(r,n,i);return e}sum(t){switch(t){case"row":return function(t){let e=d(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=d(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=d(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=d(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:i=this.mean(e)}=r;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,l=[];for(let a=0;a<n;a++){let n=0,s=0,o=0;for(let e=0;e<i;e++)o=t.get(a,e)-r[a],n+=o,s+=o*o;e?l.push((s-n*n/i)/(i-1)):l.push((s-n*n/i)/i)}return l}(this,n,i);case"column":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,l=[];for(let a=0;a<i;a++){let i=0,s=0,o=0;for(let e=0;e<n;e++)o=t.get(e,a)-r[a],i+=o,s+=o*o;e?l.push((s-i*i/n)/(n-1)):l.push((s-i*i/n)/n)}return l}(this,n,i);case void 0:if("number"!=typeof i)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,i=t.columns,l=n*i;let a=0,s=0,o=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)o=t.get(e,n)-r,a+=o,s+=o*o;return e?(s-a*a/l)/(l-1):(s-a*a/l)/l}(this,n,i);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{center:n=this.mean(e)}=r;switch(e){case"row":if(!t.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,n),this;case"column":if(!t.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");let n=r.scale;switch(e){case"row":if(void 0===n)n=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!t.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,n),this;case"column":if(void 0===n)n=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!t.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,n),this;case void 0:if(void 0===n)n=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=t.get(i,n)**2/e;return Math.sqrt(r)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}toString(t){return i(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function b(t,e){return t-e}function w(t){return t.every(t=>"number"==typeof t)}_.prototype.klass="Matrix","undefined"!=typeof Symbol&&(_.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return i(this)}),_.random=_.rand,_.randomInt=_.randInt,_.diagonal=_.diag,_.prototype.diagonal=_.prototype.diag,_.identity=_.eye,_.prototype.negate=_.prototype.neg,_.prototype.tensorProduct=_.prototype.kroneckerProduct;class y extends _{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(e,r){if(super(),y.isMatrix(e))this.#t(e.rows,e.columns),y.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#t(e,r);else{if(!t.isAnyArray(e))throw new TypeError("First argument must be a positive number or an array");{const t=e;if("number"!=typeof(r=(e=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<e;n++){if(t[n].length!==r)throw new RangeError("Inconsistent array dimensions");if(!w(t[n]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[n]))}this.rows=e,this.columns=r}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return s(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),s(this,t,!0),e=Float64Array.from(f(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){o(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),o(this,t,!0),e=u(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this}}(_,y);class v extends _{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return y.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),y.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=y.copy(t,new y(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new y(t,t);else if(this.#e=new y(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new v(this.diagonalSize);for(const[e,r,n]of this.upperRightEntries())t.set(e,r,n);return t}toMatrix(){return new y(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[r,n]of t.entries())n||e.push(r);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let r=0,n=0,i=0;i<e.length;i++)e[i]=this.get(n,r),++r>=t&&(r=++n);return e}static fromCompact(t){const e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const n=new v(r);for(let i=0,l=0,a=0;a<e;a++)n.set(i,l,t[a]),++i>=r&&(i=++l);return n}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}}v.prototype.klassType="SymmetricMatrix";class x extends v{static isDistanceMatrix(t){return v.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new v(this)}clone(){const t=new x(this.diagonalSize);for(const[e,r,n]of this.upperRightEntries())e!==r&&t.set(e,r,n);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let r=1,n=0,i=0;i<e.length;i++)e[i]=this.get(n,r),++r>=t&&(r=1+ ++n);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const n=new this(r);for(let i=1,l=0,a=0;a<e;a++)n.set(i,l,t[a]),++i>=r&&(i=1+ ++l);return n}}x.prototype.klassSubType="DistanceMatrix";class A extends _{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class M extends A{constructor(t,e,r){h(t,e),c(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class B extends _{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class S extends _{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class k{constructor(t){let e,r,n,i,l,a,s,o,f,u=(t=S.checkMatrix(t)).clone(),h=u.rows,c=u.columns,p=new Float64Array(h),d=1;for(e=0;e<h;e++)p[e]=e;for(o=new Float64Array(h),r=0;r<c;r++){for(e=0;e<h;e++)o[e]=u.get(e,r);for(e=0;e<h;e++){for(f=Math.min(e,r),l=0,n=0;n<f;n++)l+=u.get(e,n)*o[n];o[e]-=l,u.set(e,r,o[e])}for(i=r,e=r+1;e<h;e++)Math.abs(o[e])>Math.abs(o[i])&&(i=e);if(i!==r){for(n=0;n<c;n++)a=u.get(i,n),u.set(i,n,u.get(r,n)),u.set(r,n,a);s=p[i],p[i]=p[r],p[r]=s,d=-d}if(r<h&&0!==u.get(r,r))for(e=r+1;e<h;e++)u.set(e,r,u.get(e,r)/u.get(r,r))}this.LU=u,this.pivotVector=p,this.pivotSign=d}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=y.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,i,l=t.columns,a=t.subMatrixRow(this.pivotVector,0,l-1),s=e.columns;for(i=0;i<s;i++)for(r=i+1;r<s;r++)for(n=0;n<l;n++)a.set(r,n,a.get(r,n)-a.get(i,n)*e.get(r,i));for(i=s-1;i>=0;i--){for(n=0;n<l;n++)a.set(i,n,a.get(i,n)/e.get(i,i));for(r=0;r<i;r++)for(n=0;n<l;n++)a.set(r,n,a.get(r,n)-a.get(i,n)*e.get(r,i))}return a}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new y(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?n.set(i,e,t.get(i,e)):i===e?n.set(i,e,1):n.set(i,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new y(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?n.set(i,e,t.get(i,e)):n.set(i,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function E(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class N{constructor(t){let e,r,n,i,l=(t=S.checkMatrix(t)).clone(),a=t.rows,s=t.columns,o=new Float64Array(s);for(n=0;n<s;n++){let t=0;for(e=n;e<a;e++)t=E(t,l.get(e,n));if(0!==t){for(l.get(n,n)<0&&(t=-t),e=n;e<a;e++)l.set(e,n,l.get(e,n)/t);for(l.set(n,n,l.get(n,n)+1),r=n+1;r<s;r++){for(i=0,e=n;e<a;e++)i+=l.get(e,n)*l.get(e,r);for(i=-i/l.get(n,n),e=n;e<a;e++)l.set(e,r,l.get(e,r)+i*l.get(e,n))}}o[n]=-t}this.QR=l,this.Rdiag=o}solve(t){t=y.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,i,l,a,s=t.columns,o=t.clone(),f=e.columns;for(l=0;l<f;l++)for(i=0;i<s;i++){for(a=0,n=l;n<r;n++)a+=e.get(n,l)*o.get(n,i);for(a=-a/e.get(l,l),n=l;n<r;n++)o.set(n,i,o.get(n,i)+a*e.get(n,l))}for(l=f-1;l>=0;l--){for(i=0;i<s;i++)o.set(l,i,o.get(l,i)/this.Rdiag[l]);for(n=0;n<l;n++)for(i=0;i<s;i++)o.set(n,i,o.get(n,i)-o.get(l,i)*e.get(n,l))}return o.subMatrix(0,f-1,0,s-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,i=new y(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,n,i=this.QR,l=i.rows,a=i.columns,s=new y(l,a);for(r=a-1;r>=0;r--){for(t=0;t<l;t++)s.set(t,r,0);for(s.set(r,r,1),e=r;e<a;e++)if(0!==i.get(r,r)){for(n=0,t=r;t<l;t++)n+=i.get(t,r)*s.get(t,e);for(n=-n/i.get(r,r),t=r;t<l;t++)s.set(t,e,s.get(t,e)+n*i.get(t,r))}}return s}}class C{constructor(t,e={}){if((t=S.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:l=!0,autoTranspose:a=!1}=e;let s,o=Boolean(i),f=Boolean(l),u=!1;if(r<n)if(a){s=t.transpose(),r=s.rows,n=s.columns,u=!0;let e=o;o=f,f=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let h=Math.min(r,n),c=Math.min(r+1,n),p=new Float64Array(c),d=new y(r,h),g=new y(n,n),m=new Float64Array(n),_=new Float64Array(r),b=new Float64Array(c);for(let t=0;t<c;t++)b[t]=t;let w=Math.min(r-1,n),v=Math.max(0,Math.min(n-2,r)),x=Math.max(w,v);for(let t=0;t<x;t++){if(t<w){p[t]=0;for(let e=t;e<r;e++)p[t]=E(p[t],s.get(e,t));if(0!==p[t]){s.get(t,t)<0&&(p[t]=-p[t]);for(let e=t;e<r;e++)s.set(e,t,s.get(e,t)/p[t]);s.set(t,t,s.get(t,t)+1)}p[t]=-p[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==p[t]){let n=0;for(let i=t;i<r;i++)n+=s.get(i,t)*s.get(i,e);n=-n/s.get(t,t);for(let i=t;i<r;i++)s.set(i,e,s.get(i,e)+n*s.get(i,t))}m[e]=s.get(t,e)}if(o&&t<w)for(let e=t;e<r;e++)d.set(e,t,s.get(e,t));if(t<v){m[t]=0;for(let e=t+1;e<n;e++)m[t]=E(m[t],m[e]);if(0!==m[t]){m[t+1]<0&&(m[t]=0-m[t]);for(let e=t+1;e<n;e++)m[e]/=m[t];m[t+1]+=1}if(m[t]=-m[t],t+1<r&&0!==m[t]){for(let e=t+1;e<r;e++)_[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)_[e]+=m[r]*s.get(e,r);for(let e=t+1;e<n;e++){let n=-m[e]/m[t+1];for(let i=t+1;i<r;i++)s.set(i,e,s.get(i,e)+n*_[i])}}if(f)for(let e=t+1;e<n;e++)g.set(e,t,m[e])}}let A=Math.min(n,r+1);if(w<n&&(p[w]=s.get(w,w)),r<A&&(p[A-1]=0),v+1<A&&(m[v]=s.get(v,A-1)),m[A-1]=0,o){for(let t=w;t<h;t++){for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==p[t]){for(let e=t+1;e<h;e++){let n=0;for(let i=t;i<r;i++)n+=d.get(i,t)*d.get(i,e);n=-n/d.get(t,t);for(let i=t;i<r;i++)d.set(i,e,d.get(i,e)+n*d.get(i,t))}for(let e=t;e<r;e++)d.set(e,t,-d.get(e,t));d.set(t,t,1+d.get(t,t));for(let e=0;e<t-1;e++)d.set(e,t,0)}else{for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}}if(f)for(let t=n-1;t>=0;t--){if(t<v&&0!==m[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=g.get(i,t)*g.get(i,e);r=-r/g.get(t+1,t);for(let i=t+1;i<n;i++)g.set(i,e,g.get(i,e)+r*g.get(i,t))}for(let e=0;e<n;e++)g.set(e,t,0);g.set(t,t,1)}let M=A-1,B=Number.EPSILON;for(;A>0;){let t,e;for(t=A-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+B*Math.abs(p[t]+Math.abs(p[t+1]));if(Math.abs(m[t])<=e||Number.isNaN(m[t])){m[t]=0;break}}if(t===A-2)e=4;else{let r;for(r=A-1;r>=t&&r!==t;r--){let e=(r!==A?Math.abs(m[r]):0)+(r!==t+1?Math.abs(m[r-1]):0);if(Math.abs(p[r])<=B*e){p[r]=0;break}}r===t?e=3:r===A-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=m[A-2];m[A-2]=0;for(let r=A-2;r>=t;r--){let i=E(p[r],e),l=p[r]/i,a=e/i;if(p[r]=i,r!==t&&(e=-a*m[r-1],m[r-1]=l*m[r-1]),f)for(let t=0;t<n;t++)i=l*g.get(t,r)+a*g.get(t,A-1),g.set(t,A-1,-a*g.get(t,r)+l*g.get(t,A-1)),g.set(t,r,i)}break}case 2:{let e=m[t-1];m[t-1]=0;for(let n=t;n<A;n++){let i=E(p[n],e),l=p[n]/i,a=e/i;if(p[n]=i,e=-a*m[n],m[n]=l*m[n],o)for(let e=0;e<r;e++)i=l*d.get(e,n)+a*d.get(e,t-1),d.set(e,t-1,-a*d.get(e,n)+l*d.get(e,t-1)),d.set(e,n,i)}break}case 3:{const e=Math.max(Math.abs(p[A-1]),Math.abs(p[A-2]),Math.abs(m[A-2]),Math.abs(p[t]),Math.abs(m[t])),i=p[A-1]/e,l=p[A-2]/e,a=m[A-2]/e,s=p[t]/e,u=m[t]/e,h=((l+i)*(l-i)+a*a)/2,c=i*a*(i*a);let _=0;0===h&&0===c||(_=h<0?0-Math.sqrt(h*h+c):Math.sqrt(h*h+c),_=c/(h+_));let b=(s+i)*(s-i)+_,w=s*u;for(let e=t;e<A-1;e++){let i=E(b,w);0===i&&(i=Number.MIN_VALUE);let l=b/i,a=w/i;if(e!==t&&(m[e-1]=i),b=l*p[e]+a*m[e],m[e]=l*m[e]-a*p[e],w=a*p[e+1],p[e+1]=l*p[e+1],f)for(let t=0;t<n;t++)i=l*g.get(t,e)+a*g.get(t,e+1),g.set(t,e+1,-a*g.get(t,e)+l*g.get(t,e+1)),g.set(t,e,i);if(i=E(b,w),0===i&&(i=Number.MIN_VALUE),l=b/i,a=w/i,p[e]=i,b=l*m[e]+a*p[e+1],p[e+1]=-a*m[e]+l*p[e+1],w=a*m[e+1],m[e+1]=l*m[e+1],o&&e<r-1)for(let t=0;t<r;t++)i=l*d.get(t,e)+a*d.get(t,e+1),d.set(t,e+1,-a*d.get(t,e)+l*d.get(t,e+1)),d.set(t,e,i)}m[A-2]=b;break}case 4:if(p[t]<=0&&(p[t]=p[t]<0?-p[t]:0,f))for(let e=0;e<=M;e++)g.set(e,t,-g.get(e,t));for(;t<M&&!(p[t]>=p[t+1]);){let e=p[t];if(p[t]=p[t+1],p[t+1]=e,f&&t<n-1)for(let r=0;r<n;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);if(o&&t<r-1)for(let n=0;n<r;n++)e=d.get(n,t+1),d.set(n,t+1,d.get(n,t)),d.set(n,t,e);t++}A--}}if(u){let t=g;g=d,d=t}this.m=r,this.n=n,this.s=p,this.U=d,this.V=g}solve(t){let e=t,r=this.threshold,n=this.s.length,i=y.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i.set(t,t,0):i.set(t,t,1/this.s[t]);let l=this.U,a=this.rightSingularVectors,s=a.mmul(i),o=a.rows,f=l.rows,u=y.zeros(o,f);for(let t=0;t<o;t++)for(let e=0;e<f;e++){let r=0;for(let i=0;i<n;i++)r+=s.get(t,i)*l.get(e,i);u.set(t,e,r)}return u.mmul(e)}solveForDiagonal(t){return this.solve(y.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new y(r,this.s.length);for(let l=0;l<r;l++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(l,r,t.get(l,r)/this.s[r]);let l=this.U,a=l.rows,s=l.columns,o=new y(r,a);for(let t=0;t<r;t++)for(let e=0;e<a;e++){let r=0;for(let n=0;n<s;n++)r+=i.get(t,n)*l.get(e,n);o.set(t,e,r)}return o}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return y.diag(this.s)}}function R(t,e,r=!1){return t=S.checkMatrix(t),e=S.checkMatrix(e),r?new C(t).solve(e):t.isSquare()?new k(t).solve(e):new N(t).solve(e)}function z(t,e){let r=[];for(let n=0;n<t;n++)n!==e&&r.push(n);return r}function I(t,e,r,n=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}class P{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=S.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,i,l=t.columns,a=new y(l,l),s=new Float64Array(l),o=new Float64Array(l),f=t,u=!1;if(u=!!r||t.isSymmetric(),u){for(n=0;n<l;n++)for(i=0;i<l;i++)a.set(n,i,f.get(n,i));!function(t,e,r,n){let i,l,a,s,o,f,u,h;for(o=0;o<t;o++)r[o]=n.get(t-1,o);for(s=t-1;s>0;s--){for(h=0,a=0,f=0;f<s;f++)h+=Math.abs(r[f]);if(0===h)for(e[s]=r[s-1],o=0;o<s;o++)r[o]=n.get(s-1,o),n.set(s,o,0),n.set(o,s,0);else{for(f=0;f<s;f++)r[f]/=h,a+=r[f]*r[f];for(i=r[s-1],l=Math.sqrt(a),i>0&&(l=-l),e[s]=h*l,a-=i*l,r[s-1]=i-l,o=0;o<s;o++)e[o]=0;for(o=0;o<s;o++){for(i=r[o],n.set(o,s,i),l=e[o]+n.get(o,o)*i,f=o+1;f<=s-1;f++)l+=n.get(f,o)*r[f],e[f]+=n.get(f,o)*i;e[o]=l}for(i=0,o=0;o<s;o++)e[o]/=a,i+=e[o]*r[o];for(u=i/(a+a),o=0;o<s;o++)e[o]-=u*r[o];for(o=0;o<s;o++){for(i=r[o],l=e[o],f=o;f<=s-1;f++)n.set(f,o,n.get(f,o)-(i*e[f]+l*r[f]));r[o]=n.get(s-1,o),n.set(s,o,0)}}r[s]=a}for(s=0;s<t-1;s++){if(n.set(t-1,s,n.get(s,s)),n.set(s,s,1),a=r[s+1],0!==a){for(f=0;f<=s;f++)r[f]=n.get(f,s+1)/a;for(o=0;o<=s;o++){for(l=0,f=0;f<=s;f++)l+=n.get(f,s+1)*n.get(f,o);for(f=0;f<=s;f++)n.set(f,o,n.get(f,o)-l*r[f])}}for(f=0;f<=s;f++)n.set(f,s+1,0)}for(o=0;o<t;o++)r[o]=n.get(t-1,o),n.set(t-1,o,0);n.set(t-1,t-1,1),e[0]=0}(l,o,s,a),function(t,e,r,n){let i,l,a,s,o,f,u,h,c,p,d,g,m,_,b,w;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;let y=0,v=0,x=Number.EPSILON;for(f=0;f<t;f++){for(v=Math.max(v,Math.abs(r[f])+Math.abs(e[f])),u=f;u<t&&!(Math.abs(e[u])<=x*v);)u++;if(u>f)do{for(i=r[f],h=(r[f+1]-i)/(2*e[f]),c=E(h,1),h<0&&(c=-c),r[f]=e[f]/(h+c),r[f+1]=e[f]*(h+c),p=r[f+1],l=i-r[f],a=f+2;a<t;a++)r[a]-=l;for(y+=l,h=r[u],d=1,g=d,m=d,_=e[f+1],b=0,w=0,a=u-1;a>=f;a--)for(m=g,g=d,w=b,i=d*e[a],l=d*h,c=E(h,e[a]),e[a+1]=b*c,b=e[a]/c,d=h/c,h=d*r[a]-b*i,r[a+1]=l+b*(d*i+b*r[a]),o=0;o<t;o++)l=n.get(o,a+1),n.set(o,a+1,b*n.get(o,a)+d*l),n.set(o,a,d*n.get(o,a)-b*l);h=-b*w*m*_*e[f]/p,e[f]=b*h,r[f]=d*h}while(Math.abs(e[f])>x*v);r[f]=r[f]+y,e[f]=0}for(a=0;a<t-1;a++){for(o=a,h=r[a],s=a+1;s<t;s++)r[s]<h&&(o=s,h=r[s]);if(o!==a)for(r[o]=r[a],r[a]=h,s=0;s<t;s++)h=n.get(s,a),n.set(s,a,n.get(s,o)),n.set(s,o,h)}}(l,o,s,a)}else{let t=new y(l,l),e=new Float64Array(l);for(i=0;i<l;i++)for(n=0;n<l;n++)t.set(n,i,f.get(n,i));!function(t,e,r,n){let i,l,a,s,o,f,u,h=0,c=t-1;for(f=h+1;f<=c-1;f++){for(u=0,s=f;s<=c;s++)u+=Math.abs(e.get(s,f-1));if(0!==u){for(a=0,s=c;s>=f;s--)r[s]=e.get(s,f-1)/u,a+=r[s]*r[s];for(l=Math.sqrt(a),r[f]>0&&(l=-l),a-=r[f]*l,r[f]=r[f]-l,o=f;o<t;o++){for(i=0,s=c;s>=f;s--)i+=r[s]*e.get(s,o);for(i/=a,s=f;s<=c;s++)e.set(s,o,e.get(s,o)-i*r[s])}for(s=0;s<=c;s++){for(i=0,o=c;o>=f;o--)i+=r[o]*e.get(s,o);for(i/=a,o=f;o<=c;o++)e.set(s,o,e.get(s,o)-i*r[o])}r[f]=u*r[f],e.set(f,f-1,u*l)}}for(s=0;s<t;s++)for(o=0;o<t;o++)n.set(s,o,s===o?1:0);for(f=c-1;f>=h+1;f--)if(0!==e.get(f,f-1)){for(s=f+1;s<=c;s++)r[s]=e.get(s,f-1);for(o=f;o<=c;o++){for(l=0,s=f;s<=c;s++)l+=r[s]*n.get(s,o);for(l=l/r[f]/e.get(f,f-1),s=f;s<=c;s++)n.set(s,o,n.get(s,o)+l*r[s])}}}(l,t,e,a),function(t,e,r,n,i){let l,a,s,o,f,u,h,c,p,d,g,m,_,b,w,y=t-1,v=0,x=t-1,A=Number.EPSILON,M=0,B=0,S=0,k=0,E=0,N=0,C=0,R=0;for(l=0;l<t;l++)for((l<v||l>x)&&(r[l]=i.get(l,l),e[l]=0),a=Math.max(l-1,0);a<t;a++)B+=Math.abs(i.get(l,a));for(;y>=v;){for(o=y;o>v&&(N=Math.abs(i.get(o-1,o-1))+Math.abs(i.get(o,o)),0===N&&(N=B),!(Math.abs(i.get(o,o-1))<A*N));)o--;if(o===y)i.set(y,y,i.get(y,y)+M),r[y]=i.get(y,y),e[y]=0,y--,R=0;else if(o===y-1){if(h=i.get(y,y-1)*i.get(y-1,y),S=(i.get(y-1,y-1)-i.get(y,y))/2,k=S*S+h,C=Math.sqrt(Math.abs(k)),i.set(y,y,i.get(y,y)+M),i.set(y-1,y-1,i.get(y-1,y-1)+M),c=i.get(y,y),k>=0){for(C=S>=0?S+C:S-C,r[y-1]=c+C,r[y]=r[y-1],0!==C&&(r[y]=c-h/C),e[y-1]=0,e[y]=0,c=i.get(y,y-1),N=Math.abs(c)+Math.abs(C),S=c/N,k=C/N,E=Math.sqrt(S*S+k*k),S/=E,k/=E,a=y-1;a<t;a++)C=i.get(y-1,a),i.set(y-1,a,k*C+S*i.get(y,a)),i.set(y,a,k*i.get(y,a)-S*C);for(l=0;l<=y;l++)C=i.get(l,y-1),i.set(l,y-1,k*C+S*i.get(l,y)),i.set(l,y,k*i.get(l,y)-S*C);for(l=v;l<=x;l++)C=n.get(l,y-1),n.set(l,y-1,k*C+S*n.get(l,y)),n.set(l,y,k*n.get(l,y)-S*C)}else r[y-1]=c+S,r[y]=c+S,e[y-1]=C,e[y]=-C;y-=2,R=0}else{if(c=i.get(y,y),p=0,h=0,o<y&&(p=i.get(y-1,y-1),h=i.get(y,y-1)*i.get(y-1,y)),10===R){for(M+=c,l=v;l<=y;l++)i.set(l,l,i.get(l,l)-c);N=Math.abs(i.get(y,y-1))+Math.abs(i.get(y-1,y-2)),c=p=.75*N,h=-.4375*N*N}if(30===R&&(N=(p-c)/2,N=N*N+h,N>0)){for(N=Math.sqrt(N),p<c&&(N=-N),N=c-h/((p-c)/2+N),l=v;l<=y;l++)i.set(l,l,i.get(l,l)-N);M+=N,c=p=h=.964}for(R+=1,f=y-2;f>=o&&(C=i.get(f,f),E=c-C,N=p-C,S=(E*N-h)/i.get(f+1,f)+i.get(f,f+1),k=i.get(f+1,f+1)-C-E-N,E=i.get(f+2,f+1),N=Math.abs(S)+Math.abs(k)+Math.abs(E),S/=N,k/=N,E/=N,f!==o)&&!(Math.abs(i.get(f,f-1))*(Math.abs(k)+Math.abs(E))<A*(Math.abs(S)*(Math.abs(i.get(f-1,f-1))+Math.abs(C)+Math.abs(i.get(f+1,f+1)))));)f--;for(l=f+2;l<=y;l++)i.set(l,l-2,0),l>f+2&&i.set(l,l-3,0);for(s=f;s<=y-1&&(b=s!==y-1,s!==f&&(S=i.get(s,s-1),k=i.get(s+1,s-1),E=b?i.get(s+2,s-1):0,c=Math.abs(S)+Math.abs(k)+Math.abs(E),0!==c&&(S/=c,k/=c,E/=c)),0!==c);s++)if(N=Math.sqrt(S*S+k*k+E*E),S<0&&(N=-N),0!==N){for(s!==f?i.set(s,s-1,-N*c):o!==f&&i.set(s,s-1,-i.get(s,s-1)),S+=N,c=S/N,p=k/N,C=E/N,k/=S,E/=S,a=s;a<t;a++)S=i.get(s,a)+k*i.get(s+1,a),b&&(S+=E*i.get(s+2,a),i.set(s+2,a,i.get(s+2,a)-S*C)),i.set(s,a,i.get(s,a)-S*c),i.set(s+1,a,i.get(s+1,a)-S*p);for(l=0;l<=Math.min(y,s+3);l++)S=c*i.get(l,s)+p*i.get(l,s+1),b&&(S+=C*i.get(l,s+2),i.set(l,s+2,i.get(l,s+2)-S*E)),i.set(l,s,i.get(l,s)-S),i.set(l,s+1,i.get(l,s+1)-S*k);for(l=v;l<=x;l++)S=c*n.get(l,s)+p*n.get(l,s+1),b&&(S+=C*n.get(l,s+2),n.set(l,s+2,n.get(l,s+2)-S*E)),n.set(l,s,n.get(l,s)-S),n.set(l,s+1,n.get(l,s+1)-S*k)}}}if(0===B)return;for(y=t-1;y>=0;y--)if(S=r[y],k=e[y],0===k)for(o=y,i.set(y,y,1),l=y-1;l>=0;l--){for(h=i.get(l,l)-S,E=0,a=o;a<=y;a++)E+=i.get(l,a)*i.get(a,y);if(e[l]<0)C=h,N=E;else if(o=l,0===e[l]?i.set(l,y,0!==h?-E/h:-E/(A*B)):(c=i.get(l,l+1),p=i.get(l+1,l),k=(r[l]-S)*(r[l]-S)+e[l]*e[l],u=(c*N-C*E)/k,i.set(l,y,u),i.set(l+1,y,Math.abs(c)>Math.abs(C)?(-E-h*u)/c:(-N-p*u)/C)),u=Math.abs(i.get(l,y)),A*u*u>1)for(a=l;a<=y;a++)i.set(a,y,i.get(a,y)/u)}else if(k<0)for(o=y-1,Math.abs(i.get(y,y-1))>Math.abs(i.get(y-1,y))?(i.set(y-1,y-1,k/i.get(y,y-1)),i.set(y-1,y,-(i.get(y,y)-S)/i.get(y,y-1))):(w=O(0,-i.get(y-1,y),i.get(y-1,y-1)-S,k),i.set(y-1,y-1,w[0]),i.set(y-1,y,w[1])),i.set(y,y-1,0),i.set(y,y,1),l=y-2;l>=0;l--){for(d=0,g=0,a=o;a<=y;a++)d+=i.get(l,a)*i.get(a,y-1),g+=i.get(l,a)*i.get(a,y);if(h=i.get(l,l)-S,e[l]<0)C=h,E=d,N=g;else if(o=l,0===e[l]?(w=O(-d,-g,h,k),i.set(l,y-1,w[0]),i.set(l,y,w[1])):(c=i.get(l,l+1),p=i.get(l+1,l),m=(r[l]-S)*(r[l]-S)+e[l]*e[l]-k*k,_=2*(r[l]-S)*k,0===m&&0===_&&(m=A*B*(Math.abs(h)+Math.abs(k)+Math.abs(c)+Math.abs(p)+Math.abs(C))),w=O(c*E-C*d+k*g,c*N-C*g-k*d,m,_),i.set(l,y-1,w[0]),i.set(l,y,w[1]),Math.abs(c)>Math.abs(C)+Math.abs(k)?(i.set(l+1,y-1,(-d-h*i.get(l,y-1)+k*i.get(l,y))/c),i.set(l+1,y,(-g-h*i.get(l,y)-k*i.get(l,y-1))/c)):(w=O(-E-p*i.get(l,y-1),-N-p*i.get(l,y),C,k),i.set(l+1,y-1,w[0]),i.set(l+1,y,w[1]))),u=Math.max(Math.abs(i.get(l,y-1)),Math.abs(i.get(l,y))),A*u*u>1)for(a=l;a<=y;a++)i.set(a,y-1,i.get(a,y-1)/u),i.set(a,y,i.get(a,y)/u)}for(l=0;l<t;l++)if(l<v||l>x)for(a=l;a<t;a++)n.set(l,a,i.get(l,a));for(a=t-1;a>=v;a--)for(l=v;l<=x;l++){for(C=0,s=v;s<=Math.min(a,x);s++)C+=n.get(l,s)*i.get(s,a);n.set(l,a,C)}}(l,o,s,a,t)}this.n=l,this.e=o,this.d=s,this.V=a}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,n=this.e,i=this.d,l=new y(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)l.set(t,e,0);l.set(t,t,i[t]),n[t]>0?l.set(t,t+1,n[t]):n[t]<0&&l.set(t,t-1,n[t])}return l}}function O(t,e,r,n){let i,l;return Math.abs(r)>Math.abs(n)?(i=n/r,l=r+i*n,[(t+i*e)/l,(e-i*t)/l]):(i=r/n,l=n+i*r,[(i*t+e)/l,(i*e-t)/l])}class j{constructor(t){if(!(t=S.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,r,n,i=t,l=i.rows,a=new y(l,l),s=!0;for(r=0;r<l;r++){let t=0;for(n=0;n<r;n++){let l=0;for(e=0;e<n;e++)l+=a.get(n,e)*a.get(r,e);l=(i.get(r,n)-l)/a.get(n,n),a.set(r,n,l),t+=l*l}for(t=i.get(r,r)-t,s&&=t>0,a.set(r,r,Math.sqrt(Math.max(t,0))),n=r+1;n<l;n++)a.set(r,n,0)}this.L=a,this.positiveDefinite=s}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=S.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,i,l,a=t.columns,s=t.clone();for(l=0;l<r;l++)for(i=0;i<a;i++){for(n=0;n<l;n++)s.set(l,i,s.get(l,i)-s.get(n,i)*e.get(l,n));s.set(l,i,s.get(l,i)/e.get(l,l))}for(l=r-1;l>=0;l--)for(i=0;i<a;i++){for(n=l+1;n<r;n++)s.set(l,i,s.get(l,i)-s.get(n,i)*e.get(n,l));s.set(l,i,s.get(l,i)/e.get(l,l))}return s}get lowerTriangularMatrix(){return this.L}}class T{constructor(e,r={}){e=S.checkMatrix(e);let{Y:n}=r;const{scaleScores:i=!1,maxIterations:l=1e3,terminationCriteria:a=1e-10}=r;let s;if(n){if(n=t.isAnyArray(n)&&"number"==typeof n[0]?y.columnVector(n):S.checkMatrix(n),n.rows!==e.rows)throw new Error("Y should have the same number of rows as X");s=n.getColumnVector(0)}else s=e.getColumnVector(0);let o,f,u,h,c=1;for(let t=0;t<l&&c>a;t++)u=e.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),u=u.div(u.norm()),o=e.mmul(u).div(u.transpose().mmul(u).get(0,0)),t>0&&(c=o.clone().sub(h).pow(2).sum()),h=o.clone(),n?(f=n.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0)),f=f.div(f.norm()),s=n.mmul(f).div(f.transpose().mmul(f).get(0,0))):s=o;if(n){let t=e.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0));t=t.div(t.norm());let r=e.clone().sub(o.clone().mmul(t.transpose())),i=s.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0)),l=n.clone().sub(o.clone().mulS(i.get(0,0)).mmul(f.transpose()));this.t=o,this.p=t.transpose(),this.w=u.transpose(),this.q=f,this.u=s,this.s=o.transpose().mmul(o),this.xResidual=r,this.yResidual=l,this.betas=i}else this.w=u.transpose(),this.s=o.transpose().mmul(o).sqrt(),this.t=i?o.clone().div(this.s.get(0,0)):o,this.xResidual=e.sub(o.mmul(u.transpose()))}}return al.AbstractMatrix=_,al.CHO=j,al.CholeskyDecomposition=j,al.DistanceMatrix=x,al.EVD=P,al.EigenvalueDecomposition=P,al.LU=k,al.LuDecomposition=k,al.Matrix=y,al.MatrixColumnSelectionView=class extends A{constructor(t,e){c(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},al.MatrixColumnView=class extends A{constructor(t,e){o(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},al.MatrixFlipColumnView=class extends A{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},al.MatrixFlipRowView=class extends A{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},al.MatrixRowSelectionView=class extends A{constructor(t,e){h(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},al.MatrixRowView=class extends A{constructor(t,e){s(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},al.MatrixSelectionView=M,al.MatrixSubView=class extends A{constructor(t,e,r,n,i){p(t,e,r,n,i),super(t,r-e+1,i-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},al.MatrixTransposeView=class extends A{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},al.NIPALS=T,al.Nipals=T,al.QR=N,al.QrDecomposition=N,al.SVD=C,al.SingularValueDecomposition=C,al.SymmetricMatrix=v,al.WrapperMatrix1D=B,al.WrapperMatrix2D=S,al.correlation=function(e,r=e,n={}){e=new y(e);let i=!1;if("object"!=typeof r||y.isMatrix(r)||t.isAnyArray(r)?r=new y(r):(n=r,r=e,i=!0),e.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:l=!0,scale:a=!0}=n;l&&(e.center("column"),i||r.center("column")),a&&(e.scale("column"),i||r.scale("column"));const s=e.standardDeviation("column",{unbiased:!0}),o=i?s:r.standardDeviation("column",{unbiased:!0}),f=e.transpose().mmul(r);for(let t=0;t<f.rows;t++)for(let r=0;r<f.columns;r++)f.set(t,r,f.get(t,r)*(1/(s[t]*o[r]))*(1/(e.rows-1)));return f},al.covariance=function(e,r=e,n={}){e=new y(e);let i=!1;if("object"!=typeof r||y.isMatrix(r)||t.isAnyArray(r)?r=new y(r):(n=r,r=e,i=!0),e.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:l=!0}=n;l&&(e=e.center("column"),i||(r=r.center("column")));const a=e.transpose().mmul(r);for(let t=0;t<a.rows;t++)for(let r=0;r<a.columns;r++)a.set(t,r,a.get(t,r)*(1/(e.rows-1)));return a},al.default=y,al.determinant=function t(e){if((e=y.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let r,n,i,l;if(2===e.columns)return r=e.get(0,0),n=e.get(0,1),i=e.get(1,0),l=e.get(1,1),r*l-n*i;if(3===e.columns){let l,a,s;return l=new M(e,[1,2],[1,2]),a=new M(e,[1,2],[0,2]),s=new M(e,[1,2],[0,1]),r=e.get(0,0),n=e.get(0,1),i=e.get(0,2),r*t(l)-n*t(a)+i*t(s)}return new k(e).determinant}throw Error("determinant can only be calculated for a square matrix")},al.inverse=function(t,e=!1){return t=S.checkMatrix(t),e?new C(t).inverse():R(t,y.eye(t.rows))},al.linearDependencies=function(t,e={}){const{thresholdValue:r=1e-9,thresholdError:n=1e-9}=e;let i=(t=y.checkMatrix(t)).rows,l=new y(i,i);for(let e=0;e<i;e++){let a=y.columnVector(t.getRow(e)),s=t.subMatrixRow(z(i,e)).transpose(),o=new C(s).solve(a),f=y.sub(a,s.mmul(o)).abs().max();l.setRow(e,I(f,o,e,r,n))}return l},al.pseudoInverse=function(t,e=Number.EPSILON){if((t=y.checkMatrix(t)).isEmpty())return t.transpose();let r=new C(t,{autoTranspose:!0}),n=r.leftSingularVectors,i=r.rightSingularVectors,l=r.diagonal;for(let t=0;t<l.length;t++)Math.abs(l[t])>e?l[t]=1/l[t]:l[t]=0;return i.mmul(y.diag(l).mmul(n.transpose()))},al.solve=R,al.wrap=function(e,r){if(t.isAnyArray(e))return e[0]&&t.isAnyArray(e[0])?new S(e):new B(e,r);throw new Error("the argument is not an array")},al}var pl=cl(),dl=il(pl);const gl=pl.EVD,ml=pl.Matrix,_l=pl.MatrixTransposeView,bl=pl.NIPALS,wl=pl.SVD;dl.Matrix?dl.Matrix:pl.Matrix;const yl=pl.inverse;var vl,xl,Al,Ml={exports:{}},Bl=Ml.exports;function Sl(){return vl||(vl=1,t=Ml,function(){var e,r,n,i,l,a,s,o,f,u,h,c,p,d,g;n=Math.floor,u=Math.min,r=function(t,e){return t<e?-1:t>e?1:0},f=function(t,e,i,l,a){var s;if(null==i&&(i=0),null==a&&(a=r),i<0)throw new Error("lo must be non-negative");for(null==l&&(l=t.length);i<l;)a(e,t[s=n((i+l)/2)])<0?l=s:i=s+1;return[].splice.apply(t,[i,i-i].concat(e)),e},a=function(t,e,n){return null==n&&(n=r),t.push(e),d(t,0,t.length-1,n)},l=function(t,e){var n,i;return null==e&&(e=r),n=t.pop(),t.length?(i=t[0],t[0]=n,g(t,0,e)):i=n,i},o=function(t,e,n){var i;return null==n&&(n=r),i=t[0],t[0]=e,g(t,0,n),i},s=function(t,e,n){var i;return null==n&&(n=r),t.length&&n(t[0],e)<0&&(e=(i=[t[0],e])[0],t[0]=i[1],g(t,0,n)),e},i=function(t,e){var i,l,a,s,o,f;for(null==e&&(e=r),o=[],l=0,a=(s=function(){f=[];for(var e=0,r=n(t.length/2);0<=r?e<r:e>r;0<=r?e++:e--)f.push(e);return f}.apply(this).reverse()).length;l<a;l++)i=s[l],o.push(g(t,i,e));return o},p=function(t,e,n){var i;if(null==n&&(n=r),-1!==(i=t.indexOf(e)))return d(t,0,i,n),g(t,i,n)},h=function(t,e,n){var l,a,o,f,u;if(null==n&&(n=r),!(a=t.slice(0,e)).length)return a;for(i(a,n),o=0,f=(u=t.slice(e)).length;o<f;o++)l=u[o],s(a,l,n);return a.sort(n).reverse()},c=function(t,e,n){var a,s,o,h,c,p,d,g,m;if(null==n&&(n=r),10*e<=t.length){if(!(o=t.slice(0,e).sort(n)).length)return o;for(s=o[o.length-1],h=0,p=(d=t.slice(e)).length;h<p;h++)n(a=d[h],s)<0&&(f(o,a,0,null,n),o.pop(),s=o[o.length-1]);return o}for(i(t,n),m=[],c=0,g=u(e,t.length);0<=g?c<g:c>g;0<=g?++c:--c)m.push(l(t,n));return m},d=function(t,e,n,i){var l,a,s;for(null==i&&(i=r),l=t[n];n>e&&i(l,a=t[s=n-1>>1])<0;)t[n]=a,n=s;return t[n]=l},g=function(t,e,n){var i,l,a,s,o;for(null==n&&(n=r),l=t.length,o=e,a=t[e],i=2*e+1;i<l;)(s=i+1)<l&&!(n(t[i],t[s])<0)&&(i=s),t[e]=t[i],i=2*(e=i)+1;return t[e]=a,d(t,o,e,n)},e=function(){function t(t){this.cmp=null!=t?t:r,this.nodes=[]}return t.push=a,t.pop=l,t.replace=o,t.pushpop=s,t.heapify=i,t.updateItem=p,t.nlargest=h,t.nsmallest=c,t.prototype.push=function(t){return a(this.nodes,t,this.cmp)},t.prototype.pop=function(){return l(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return o(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return s(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return i(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return p(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),t.exports=e}.call(Bl)),Ml.exports;var t}var kl=il(Al?xl:(Al=1,xl=Sl()));class El{constructor(){this.children=[],this.height=0,this.size=1,this.index=-1,this.isLeaf=!1}cut(t){if("number"!=typeof t)throw new TypeError("threshold must be a number");if(t<0)throw new RangeError("threshold must be a positive number");let e=[this];const r=[];for(;e.length>0;){const n=e.shift();t>=n.height?r.push(n):e=e.concat(n.children)}return r}group(t){if(!Number.isInteger(t)||t<1)throw new RangeError("groups must be a positive integer");const e=new kl((t,e)=>e.height-t.height);for(e.push(this);e.size()<t;){const t=e.pop();if(0===t.children.length)break;t.children.forEach(t=>e.push(t))}const r=new El;return r.children=e.toArray(),r.height=this.height,r}traverse(t){!function t(e,r){if(r(e),e.children)for(const n of e.children)t(n,r)}(this,t)}indices(){const t=[];return this.traverse(e=>{e.isLeaf&&t.push(e.index)}),t}}function Nl(t,e){return Math.min(t,e)}function Cl(t,e){return Math.max(t,e)}function Rl(t,e,r,n,i){return n/(n+i)*t+i/(n+i)*e}function zl(t,e){return(t+e)/2}function Il(t,e,r,n,i){return n/(n+i)*t+i/(n+i)*e+-n*i/(n+i)**2*r}function Pl(t,e,r){return t/2+e/2-r/4}function Ol(t,e,r,n,i,l){return(n+l)/(n+i+l)*t+(i+l)/(n+i+l)*e+-l/(n+i+l)*r}function jl(t,e,r,n,i,l){const a=(n+l)/(n+i+l),s=(i+l)/(n+i+l),o=-l/(n+i+l);return Math.sqrt(a*t*t+s*e*e+o*r*r)}function Tl(t,e={}){const{distanceFunction:r=rl,method:n="complete",isDistanceMatrix:i=!1}=e;let l;i||(t=nl(t,r));let a=new ml(t);const s=a.rows;if("string"==typeof n)switch(n.toLowerCase()){case"single":l=Nl;break;case"complete":l=Cl;break;case"average":case"upgma":l=Rl;break;case"wpgma":l=zl;break;case"centroid":case"upgmc":l=Il;break;case"median":case"wpgmc":l=Pl;break;case"ward":l=Ol;break;case"ward2":l=jl;break;default:throw new RangeError(`unknown clustering method: ${n}`)}else if("function"!=typeof n)throw new TypeError("method must be a string or function");let o=[];for(let t=0;t<s;t++){const e=new El;e.isLeaf=!0,e.index=t,o.push(e)}for(let t=0;t<s-1;t++){const[t,e,r]=$l(a),n=o[t],i=o[e],s=new El;s.size=n.size+i.size,s.children.push(n,i),s.height=r;const f=[s],u=new ml(a.rows-1,a.rows-1),h=r=>Dl(r,Math.min(t,e),Math.max(t,e));for(let s=1;s<u.rows;s++){const c=h(s),p=o[c];f.push(p);for(let o=0;o<s;o++)if(0===o){const f=l(a.get(t,c),a.get(c,e),r,n.size,i.size,p.size);u.set(s,o,f),u.set(o,s,f)}else{const t=a.get(c,h(o));u.set(s,o,t),u.set(o,s,t)}}o=f,a=u}return o[0]}function $l(t){let e=1/0,r=0,n=0;for(let i=1;i<t.rows;i++)for(let l=0;l<i;l++)t.get(i,l)<e&&(e=t.get(i,l),r=i,n=l);return[r,n,e]}function Dl(t,e,r){return(t-=1)>=e&&t++,t>=r&&t++,t}var Vl,Fl=Object.freeze({__proto__:null,additiveSymmetric:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])*(t[n]+e[n])/(t[n]*e[n]);return r},avg:function(t,e){let r=0,n=0,i=0;for(let l=0;l<t.length;l++)i=Math.abs(t[l]-e[l]),n+=i,r<i&&(r=i);return(r+n)/2},bhattacharyya:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return-Math.log(r)},canberra:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.abs(t[n]-e[n])/(t[n]+e[n]);return r},chebyshev:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)n=Math.abs(t[i]-e[i]),r<n&&(r=n);return r},clark:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(Math.abs(t[n]-e[n])/(t[n]+e[n]))**2;return Math.sqrt(r)},czekanowski:function(t,e){return 1-function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.min(t[i],e[i]),n+=t[i]+e[i];return 2*r/n}(t,e)},dice:function(t,e){let r=0,n=0,i=0;for(let l=0;l<t.length;l++)r+=t[l]*t[l],n+=e[l]*e[l],i+=(t[l]-e[l])*(t[l]-e[l]);return i/(r+n)},divergence:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/((t[n]+e[n])*(t[n]+e[n]));return 2*r},euclidean:rl,fidelity:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return r},gower:function(t,e){const r=t.length;let n=0;for(let r=0;r<t.length;r++)n+=Math.abs(t[r]-e[r]);return n/r},harmonicMean:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*e[n]/(t[n]+e[n]);return 2*r},hellinger:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return 2*Math.sqrt(1-r)},innerProduct:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*e[n];return r},intersection:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.min(t[n],e[n]);return 1-r},jaccard:function(t,e){return 1-function(t,e){let r=0,n=0,i=0;for(let l=0;l<t.length;l++)r+=t[l]*e[l],n+=t[l]*t[l],i+=e[l]*e[l];return r/(n+i-r)}(t,e)},jeffreys:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*Math.log(t[n]/e[n]);return r},jensenDifference:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]*Math.log(t[n])+e[n]*Math.log(e[n]))/2-(t[n]+e[n])/2*Math.log((t[n]+e[n])/2);return r},jensenShannon:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=t[i]*Math.log(2*t[i]/(t[i]+e[i])),n+=e[i]*Math.log(2*e[i]/(t[i]+e[i]));return(r+n)/2},kdivergence:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*Math.log(2*t[n]/(t[n]+e[n]));return r},kulczynski:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i]),n+=Math.min(t[i],e[i]);return r/n},kullbackLeibler:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*Math.log(t[n]/e[n]);return r},kumarJohnson:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]*t[n]-e[n]*e[n])**2/(2*(t[n]*e[n])**1.5);return r},lorentzian:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.log(Math.abs(t[n]-e[n])+1);return r},manhattan:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.abs(t[n]-e[n]);return r},matusita:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return Math.sqrt(2-2*r)},minkowski:function(t,e,r){let n=0;for(let i=0;i<t.length;i++)n+=Math.abs(t[i]-e[i])**r;return n**(1/r)},motyka:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.min(t[i],e[i]),n+=t[i]+e[i];return 1-r/n},neyman:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/t[n];return r},pearson:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/e[n];return r},probabilisticSymmetric:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/(t[n]+e[n]);return 2*r},ruzicka:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.min(t[i],e[i]),n+=Math.max(t[i],e[i]);return r/n},soergel:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i]),n+=Math.max(t[i],e[i]);return r/n},sorensen:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i]),n+=t[i]+e[i];return r/n},squared:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/(t[n]+e[n]);return r},squaredChord:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(Math.sqrt(t[n])-Math.sqrt(e[n]))**2;return r},squaredEuclidean:el,taneja:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]+e[n])/2*Math.log((t[n]+e[n])/(2*Math.sqrt(t[n]*e[n])));return r},tanimoto:function(t,e,r){if(r)return 1-function(t,e,r){if(r){let r=0,n=0;for(let i=0;i<t.length;i++)r+=t[i]&&e[i],n+=t[i]||e[i];return 0===n?1:r/n}{let r=0,n=0,i=0;for(let l=0;l<t.length;l++)r+=t[l],n+=e[l],i+=Math.min(t[l],e[l]);return 1-(r+n-2*i)/(r+n-i)}}(t,e,r);{let r=0,n=0,i=0;for(let l=0;l<t.length;l++)r+=t[l],n+=e[l],i+=Math.min(t[l],e[l]);return(r+n-2*i)/(r+n-i)}},topsoe:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*Math.log(2*t[n]/(t[n]+e[n]))+e[n]*Math.log(2*e[n]/(t[n]+e[n]));return r},waveHedges:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=1-Math.min(t[n],e[n])/Math.max(t[n],e[n]);return r}}),Ll={};!function(){if(Vl)return Ll;function t(t){if("number"!=typeof t)throw new TypeError("Expected a number")}Vl=1,Ll.ascending=(e,r)=>(t(e),t(r),Number.isNaN(e)?-1:Number.isNaN(r)?1:e-r),Ll.descending=(e,r)=>(t(e),t(r),Number.isNaN(e)?1:Number.isNaN(r)?-1:r-e)}();const ql=async function(t){const e=t.split(/\r?\n/),r=e[0].split(","),n=[];n.headers=r;for(let t=1;t<e.length-1;t++){const i={},l=e[t].split(",");for(let t=0;t<r.length;t++)i[r[t]]=Ul(l[t]);n.push(i)}return n},Ul=function(t){return isNaN(t)?t:Number(t)},Hl=function(t){return t.filter(t=>"number"==typeof t)},Yl=function(t){return t.filter(t=>"number"!=typeof t)},Xl=function(t){return t.map(t=>{const e={};for(const r in t)"number"==typeof t[r]&&(e[r]=t[r]);return e})},Gl=function(t){return t.map(t=>{const e={};for(const r in t)"number"!=typeof t[r]&&(e[r]=t[r]);return e})},Wl=function(t){if(null==t)throw new Error("No data passed to function.");if(!Array.isArray(t)||"object"!=typeof t[0]||null===t[0])throw new Error("First argument must be an array of objects");const e=t;if(!t.columns){const t=new Set;for(const r of e)for(const e of Object.keys(r))t.add(e);e.columns=[...t]}return e.columns.forEach(t=>{Object.getOwnPropertyDescriptor(e,t)||Object.defineProperty(e,t,{get:function(){return this.map(e=>e[t])},set:function(e){if(!e)throw new Error(`No data passed to set ${t} column.`);if(e.length!==this.length)throw new Error(`Data length (${e.length}) different from column ${t} length (${this.length}).`);this.forEach((r,n)=>r[t]=e[n])}})}),e},Kl=async function(t){const e=await Promise.resolve().then(function(){return qn}),r=JSON.parse(JSON.stringify(t)),n=Wl(r);return n.columns.forEach(t=>{const r=n[t],i=e.mean(r),l=e.deviation(r);n[t]=r.map(t=>null!=t?(t-i)/l:t)}),n},Ql=async function(t,e){const r=document.getElementById(e);r.innerHTML="";const n=t.split("\n");for(const t of n){const e=t.split(","),n=document.createElement("tr");for(const t of e){const e=document.createElement("td");e.textContent=t,n.appendChild(e)}r.appendChild(n)}},Jl=async function(t={}){const{text:e="No text provided",divid:r="",width:n=460,height:i=150,border:l="2px solid",color:a="red"}=t;if(document.getElementById(r)){console.log("textbox div provided in function parameters.");const t=document.getElementById(r);t.id=r,t.style.display="block",t.style.overflow="auto",t.style.width=n+"px",t.style.height=i+"px",t.style.border=l+" "+a,t.style.resize="both",t.style.boxSizing="border-box",t.style.margin="8px 0",Ql(e,r)}else if(document.getElementById("textboxDiv"))console.log("textbox div exists. updating contents..."),Ql(e,"textboxDiv");else{const t=r||"textboxDiv";console.log(`textbox div NOT provided or not found. creating element with id: ${t}`);const s=document.createElement("table");s.id=t,document.body.appendChild(s),Ql(e,t),s.style.display="block",s.style.overflow="auto",s.style.width=n+"px",s.style.height=i+"px",s.style.border=l+" "+a,s.style.resize="both",s.style.boxSizing="border-box",s.style.margin="8px 0"}return document.getElementById(r||"textboxDiv")},Zl={data:{divNum:1,iris:{json:t,csv:null},file:{json:null,csv:null}}},ta=t=>t[0].map((e,r)=>t.map(t=>t[r]));function ea(t,e){return t.map(t=>e[t].length>12?e[t].slice(0,6)+"..."+e[t].slice(-3):e[t])}async function ra(e={}){console.log("RUNNING hclust_plot()-------------------------------");const{divid:r="",matrix:n=t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:i=t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:l=Object.keys(t[0]).slice(0,-1),width:a=400,height:s=1600,clusterCols:o=!0,clusterRows:f=!0,clusteringDistanceRows:u="euclidean",clusteringDistanceCols:h="euclidean",clusteringMethodCols:c="complete",clusteringMethodRows:p="complete",marginTop:d=(o?85:53),marginLeft:g=(f?250:80),colPadding:m=(o?12:0),rowPadding:_=(f?75:0),dendogram_font:b="10px",colDendoColor:y="blue",rowDendoColor:A="red",heatmapColor:M="green",heatmapColorScale:B=[0,8],tooltip_decimal:S=2,tooltip_fontFamily:k="monospace",tooltip_fontSize:E="12px"}=e,N=d,C=0,z=g,P=0,O=Jt("svg"),j=n,T=An(new Tl(nl(ta(j),Fl[h]),{method:c,isDistanceMatrix:!0}));vn()(T);const $=An(new Tl(nl(j,Fl[u]),{method:p,isDistanceMatrix:!0}));vn()($);let D=o?T.leaves().map(t=>t.data.index):x(j[0].length),V=f?$.leaves().map(t=>t.data.index):x(j.length);const F=ta(D.map(t=>ta(V.map(t=>j[t]))[t]));let L=l?ea(D,l):Array.from(new Array(j[0].length),(t,e)=>e+1),q=i?ea(V,i):Array.from(new Array(j[0].length),(t,e)=>e+1);w(L.map(t=>t.length));const U=w(q.map(t=>String(t).length)),H=Fn().domain(B).range(["#000",`${M}`]);let Y=zn().domain(L).range([0,a-z-P]),X=zn().domain(q).range([0,s-N]);O.attr("width",a).attr("height",s),O.append("rect").attr("x",0).attr("y",0).attr("width",a).attr("height",s).attr("fill","#ffffff");const G=O.append("g").attr("transform",`translate(${z+P}, ${N+C})`),W=G.append("g").call(R(Y)).style("font-size",b);W.selectAll(".tick").selectAll("line").remove(),W.selectAll("text").style("text-anchor","start").attr("dx","2px").attr("dy","1.1em").attr("transform","rotate(-90)").attr("class","xa").style("fill","#000");let K=G.append("g").call(I(X)).style("font-size",b).attr("id","ya");K.selectAll(".tick").selectAll("line").remove(),K.selectAll("text").attr("dx","14px").attr("dy","0.3em").attr("class","yaa").style("fill","#000");const Q=G.append("g").attr("class","gPoints"),J=tl().style("border","solid 3px black").style("background-color","white").style("border-radius","10px").style("float","left").style("color","#000").style("font-family",k).html((t,e)=>`\n          <div style='float: right; color: #000;'>\n           value:${e.value.toFixed(S)} <br/>\n           row:${q[e.n]}, col:${L[e.t]} \n        </div>`),Z=await async function(t){let e=[];return x(t.length).map(r=>{const n=x(t[0].length).map(e=>({t:e,n:r,value:t[r][e]}));e=[...e,...n]}),e}(F);O.call(J),Q.selectAll().data(Z).enter().append("rect").attr("x",t=>Y(L[t.t])).attr("y",t=>X(q[t.n])).attr("width",a/j[0].length).attr("height",s/j.length).attr("fill",t=>H(t.value)).on("mouseover",J.show).on("mouseout",J.hide);const tt=tl().style("border","solid 3px black").style("background-color","white").style("border-radius","9px").style("float","left").style("color","#000").style("font-family",k).style("font-size",E).html((t,e)=>`\n<div style='float: right; color: #000;'>\n   Height:${e.source.data.height.toFixed(3)} <br/>\n</div>`);if(1==o){function et(t){const e=m;return e-t.data.height/rt*e}const rt=T.data.height-m+5,nt=T.descendants().reverse(),it=nt.filter(t=>!t.children);it.sort((t,e)=>t.x-e.x);const lt=(a-z)/it.length;it.forEach((t,e)=>t.x=e*lt+lt/2),nt.forEach(t=>{t.children&&(t.x=v(t.children,t=>t.x))}),O.call(tt),T.links().forEach((t,e)=>{var r;O.append("path").attr("class","link").attr("stroke",t.source.color||`${y}`).attr("stroke-width","3px").attr("fill","none").attr("transform",`translate(${z}, ${m})`).attr("d",(r=t,"M"+r.source.x+","+et(r.source)+"H"+r.target.x+"V"+et(r.target))).on("mouseover",tt.show).on("mouseout",tt.hide)})}if(1==f){function at(t){const e=z-_;return e-t.data.height/st*e}const st=$.data.height+2;vn()($);const ot=$.descendants().reverse(),ft=ot.filter(t=>!t.children);ft.sort((t,e)=>t.x-e.x);const ut=(s-N)/ft.length;ft.forEach((t,e)=>t.x=e*ut+ut/2),ot.forEach(t=>{t.children&&(t.x=v(t.children,t=>t.x))}),O.call(tt),$.links().forEach((t,e)=>{var r;O.append("path").attr("class","link").attr("stroke",t.source.color||`${A}`).attr("stroke-width","3px").attr("fill","none").attr("transform",`translate(${U},${N})`).attr("d",(r=t,"M"+at(r.source)+","+r.source.x+"V"+r.target.x+"H"+at(r.target))).on("mouseover",tt.show).on("mouseout",tt.hide)}),O.selectAll("path").data($.links())}if(document.getElementById(r)){const ht=document.getElementById(r);ht.innerHTML="",ht.appendChild(O.node()),console.log("plot div provided in function parameters.divid:",r)}else if(!document.getElementById("childDiv")){const ct=Zl.data.divNum,pt=document.createElement("div");pt.id=r||"hclust_plot"+ct,console.log("div  NOT provided in function options or doesn't exist... created a new div with id: ",pt.id,"and appended to document body!"),document.body.appendChild(pt),pt.appendChild(O.node()),Zl.data.divNum=ct+1}return O.node()}async function na(e={}){console.log("RUNNING hclust_UI()-------------------------------"),console.log("hclust UI div num",Zl.data.divNum);const{divid:r=""}=e;let n=document.getElementById(r);document.getElementById(r)?console.log("hclust_UI() div ID provided, loading div:",n):(console.log("hclust_UI() div NOT provided. creating div...",n),n=document.createElement("div"),n.id="loadUI"+Zl.data.divNum,n.style.alignContent="center",document.body.appendChild(n),console.log("hclust_UI() div NOT provided. creating div...",n));const i=document.createElement("button");i.id="irisDataButton"+Zl.data.divNum,i.textContent="Load Iris Data",n.appendChild(i),console.log("hclustUI: irisDataButton:",document.getElementById(i.id));const l=document.createElement("input");l.id="fileInput"+Zl.data.divNum,l.setAttribute("type","file"),n.appendChild(l),n.append(document.createElement("br")),n.append(document.createElement("br"));const a=document.createElement("div");a.id="hcplotDiv"+Zl.data.divNum,n.appendChild(a),console.log("hclustUI: plotDiv:",document.getElementById(a.id));const s=document.createElement("div");s.id="textBoxDiv"+Zl.data.divNum,s.style.alignContent="center",n.appendChild(s),console.log("hclustUI: textBoxDiv:",document.getElementById(s.id)),l.addEventListener("change",t=>{console.log(Zl.data.divNum,"fileInput button clicked!");const e=t.target.files;for(const r of e){const e=new FileReader;e.onload=e=>{const r=t.target.files[0];if(r){const t=new FileReader;t.onload=async function(t){const e=t.target.result,r=await ql(e);console.log("hclustDt.data.divNum",Zl.data.divNum);if(r.map(Object.values).headers=r.headers,Zl.data.file=[],Zl.data.file.json=r,Zl.data.file.csv=e,!document.getElementById("rowCluster"+Zl.data.divNum)){console.log("*********",!document.getElementById("rowCluster"+Zl.data.divNum));const t=document.createElement("button");t.id="rowCluster"+Zl.data.divNum,t.textContent="Cluster by Rows",n.appendChild(t),console.log("hclustUI: rowCluster:",document.getElementById(t.id));const e=document.createElement("button");e.id="colCluster"+Zl.data.divNum,e.textContent="Cluster by Columns",n.appendChild(e),n.append(document.createElement("br")),n.append(document.createElement("br"))}console.log("load iris data button for Hclust clicked!"),ra({matrix:Zl.data.file.json.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:Zl.data.file.json.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(Zl.data.file.json[0]).slice(0,-1),divid:a.id,clusterCols:!1,clusterRows:!1})},t.onerror=function(){displayError("Error reading the file.")},t.readAsText(r)}},e.readAsText(r)}}),document.getElementById(i.id).addEventListener("click",async function(){let e=!1,r=!1;if(!document.getElementById("rowCluster"+Zl.data.divNum)){console.log("*********",!document.getElementById("rowCluster"+Zl.data.divNum));const t=document.createElement("button");t.id="rowCluster"+Zl.data.divNum,t.textContent="Cluster by Rows",n.appendChild(t),console.log("hclustUI: rowCluster:",document.getElementById(t.id));const e=document.createElement("button");e.id="colCluster"+Zl.data.divNum,e.textContent="Cluster by Columns",n.appendChild(e),n.append(document.createElement("br")),n.append(document.createElement("br"))}console.log("load iris data button for Hclust clicked!"),ra({matrix:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:a.id,clusterCols:r,clusterRows:e}),document.getElementById("rowCluster"+Zl.data.divNum).addEventListener("click",async function(){console.log(document.getElementById("rowCluster"+Zl.data.divNum)),console.log("clusterRows",e),0==e?e=!0:1==e&&(e=!1),console.log("clusterRows",e),ra({matrix:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:a.id,clusterCols:r,clusterRows:e})}),document.getElementById("colCluster"+Zl.data.divNum).addEventListener("click",async function(){console.log(document.getElementById("colCluster"+Zl.data.divNum)),console.log("clusterCols",r),0==r?r=!0:1==r&&(r=!1),console.log("clusterCols",r),ra({matrix:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:a.id,clusterCols:r,clusterRows:e})})}),console.log(`rowCluster${Zl.data.divNum}`),console.log(document.getElementById(`rowCluster${Zl.data.divNum}`)),Zl.data.divNum+=1}class ia{constructor(t,e={},r){if(this.U=null,this.S=null,r)return this.center=r.center,this.scale=r.scale,this.means=r.means,this.stdevs=r.stdevs,this.U=ml.checkMatrix(r.U),this.S=r.S,this.R=r.R,void(this.excludedFeatures=r.excludedFeatures||[]);let n;n=(Array.isArray(t),new ml(t));const{isCovarianceMatrix:i=!1,method:l="SVD",nCompNIPALS:a=2,center:s=!0,scale:o=!1,ignoreZeroVariance:f=!1}=e;if(this.center=s,this.scale=o,this.means=null,this.stdevs=null,this.excludedFeatures=[],i)this._computeFromCovarianceMatrix(n);else switch(this._adjust(n,f),l){case"covarianceMatrix":{const t=new _l(n).mmul(n).div(n.rows-1);this._computeFromCovarianceMatrix(t);break}case"NIPALS":this._computeWithNIPALS(n,a);break;case"SVD":{const t=new wl(n,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=t.rightSingularVectors;const e=t.diagonal,r=[];for(const t of e)r.push(t*t/(n.rows-1));this.S=r;break}default:throw new Error(`unknown method: ${l}`)}}static load(t){if("string"!=typeof t.name)throw new TypeError("model must have a name property");if("PCA"!==t.name)throw new RangeError(`invalid model: ${t.name}`);return new ia(void 0,void 0,t)}predict(t,e={}){const{nComponents:r=this.U.columns}=e;let n;if(n=(Array.isArray(t),new ml(t)),this.center&&(n.subRowVector(this.means),this.scale)){for(let t of this.excludedFeatures)n.removeColumn(t);n.divRowVector(this.stdevs)}let i=n.mmul(this.U);return i.subMatrix(0,i.rows-1,0,r-1)}invert(t){let e=(t=ml.checkMatrix(t)).mmul(this.U.transpose());return this.center&&(this.scale&&e.mulRowVector(this.stdevs),e.addRowVector(this.means)),e}getExplainedVariance(){let t=0;if(this.S)for(const e of this.S)t+=e;return this.S?this.S.map(e=>e/t):[]}getCumulativeVariance(){let t=this.getExplainedVariance();for(let e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(t=>Math.sqrt(t))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S,excludedFeatures:this.excludedFeatures}}_adjust(t,e){if(this.center){const r=t.mean("column"),n=this.scale?t.standardDeviation("column",{mean:r}):null;if(this.means=r,t.subRowVector(r),this.scale){for(let r=0;r<n.length;r++)if(0===n[r]){if(!e)throw new RangeError(`Cannot scale the dataset (standard deviation is zero at index ${r}`);t.removeColumn(r),n.splice(r,1),this.excludedFeatures.push(r),r--}this.stdevs=n,t.divRowVector(n)}}}_computeFromCovarianceMatrix(t){const e=new gl(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix,this.U.flipRows(),this.S=e.realEigenvalues,this.S.reverse()}_computeWithNIPALS(t,e){this.U=new ml(e,t.columns),this.S=[];let r=t;for(let t=0;t<e;t++){let e=new bl(r);this.U.setRow(t,e.w.transpose()),this.S.push(Math.pow(e.s.get(0,0),2)),r=e.xResidual}this.U=this.U.transpose()}}const la={data:{divNum:1,iris:{json:t,csv:null},file:{json:null,csv:null}}};function aa(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),l=Zt(".points").filter(t=>t.group===e),a=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),a.transition().attr("opacity",.1),l.transition().attr("opacity",r),i.transition().attr("opacity",r)}async function sa(e={}){console.log("RUNNING: pca_plot() function----------");const{divid:r="",data:n=t,width:i=600,height:l=300,colors:a=["red","blue","green","orange","purple","pink","yellow"]}=e;let s=r?document.getElementById(r):null;if(s)console.log("div provided in function parameters:",r),s.innerHTML="";else{const t=la.data.divNum;s=document.createElement("div"),s.id=r||"pca_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",s.id,"and appended to document body!"),document.body.appendChild(s),la.data.divNum=t+1}const f=await async function(t){const e=Xl(t);let r=(await Kl(e)).map(Object.values);const n=new ia(r,{center:!0,scale:!0}),i=t[0]||{},l=Object.keys(i).find(t=>"number"!=typeof i[t]);return n.predict(r).toJSON().map((e,r)=>({group:l?t[r]?.[l]:"row_"+r,name:"id_"+r,PC1:e[0],PC2:e[1]}))}(n),u=[...new Set(f.map(t=>t.group))],h=Rn(a).domain(u),c=25,p=170,d=45,g=45,m=y(f,t=>t.PC1),_=w(f,t=>t.PC1),b=_-m,v=m-.1*b,x=_+.1*b,A=Fn().domain([v,x]).range([g,i-p]),M=Fn().domain(o(f,t=>t.PC2)).range([l-d,c]),B=Jt("svg").style("background","white").style("overflow","visible");B.attr("id","svgid"),B.append("text").attr("x",i/2-g).attr("y",c/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("PCA Plot");const S=B.attr("width",i).attr("height",l).append("g");S.append("g").call(t=>t.attr("transform",`translate(0,${l-d+5})`).call(z(A).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-p).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("PC1"))),S.append("g").call(t=>t.attr("transform",`translate(${g-5},0)`).call(I(M).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",c-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("PC2"))),S.append("rect").attr("id","background").attr("x",g).attr("y",c).attr("width",i-g-p).attr("height",l-c-d).attr("fill","white").on("click",(t,e)=>aa(0,e,.7));const k=S.append("g").attr("class","gPoints").style("isolation","isolate"),E=tl().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n          <div style='line-height: 1.5;'>\n            <div><strong>Name:</strong> ${e.name}</div>\n            <div><strong>PC1:</strong> ${e.PC1.toFixed(2)}</div>\n            <div><strong>PC2:</strong> ${e.PC2.toFixed(2)}</div>\n          </div>`);B.call(E),k.selectAll("circle").data(f).enter().append("circle").attr("class","points").attr("cx",t=>A(t.PC1)).attr("cy",t=>M(t.PC2)).attr("fill",t=>h(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",E.show).on("mouseout",E.hide);const N=S.append("g").selectAll("rect").data(u);N.enter().append("rect").attr("class","keyRects").attr("x",i-g-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>h(t)).on("click",(t,e)=>aa(0,e,.7)),N.enter().append("text").attr("x",t=>i-g-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>aa(0,e,.7)),s.appendChild(B.node())}async function oa(e={}){console.log("RUNNING pca_UI()-------------------------------");const{divid:r="",data:n=t,width:i=600,height:l=300,colors:a=["red","blue","green","orange","purple","pink","yellow"],loadIrisOnStart:s=!1}=e,o=la.data.divNum;let f=r?document.getElementById(r):null;f?(console.log("plot div provided in function parameters. divid:",r),f.innerHTML=""):(f=document.createElement("div"),f.id=r||"pca_UI"+o,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",f.id,"and appended to document body!"),document.body.appendChild(f));const u=document.createElement("div");u.id="loadingMessage_"+o,u.style.display="none",u.style.padding="10px",u.style.margin="10px 0",u.style.backgroundColor="#e3f2fd",u.style.border="1px solid #2196F3",u.style.borderRadius="4px",u.textContent="Processing data...";const h=document.createElement("div");h.id="errorMessage_"+o,h.style.display="none",h.style.padding="10px",h.style.margin="10px 0",h.style.backgroundColor="#ffebee",h.style.border="1px solid #f44336",h.style.borderRadius="4px",h.style.color="#c62828";const c=document.createElement("button");c.id="irisDataButton_"+o,c.textContent="Load Iris Data",c.setAttribute("aria-label","Load built-in iris dataset"),c.style.marginRight="10px",c.style.padding="5px 10px";const p=document.createElement("input");p.id="fileInput_"+o,p.setAttribute("type","file"),p.setAttribute("accept",".csv"),p.setAttribute("aria-label","Upload CSV file for PCA analysis");const d=document.createElement("label");d.setAttribute("for",p.id),d.textContent="Or upload CSV file: ",d.style.marginLeft="10px",f.appendChild(c),f.appendChild(d),f.appendChild(p),f.appendChild(document.createElement("br")),f.appendChild(u),f.appendChild(h),f.appendChild(document.createElement("br"));const g=document.createElement("div");g.id="pcaplotDiv_"+o,f.appendChild(g);const m=document.createElement("div");m.id="textBoxDiv_"+o,m.style.alignContent="center",f.appendChild(m);const _=t=>{h.textContent=t,h.style.display="block",u.style.display="none"},b=async(t,e)=>{try{u.style.display="block",h.style.display="none";const r=Xl(t);if(0===r.length||0===Object.keys(r[0]).length)throw new Error("No numeric columns found in data. PCA requires numeric data.");g.innerHTML="",m.innerHTML="",await sa({data:t,divid:g.id,width:i,height:l,colors:a}),await Jl({text:e,divid:m.id}),u.style.display="none"}catch(t){console.error("Error rendering data:",t),_(`Error: ${t.message}`)}},w=async t=>{const e=t.target.files[0];if(!e)return;if(console.log(o,"fileInput button clicked!"),!e.name.endsWith(".csv"))return void _("Please upload a CSV file.");const r=new FileReader;r.onload=async function(t){try{const e=t.target.result;if(!e||0===e.trim().length)throw new Error("File is empty.");const r=await ql(e);if(!r||0===r.length)throw new Error("No valid data found in CSV file.");la.data.file.json=r,la.data.file.csv=e,await b(r,e)}catch(t){console.error("Error processing file:",t),_(`Error processing file: ${t.message}`)}},r.onerror=function(){_("Error reading the file. Please try again.")},r.readAsText(e)};p.removeEventListener("change",w),p.addEventListener("change",w);const y=async function(){console.log(o,"load iris data button clicked!"),await b(la.data.iris.json,la.data.iris.csv)};return c.removeEventListener("click",y),c.addEventListener("click",y),s&&await b(la.data.iris.json,la.data.iris.csv),la.data.divNum+=1,f}var fa,ua,ha={},ca={};var pa=(ua||(ua=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TSNE=void 0;var e=(fa||(fa=1,Object.defineProperty(ca,"__esModule",{value:!0}),ca.TSNE=void 0,ca.TSNE=class{constructor(t){this.returnV=!1,this.vValue=0,this.iter=0,t=t||{},this.perplexity=this.getopt(t,"perplexity",30),this.dim=this.getopt(t,"dim",2),this.epsilon=this.getopt(t,"epsilon",10)}assert(t,e){if(!t)throw e||"Assertion failed"}getopt(t,e,r){return t.hasOwnProperty(e)?t[e]:r}gaussRandom(){if(this.returnV)return this.returnV=!1,this.vValue;const t=2*Math.random()-1,e=2*Math.random()-1,r=t*t+e*e;if(0===r||r>1)return this.gaussRandom();const n=Math.sqrt(-2*Math.log(r)/r);return this.vValue=e*n,this.returnV=!0,t*n}randn(t,e){return t+this.gaussRandom()*e}zeros(t){if(void 0===t||isNaN(t))return[];if("undefined"==typeof ArrayBuffer){const e=new Array(t);for(let r=0;r<t;r++)e[r]=0;return e}return new Float64Array(t)}randn2d(t,e,r){const n=void 0!==r,i=[];for(let l=0;l<t;l++){const t=[];for(let i=0;i<e;i++)n?t.push(r):t.push(this.randn(0,1e-4));i.push(t)}return i}L2(t,e){const r=t.length;let n=0;for(let i=0;i<r;i++){const r=t[i],l=e[i];n+=(r-l)*(r-l)}return n}xtod(t){const e=t.length,r=this.zeros(e*e);for(let n=0;n<e;n++)for(let i=n+1;i<e;i++){const l=this.L2(t[n],t[i]);r[n*e+i]=l,r[i*e+n]=l}return r}d2p(t,e,r){const n=Math.sqrt(t.length),i=Math.floor(n);this.assert(i===n,"D should have square number of elements.");const l=Math.log(e),a=this.zeros(i*i),s=this.zeros(i);for(let e=0;e<i;e++){let n=-1/0,o=1/0,f=1,u=!1;const h=50;let c=0;for(;!u;){let a=0;for(let r=0;r<i;r++){let n=Math.exp(-t[e*i+r]*f);e===r&&(n=0),s[r]=n,a+=n}let p=0;for(let t=0;t<i;t++){let e;e=0===a?0:s[t]/a,s[t]=e,e>1e-7&&(p-=e*Math.log(e))}p>l?(n=f,o===1/0?f*=2:f=(f+o)/2):(o=f,n===-1/0?f/=2:f=(f+n)/2),c++,Math.abs(p-l)<r&&(u=!0),c>=h&&(u=!0)}for(let t=0;t<i;t++)a[e*i+t]=s[t]}const o=this.zeros(i*i),f=2*i;for(let t=0;t<i;t++)for(let e=0;e<i;e++)o[t*i+e]=Math.max((a[t*i+e]+a[e*i+t])/f,1e-100);return o}sign(t){return t>0?1:t<0?-1:0}initDataRaw(t){const e=t.length,r=t[0].length;this.assert(e>0," X is empty? You must have some data!"),this.assert(r>0," X[0] is empty? Where is the data?");const n=this.xtod(t);this.P=this.d2p(n,this.perplexity,1e-4),this.N=e,this.initSolution()}initDataDist(t){const e=t.length;this.assert(e>0," X is empty? You must have some data!");const r=this.zeros(e*e);for(let n=0;n<e;n++)for(let i=n+1;i<e;i++){const l=t[n][i];r[n*e+i]=l,r[i*e+n]=l}this.P=this.d2p(r,this.perplexity,1e-4),this.N=e,this.initSolution()}initSolution(){this.Y=this.randn2d(this.N,this.dim),this.gains=this.randn2d(this.N,this.dim,1),this.ystep=this.randn2d(this.N,this.dim,0),this.iter=0}getSolution(){return this.Y}step(){this.iter+=1;const t=this.N,e=this.costGrad(this.Y),r=e.cost,n=e.grad,i=this.zeros(this.dim);for(let e=0;e<t;e++)for(let t=0;t<this.dim;t++){const r=n[e][t],l=this.ystep[e][t],a=this.gains[e][t];let s=this.sign(r)===this.sign(l)?.8*a:a+.2;s<.01&&(s=.01),this.gains[e][t]=s;const o=(this.iter<250?.5:.8)*l-this.epsilon*s*n[e][t];this.ystep[e][t]=o,this.Y[e][t]+=o,i[t]+=this.Y[e][t]}for(let e=0;e<t;e++)for(let r=0;r<this.dim;r++)this.Y[e][r]-=i[r]/t;return r}debugGrad(){const t=this.N,e=this.costGrad(this.Y);e.cost;const r=e.grad,n=1e-5;for(let e=0;e<t;e++)for(let t=0;t<this.dim;t++){const i=this.Y[e][t];this.Y[e][t]=i+n;const l=this.costGrad(this.Y);this.Y[e][t]=i-n;const a=this.costGrad(this.Y),s=r[e][t],o=(l.cost-a.cost)/(2*n);console.log(e+","+t+": gradcheck analytic: "+s+" vs. numerical: "+o),this.Y[e][t]=i}}costGrad(t){const e=this.N,r=this.dim,n=this.P,i=this.iter<100?4:1,l=this.zeros(e*e);let a=0;for(let n=0;n<e;n++)for(let i=n+1;i<e;i++){let s=0;for(let e=0;e<r;e++){const r=t[n][e]-t[i][e];s+=r*r}const o=1/(1+s);l[n*e+i]=o,l[i*e+n]=o,a+=2*o}const s=e*e,o=this.zeros(s);for(let t=0;t<s;t++)o[t]=Math.max(l[t]/a,1e-100);let f=0;const u=[];for(let a=0;a<e;a++){const s=new Array(r);for(let t=0;t<r;t++)s[t]=0;for(let u=0;u<e;u++){f+=-n[a*e+u]*Math.log(o[a*e+u]);const h=4*(i*n[a*e+u]-o[a*e+u])*l[a*e+u];for(let e=0;e<r;e++)s[e]+=h*(t[a][e]-t[u][e])}u.push(s)}return{cost:f,grad:u}}}),ca);Object.defineProperty(t,"TSNE",{enumerable:!0,get:function(){return e.TSNE}})}(ha)),ha);const da={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};async function ga(e={}){console.log("RUNNING: tsne_plot() function----------");const{divid:r="",data:n=t,width:i=600,height:l=300,colors:a=["red","blue","green","orange","purple","pink","yellow"],perplexity:s=30,epsilon:f=10,iterations:u=1e3}=e;let h=r?document.getElementById(r):null;if(h)console.log("plot div provided in function parameters. divid:",r),h.innerHTML="";else{const t=da.data.divNum;h=document.createElement("div"),h.id=r||"tsne_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",h.id),document.body.appendChild(h),da.data.divNum=t+1}const c=n[0]||{},p=Object.keys(c),d=p.filter(t=>"number"==typeof c[t]),g=p.find(t=>"number"!=typeof c[t]),m=n.map(t=>d.map(e=>t[e])),_=g?n.map(t=>t[g]):n.map((t,e)=>`row${e}`),b=function(t){const e=t.length,r=t[0].length,n=Array(r).fill(0),i=Array(r).fill(0);for(const e of t)for(let t=0;t<r;t++)n[t]+=e[t];for(let t=0;t<r;t++)n[t]/=e;for(const e of t)for(let t=0;t<r;t++)i[t]+=(e[t]-n[t])**2;for(let t=0;t<r;t++)i[t]=Math.sqrt(i[t]/(e-1))||1;return t.map(t=>t.map((t,e)=>(t-n[e])/i[e]))}(m),v=new pa.TSNE({dim:2,perplexity:s,earlyExaggeration:4,learningRate:f,nIter:u,metric:"euclidean"});v.initDataRaw(b),v.initSolution();for(let t=0;t<u;t++)v.step();const x=v.getSolution().map((t,e)=>({group:_[e],name:g?String(_[e])+"_"+e:"id_"+e,tSNE1:t[0],tSNE2:t[1]})),A=[...new Set(x.map(t=>t.group))],M=Rn(a).domain(A),B=25,S=170,k=45,E=45,N=y(x,t=>t.tSNE1),C=w(x,t=>t.tSNE1),R=C-N,P=N-.1*R,O=C+.1*R,j=Fn().domain([P,O]).range([E,i-S]),T=Fn().domain(o(x,t=>t.tSNE2)).range([l-k,B]),$=Jt("svg").style("background","white").style("overflow","visible");$.attr("id","svgid_tsne"),$.append("text").attr("x",i/2-E).attr("y",B/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("t-SNE Plot");const D=$.attr("width",i).attr("height",l).append("g");D.append("g").call(t=>t.attr("transform",`translate(0,${l-k+5})`).call(z(j).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-S).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("t-SNE 1"))),D.append("g").call(t=>t.attr("transform",`translate(${E-5},0)`).call(I(T).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",B-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("t-SNE 2"))),D.append("rect").attr("id","background").attr("x",E).attr("y",B).attr("width",i-E-S).attr("height",l-B-k).attr("fill","white").on("click",(t,e)=>q(null,e,.7));const V=D.append("g").attr("class","gPoints").style("isolation","isolate"),F=tl().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n      <div style='line-height: 1.5;'>\n        <div><strong>Name:</strong> ${e.name}</div>\n        <div><strong>t-SNE 1:</strong> ${e.tSNE1.toFixed(2)}</div>\n        <div><strong>t-SNE 2:</strong> ${e.tSNE2.toFixed(2)}</div>\n      </div>`);$.call(F),V.selectAll("circle").data(x).enter().append("circle").attr("class","points").attr("cx",t=>j(t.tSNE1)).attr("cy",t=>T(t.tSNE2)).attr("fill",t=>M(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",F.show).on("mouseout",F.hide);const L=D.append("g").selectAll("rect").data(A);function q(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),l=Zt(".points").filter(t=>t.group===e),a=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),a.transition().attr("opacity",.1),l.transition().attr("opacity",r),i.transition().attr("opacity",r)}L.enter().append("rect").attr("class","keyRects").attr("x",i-E-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>M(t)).on("click",(t,e)=>q(null,e,.7)),L.enter().append("text").attr("x",t=>i-E-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>q(null,e,.7)),h.appendChild($.node())}const ma=async(t={})=>{console.log("t-SNE UI - not yet implemented"),console.log("Options:",t)};var _a,ba,wa={},ya={},va={},xa={};function Aa(){if(_a)return xa;_a=1;var t=xa&&xa.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function e(t,e){return Math.floor(e()*t)}function r(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function n(t,e){return r(t).map(function(){return e})}function i(t){return n(t,0)}function l(t){return t.reduce(function(t,e){return t+e})}return Object.defineProperty(xa,"__esModule",{value:!0}),xa.reshape2d=xa.rejectionSample=xa.max2d=xa.max=xa.mean=xa.sum=xa.linear=xa.ones=xa.zeros=xa.filled=xa.range=xa.empty=xa.norm=xa.tauRand=xa.tauRandInt=void 0,xa.tauRandInt=e,xa.tauRand=function(t){return t()},xa.norm=function(e){var r,n,i=0;try{for(var l=t(e),a=l.next();!a.done;a=l.next()){var s=a.value;i+=Math.pow(s,2)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return Math.sqrt(i)},xa.empty=r,xa.range=function(t){return r(t).map(function(t,e){return e})},xa.filled=n,xa.zeros=i,xa.ones=function(t){return n(t,1)},xa.linear=function(t,e,n){return r(n).map(function(r,i){return t+i*((e-t)/(n-1))})},xa.sum=l,xa.mean=function(t){return l(t)/t.length},xa.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},xa.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)e=t[r][n]>e?t[r][n]:e;return e},xa.rejectionSample=function(t,r,n){for(var l=i(t),a=0;a<t;a++)for(var s=!0;s;){for(var o=e(r,n),f=!1,u=0;u<a;u++)if(o===l[u]){f=!0;break}f||(s=!1),l[a]=o}return l},xa.reshape2d=function(t,e,r){var n=[],i=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var l=0;l<e;l++){for(var a=[],s=0;s<r;s++)a.push(t[i]),i+=1;n.push(a)}return n},xa}function Ma(){if(ba)return va;ba=1;var t=va&&va.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=va&&va.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=va&&va.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n};Object.defineProperty(va,"__esModule",{value:!0}),va.smallestFlagged=va.deheapSort=va.buildCandidates=va.uncheckedHeapPush=va.heapPush=va.rejectionSample=va.makeHeap=void 0;var n=r(Aa());function i(t,e){var r=function(r){return n.empty(t).map(function(){return n.filled(e,r)})},i=[];return i.push(r(-1)),i.push(r(1/0)),i.push(r(0)),i}function l(t,e,r,n,i){e=Math.floor(e);var l=t[0][e],s=t[1][e];if(t[2][e],r>=s[0])return 0;for(var o=0;o<l.length;o++)if(n===l[o])return 0;return a(t,e,r,n,i)}function a(t,e,r,n,i){var l=t[0][e],a=t[1][e],s=t[2][e];if(r>=a[0])return 0;a[0]=r,l[0]=n,s[0]=i;for(var o=0,f=0;;){var u=2*o+1,h=u+1,c=t[0][0].length;if(u>=c)break;if(h>=c){if(!(a[u]>r))break;f=u}else if(a[u]>=a[h]){if(!(r<a[u]))break;f=u}else{if(!(r<a[h]))break;f=h}a[o]=a[f],l[o]=l[f],s[o]=s[f],o=f}return a[o]=r,l[o]=n,s[o]=i,1}function s(t,e,r,n){for(;2*n+1<r;){var i=2*n+1,l=i+1,a=n;if(t[a]<t[i]&&(a=i),l<r&&t[a]<t[l]&&(a=l),a===n)break;var s=t[n];t[n]=t[a],t[a]=s;var o=e[n];e[n]=e[a],e[a]=o,n=a}}return va.makeHeap=i,va.rejectionSample=function(t,e,r){for(var i=n.zeros(t),l=0;l<t;l++){for(var a=!0,s=0;a;){s=n.tauRandInt(e,r);for(var o=!1,f=0;f<l;f++)if(s===i[f]){o=!0;break}o||(a=!1)}i[l]=s}return i},va.heapPush=l,va.uncheckedHeapPush=a,va.buildCandidates=function(t,e,r,a,s){for(var o=i(e,a),f=0;f<e;f++)for(var u=0;u<r;u++)if(!(t[0][f][u]<0)){var h=t[0][f][u],c=t[2][f][u],p=n.tauRand(s);l(o,f,p,h,c),l(o,h,p,f,c),t[2][f][u]=0}return o},va.deheapSort=function(t){for(var e=t[0],r=t[1],n=0;n<e.length;n++)for(var i=e[n],l=r[n],a=0;a<i.length-1;a++){var o=i.length-a-1,f=l.length-a-1,u=i[0];i[0]=i[o],i[o]=u;var h=l[0];l[0]=l[f],l[f]=h,s(l,i,f,0)}return{indices:e,weights:r}},va.smallestFlagged=function(t,e){for(var r=t[0][e],n=t[1][e],i=t[2][e],l=1/0,a=-1,s=0;s>r.length;s++)1===i[s]&&n[s]<l&&(l=n[s],a=s);return a>=0?(i[a]=0,Math.floor(r[a])):-1},va}var Ba,Sa={};function ka(){if(Ba)return Sa;Ba=1;var t,e=Sa&&Sa.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),r=Sa&&Sa.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=Sa&&Sa.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&e(n,t,i);return r(n,t),n},i=Sa&&Sa.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,l=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=l.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}return a},l=Sa&&Sa.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.getCSR=Sa.normalize=Sa.eliminateZeros=Sa.multiplyScalar=Sa.maximum=Sa.subtract=Sa.add=Sa.pairwiseMultiply=Sa.identity=Sa.transpose=Sa.SparseMatrix=void 0;var a=n(Aa()),s=function(){function t(t,e,r,n){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=n[0],this.nCols=n[1];for(var i=0;i<r.length;i++){var l=t[i],a=e[i];this.checkDims(l,a);var s=this.makeKey(l,a);this.entries.set(s,{value:r[i],row:l,col:a})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var n=this.makeKey(t,e);this.entries.has(n)?this.entries.get(n).value=r:this.entries.set(n,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var n=this.makeKey(t,e);return this.entries.has(n)?this.entries.get(n).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach(function(t){e.push(t)}),t&&e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].row})},t.prototype.getCols=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].col})},t.prototype.getValues=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].value})},t.prototype.forEach=function(t){this.entries.forEach(function(e){return t(e.value,e.row,e.col)})},t.prototype.map=function(e){var r=[];this.entries.forEach(function(t){r.push(e(t.value,t.row,t.col))});var n=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,n)},t.prototype.toArray=function(){var t=this,e=a.empty(this.nRows).map(function(){return a.zeros(t.nCols)});return this.entries.forEach(function(t){e[t.row][t.col]=t.value}),e},t}();Sa.SparseMatrix=s,Sa.transpose=function(t){var e=[],r=[],n=[];t.forEach(function(t,i,l){e.push(i),r.push(l),n.push(t)});var i=[t.nCols,t.nRows];return new s(r,e,n,i)},Sa.identity=function(t){for(var e=i(t,1)[0],r=new s([],[],[],t),n=0;n<e;n++)r.set(n,n,1);return r},Sa.pairwiseMultiply=function(t,e){return f(t,e,function(t,e){return t*e})},Sa.add=function(t,e){return f(t,e,function(t,e){return t+e})},Sa.subtract=function(t,e){return f(t,e,function(t,e){return t-e})},Sa.maximum=function(t,e){return f(t,e,function(t,e){return t>e?t:e})},Sa.multiplyScalar=function(t,e){return t.map(function(t){return t*e})},Sa.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),n=t.getRows(),i=t.getCols(),l=0;l<r.length;l++)0===r[l]&&e.add(l);var a=function(t,r){return!e.has(r)},o=r.filter(a),f=n.filter(a),u=i.filter(a);return new s(f,u,o,t.getDims())},Sa.normalize=function(t,e){var r,n;void 0===e&&(e="l2");var i=o[e],a=new Map;t.forEach(function(t,e,r){var n=a.get(e)||[];n.push(r),a.set(e,n)});var f=new s([],[],[],t.getDims()),u=function(e){for(var r=a.get(e).sort(),n=r.map(function(r){return t.get(e,r)}),l=i(n),s=0;s<l.length;s++)f.set(e,r[s],l[s])};try{for(var h=l(a.keys()),c=h.next();!c.done;c=h.next()){u(c.value)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return f};var o=((t={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map(function(t){return t/e})},t.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map(function(t){return t/e})},t.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map(function(t){return Math.sqrt(Math.pow(t,2)/e)})},t);function f(t,e,r){for(var n=new Set,i=[],l=[],a=[],o=function(n,s){i.push(n),l.push(s);var o=r(t.get(n,s),e.get(n,s));a.push(o)},f=t.getValues(),u=t.getRows(),h=t.getCols(),c=0;c<f.length;c++){var p=(_=u[c])+":"+(b=h[c]);n.add(p),o(_,b)}var d=e.getValues(),g=e.getRows(),m=e.getCols();for(c=0;c<d.length;c++){var _,b;p=(_=g[c])+":"+(b=m[c]);n.has(p)||o(_,b)}var w=[t.nRows,t.nCols];return new s(i,l,a,w)}return Sa.getCSR=function(t){var e=[];t.forEach(function(t,r,n){e.push({value:t,row:r,col:n})}),e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row});for(var r=[],n=[],i=[],l=-1,a=0;a<e.length;a++){var s=e[a],o=s.row,f=s.col,u=s.value;o!==l&&(l=o,i.push(a)),r.push(f),n.push(u)}return{indices:r,values:n,indptr:i}},Sa}var Ea,Na,Ca={},Ra={};function za(){if(Ea)return Ra;Ea=1;var t=Ra&&Ra.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=Ra&&Ra.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=Ra&&Ra.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n},n=Ra&&Ra.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,l=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=l.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}return a},i=Ra&&Ra.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},l=Ra&&Ra.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.searchFlatTree=Ra.makeLeafArray=Ra.makeForest=Ra.FlatTree=void 0;var a=r(Aa()),s=function(t,e,r,n){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=n};function o(t,e,r,n,i){if(void 0===r&&(r=30),e.length>r){var l=function(t,e,r){var n=t[0].length,i=a.tauRandInt(e.length,r),l=a.tauRandInt(e.length,r);l=(l+=i===l?1:0)%e.length;for(var s=e[i],o=e[l],f=0,u=a.zeros(n),h=0;h<u.length;h++)u[h]=t[s][h]-t[o][h],f-=u[h]*(t[s][h]+t[o][h])/2;var c=0,p=0,d=a.zeros(e.length);for(h=0;h<e.length;h++){for(var g=f,m=0;m<n;m++)g+=u[m]*t[e[h]][m];0===g?(d[h]=a.tauRandInt(2,r),0===d[h]?c+=1:p+=1):g>0?(d[h]=0,c+=1):(d[h]=1,p+=1)}var _=a.zeros(c),b=a.zeros(p);c=0,p=0;for(h=0;h<d.length;h++)0===d[h]?(_[c]=e[h],c+=1):(b[p]=e[h],p+=1);return{indicesLeft:_,indicesRight:b,hyperplane:u,offset:f}}(t,e,i),s=l.indicesLeft,f=l.indicesRight,u=l.hyperplane,h=l.offset;return{leftChild:o(t,s,r,n+1,i),rightChild:o(t,f,r,n+1,i),isLeaf:!1,hyperplane:u,offset:h}}return{indices:e,isLeaf:!0}}function f(t,e,r,n,l,a,s){var o;if(t.isLeaf)return n[a][0]=-s,(o=l[s]).splice.apply(o,i([0,t.indices.length],t.indices)),{nodeNum:a,leafNum:s+=1};e[a]=t.hyperplane,r[a]=t.offset,n[a][0]=a+1;var u=a,h=f(t.leftChild,e,r,n,l,a+1,s);return a=h.nodeNum,s=h.leafNum,n[u][1]=a+1,{nodeNum:(h=f(t.rightChild,e,r,n,l,a+1,s)).nodeNum,leafNum:h.leafNum}}function u(t){return t.isLeaf?1:1+u(t.leftChild)+u(t.rightChild)}function h(t){return t.isLeaf?1:h(t.leftChild)+h(t.rightChild)}function c(t,e,r,n){for(var i=e,l=0;l<r.length;l++)i+=t[l]*r[l];return 0===i?a.tauRandInt(2,n):i>0?0:1}return Ra.FlatTree=s,Ra.makeForest=function(t,e,r,n){var i=Math.max(10,e),l=a.range(r).map(function(e,r){return function(t,e,r,n){void 0===e&&(e=30);var i=a.range(t.length),l=o(t,i,e,r,n);return l}(t,i,r,n)}),c=l.map(function(t){return function(t,e){var r=u(t),n=h(t),i=a.range(r).map(function(){return a.zeros(t.hyperplane?t.hyperplane.length:0)}),l=a.zeros(r),o=a.range(r).map(function(){return[-1,-1]}),c=a.range(n).map(function(){return a.range(e).map(function(){return-1})});return f(t,i,l,o,c,0,0),new s(i,l,o,c)}(t,i)});return c},Ra.makeLeafArray=function(t){var e,r;if(t.length>0){var n=[];try{for(var a=l(t),s=a.next();!s.done;s=a.next()){var o=s.value;n.push.apply(n,i(o.indices))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return n}return[[-1]]},Ra.searchFlatTree=function(t,e,r){for(var n=0;e.children[n][0]>0;){n=0===c(e.hyperplanes[n],e.offsets[n],t,r)?e.children[n][0]:e.children[n][1]}var i=-1*e.children[n][0];return e.indices[i]},Ra}const Ia=Object.prototype.toString;function Pa(t){return Ia.call(t).endsWith("Array]")}function Oa(t,e,r){let n=0;const i=r(e);for(let e=0;e<t.x.length;e++)n+=Math.abs(t.y[e]-i(t.x[e]));return n}function ja(t,e,r,n,i){let l=r*n*n,a=ml.eye(e.length,e.length,l);const s=i(e);let o=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)o[e]=s(t.x[e]);let f=function(t,e,r,n,i){const l=r.length,a=t.x.length;let s=new Array(l);for(let o=0;o<l;o++){s[o]=new Array(a);let l=r.slice();l[o]+=n;let f=i(l);for(let r=0;r<a;r++)s[o][r]=e[r]-f(t.x[r])}return new ml(s)}(t,o,e,n,i),u=function(t,e){const r=t.x.length;let n=new Array(r);for(let i=0;i<r;i++)n[i]=[t.y[i]-e[i]];return new ml(n)}(t,o),h=yl(a.add(f.mmul(f.transpose())));return(e=(e=new ml([e])).sub(h.mmul(f).mmul(u).mul(n).transpose())).to1DArray()}var Ta,$a,Da=ll(Object.freeze({__proto__:null,default:function(t,e,r={}){let{maxIterations:n=100,gradientDifference:i=.1,damping:l=0,errorTolerance:a=.01,minValues:s,maxValues:o,initialValues:f}=r;if(l<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!Pa(t.x)||t.x.length<2||!Pa(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let u=f||new Array(e.length).fill(1),h=u.length;if(o=o||new Array(h).fill(Number.MAX_SAFE_INTEGER),s=s||new Array(h).fill(Number.MIN_SAFE_INTEGER),o.length!==s.length)throw new Error("minValues and maxValues must be the same size");if(!Pa(u))throw new Error("initialValues must be an array");let c,p=Oa(t,u,e),d=p<=a;for(c=0;c<n&&!d;c++){u=ja(t,u,l,i,e);for(let t=0;t<h;t++)u[t]=Math.min(Math.max(s[t],u[t]),o[t]);if(p=Oa(t,u,e),isNaN(p))break;d=p<=a}return{parameterValues:u,parameterError:p,iterations:c}}}));function Va(){if(Ta)return ya;Ta=1;var t=ya&&ya.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=ya&&ya.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=ya&&ya.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n},n=ya&&ya.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,l){function a(t){try{o(n.next(t))}catch(t){l(t)}}function s(t){try{o(n.throw(t))}catch(t){l(t)}}function o(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(a,s)}o((n=n.apply(t,e||[])).next())})},i=ya&&ya.__generator||function(t,e){var r,n,i,l,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return l={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function s(l){return function(s){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&l[0]?n.return:l[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,l[1])).done)return i;switch(n=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(6===l[0]&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=e.call(t,a)}catch(t){l=[6,t],n=0}finally{r=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},l=ya&&ya.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,l=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=l.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=l.return)&&r.call(l)}finally{if(i)throw i.error}}return a},a=ya&&ya.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t},s=ya&&ya.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ya,"__esModule",{value:!0}),ya.initTransform=ya.resetLocalConnectivity=ya.fastIntersection=ya.findABParams=ya.cosine=ya.euclidean=ya.UMAP=void 0;var o=r(Ma()),f=r(ka()),u=r(function(){if(Na)return Ca;Na=1;var t=Ca&&Ca.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=Ca&&Ca.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=Ca&&Ca.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n},n=Ca&&Ca.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.initializeSearch=Ca.makeInitializedNNSearch=Ca.makeInitializations=Ca.makeNNDescent=void 0;var i=r(Ma()),l=r(ka()),a=r(za()),s=r(Aa());return Ca.makeNNDescent=function(t,e){return function(r,n,l,a,o,f,u,h){void 0===a&&(a=10),void 0===o&&(o=50),void 0===f&&(f=.001),void 0===u&&(u=.5),void 0===h&&(h=!0);for(var c=r.length,p=i.makeHeap(r.length,l),d=0;d<r.length;d++)for(var g=i.rejectionSample(l,r.length,e),m=0;m<g.length;m++){var _=t(r[d],r[g[m]]);i.heapPush(p,d,_,g[m],1),i.heapPush(p,g[m],_,d,1)}if(h)for(var b=0;b<n.length;b++)for(d=0;d<n[b].length&&!(n[b][d]<0);d++)for(m=d+1;m<n[b].length&&!(n[b][m]<0);m++)_=t(r[n[b][d]],r[n[b][m]]),i.heapPush(p,n[b][d],_,n[b][m],1),i.heapPush(p,n[b][m],_,n[b][d],1);for(b=0;b<a;b++){var w=i.buildCandidates(p,c,l,o,e),y=0;for(d=0;d<c;d++)for(m=0;m<o;m++){var v=Math.floor(w[0][d][m]);if(!(v<0||s.tauRand(e)<u))for(var x=0;x<o;x++){var A=Math.floor(w[0][d][x]),M=w[2][d][m],B=w[2][d][x];A<0||!M&&!B||(_=t(r[v],r[A]),y+=i.heapPush(p,v,_,A,1),y+=i.heapPush(p,A,_,v,1))}}if(y<=f*l*r.length)break}return i.deheapSort(p)}},Ca.makeInitializations=function(t){return{initFromRandom:function(e,r,n,l,a){for(var o=0;o<n.length;o++)for(var f=s.rejectionSample(e,r.length,a),u=0;u<f.length;u++)if(!(f[u]<0)){var h=t(r[f[u]],n[o]);i.heapPush(l,o,h,f[u],1)}},initFromTree:function(e,r,n,l,s){for(var o=0;o<n.length;o++)for(var f=a.searchFlatTree(n[o],e,s),u=0;u<f.length;u++){if(f[u]<0)return;var h=t(r[f[u]],n[o]);i.heapPush(l,o,h,f[u],1)}}}},Ca.makeInitializedNNSearch=function(t){return function(e,r,a,s){for(var o,f,u=l.getCSR(r),h=u.indices,c=u.indptr,p=0;p<s.length;p++)for(var d=new Set(a[0][p]);;){var g=i.smallestFlagged(a,p);if(-1===g)break;var m=h.slice(c[g],c[g+1]);try{for(var _=(o=void 0,n(m)),b=_.next();!b.done;b=_.next()){var w=b.value;if(w!==g&&-1!==w&&!d.has(w)){var y=t(e[w],s[p]);i.uncheckedHeapPush(a,p,y,w,1),d.add(w)}}}catch(t){o={error:t}}finally{try{b&&!b.done&&(f=_.return)&&f.call(_)}finally{if(o)throw o.error}}}return a}},Ca.initializeSearch=function(t,e,r,l,a,s,o){var f,u,h=i.makeHeap(r.length,l);if(a(l,e,r,h,o),t)try{for(var c=n(t),p=c.next();!p.done;p=c.next())s(p.value,e,r,h,o)}catch(t){f={error:t}}finally{try{p&&!p.done&&(u=c.return)&&u.call(c)}finally{if(f)throw f.error}}return h},Ca}()),h=r(za()),c=r(Aa()),p=s(Da),d=1e-5,g=.001,m=function(){function t(t){var e=this;void 0===t&&(t={}),this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=_,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new b;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),n(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}})})},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),n=r.head,i=r.tail,l=r.epochsPerSample;return this.optimizationState.head=n,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=l,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=u.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=u.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,n=[t.length,t.length],i=new f.SparseMatrix([],[],[],n),l=0;l<e.length;l++)for(var a=e[l],s=r[l],o=0;o<a.length;o++){var u=a[o],h=s[o];h>0&&i.set(l,u,h)}var c=f.transpose(i);return f.maximum(i,c)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw new Error("No data has been fit.");var n=Math.floor(this.nNeighbors*this.transformQueueSize);n=Math.min(r.length,n);var i=u.initializeSearch(this.rpForest,r,t,n,this.initFromRandom,this.initFromTree,this.random),l=this.search(r,this.searchGraph,i,t),a=o.deheapSort(l),s=a.indices,h=a.weights;s=s.map(function(t){return t.slice(0,e.nNeighbors)}),h=h.map(function(t){return t.slice(0,e.nNeighbors)});var p=Math.max(0,this.localConnectivity-1),d=this.smoothKNNDistance(h,this.nNeighbors,p),g=d.sigmas,m=d.rhos,_=this.computeMembershipStrengths(s,h,g,m),b=_.rows,w=_.cols,y=_.vals,v=[t.length,r.length],x=new f.SparseMatrix(b,w,y,v),A=f.normalize(x,"l1"),B=f.getCSR(A),S=t.length,k=M(c.reshape2d(B.indices,S,this.nNeighbors),c.reshape2d(B.values,S,this.nNeighbors),this.embedding),E=this.nEpochs?this.nEpochs/3:x.nRows<=1e4?100:30,N=x.getValues().reduce(function(t,e){return e>t?e:t},0);x=x.map(function(t){return t<N/E?0:t}),x=f.eliminateZeros(x);var C=this.makeEpochsPerSample(x.getValues(),E),R=x.getRows(),z=x.getCols();return this.assignOptimizationStateParameters({headEmbedding:k,tailEmbedding:this.embedding,head:R,tail:z,currentEpoch:0,nEpochs:E,nVertices:x.getDims()[1],epochsPerSample:C}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,n=this.nNeighbors,i=u.makeNNDescent(r,this.random),l=5+Math.floor(.5===(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),a=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=h.makeForest(t,n,l,this.random);var s=i(t,h.makeLeafArray(this.rpForest),n,a);return{knnIndices:s.indices,knnDistances:s.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var n=this,i=n.knnIndices,l=void 0===i?[]:i,a=n.knnDistances,s=void 0===a?[]:a,o=n.localConnectivity,u=this.smoothKNNDistance(s,e,o),h=u.sigmas,c=u.rhos,p=this.computeMembershipStrengths(l,s,h,c),d=p.rows,g=p.cols,m=p.vals,_=[t.length,t.length],b=new f.SparseMatrix(d,g,m,_),w=f.transpose(b),y=f.pairwiseMultiply(b,w),v=f.subtract(f.add(b,w),y),x=f.multiplyScalar(v,r),A=f.multiplyScalar(y,1-r);return f.add(x,A)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,n){void 0===n&&(n=1);var i=x(t,e,n,r);return A(i=f.eliminateZeros(i))},t.prototype.smoothKNNDistance=function(t,e,r,n,i){void 0===r&&(r=1),void 0===n&&(n=64),void 0===i&&(i=1);for(var l=Math.log(e)/Math.log(2)*i,a=c.zeros(t.length),s=c.zeros(t.length),o=0;o<t.length;o++){var f=0,u=1/0,h=1,p=t[o],m=p.filter(function(t){return t>0});if(m.length>=r){var _=Math.floor(r),b=r-_;_>0?(a[o]=m[_-1],b>d&&(a[o]+=b*(m[_]-m[_-1]))):a[o]=b*m[0]}else m.length>0&&(a[o]=c.max(m));for(var w=0;w<n;w++){for(var y=0,v=1;v<t[o].length;v++){var x=t[o][v]-a[o];y+=x>0?Math.exp(-x/h):1}if(Math.abs(y-l)<d)break;y>l?h=(f+(u=h))/2:(f=h,u===1/0?h*=2:h=(f+u)/2)}if(s[o]=h,a[o]>0){var A=c.mean(p);s[o]<g*A&&(s[o]=g*A)}else{var M=c.mean(t.map(c.mean));s[o]<g*M&&(s[o]=g*M)}}return{sigmas:s,rhos:a}},t.prototype.computeMembershipStrengths=function(t,e,r,n){for(var i=t.length,l=t[0].length,a=c.zeros(i*l),s=c.zeros(i*l),o=c.zeros(i*l),f=0;f<i;f++)for(var u=0;u<l;u++){var h=0;-1!==t[f][u]&&(h=t[f][u]===f?0:e[f][u]-n[f]<=0?1:Math.exp(-(e[f][u]-n[f])/r[f]),a[f*l+u]=f,s[f*l+u]=t[f][u],o[f*l+u]=h)}return{rows:a,cols:s,vals:o}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,n=this.graph.getValues(),i=0,l=0;l<n.length;l++){var a=n[l];i<n[l]&&(i=a)}var s=this.graph.map(function(t){return t<i/e?0:t});this.embedding=c.zeros(s.nRows).map(function(){return c.zeros(r).map(function(){return 20*c.tauRand(t.random)-10})});var o=[],f=[],u=[],h=s.getAll();for(l=0;l<h.length;l++){var p=h[l];p.value&&(o.push(p.value),u.push(p.row),f.push(p.col))}return{head:f,tail:u,epochsPerSample:this.makeEpochsPerSample(o,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=c.filled(t.length,-1),n=c.max(t),i=t.map(function(t){return t/n*e});return i.forEach(function(t,n){t>0&&(r[n]=e/i[n])}),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,r=t.learningRate,n=t.negativeSampleRate,i=this.optimizationState,l=i.epochsPerSample,s=i.headEmbedding,o=i.tailEmbedding,f=s[0].length,u=s.length===o.length,h=l.map(function(t){return t/n}),c=a(h),p=a(l);this.assignOptimizationStateParameters({epochOfNextSample:p,epochOfNextNegativeSample:c,epochsPerNegativeSample:h,moveOther:u,initialAlpha:r,alpha:r,gamma:e,dim:f})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,n=r.head,i=r.tail,l=r.epochsPerSample,a=this.getNEpochs(),s=this.graph.nCols,o=v(this.spread,this.minDist),f=o.a,u=o.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:n,tail:i,epochsPerSample:l,a:f,b:u,nEpochs:a,nVertices:s})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,n=e.tail,i=e.headEmbedding,l=e.tailEmbedding,a=e.epochsPerSample,s=e.epochOfNextSample,o=e.epochOfNextNegativeSample,f=e.epochsPerNegativeSample,u=e.moveOther,h=e.initialAlpha,p=e.alpha,d=e.gamma,g=e.a,m=e.b,_=e.dim,b=e.nEpochs,v=e.nVertices,x=0;x<a.length;x++)if(!(s[x]>t)){var A=r[x],M=n[x],B=i[A],S=l[M],k=y(B,S),E=0;k>0&&(E=-2*g*m*Math.pow(k,m-1),E/=g*Math.pow(k,m)+1);for(var N=0;N<_;N++){var C=w(E*(B[N]-S[N]),4);B[N]+=C*p,u&&(S[N]+=-C*p)}s[x]+=a[x];for(var R=Math.floor((t-o[x])/f[x]),z=0;z<R;z++){var I=c.tauRandInt(v,this.random),P=l[I],O=y(B,P),j=0;if(O>0)j=2*d*m,j/=(.001+O)*(g*Math.pow(O,m)+1);else if(A===I)continue;for(N=0;N<_;N++){C=4;j>0&&(C=w(j*(B[N]-P[N]),4)),B[N]+=C*p}}o[x]+=R*f[x]}return e.alpha=h*(1-t/b),e.currentEpoch+=1,i},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise(function(r,l){var a=function(){return n(e,void 0,void 0,function(){var e,n,s,o,f,u;return i(this,function(i){try{if(e=this.optimizationState,n=e.nEpochs,s=e.currentEpoch,this.embedding=this.optimizeLayoutStep(s),o=this.optimizationState.currentEpoch,f=!1===t(o),u=o===n,f||u)return[2,r(u)];setTimeout(function(){return a()},0)}catch(t){l(t)}return[2]})})};setTimeout(function(){return a()},0)})},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var n=this.optimizationState,i=n.nEpochs,l=n.currentEpoch;r=this.optimizeLayoutStep(l);var a=this.optimizationState.currentEpoch,s=!1===t(a);e=a===i||s}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();function _(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return Math.sqrt(r)}ya.UMAP=m,ya.euclidean=_,ya.cosine=function(t,e){for(var r=0,n=0,i=0,l=0;l<t.length;l++)r+=t[l]*e[l],n+=Math.pow(t[l],2),i+=Math.pow(e[l],2);return 0===n&&0===i?0:0===n||0===i?1:1-r/Math.sqrt(n*i)};var b=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function w(t,e){return t>e?e:t<-e?-e:t}function y(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r}function v(t,e){var r=c.linear(0,3*t,300).map(function(t){return t<e?1:t}),n=c.zeros(r.length).map(function(n,i){return r[i]>=e?Math.exp(-(r[i]-e)/t):n}),i={x:r,y:n},a={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},s=p.default(i,function(t){var e=l(t,2),r=e[0],n=e[1];return function(t){return 1/(1+r*Math.pow(t,2*n))}},a).parameterValues,o=l(s,2);return{a:o[0],b:o[1]}}function x(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=5),t.map(function(t,i,l){return-1===e[i]||-1===e[l]?t*Math.exp(-r):e[i]!==e[l]?t*Math.exp(-n):t})}function A(t){t=f.normalize(t,"max");var e=f.transpose(t),r=f.pairwiseMultiply(e,t);return t=f.add(t,f.subtract(e,r)),f.eliminateZeros(t)}function M(t,e,r){for(var n=c.zeros(t.length).map(function(t){return c.zeros(r[0].length)}),i=0;i<t.length;i++)for(var l=0;l<t[0].length;l++)for(var a=0;a<r[0].length;a++){var s=t[i][l];n[i][a]+=e[i][l]*r[s][a]}return n}return ya.findABParams=v,ya.fastIntersection=x,ya.resetLocalConnectivity=A,ya.initTransform=M,ya}var Fa=($a||($a=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Va();Object.defineProperty(t,"UMAP",{enumerable:!0,get:function(){return e.UMAP}})}(wa)),wa);const La={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};async function qa(e={}){console.log("RUNNING: umap_plot() function----------");const{divid:r="",data:n=t,width:i=600,height:l=300,colors:a=["red","blue","green","orange","purple","pink","yellow"],nNeighbors:s=15,minDist:f=.1,nComponents:u=2}=e;let h=r?document.getElementById(r):null;if(h)console.log("plot div provided in function parameters. divid:",r),h.innerHTML="";else{const t=La.data.divNum;h=document.createElement("div"),h.id=r||"umap_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",h.id),document.body.appendChild(h),La.data.divNum=t+1}const c=n[0]||{},p=Object.keys(c),d=p.filter(t=>"number"==typeof c[t]),g=p.find(t=>"number"!=typeof c[t]),m=n.map(t=>d.map(e=>t[e])),_=g?n.map(t=>t[g]):n.map((t,e)=>`row${e}`),b=function(t){const e=t.length,r=t[0].length,n=Array(r).fill(0),i=Array(r).fill(0);for(const e of t)for(let t=0;t<r;t++)n[t]+=e[t];for(let t=0;t<r;t++)n[t]/=e;for(const e of t)for(let t=0;t<r;t++)i[t]+=(e[t]-n[t])**2;for(let t=0;t<r;t++)i[t]=Math.sqrt(i[t]/(e-1))||1;return t.map(t=>t.map((t,e)=>(t-n[e])/i[e]))}(m),v=new Fa.UMAP({nComponents:u,nNeighbors:s,minDist:f,random:Math.random}).fit(b).map((t,e)=>({group:_[e],name:g?String(_[e])+"_"+e:"id_"+e,UMAP1:t[0],UMAP2:t[1]})),x=[...new Set(v.map(t=>t.group))],A=Rn(a).domain(x),M=25,B=170,S=45,k=45,E=y(v,t=>t.UMAP1),N=w(v,t=>t.UMAP1),C=N-E,R=E-.1*C,P=N+.1*C,O=Fn().domain([R,P]).range([k,i-B]),j=Fn().domain(o(v,t=>t.UMAP2)).range([l-S,M]),T=Jt("svg").style("background","white").style("overflow","visible");T.attr("id","svgid_umap"),T.append("text").attr("x",i/2-k).attr("y",M/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("UMAP Plot");const $=T.attr("width",i).attr("height",l).append("g");$.append("g").call(t=>t.attr("transform",`translate(0,${l-S+5})`).call(z(O).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-B).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("UMAP1"))),$.append("g").call(t=>t.attr("transform",`translate(${k-5},0)`).call(I(j).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",M-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("UMAP2"))),$.append("rect").attr("id","background").attr("x",k).attr("y",M).attr("width",i-k-B).attr("height",l-M-S).attr("fill","white").on("click",(t,e)=>L(null,e,.7));const D=$.append("g").attr("class","gPoints").style("isolation","isolate"),V=tl().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n      <div style='line-height: 1.5;'>\n        <div><strong>Name:</strong> ${e.name}</div>\n        <div><strong>UMAP1:</strong> ${e.UMAP1.toFixed(2)}</div>\n        <div><strong>UMAP2:</strong> ${e.UMAP2.toFixed(2)}</div>\n      </div>`);T.call(V),D.selectAll("circle").data(v).enter().append("circle").attr("class","points").attr("cx",t=>O(t.UMAP1)).attr("cy",t=>j(t.UMAP2)).attr("fill",t=>A(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",V.show).on("mouseout",V.hide);const F=$.append("g").selectAll("rect").data(x);function L(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),l=Zt(".points").filter(t=>t.group===e),a=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),a.transition().attr("opacity",.1),l.transition().attr("opacity",r),i.transition().attr("opacity",r)}F.enter().append("rect").attr("class","keyRects").attr("x",i-k-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>A(t)).on("click",(t,e)=>L(null,e,.7)),F.enter().append("text").attr("x",t=>i-k-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>L(null,e,.7)),h.appendChild(T.node())}const Ua=async(t={})=>{console.log("UMAP UI - not yet implemented"),console.log("Options:",t)};const Ha={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};function Ya(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),l=Zt(".points").filter(t=>t.group===e),a=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),a.transition().attr("opacity",.1),l.transition().attr("opacity",r),i.transition().attr("opacity",r)}async function Xa(t={}){console.log("RUNNING: scatter_plot() function----------");const{divid:r="",data:n=e,width:i=600,height:l=460,colors:a=["red","blue","green","orange","purple","pink","yellow"],xCol:s=null,yCol:f=null}=t;let u=r?document.getElementById(r):null;if(u)console.log("div provided in function parameters:",r),u.innerHTML="";else{const t=Ha.data.divNum;u=document.createElement("div"),u.id=r||"scatter_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",u.id),document.body.appendChild(u),Ha.data.divNum=t+1}const h=n[0]||{},c=Object.keys(h),p=c.filter(t=>"number"==typeof h[t]),d=c.find(t=>"number"!=typeof h[t]),g=s||p[0]||c[0],m=f||p[1]||c[1];if(!g||!m)return void console.error("Need at least 2 columns for scatter plot");const _=n.map((t,e)=>({x:t[g],y:t[m],group:d?t[d]:"row_"+e,name:d?String(t[d])+"_"+e:"id_"+e,original:t})),b=[...new Set(_.map(t=>t.group))],v=Rn(a).domain(b),x=25,A=170,M=45,B=45,S=y(_,t=>t.x),k=w(_,t=>t.x),E=k-S,N=S-.1*E,C=k+.1*E,R=Fn().domain([N,C]).range([B,i-A]),P=Fn().domain(o(_,t=>t.y)).range([l-M,x]),O=Jt("svg").style("background","white").style("overflow","visible");O.attr("id","svgid_scatter"),O.append("text").attr("x",i/2-B).attr("y",x/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("Scatter Plot");const j=O.attr("width",i).attr("height",l).append("g");j.append("g").call(t=>t.attr("transform",`translate(0,${l-M+5})`).call(z(R).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-A).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text(g))),j.append("g").call(t=>t.attr("transform",`translate(${B-5},0)`).call(I(P).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",x-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text(m))),j.append("rect").attr("id","background").attr("x",B).attr("y",x).attr("width",i-B-A).attr("height",l-x-M).attr("fill","white").on("click",(t,e)=>Ya(0,e,.7));const T=j.append("g").attr("class","gPoints").style("isolation","isolate"),$=tl().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n      <div style='line-height: 1.5;'>\n        <div><strong>Name:</strong> ${e.name}</div>\n        <div><strong>${g}:</strong> ${e.x.toFixed(2)}</div>\n        <div><strong>${m}:</strong> ${e.y.toFixed(2)}</div>\n      </div>`);O.call($),T.selectAll("circle").data(_).enter().append("circle").attr("class","points").attr("cx",t=>R(t.x)).attr("cy",t=>P(t.y)).attr("fill",t=>v(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",$.show).on("mouseout",$.hide);const D=j.append("g").selectAll("rect").data(b);D.enter().append("rect").attr("class","keyRects").attr("x",i-B-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>v(t)).on("click",(t,e)=>Ya(0,e,.7)),D.enter().append("text").attr("x",t=>i-B-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>Ya(0,e,.7)),u.appendChild(O.node())}const Ga=async(t={})=>{console.log("Scatter UI - not yet implemented"),console.log("Options:",t)},Wa={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};function Ka(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),l=Zt(".points").filter(t=>t.group===e),a=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),a.transition().attr("opacity",.1),l.transition().attr("opacity",r),i.transition().attr("opacity",r)}async function Qa(e={}){console.log("RUNNING: pairs_plot() function----------");const{divid:r="",data:n=t,width:i=1e3,height:l=1e3,colors:a=["red","blue","green","orange","purple","pink","yellow"]}=e;let s=r?document.getElementById(r):null;if(s)console.log("div provided in function parameters:",r),s.innerHTML="";else{const t=Wa.data.divNum;s=document.createElement("div"),s.id=r||"pairs_plot"+t,console.log("div NOT provided... created new div with id:",s.id),document.body.appendChild(s),Wa.data.divNum=t+1}const f=n[0]||{},u=Object.keys(f),h=u.filter(t=>"number"==typeof f[t]),c=u.find(t=>"number"!=typeof f[t]);if(h.length<2)return void(s.innerHTML='<div class="text-muted">Need at least 2 numeric columns for pairs plot</div>');const p=n.map((t,e)=>({values:h.map(e=>t[e]),group:c?t[c]:"row_"+e,name:c?String(t[c])+"_"+e:"id_"+e})),d=[...new Set(p.map(t=>t.group))],g=Rn(a).domain(d),m=.6,_=h.length,b=Math.min(180,(i-100)/_),w=60,y=150,v=60,x=b*_+v+y,A=b*_+w+40,M=Jt("svg").attr("width",x).attr("height",A).style("background","white");M.append("text").attr("x",x/2).attr("y",w/2).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("Pairs Plot");const B=M.append("g").attr("transform",`translate(${v},${w})`);B.append("rect").attr("x",0).attr("y",0).attr("width",b*_).attr("height",b*_).attr("fill","transparent").attr("pointer-events","all").style("cursor","pointer").on("click",()=>function(t){Zt(".points").transition().attr("opacity",t),Zt(".keyRects").transition().attr("opacity",1)}(m));const S=tl().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","11px").html((t,e)=>{const r=e.xVar,n=e.yVar;return`\n        <div>\n          <strong>${e.group}</strong><br/>\n          ${r}: ${e.xVal.toFixed(2)}<br/>\n          ${n}: ${e.yVal.toFixed(2)}\n        </div>`});M.call(S);const k=h.map(t=>{const e=n.map(e=>e[t]);return Fn().domain(o(e)).range([b,0])});for(let t=0;t<_;t++)for(let e=0;e<_;e++){const r=B.append("g").attr("transform",`translate(${e*b},${t*b})`);if(r.append("rect").attr("width",b).attr("height",b).attr("fill","none").attr("stroke","#ccc"),t===e)r.append("text").attr("x",b/2).attr("y",b/2).attr("text-anchor","middle").attr("dominant-baseline","middle").style("font-size","11px").style("font-weight","bold").text(h[t]);else{const n=k[e],i=k[t];p.forEach(l=>{r.append("circle").datum({...l,xVar:h[e],yVar:h[t],xVal:l.values[e],yVal:l.values[t]}).attr("class","points").attr("cx",n(l.values[e])).attr("cy",i(l.values[t])).attr("r",2.5).attr("fill",g(l.group)).attr("opacity",m).on("mouseover",S.show).on("mouseout",S.hide)})}t===_-1&&r.append("text").attr("x",b/2).attr("y",b+15).attr("text-anchor","middle").style("font-size","9px").text(h[e]),0===e&&r.append("text").attr("x",-10).attr("y",b/2).attr("text-anchor","end").attr("dominant-baseline","middle").style("font-size","9px").text(h[t])}const E=M.append("g").attr("transform",`translate(${x-y+20},${w})`).selectAll("rect").data(d);E.enter().append("rect").attr("class","keyRects").attr("x",0).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>g(t)).on("click",(t,e)=>Ka(0,e,m)),E.enter().append("text").attr("x",20).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>Ka(0,e,m)),s.appendChild(M.node())}async function Ja(e={}){const{divid:r="",data:n=t,width:i=1e3,height:l=1e3,colors:a=["red","blue","green","orange","purple","pink","yellow"]}=e;await Qa({divid:r,data:n,width:i,height:l,colors:a})}async function Za(e={}){console.log("RUNNING heatmap_plot()----------------------");const{divid:r="",matrix:n=t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:i=t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:l=Object.keys(t[0]).slice(0,-1),height:a=900,width:s=400,color:o="green",marginLeft:f=50,marginRight:u=10,colorScale:h=[0,8]}=e,c=Fn().domain(h).range(["#000",`${o}`]),p=53,d=10,g=f,m=u,_=Jt("svg"),b=tl().style("border","solid 2px black").style("background-color","white").style("color","#000").style("border-radius","6px").style("float","left").style("font-family","monospace").style("font-size","10px").html((t,e)=>`\n        <div style='float: right; color: #000;'>\n           val:${e.value.toFixed(0)} <br/>\n             row:${i[e.n]}, col:${l[e.t]} \n        </div>`);_.call(b);let w=zn().domain(i).range([0,a-p]),y=zn().domain(l).range([0,s-g-m]);Zt("text").nodes().map(t=>t.getComputedTextLength()),_.attr("width",s).attr("height",a),_.append("rect").attr("x",0).attr("y",0).attr("width",s).attr("height",a).attr("fill","#ffffff");const v=_.append("g").attr("transform",`translate(${g+m}, ${p+d})`),A=v.append("g").call(R(y));A.selectAll(".tick").selectAll("line").remove(),A.selectAll("text").style("text-anchor","start").attr("dx","2px").attr("dy","1.1em").attr("transform","rotate(-90)").style("fill","#000");let M=v.append("g").call(I(w)).attr("id","ya");M.selectAll(".tick").selectAll("line").remove(),M.selectAll("text").attr("dx","3px").attr("dy","0.3em").attr("class","yaa").style("fill","#000");if(v.append("g").attr("class","gPoints").selectAll().data(await async function(t){let e=[];return x(t.length).map(r=>{const n=x(t[0].length).map(e=>({t:e,n:r,value:t[r][e]}));e=[...e,...n]}),e}(n)).enter().append("rect").attr("x",t=>y(l[t.t])).attr("y",t=>w(i[t.n])).attr("width",s/n[0].length).attr("height",a/n.length).attr("fill",t=>c(t.value)).on("mouseover",b.show).on("mouseout",b.hide),document.getElementById(r)){console.log("plot div provided in function parameters.divid:",r);const t=document.getElementById(r);t.innerHTML="",t.appendChild(_.node())}else if(!document.getElementById("childDiv")){const t=document.createElement("div");document.body.appendChild(t),t.appendChild(_.node())}return _.node()}const ts="0.1.0";export{Wl as asDataFrame,Ul as convertStrToNumber,Ql as createTableFromCSV,ql as csvToJson,Zl as hclustDt,na as hclust_UI,ra as hclust_plot,Za as heatmap_plot,t as irisData,Wa as pairsDt,Ja as pairs_UI,Qa as pairs_plot,la as pcaDt,oa as pca_UI,sa as pca_plot,Xl as removeNonNumberValues,Hl as removeNonNumbers,Gl as removeNumberValues,Yl as removeNumbers,Kl as scale,Ha as scatterDt,Ga as scatter_UI,Xa as scatter_plot,e as spiralData,Jl as textBox,da as tsneDt,ma as tsne_UI,ga as tsne_plot,La as umapDt,Ua as umap_UI,qa as umap_plot,ts as version};
//# sourceMappingURL=sdk.mjs.map
