const t=[{sepal_length:5.1,sepal_width:3.5,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.7,sepal_width:3.2,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:4.6,sepal_width:3.1,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.6,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:5.4,sepal_width:3.9,petal_length:1.7,petal_width:.4,species:"setosa"},{sepal_length:4.6,sepal_width:3.4,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5,sepal_width:3.4,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:4.4,sepal_width:2.9,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5.4,sepal_width:3.7,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3.4,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3,petal_length:1.4,petal_width:.1,species:"setosa"},{sepal_length:4.3,sepal_width:3,petal_length:1.1,petal_width:.1,species:"setosa"},{sepal_length:5.8,sepal_width:4,petal_length:1.2,petal_width:.2,species:"setosa"},{sepal_length:5.7,sepal_width:4.4,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:5.4,sepal_width:3.9,petal_length:1.3,petal_width:.4,species:"setosa"},{sepal_length:5.1,sepal_width:3.5,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5.7,sepal_width:3.8,petal_length:1.7,petal_width:.3,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.5,petal_width:.3,species:"setosa"},{sepal_length:5.4,sepal_width:3.4,petal_length:1.7,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.7,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:4.6,sepal_width:3.6,petal_length:1,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.3,petal_length:1.7,petal_width:.5,species:"setosa"},{sepal_length:4.8,sepal_width:3.4,petal_length:1.9,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.4,petal_length:1.6,petal_width:.4,species:"setosa"},{sepal_length:5.2,sepal_width:3.5,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5.2,sepal_width:3.4,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.7,sepal_width:3.2,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3.1,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:5.4,sepal_width:3.4,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:5.2,sepal_width:4.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5.5,sepal_width:4.2,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5,sepal_width:3.2,petal_length:1.2,petal_width:.2,species:"setosa"},{sepal_length:5.5,sepal_width:3.5,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.6,petal_length:1.4,petal_width:.1,species:"setosa"},{sepal_length:4.4,sepal_width:3,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.4,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.5,petal_length:1.3,petal_width:.3,species:"setosa"},{sepal_length:4.5,sepal_width:2.3,petal_length:1.3,petal_width:.3,species:"setosa"},{sepal_length:4.4,sepal_width:3.2,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.5,petal_length:1.6,petal_width:.6,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.9,petal_width:.4,species:"setosa"},{sepal_length:4.8,sepal_width:3,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.6,sepal_width:3.2,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:5.3,sepal_width:3.7,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:7,sepal_width:3.2,petal_length:4.7,petal_width:1.4,species:"versicolor"},{sepal_length:6.4,sepal_width:3.2,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:6.9,sepal_width:3.1,petal_length:4.9,petal_width:1.5,species:"versicolor"},{sepal_length:5.5,sepal_width:2.3,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:6.5,sepal_width:2.8,petal_length:4.6,petal_width:1.5,species:"versicolor"},{sepal_length:5.7,sepal_width:2.8,petal_length:4.5,petal_width:1.3,species:"versicolor"},{sepal_length:6.3,sepal_width:3.3,petal_length:4.7,petal_width:1.6,species:"versicolor"},{sepal_length:4.9,sepal_width:2.4,petal_length:3.3,petal_width:1,species:"versicolor"},{sepal_length:6.6,sepal_width:2.9,petal_length:4.6,petal_width:1.3,species:"versicolor"},{sepal_length:5.2,sepal_width:2.7,petal_length:3.9,petal_width:1.4,species:"versicolor"},{sepal_length:5,sepal_width:2,petal_length:3.5,petal_width:1,species:"versicolor"},{sepal_length:5.9,sepal_width:3,petal_length:4.2,petal_width:1.5,species:"versicolor"},{sepal_length:6,sepal_width:2.2,petal_length:4,petal_width:1,species:"versicolor"},{sepal_length:6.1,sepal_width:2.9,petal_length:4.7,petal_width:1.4,species:"versicolor"},{sepal_length:5.6,sepal_width:2.9,petal_length:3.6,petal_width:1.3,species:"versicolor"},{sepal_length:6.7,sepal_width:3.1,petal_length:4.4,petal_width:1.4,species:"versicolor"},{sepal_length:5.6,sepal_width:3,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.8,sepal_width:2.7,petal_length:4.1,petal_width:1,species:"versicolor"},{sepal_length:6.2,sepal_width:2.2,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.6,sepal_width:2.5,petal_length:3.9,petal_width:1.1,species:"versicolor"},{sepal_length:5.9,sepal_width:3.2,petal_length:4.8,petal_width:1.8,species:"versicolor"},{sepal_length:6.1,sepal_width:2.8,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:6.3,sepal_width:2.5,petal_length:4.9,petal_width:1.5,species:"versicolor"},{sepal_length:6.1,sepal_width:2.8,petal_length:4.7,petal_width:1.2,species:"versicolor"},{sepal_length:6.4,sepal_width:2.9,petal_length:4.3,petal_width:1.3,species:"versicolor"},{sepal_length:6.6,sepal_width:3,petal_length:4.4,petal_width:1.4,species:"versicolor"},{sepal_length:6.8,sepal_width:2.8,petal_length:4.8,petal_width:1.4,species:"versicolor"},{sepal_length:6.7,sepal_width:3,petal_length:5,petal_width:1.7,species:"versicolor"},{sepal_length:6,sepal_width:2.9,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.7,sepal_width:2.6,petal_length:3.5,petal_width:1,species:"versicolor"},{sepal_length:5.5,sepal_width:2.4,petal_length:3.8,petal_width:1.1,species:"versicolor"},{sepal_length:5.5,sepal_width:2.4,petal_length:3.7,petal_width:1,species:"versicolor"},{sepal_length:5.8,sepal_width:2.7,petal_length:3.9,petal_width:1.2,species:"versicolor"},{sepal_length:6,sepal_width:2.7,petal_length:5.1,petal_width:1.6,species:"versicolor"},{sepal_length:5.4,sepal_width:3,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:6,sepal_width:3.4,petal_length:4.5,petal_width:1.6,species:"versicolor"},{sepal_length:6.7,sepal_width:3.1,petal_length:4.7,petal_width:1.5,species:"versicolor"},{sepal_length:6.3,sepal_width:2.3,petal_length:4.4,petal_width:1.3,species:"versicolor"},{sepal_length:5.6,sepal_width:3,petal_length:4.1,petal_width:1.3,species:"versicolor"},{sepal_length:5.5,sepal_width:2.5,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:5.5,sepal_width:2.6,petal_length:4.4,petal_width:1.2,species:"versicolor"},{sepal_length:6.1,sepal_width:3,petal_length:4.6,petal_width:1.4,species:"versicolor"},{sepal_length:5.8,sepal_width:2.6,petal_length:4,petal_width:1.2,species:"versicolor"},{sepal_length:5,sepal_width:2.3,petal_length:3.3,petal_width:1,species:"versicolor"},{sepal_length:5.6,sepal_width:2.7,petal_length:4.2,petal_width:1.3,species:"versicolor"},{sepal_length:5.7,sepal_width:3,petal_length:4.2,petal_width:1.2,species:"versicolor"},{sepal_length:5.7,sepal_width:2.9,petal_length:4.2,petal_width:1.3,species:"versicolor"},{sepal_length:6.2,sepal_width:2.9,petal_length:4.3,petal_width:1.3,species:"versicolor"},{sepal_length:5.1,sepal_width:2.5,petal_length:3,petal_width:1.1,species:"versicolor"},{sepal_length:6.3,sepal_width:3.3,petal_length:6,petal_width:2.5,species:"virginica"},{sepal_length:5.8,sepal_width:2.7,petal_length:5.1,petal_width:1.9,species:"virginica"},{sepal_length:7.1,sepal_width:3,petal_length:5.9,petal_width:2.1,species:"virginica"},{sepal_length:6.3,sepal_width:2.9,petal_length:5.6,petal_width:1.8,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.8,petal_width:2.2,species:"virginica"},{sepal_length:7.6,sepal_width:3,petal_length:6.6,petal_width:2.1,species:"virginica"},{sepal_length:4.9,sepal_width:2.5,petal_length:4.5,petal_width:1.7,species:"virginica"},{sepal_length:7.3,sepal_width:2.9,petal_length:6.3,petal_width:1.8,species:"virginica"},{sepal_length:6.7,sepal_width:2.5,petal_length:5.8,petal_width:1.8,species:"virginica"},{sepal_length:7.2,sepal_width:3.6,petal_length:6.1,petal_width:2.5,species:"virginica"},{sepal_length:6.5,sepal_width:3.2,petal_length:5.1,petal_width:2,species:"virginica"},{sepal_length:6.4,sepal_width:2.7,petal_length:5.3,petal_width:1.9,species:"virginica"},{sepal_length:6.8,sepal_width:3,petal_length:5.5,petal_width:2.1,species:"virginica"},{sepal_length:5.7,sepal_width:2.5,petal_length:5,petal_width:2,species:"virginica"},{sepal_length:5.8,sepal_width:2.8,petal_length:5.1,petal_width:2.4,species:"virginica"},{sepal_length:6.4,sepal_width:3.2,petal_length:5.3,petal_width:2.3,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.5,petal_width:1.8,species:"virginica"},{sepal_length:7.7,sepal_width:3.8,petal_length:6.7,petal_width:2.2,species:"virginica"},{sepal_length:7.7,sepal_width:2.6,petal_length:6.9,petal_width:2.3,species:"virginica"},{sepal_length:6,sepal_width:2.2,petal_length:5,petal_width:1.5,species:"virginica"},{sepal_length:6.9,sepal_width:3.2,petal_length:5.7,petal_width:2.3,species:"virginica"},{sepal_length:5.6,sepal_width:2.8,petal_length:4.9,petal_width:2,species:"virginica"},{sepal_length:7.7,sepal_width:2.8,petal_length:6.7,petal_width:2,species:"virginica"},{sepal_length:6.3,sepal_width:2.7,petal_length:4.9,petal_width:1.8,species:"virginica"},{sepal_length:6.7,sepal_width:3.3,petal_length:5.7,petal_width:2.1,species:"virginica"},{sepal_length:7.2,sepal_width:3.2,petal_length:6,petal_width:1.8,species:"virginica"},{sepal_length:6.2,sepal_width:2.8,petal_length:4.8,petal_width:1.8,species:"virginica"},{sepal_length:6.1,sepal_width:3,petal_length:4.9,petal_width:1.8,species:"virginica"},{sepal_length:6.4,sepal_width:2.8,petal_length:5.6,petal_width:2.1,species:"virginica"},{sepal_length:7.2,sepal_width:3,petal_length:5.8,petal_width:1.6,species:"virginica"},{sepal_length:7.4,sepal_width:2.8,petal_length:6.1,petal_width:1.9,species:"virginica"},{sepal_length:7.9,sepal_width:3.8,petal_length:6.4,petal_width:2,species:"virginica"},{sepal_length:6.4,sepal_width:2.8,petal_length:5.6,petal_width:2.2,species:"virginica"},{sepal_length:6.3,sepal_width:2.8,petal_length:5.1,petal_width:1.5,species:"virginica"},{sepal_length:6.1,sepal_width:2.6,petal_length:5.6,petal_width:1.4,species:"virginica"},{sepal_length:7.7,sepal_width:3,petal_length:6.1,petal_width:2.3,species:"virginica"},{sepal_length:6.3,sepal_width:3.4,petal_length:5.6,petal_width:2.4,species:"virginica"},{sepal_length:6.4,sepal_width:3.1,petal_length:5.5,petal_width:1.8,species:"virginica"},{sepal_length:6,sepal_width:3,petal_length:4.8,petal_width:1.8,species:"virginica"},{sepal_length:6.9,sepal_width:3.1,petal_length:5.4,petal_width:2.1,species:"virginica"},{sepal_length:6.7,sepal_width:3.1,petal_length:5.6,petal_width:2.4,species:"virginica"},{sepal_length:6.9,sepal_width:3.1,petal_length:5.1,petal_width:2.3,species:"virginica"},{sepal_length:5.8,sepal_width:2.7,petal_length:5.1,petal_width:1.9,species:"virginica"},{sepal_length:6.8,sepal_width:3.2,petal_length:5.9,petal_width:2.3,species:"virginica"},{sepal_length:6.7,sepal_width:3.3,petal_length:5.7,petal_width:2.5,species:"virginica"},{sepal_length:6.7,sepal_width:3,petal_length:5.2,petal_width:2.3,species:"virginica"},{sepal_length:6.3,sepal_width:2.5,petal_length:5,petal_width:1.9,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.2,petal_width:2,species:"virginica"},{sepal_length:6.2,sepal_width:3.4,petal_length:5.4,petal_width:2.3,species:"virginica"},{sepal_length:5.9,sepal_width:3,petal_length:5.1,petal_width:1.8,species:"virginica"}];function e(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function n(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function r(t){let r,o,s;function a(t,e,n=0,i=t.length){if(n<i){if(0!==r(e,e))return i;do{const r=n+i>>>1;o(t[r],e)<0?n=r+1:i=r}while(n<i)}return n}return 2!==t.length?(r=e,o=(n,r)=>e(t(n),r),s=(e,n)=>t(e)-n):(r=t===e||t===n?t:i,o=t,s=t),{left:a,center:function(t,e,n=0,r=t.length){const i=a(t,e,n,r-1);return i>n&&s(t[i-1],e)>-s(t[i],e)?i-1:i},right:function(t,e,n=0,i=t.length){if(n<i){if(0!==r(e,e))return i;do{const r=n+i>>>1;o(t[r],e)<=0?n=r+1:i=r}while(n<i)}return n}}}function i(){return 0}const o=r(e).right;function s(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(n=e-i,i+=n/++r,o+=n*(e-i));else{let s=-1;for(let a of t)null!=(a=e(a,++s,t))&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i))}if(r>1)return o/(r-1)}function a(t,e){let n,r;if(void 0===e)for(const e of t)null!=e&&(void 0===n?e>=e&&(n=r=e):(n>e&&(n=e),r<e&&(r=e)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}r(function(t){return null===t?NaN:+t}).center;class l extends Map{constructor(t,e=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(u(this,t))}has(t){return super.has(u(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){const r=e(n);t.has(r)&&(n=t.get(r),t.delete(r));return n}(this,t))}}function u({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function h(t){return null!==t&&"object"==typeof t?t.valueOf():t}const c=Math.sqrt(50),f=Math.sqrt(10),p=Math.sqrt(2);function d(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=c?10:o>=f?5:o>=p?2:1;let a,l,u;return i<0?(u=Math.pow(10,-i)/s,a=Math.round(t*u),l=Math.round(e*u),a/u<t&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*s,a=Math.round(t/u),l=Math.round(e/u),a*u<t&&++a,l*u>e&&--l),l<a&&.5<=n&&n<2?d(t,e,2*n):[a,l,u]}function g(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[i,o,s]=r?d(e,t,n):d(t,e,n);if(!(o>=i))return[];const a=o-i+1,l=new Array(a);if(r)if(s<0)for(let t=0;t<a;++t)l[t]=(o-t)/-s;else for(let t=0;t<a;++t)l[t]=(o-t)*s;else if(s<0)for(let t=0;t<a;++t)l[t]=(i+t)/-s;else for(let t=0;t<a;++t)l[t]=(i+t)*s;return l}function m(t,e,n){return d(t=+t,e=+e,n=+n)[2]}function w(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?m(e,t,n):m(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function y(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function v(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function _(t,e){let n=0,r=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++n,r+=e);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function b(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function x(t){return t}var M=1e-6;function E(t){return"translate("+t+",0)"}function S(t){return"translate(0,"+t+")"}function k(t){return e=>+t(e)}function N(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function A(){return!this.__axis}function C(t,e){var n=[],r=null,i=null,o=6,s=6,a=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,u=1===t||4===t?-1:1,h=4===t||2===t?"x":"y",c=1===t||3===t?E:S;function f(f){var p=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,d=null==i?e.tickFormat?e.tickFormat.apply(e,n):x:i,g=Math.max(o,0)+a,m=e.range(),w=+m[0]+l,y=+m[m.length-1]+l,v=(e.bandwidth?N:k)(e.copy(),l),_=f.selection?f.selection():f,b=_.selectAll(".domain").data([null]),E=_.selectAll(".tick").data(p,e).order(),S=E.exit(),C=E.enter().append("g").attr("class","tick"),R=E.select("line"),I=E.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),E=E.merge(C),R=R.merge(C.append("line").attr("stroke","currentColor").attr(h+"2",u*o)),I=I.merge(C.append("text").attr("fill","currentColor").attr(h,u*g).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),f!==_&&(b=b.transition(f),E=E.transition(f),R=R.transition(f),I=I.transition(f),S=S.transition(f).attr("opacity",M).attr("transform",function(t){return isFinite(t=v(t))?c(t+l):this.getAttribute("transform")}),C.attr("opacity",M).attr("transform",function(t){var e=this.parentNode.__axis;return c((e&&isFinite(e=e(t))?e:v(t))+l)})),S.remove(),b.attr("d",4===t||2===t?s?"M"+u*s+","+w+"H"+l+"V"+y+"H"+u*s:"M"+l+","+w+"V"+y:s?"M"+w+","+u*s+"V"+l+"H"+y+"V"+u*s:"M"+w+","+l+"H"+y),E.attr("opacity",1).attr("transform",function(t){return c(v(t)+l)}),R.attr(h+"2",u*o),I.attr(h,u*g).text(d),_.filter(A).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),_.each(function(){this.__axis=v})}return f.scale=function(t){return arguments.length?(e=t,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),f):n.slice()},f.tickValues=function(t){return arguments.length?(r=null==t?null:Array.from(t),f):r&&r.slice()},f.tickFormat=function(t){return arguments.length?(i=t,f):i},f.tickSize=function(t){return arguments.length?(o=s=+t,f):o},f.tickSizeInner=function(t){return arguments.length?(o=+t,f):o},f.tickSizeOuter=function(t){return arguments.length?(s=+t,f):s},f.tickPadding=function(t){return arguments.length?(a=+t,f):a},f.offset=function(t){return arguments.length?(l=+t,f):l},f}function R(t){return C(1,t)}function I(t){return C(3,t)}function P(t){return C(4,t)}var z={value:()=>{}};function O(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new T(r)}function T(t){this._=t}function j(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function D(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=z,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}T.prototype=O.prototype={constructor:T,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),s=-1,a=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<a;)if(n=(t=o[s]).type)i[n]=D(i[n],t.name,e);else if(null==e)for(n in i)i[n]=D(i[n],t.name,null);return this}for(;++s<a;)if((n=(t=o[s]).type)&&(n=j(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new T(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var $="http://www.w3.org/1999/xhtml",V={svg:"http://www.w3.org/2000/svg",xhtml:$,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function F(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),V.hasOwnProperty(e)?{space:V[e],local:t}:t}function L(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===$&&e.documentElement.namespaceURI===$?e.createElement(t):e.createElementNS(n,t)}}function q(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function U(t){var e=F(t);return(e.local?q:L)(e)}function B(){}function H(t){return null==t?B:function(){return this.querySelector(t)}}function X(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function G(){return[]}function W(t){return null==t?G:function(){return this.querySelectorAll(t)}}function Y(t){return function(){return this.matches(t)}}function K(t){return function(e){return e.matches(t)}}var Q=Array.prototype.find;function J(){return this.firstElementChild}var Z=Array.prototype.filter;function tt(){return Array.from(this.children)}function et(t){return new Array(t.length)}function nt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function rt(t,e,n,r,i,o){for(var s,a=0,l=e.length,u=o.length;a<u;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new nt(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function it(t,e,n,r,i,o,s){var a,l,u,h=new Map,c=e.length,f=o.length,p=new Array(c);for(a=0;a<c;++a)(l=e[a])&&(p[a]=u=s.call(l,l.__data__,a,e)+"",h.has(u)?i[a]=l:h.set(u,l));for(a=0;a<f;++a)u=s.call(t,o[a],a,o)+"",(l=h.get(u))?(r[a]=l,l.__data__=o[a],h.delete(u)):n[a]=new nt(t,o[a]);for(a=0;a<c;++a)(l=e[a])&&h.get(p[a])===l&&(i[a]=l)}function ot(t){return t.__data__}function st(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function at(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function lt(t){return function(){this.removeAttribute(t)}}function ut(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ht(t,e){return function(){this.setAttribute(t,e)}}function ct(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ft(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function pt(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function dt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gt(t){return function(){this.style.removeProperty(t)}}function mt(t,e,n){return function(){this.style.setProperty(t,e,n)}}function wt(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function yt(t,e){return t.style.getPropertyValue(e)||dt(t).getComputedStyle(t,null).getPropertyValue(e)}function vt(t){return function(){delete this[t]}}function _t(t,e){return function(){this[t]=e}}function bt(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function xt(t){return t.trim().split(/^|\s+/)}function Mt(t){return t.classList||new Et(t)}function Et(t){this._node=t,this._names=xt(t.getAttribute("class")||"")}function St(t,e){for(var n=Mt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function kt(t,e){for(var n=Mt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Nt(t){return function(){St(this,t)}}function At(t){return function(){kt(this,t)}}function Ct(t,e){return function(){(e.apply(this,arguments)?St:kt)(this,t)}}function Rt(){this.textContent=""}function It(t){return function(){this.textContent=t}}function Pt(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function zt(){this.innerHTML=""}function Ot(t){return function(){this.innerHTML=t}}function Tt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function jt(){this.nextSibling&&this.parentNode.appendChild(this)}function Dt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $t(){return null}function Vt(){var t=this.parentNode;t&&t.removeChild(this)}function Ft(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Lt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qt(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function Ut(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function Bt(t,e,n){var r=dt(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Ht(t,e){return function(){return Bt(this,t,e)}}function Xt(t,e){return function(){return Bt(this,t,e.apply(this,arguments))}}nt.prototype={constructor:nt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},Et.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Gt=[null];function Wt(t,e){this._groups=t,this._parents=e}function Yt(){return new Wt([[document.documentElement]],Gt)}function Kt(t){return"string"==typeof t?new Wt([[document.querySelector(t)]],[document.documentElement]):new Wt([[t]],Gt)}function Qt(t){return Kt(U(t).call(document.documentElement))}function Jt(t){return"string"==typeof t?new Wt([document.querySelectorAll(t)],[document.documentElement]):new Wt([X(t)],Gt)}function Zt(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function te(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ee(){}Wt.prototype=Yt.prototype={constructor:Wt,select:function(t){"function"!=typeof t&&(t=H(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=e[i],l=a.length,u=r[i]=new Array(l),h=0;h<l;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),u[h]=s);return new Wt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return X(t.apply(this,arguments))}}(t):W(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,u=0;u<l;++u)(s=a[u])&&(r.push(t.call(s,s.__data__,u,a)),i.push(s));return new Wt(r,i)},selectChild:function(t){return this.select(null==t?J:function(t){return function(){return Q.call(this.children,t)}}("function"==typeof t?t:K(t)))},selectChildren:function(t){return this.selectAll(null==t?tt:function(t){return function(){return Z.call(this.children,t)}}("function"==typeof t?t:K(t)))},filter:function(t){"function"!=typeof t&&(t=Y(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&l.push(o);return new Wt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,ot);var n,r=e?it:rt,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=o.length,a=new Array(s),l=new Array(s),u=new Array(s),h=0;h<s;++h){var c=i[h],f=o[h],p=f.length,d=st(t.call(c,c&&c.__data__,h,i)),g=d.length,m=l[h]=new Array(g),w=a[h]=new Array(g);r(c,f,m,w,u[h]=new Array(p),d,e);for(var y,v,_=0,b=0;_<g;++_)if(y=m[_]){for(_>=b&&(b=_+1);!(v=w[b])&&++b<g;);y._next=v||null}}return(a=new Wt(a,i))._enter=l,a._exit=u,a},enter:function(){return new Wt(this._enter||this._groups.map(et),this._parents)},exit:function(){return new Wt(this._exit||this._groups.map(et),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var u,h=n[l],c=r[l],f=h.length,p=a[l]=new Array(f),d=0;d<f;++d)(u=h[d]||c[d])&&(p[d]=u);for(;l<i;++l)a[l]=n[l];return new Wt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=at);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,u=i[o]=new Array(l),h=0;h<l;++h)(s=a[h])&&(u[h]=s);u.sort(e)}return new Wt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this},attr:function(t,e){var n=F(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?ut:lt:"function"==typeof e?n.local?pt:ft:n.local?ct:ht)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?gt:"function"==typeof e?wt:mt)(t,e,null==n?"":n)):yt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?vt:"function"==typeof e?bt:_t)(t,e)):this.node()[t]},classed:function(t,e){var n=xt(t+"");if(arguments.length<2){for(var r=Mt(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Ct:e?Nt:At)(n,e))},text:function(t){return arguments.length?this.each(null==t?Rt:("function"==typeof t?Pt:It)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?zt:("function"==typeof t?Tt:Ot)(t)):this.node().innerHTML},raise:function(){return this.each(jt)},lower:function(){return this.each(Dt)},append:function(t){var e="function"==typeof t?t:U(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:U(t),r=null==e?$t:"function"==typeof e?e:H(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Vt)},clone:function(t){return this.select(t?Lt:Ft)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?Ut:qt,r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var l,u=0,h=a.length;u<h;++u)for(r=0,l=a[u];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?Xt:Ht)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};var ne=.7,re=1/ne,ie="\\s*([+-]?\\d+)\\s*",oe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",se="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ae=/^#([0-9a-f]{3,8})$/,le=new RegExp(`^rgb\\(${ie},${ie},${ie}\\)$`),ue=new RegExp(`^rgb\\(${se},${se},${se}\\)$`),he=new RegExp(`^rgba\\(${ie},${ie},${ie},${oe}\\)$`),ce=new RegExp(`^rgba\\(${se},${se},${se},${oe}\\)$`),fe=new RegExp(`^hsl\\(${oe},${se},${se}\\)$`),pe=new RegExp(`^hsla\\(${oe},${se},${se},${oe}\\)$`),de={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ge(){return this.rgb().formatHex()}function me(){return this.rgb().formatRgb()}function we(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ae.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ye(e):3===n?new be(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ve(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ve(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=le.exec(t))?new be(e[1],e[2],e[3],1):(e=ue.exec(t))?new be(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=he.exec(t))?ve(e[1],e[2],e[3],e[4]):(e=ce.exec(t))?ve(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=fe.exec(t))?Ne(e[1],e[2]/100,e[3]/100,1):(e=pe.exec(t))?Ne(e[1],e[2]/100,e[3]/100,e[4]):de.hasOwnProperty(t)?ye(de[t]):"transparent"===t?new be(NaN,NaN,NaN,0):null}function ye(t){return new be(t>>16&255,t>>8&255,255&t,1)}function ve(t,e,n,r){return r<=0&&(t=e=n=NaN),new be(t,e,n,r)}function _e(t,e,n,r){return 1===arguments.length?((i=t)instanceof ee||(i=we(i)),i?new be((i=i.rgb()).r,i.g,i.b,i.opacity):new be):new be(t,e,n,null==r?1:r);var i}function be(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function xe(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}`}function Me(){const t=Ee(this.opacity);return`${1===t?"rgb(":"rgba("}${Se(this.r)}, ${Se(this.g)}, ${Se(this.b)}${1===t?")":`, ${t})`}`}function Ee(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Se(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ke(t){return((t=Se(t))<16?"0":"")+t.toString(16)}function Ne(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Re(t,e,n,r)}function Ae(t){if(t instanceof Re)return new Re(t.h,t.s,t.l,t.opacity);if(t instanceof ee||(t=we(t)),!t)return new Re;if(t instanceof Re)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new Re(s,a,l,t.opacity)}function Ce(t,e,n,r){return 1===arguments.length?Ae(t):new Re(t,e,n,null==r?1:r)}function Re(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ie(t){return(t=(t||0)%360)<0?t+360:t}function Pe(t){return Math.max(0,Math.min(1,t||0))}function ze(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Zt(ee,we,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ge,formatHex:ge,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ae(this).formatHsl()},formatRgb:me,toString:me}),Zt(be,_e,te(ee,{brighter(t){return t=null==t?re:Math.pow(re,t),new be(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ne:Math.pow(ne,t),new be(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new be(Se(this.r),Se(this.g),Se(this.b),Ee(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xe,formatHex:xe,formatHex8:function(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}${ke(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Me,toString:Me})),Zt(Re,Ce,te(ee,{brighter(t){return t=null==t?re:Math.pow(re,t),new Re(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ne:Math.pow(ne,t),new Re(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new be(ze(t>=240?t-240:t+120,i,r),ze(t,i,r),ze(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Re(Ie(this.h),Pe(this.s),Pe(this.l),Ee(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ee(this.opacity);return`${1===t?"hsl(":"hsla("}${Ie(this.h)}, ${100*Pe(this.s)}%, ${100*Pe(this.l)}%${1===t?")":`, ${t})`}`}}));var Oe=t=>()=>t;function Te(t){return 1===(t=+t)?je:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Oe(isNaN(e)?n:e)}}function je(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Oe(isNaN(t)?e:t)}var De=function t(e){var n=Te(e);function r(t,e){var r=n((t=_e(t)).r,(e=_e(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=je(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function $e(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function Ve(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=Xe(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=o[n](t);return s}}function Fe(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Le(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function qe(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Xe(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Ue=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Be=new RegExp(Ue.source,"g");function He(t,e){var n,r,i,o=Ue.lastIndex=Be.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=Ue.exec(t))&&(r=Be.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Le(n,r)})),o=Be.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})}function Xe(t,e){var n,r,i=typeof e;return null==e||"boolean"===i?Oe(e):("number"===i?Le:"string"===i?(n=we(e))?(e=n,De):He:e instanceof we?De:e instanceof Date?Fe:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?Ve:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?qe:Le:$e))(t,e)}function Ge(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var We,Ye=180/Math.PI,Ke={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Qe(t,e,n,r,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Ye,skewX:Math.atan(l)*Ye,scaleX:s,scaleY:a}}function Je(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:Le(t,i)},{i:l-2,x:Le(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Le(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Le(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,l),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:Le(t,n)},{i:a-2,x:Le(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var Ze,tn,en=Je(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ke:Qe(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),nn=Je(function(t){return null==t?Ke:(We||(We=document.createElementNS("http://www.w3.org/2000/svg","g")),We.setAttribute("transform",t),(t=We.transform.baseVal.consolidate())?Qe((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Ke)},", ",")",")"),rn=0,on=0,sn=0,an=0,ln=0,un=0,hn="object"==typeof performance&&performance.now?performance:Date,cn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function fn(){return ln||(cn(pn),ln=hn.now()+un)}function pn(){ln=0}function dn(){this._call=this._time=this._next=null}function gn(t,e,n){var r=new dn;return r.restart(t,e,n),r}function mn(){fn(),++rn;for(var t,e=Ze;e;)(t=ln-e._time)>=0&&e._call.call(void 0,t),e=e._next;--rn}function wn(){ln=(an=hn.now())+un,rn=on=0;try{mn()}finally{rn=0,function(){var t,e,n=Ze,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ze=e);tn=t,vn(r)}(),ln=0}}function yn(){var t=hn.now(),e=t-an;e>1e3&&(un-=e,an=t)}function vn(t){rn||(on&&(on=clearTimeout(on)),t-ln>24?(t<1/0&&(on=setTimeout(wn,t-hn.now()-un)),sn&&(sn=clearInterval(sn))):(sn||(an=hn.now(),sn=setInterval(yn,1e3)),rn=1,cn(wn)))}function _n(t,e,n){var r=new dn;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r}dn.prototype=gn.prototype={constructor:dn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?fn():+n)+(null==e?0:+e),this._next||tn===this||(tn?tn._next=this:Ze=this,tn=this),this._call=t,this._time=n,vn()},stop:function(){this._call&&(this._call=null,this._time=1/0,vn())}};var bn=O("start","end","cancel","interrupt"),xn=[];function Mn(t,e,n,r,i,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}function s(o){var u,h,c,f;if(1!==n.state)return l();for(u in i)if((f=i[u]).name===n.name){if(3===f.state)return _n(s);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[u])}if(_n(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(o))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(c=n.tween.length),u=0,h=-1;u<c;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++h]=f);r.length=h+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=gn(o,0,n.time)}(t,n,{name:e,index:r,group:i,on:bn,tween:xn,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function En(t,e){var n=kn(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Sn(t,e){var n=kn(t,e);if(n.state>3)throw new Error("too late; already running");return n}function kn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Nn(t,e){var n,r,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete t.__transition}}function An(t,e){var n,r;return function(){var i=Sn(this,t),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function Cn(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=Sn(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=a;break}l===u&&i.push(a)}o.tween=i}}function Rn(t,e,n){var r=t._id;return t.each(function(){var t=Sn(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return kn(t,r).value[e]}}function In(t,e){var n;return("number"==typeof e?Le:e instanceof we?De:(n=we(e))?(e=n,De):He)(t,e)}function Pn(t){return function(){this.removeAttribute(t)}}function zn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function On(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function Tn(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function jn(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttribute(t)}}function Dn(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function $n(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function Vn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function Fn(t,e){return function(){En(this,t).delay=+e.apply(this,arguments)}}function Ln(t,e){return e=+e,function(){En(this,t).delay=e}}function qn(t,e){return function(){Sn(this,t).duration=+e.apply(this,arguments)}}function Un(t,e){return e=+e,function(){Sn(this,t).duration=e}}var Bn=Yt.prototype.constructor;function Hn(t){return function(){this.style.removeProperty(t)}}var Xn=0;function Gn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Wn(){return++Xn}var Yn=Yt.prototype;function Kn(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Gn.prototype={constructor:Gn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=H(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,l,u=r[s],h=u.length,c=o[s]=new Array(h),f=0;f<h;++f)(a=u[f])&&(l=t.call(a,a.__data__,f,u))&&("__data__"in a&&(l.__data__=a.__data__),c[f]=l,Mn(c[f],e,n,f,c,kn(a,n)));return new Gn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=W(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l,u=r[a],h=u.length,c=0;c<h;++c)if(l=u[c]){for(var f,p=t.call(l,l.__data__,c,u),d=kn(l,n),g=0,m=p.length;g<m;++g)(f=p[g])&&Mn(f,e,n,g,p,d);o.push(p),s.push(l)}return new Gn(o,s,e,n)},selectChild:Yn.selectChild,selectChildren:Yn.selectChildren,filter:function(t){"function"!=typeof t&&(t=Y(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&l.push(o);return new Gn(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,u=e[a],h=n[a],c=u.length,f=s[a]=new Array(c),p=0;p<c;++p)(l=u[p]||h[p])&&(f[p]=l);for(;a<r;++a)s[a]=e[a];return new Gn(s,this._parents,this._name,this._id)},selection:function(){return new Bn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Wn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,u=0;u<l;++u)if(s=a[u]){var h=kn(s,e);Mn(s,t,n,u,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Gn(r,this._parents,t,n)},call:Yn.call,nodes:Yn.nodes,node:Yn.node,size:Yn.size,empty:Yn.empty,each:Yn.each,on:function(t,e){var n=this._id;return arguments.length<2?kn(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?En:Sn;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}(n,t,e))},attr:function(t,e){var n=F(t),r="transform"===n?nn:In;return this.attrTween(t,"function"==typeof e?(n.local?Dn:jn)(n,r,Rn(this,"attr."+t,e)):null==e?(n.local?zn:Pn)(n):(n.local?Tn:On)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=F(t);return this.tween(n,(r.local?$n:Vn)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?en:In;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=yt(this,t),s=(this.style.removeProperty(t),yt(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}(t,r)).on("end.style."+t,Hn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var s=yt(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=yt(this,t)),s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a))}}(t,r,Rn(this,"style."+t,e))).each(function(t,e){var n,r,i,o,s="style."+e,a="end."+s;return function(){var l=Sn(this,t),u=l.on,h=null==l.value[s]?o||(o=Hn(e)):void 0;u===n&&i===h||(r=(n=u).copy()).on(a,i=h),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var s=yt(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Rn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=kn(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?An:Cn)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Fn:Ln)(e,t)):kn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?qn:Un)(e,t)):kn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Sn(this,t).ease=e}}(e,t)):kn(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Sn(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},l={value:function(){0===--i&&o()}};n.each(function(){var n=Sn(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e}),0===i&&o()})},[Symbol.iterator]:Yn[Symbol.iterator]};var Qn={time:null,delay:0,duration:250,ease:Kn};function Jn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Zn(t,e){if(!isFinite(t)||0===t)return null;var n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function tr(t){return(t=Zn(Math.abs(t)))?t[1]:NaN}Yt.prototype.interrupt=function(t){return this.each(function(){Nn(this,t)})},Yt.prototype.transition=function(t){var e,n;t instanceof Gn?(e=t._id,t=t._name):(e=Wn(),(n=Qn).time=fn(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,u=0;u<l;++u)(s=a[u])&&Mn(s,t,e,u,a,n||Jn(s,e));return new Gn(r,this._parents,t,e)};var er,nr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rr(t){if(!(e=nr.exec(t)))throw new Error("invalid format: "+t);var e;return new ir({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ir(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function or(t,e){var n=Zn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}rr.prototype=ir.prototype,ir.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var sr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>or(100*t,e),r:or,s:function(t,e){var n=Zn(t,e);if(!n)return er=void 0,t.toPrecision(e);var r=n[0],i=n[1],o=i-(er=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Zn(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ar(t){return t}var lr,ur,hr,cr=Array.prototype.map,fr=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function pr(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ar:(e=cr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(t.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?ar:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(cr.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function c(t,e){var n=(t=rr(t)).fill,c=t.align,f=t.sign,p=t.symbol,d=t.zero,g=t.width,m=t.comma,w=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):sr[v]||(void 0===w&&(w=12),y=!0,v="g"),(d||"0"===n&&"="===c)&&(d=!0,n="0",c="=");var _=(e&&void 0!==e.prefix?e.prefix:"")+("$"===p?i:"#"===p&&/[boxX]/.test(v)?"0"+v.toLowerCase():""),b=("$"===p?o:/[%p]/.test(v)?l:"")+(e&&void 0!==e.suffix?e.suffix:""),x=sr[v],M=/[defgprs%]/.test(v);function E(t){var e,i,o,l=_,p=b;if("c"===v)p=x(t)+p,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?h:x(Math.abs(t),w),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),E&&0===+t&&"+"!==f&&(E=!1),l=(E?"("===f?f:u:"-"===f||"("===f?"":f)+l,p=("s"!==v||isNaN(t)||void 0===er?"":fr[8+er/3])+p+(E&&"("===f?")":""),M)for(e=-1,i=t.length;++e<i;)if(48>(o=t.charCodeAt(e))||o>57){p=(46===o?s+t.slice(e+1):t.slice(e))+p,t=t.slice(0,e);break}}m&&!d&&(t=r(t,1/0));var S=l.length+t.length+p.length,k=S<g?new Array(g-S+1).join(n):"";switch(m&&d&&(t=r(k+t,k.length?g-p.length:1/0),k=""),c){case"<":t=l+t+p+k;break;case"=":t=l+k+t+p;break;case"^":t=k.slice(0,S=k.length>>1)+l+t+p+k.slice(S);break;default:t=k+l+t+p}return a(t)}return w=void 0===w?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w)),E.toString=function(){return t+""},E}return{format:c,formatPrefix:function(t,e){var n=3*Math.max(-8,Math.min(8,Math.floor(tr(e)/3))),r=Math.pow(10,-n),i=c(((t=rr(t)).type="f",t),{suffix:fr[8+n/3]});return function(t){return i(r*t)}}}}function dr(t){return Math.max(0,-tr(Math.abs(t)))}function gr(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(tr(e)/3)))-tr(Math.abs(t)))}function mr(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,tr(e)-tr(t))+1}function wr(t,e){return t.parent===e.parent?1:2}function yr(t,e){return t+e.x}function vr(t,e){return Math.max(t,e.y)}function _r(){var t=wr,e=1,n=1,r=!1;function i(i){var o,s=0;i.eachAfter(function(e){var n=e.children;n?(e.x=function(t){return t.reduce(yr,0)/t.length}(n),e.y=function(t){return 1+t.reduce(vr,0)}(n)):(e.x=o?s+=t(e,o):0,e.y=0,o=e)});var a=function(t){for(var e;e=t.children;)t=e[0];return t}(i),l=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),u=a.x-t(a,l)/2,h=l.x+t(l,a)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-u)/(h-u)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}function br(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function xr(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Er)):void 0===e&&(e=Mr);for(var n,r,i,o,s,a=new Nr(t),l=[a];n=l.pop();)if((i=e(n.data))&&(s=(i=Array.from(i)).length))for(n.children=i,o=s-1;o>=0;--o)l.push(r=i[o]=new Nr(i[o])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(kr)}function Mr(t){return t.children}function Er(t){return Array.isArray(t)?t[1]:null}function Sr(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function kr(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Nr(t){this.data=t,this.depth=this.height=0,this.parent=null}function Ar(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}lr=pr({thousands:",",grouping:[3],currency:["$",""]}),ur=lr.format,hr=lr.formatPrefix,Nr.prototype=xr.prototype={constructor:Nr,count:function(){return this.eachAfter(br)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,s=[o],a=[],l=-1;o=s.pop();)if(a.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)s.push(n[r]);for(;o=a.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],s=-1;i=o.pop();)if(t.call(e,i,++s,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return xr(this).eachBefore(Sr)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};const Cr=Symbol("implicit");function Rr(){var t=new l,e=[],n=[],r=Cr;function i(i){let o=t.get(i);if(void 0===o){if(r!==Cr)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new l;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Rr(e,n).unknown(r)},Ar.apply(i,arguments),i}function Ir(){var t,e,n=Rr().unknown(void 0),r=n.domain,i=n.range,o=0,s=1,a=!1,l=0,u=0,h=.5;function c(){var n=r().length,c=s<o,f=c?s:o,p=c?o:s;t=(p-f)/Math.max(1,n-l+2*u),a&&(t=Math.floor(t)),f+=(p-f-t*(n-l))*h,e=t*(1-l),a&&(f=Math.round(f),e=Math.round(e));var d=b(n).map(function(e){return f+t*e});return i(c?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?([o,s]=t,o=+o,s=+s,c()):[o,s]},n.rangeRound=function(t){return[o,s]=t,o=+o,s=+s,a=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,c()):a},n.padding=function(t){return arguments.length?(l=Math.min(1,u=+t),c()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),c()):l},n.paddingOuter=function(t){return arguments.length?(u=+t,c()):u},n.align=function(t){return arguments.length?(h=Math.max(0,Math.min(1,t)),c()):h},n.copy=function(){return Ir(r(),[o,s]).round(a).paddingInner(l).paddingOuter(u).align(h)},Ar.apply(c(),arguments)}function Pr(t){return+t}var zr=[0,1];function Or(t){return t}function Tr(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function jr(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=Tr(i,r),o=n(s,o)):(r=Tr(r,i),o=n(o,s)),function(t){return o(r(t))}}function Dr(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Tr(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(e){var n=o(t,e,1,r)-1;return s[n](i[n](e))}}function $r(){var t,e,n,r,i,o,s=zr,a=zr,l=Xe,u=Or;function h(){var t,e,n,l=Math.min(s.length,a.length);return u!==Or&&(t=s[0],e=s[l-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),r=l>2?Dr:jr,i=o=null,c}function c(e){return null==e||isNaN(e=+e)?n:(i||(i=r(s.map(t),a,l)))(t(u(e)))}return c.invert=function(n){return u(e((o||(o=r(a,s.map(t),Le)))(n)))},c.domain=function(t){return arguments.length?(s=Array.from(t,Pr),h()):s.slice()},c.range=function(t){return arguments.length?(a=Array.from(t),h()):a.slice()},c.rangeRound=function(t){return a=Array.from(t),l=Ge,h()},c.clamp=function(t){return arguments.length?(u=!!t||Or,h()):u!==Or},c.interpolate=function(t){return arguments.length?(l=t,h()):l},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,r){return t=n,e=r,h()}}function Vr(t,e,n,r){var i,o=w(t,e,n);switch((r=rr(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=gr(o,s))||(r.precision=i),hr(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=mr(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=dr(o))||(r.precision=i-2*("%"===r.type))}return ur(r)}function Fr(){var t=$r()(Or,Or);return t.copy=function(){return e=t,Fr().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},Ar.apply(t,arguments),function(t){var e=t.domain;return t.ticks=function(t){var n=e();return g(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Vr(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),s=0,a=o.length-1,l=o[s],u=o[a],h=10;for(u<l&&(i=l,l=u,u=i,i=s,s=a,a=i);h-- >0;){if((i=m(l,u,n))===r)return o[s]=l,o[a]=u,e(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}(t)}function Lr(t,e,n){this.k=t,this.x=e,this.y=n}Lr.prototype={constructor:Lr,scale:function(t){return 1===t?this:new Lr(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Lr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Lr.prototype;var qr=Object.freeze({__proto__:null,FormatSpecifier:ir,InternMap:l,Node:Nr,ZoomTransform:Lr,ascending:e,axisBottom:I,axisLeft:P,axisTop:R,bisect:o,bisectRight:o,bisector:r,cluster:_r,color:we,create:Qt,creator:U,descending:n,deviation:function(t,e){const n=s(t,e);return n?Math.sqrt(n):n},dispatch:O,easeCubic:Kn,easeCubicInOut:Kn,extent:a,get format(){return ur},formatLocale:pr,get formatPrefix(){return hr},formatSpecifier:rr,hierarchy:xr,hsl:Ce,interpolate:Xe,interpolateDate:Fe,interpolateNumber:Le,interpolateNumberArray:$e,interpolateObject:qe,interpolateRgb:De,interpolateRound:Ge,interpolateString:He,interpolateTransformCss:en,interpolateTransformSvg:nn,interrupt:Nn,matcher:Y,max:y,mean:_,min:v,namespace:F,namespaces:V,now:fn,precisionFixed:dr,precisionPrefix:gr,precisionRound:mr,range:b,rgb:_e,scaleBand:Ir,scaleImplicit:Cr,scaleLinear:Fr,scaleOrdinal:Rr,select:Kt,selectAll:Jt,selection:Yt,selector:H,selectorAll:W,style:yt,tickFormat:Vr,tickIncrement:m,tickStep:w,ticks:g,timeout:_n,timer:gn,timerFlush:mn,variance:s,window:dt}),Ur="$";function Br(){}function Hr(t,e){var n=new Br;if(t instanceof Br)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var s in t)n.set(s,t[s]);return n}function Xr(){}Br.prototype=Hr.prototype={constructor:Br,has:function(t){return Ur+t in this},get:function(t){return this[Ur+t]},set:function(t,e){return this[Ur+t]=e,this},remove:function(t){var e=Ur+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Ur&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Ur&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Ur&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Ur&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Ur&&++t;return t},empty:function(){for(var t in this)if(t[0]===Ur)return!1;return!0},each:function(t){for(var e in this)e[0]===Ur&&t(this[e],e.slice(1),this)}};var Gr=Hr.prototype;Xr.prototype={constructor:Xr,has:Gr.has,add:function(t){return this[Ur+(t+="")]=t,this},remove:Gr.remove,clear:Gr.clear,values:Gr.keys,size:Gr.size,empty:Gr.empty,each:Gr.each};var Wr="http://www.w3.org/1999/xhtml",Yr={svg:"http://www.w3.org/2000/svg",xhtml:Wr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Kr(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Yr.hasOwnProperty(e)?{space:Yr[e],local:t}:t}function Qr(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Wr&&e.documentElement.namespaceURI===Wr?e.createElement(t):e.createElementNS(n,t)}}function Jr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Zr(t){var e=Kr(t);return(e.local?Jr:Qr)(e)}function ti(){}function ei(t){return null==t?ti:function(){return this.querySelector(t)}}function ni(){return[]}function ri(t){return new Array(t.length)}function ii(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ii.prototype={constructor:ii,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function oi(t,e,n,r,i,o){for(var s,a=0,l=e.length,u=o.length;a<u;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new ii(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function si(t,e,n,r,i,o,s){var a,l,u,h={},c=e.length,f=o.length,p=new Array(c);for(a=0;a<c;++a)(l=e[a])&&(p[a]=u="$"+s.call(l,l.__data__,a,e),u in h?i[a]=l:h[u]=l);for(a=0;a<f;++a)(l=h[u="$"+s.call(t,o[a],a,o)])?(r[a]=l,l.__data__=o[a],h[u]=null):n[a]=new ii(t,o[a]);for(a=0;a<c;++a)(l=e[a])&&h[p[a]]===l&&(i[a]=l)}function ai(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function li(t){return function(){this.removeAttribute(t)}}function ui(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hi(t,e){return function(){this.setAttribute(t,e)}}function ci(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function fi(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function pi(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function di(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gi(t){return function(){this.style.removeProperty(t)}}function mi(t,e,n){return function(){this.style.setProperty(t,e,n)}}function wi(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function yi(t){return function(){delete this[t]}}function vi(t,e){return function(){this[t]=e}}function _i(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function bi(t){return t.trim().split(/^|\s+/)}function xi(t){return t.classList||new Mi(t)}function Mi(t){this._node=t,this._names=bi(t.getAttribute("class")||"")}function Ei(t,e){for(var n=xi(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Si(t,e){for(var n=xi(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function ki(t){return function(){Ei(this,t)}}function Ni(t){return function(){Si(this,t)}}function Ai(t,e){return function(){(e.apply(this,arguments)?Ei:Si)(this,t)}}function Ci(){this.textContent=""}function Ri(t){return function(){this.textContent=t}}function Ii(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Pi(){this.innerHTML=""}function zi(t){return function(){this.innerHTML=t}}function Oi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ti(){this.nextSibling&&this.parentNode.appendChild(this)}function ji(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Di(){return null}function $i(){var t=this.parentNode;t&&t.removeChild(this)}function Vi(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Fi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}Mi.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Li={};"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Li={mouseenter:"mouseover",mouseleave:"mouseout"}));function qi(t,e,n){return t=Ui(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Ui(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function Bi(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function Hi(t,e,n){var r=Li.hasOwnProperty(t.type)?qi:Ui;return function(i,o,s){var a,l=this.__on,u=r(e,o,s);if(l)for(var h=0,c=l.length;h<c;++h)if((a=l[h]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=u,a.capture=n),void(a.value=e);this.addEventListener(t.type,u,n),a={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(a):this.__on=[a]}}function Xi(t,e,n){var r=di(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Gi(t,e){return function(){return Xi(this,t,e)}}function Wi(t,e){return function(){return Xi(this,t,e.apply(this,arguments))}}var Yi=[null];function Ki(t,e){this._groups=t,this._parents=e}function Qi(){return new Ki([[document.documentElement]],Yi)}function Ji(t){return"string"==typeof t?new Ki([[document.querySelector(t)]],[document.documentElement]):new Ki([[t]],Yi)}function Zi(){var t=function(){return"n"},e=function(){return[0,0]},n=function(){return" "},r=document.body,i=c(),o=null,s=null,a=null;function l(t){o=function(t){var e=t.node();return e?"svg"===e.tagName.toLowerCase()?e:e.ownerSVGElement:null}(t),o&&(s=o.createSVGPoint(),r.appendChild(i))}l.show=function(){var i=Array.prototype.slice.call(arguments);i[i.length-1]instanceof SVGElement&&(a=i.pop());var o,s=n.apply(this,i),c=e.apply(this,i),p=t.apply(this,i),d=f(),g=h.length,m=document.documentElement.scrollTop||r.scrollTop,w=document.documentElement.scrollLeft||r.scrollLeft;for(d.html(s).style("opacity",1).style("pointer-events","all");g--;)d.classed(h[g],!1);return o=u.get(p).apply(this),d.classed(p,!0).style("top",o.top+c[0]+m+"px").style("left",o.left+c[1]+w+"px"),l},l.hide=function(){return f().style("opacity",0).style("pointer-events","none"),l},l.attr=function(t,e){if(arguments.length<2&&"string"==typeof t)return f().attr(t);var n=Array.prototype.slice.call(arguments);return Qi.prototype.attr.apply(f(),n),l},l.style=function(t,e){if(arguments.length<2&&"string"==typeof t)return f().style(t);var n=Array.prototype.slice.call(arguments);return Qi.prototype.style.apply(f(),n),l},l.direction=function(e){return arguments.length?(t=null==e?e:d(e),l):t},l.offset=function(t){return arguments.length?(e=null==t?t:d(t),l):e},l.html=function(t){return arguments.length?(n=null==t?t:d(t),l):n},l.rootElement=function(t){return arguments.length?(r=null==t?t:d(t),l):r},l.destroy=function(){return i&&(f().remove(),i=null),l};var u=Hr({n:function(){var t=p(this);return{top:t.n.y-i.offsetHeight,left:t.n.x-i.offsetWidth/2}},s:function(){var t=p(this);return{top:t.s.y,left:t.s.x-i.offsetWidth/2}},e:function(){var t=p(this);return{top:t.e.y-i.offsetHeight/2,left:t.e.x}},w:function(){var t=p(this);return{top:t.w.y-i.offsetHeight/2,left:t.w.x-i.offsetWidth}},nw:function(){var t=p(this);return{top:t.nw.y-i.offsetHeight,left:t.nw.x-i.offsetWidth}},ne:function(){var t=p(this);return{top:t.ne.y-i.offsetHeight,left:t.ne.x}},sw:function(){var t=p(this);return{top:t.sw.y,left:t.sw.x-i.offsetWidth}},se:function(){var t=p(this);return{top:t.se.y,left:t.se.x}}}),h=u.keys();function c(){var t=Ji(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function f(){return null==i&&(i=c(),r.appendChild(i)),Ji(i)}function p(t){for(var e=a||t;null==e.getScreenCTM&&null!=e.parentNode;)e=e.parentNode;var n={},r=e.getScreenCTM(),i=e.getBBox(),o=i.width,l=i.height,u=i.x,h=i.y;return s.x=u,s.y=h,n.nw=s.matrixTransform(r),s.x+=o,n.ne=s.matrixTransform(r),s.y+=l,n.se=s.matrixTransform(r),s.x-=o,n.sw=s.matrixTransform(r),s.y-=l/2,n.w=s.matrixTransform(r),s.x+=o,n.e=s.matrixTransform(r),s.x-=o/2,s.y-=l/2,n.n=s.matrixTransform(r),s.y+=l,n.s=s.matrixTransform(r),n}function d(t){return"function"==typeof t?t:function(){return t}}return l}function to(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r]);return n}function eo(t,e){return Math.sqrt(to(t,e))}function no(t,e){const n=function(t){const e=[];for(let n=0;n<t;n++){const n=[];e.push(n);for(let e=0;e<t;e++)n.push(0)}return e}(t.length);for(let r=0;r<t.length;r++)for(let i=0;i<=r;i++)n[r][i]=e(t[r],t[i]),n[i][r]=n[r][i];return n}function ro(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function io(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if("function"==typeof e){var n=function t(){var n=!1;try{n=this instanceof t}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})}),n}Ki.prototype=Qi.prototype={constructor:Ki,select:function(t){"function"!=typeof t&&(t=ei(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=e[i],l=a.length,u=r[i]=new Array(l),h=0;h<l;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),u[h]=s);return new Ki(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?ni:function(){return this.querySelectorAll(t)}}(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,u=0;u<l;++u)(s=a[u])&&(r.push(t.call(s,s.__data__,u,a)),i.push(s));return new Ki(r,i)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&l.push(o);return new Ki(r,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),h=-1,this.each(function(t){d[++h]=t}),d;var n,r=e?si:oi,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=o.length,a=new Array(s),l=new Array(s),u=new Array(s),h=0;h<s;++h){var c=i[h],f=o[h],p=f.length,d=t.call(c,c&&c.__data__,h,i),g=d.length,m=l[h]=new Array(g),w=a[h]=new Array(g);r(c,f,m,w,u[h]=new Array(p),d,e);for(var y,v,_=0,b=0;_<g;++_)if(y=m[_]){for(_>=b&&(b=_+1);!(v=w[b])&&++b<g;);y._next=v||null}}return(a=new Ki(a,i))._enter=l,a._exit=u,a},enter:function(){return new Ki(this._enter||this._groups.map(ri),this._parents)},exit:function(){return new Ki(this._exit||this._groups.map(ri),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,u=e[a],h=n[a],c=u.length,f=s[a]=new Array(c),p=0;p<c;++p)(l=u[p]||h[p])&&(f[p]=l);for(;a<r;++a)s[a]=e[a];return new Ki(s,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=ai);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,u=i[o]=new Array(l),h=0;h<l;++h)(s=a[h])&&(u[h]=s);u.sort(e)}return new Ki(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this},attr:function(t,e){var n=Kr(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?ui:li:"function"==typeof e?n.local?pi:fi:n.local?ci:hi)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?gi:"function"==typeof e?wi:mi)(t,e,null==n?"":n)):function(t,e){return t.style.getPropertyValue(e)||di(t).getComputedStyle(t,null).getPropertyValue(e)}(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?yi:"function"==typeof e?_i:vi)(t,e)):this.node()[t]},classed:function(t,e){var n=bi(t+"");if(arguments.length<2){for(var r=xi(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Ai:e?ki:Ni)(n,e))},text:function(t){return arguments.length?this.each(null==t?Ci:("function"==typeof t?Ii:Ri)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Pi:("function"==typeof t?Oi:zi)(t)):this.node().innerHTML},raise:function(){return this.each(Ti)},lower:function(){return this.each(ji)},append:function(t){var e="function"==typeof t?t:Zr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:Zr(t),r=null==e?Di:"function"==typeof e?e:ei(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each($i)},clone:function(t){return this.select(t?Fi:Vi)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?Hi:Bi,null==n&&(n=!1),r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var l,u=0,h=a.length;u<h;++u)for(r=0,l=a[u];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?Wi:Gi)(t,e))}};var oo={};const so=Object.prototype.toString;function ao(t){const e=so.call(t);return e.endsWith("Array]")&&!e.includes("Big")}var lo=io(Object.freeze({__proto__:null,isAnyArray:ao}));var uo,ho=io(Object.freeze({__proto__:null,default:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ao(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!ao(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ao(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[r],a=r+1;a<o;a++)t[a]<s&&(s=t[a]);return s}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ao(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[r],a=r+1;a<o;a++)t[a]>s&&(s=t[a]);return s}(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,s=void 0===o?n.autoMinMax?r:0:o,a=n.max,l=void 0===a?n.autoMinMax?i:1:a;if(s>=l)throw new RangeError("min option must be smaller than max option");for(var u=(l-s)/(i-r),h=0;h<t.length;h++)e[h]=(t[h]-r)*u+s;return e}}));function co(){if(uo)return oo;uo=1,Object.defineProperty(oo,"__esModule",{value:!0});var t=lo,e=ho;const n=" ".repeat(2),r=" ".repeat(4);function i(t,e={}){const{maxRows:i=15,maxColumns:s=10,maxNumSize:a=8,padMinus:l="auto"}=e;return`${t.constructor.name} {\n${n}[\n${r}${function(t,e,n,i,s){const{rows:a,columns:l}=t,u=Math.min(a,e),h=Math.min(l,n),c=[];if("auto"===s){s=!1;t:for(let e=0;e<u;e++)for(let n=0;n<h;n++)if(t.get(e,n)<0){s=!0;break t}}for(let e=0;e<u;e++){let n=[];for(let r=0;r<h;r++)n.push(o(t.get(e,r),i,s));c.push(`${n.join(" ")}`)}h!==l&&(c[c.length-1]+=` ... ${l-n} more columns`);u!==a&&c.push(`... ${a-e} more rows`);return c.join(`\n${r}`)}(t,i,s,a,l)}\n${n}]\n${n}rows: ${t.rows}\n${n}columns: ${t.columns}\n}`}function o(t,e,n){return(t>=0&&n?` ${s(t,e-1)}`:s(t,e)).padEnd(e)}function s(t,e){let n=t.toString();if(n.length<=e)return n;let r=t.toFixed(e);if(r.length>e&&(r=t.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function a(t,e,n){let r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function l(t,e,n){let r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function u(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function h(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function c(e,n){if(!t.isAnyArray(n))throw new TypeError("row indices must be an array");for(let t=0;t<n.length;t++)if(n[t]<0||n[t]>=e.rows)throw new RangeError("row indices are out of range")}function f(e,n){if(!t.isAnyArray(n))throw new TypeError("column indices must be an array");for(let t=0;t<n.length;t++)if(n[t]<0||n[t]>=e.columns)throw new RangeError("column indices are out of range")}function p(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(g("startRow",e),g("endRow",n),g("startColumn",r),g("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function d(t,e=0){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function g(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function m(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class w{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let r=new _(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)r.set(i,t,n[i*e+t]);return r}static rowVector(t){let e=new _(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new _(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new _(t,e)}static ones(t,e){return new _(t,e).fill(1)}static rand(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:r=Math.random}=n;let i=new _(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)i.set(n,t,r());return i}static randInt(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:r=0,max:i=1e3,random:o=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(r>=i)throw new RangeError("min must be smaller than max");let s=i-r,a=new _(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++){let e=r+Math.round(o()*s);a.set(n,t,e)}return a}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);let r=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<r;t++)i.set(t,t,n);return i}static diag(t,e,n){let r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);let i=Math.min(r,e,n),o=this.zeros(e,n);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new _(n,r);for(let o=0;o<n;o++)for(let n=0;n<r;n++)i.set(o,n,Math.min(t.get(o,n),e.get(o,n)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new this(n,r);for(let o=0;o<n;o++)for(let n=0;n<r;n++)i.set(o,n,Math.max(t.get(o,n),e.get(o,n)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new _(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(r=!1);t++}return r}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let r=e;for(let i=e;i<t.rows;i++)t.get(i,n)>t.get(r,n)&&(r=i);if(0===t.get(r,n))n++;else{t.swapRows(e,r);let i=t.get(e,n);for(let r=n;r<t.columns;r++)t.set(e,r,t.get(e,r)/i);for(let r=e+1;r<t.rows;r++){let i=t.get(r,n)/t.get(e,n);t.set(r,n,0);for(let o=n+1;o<t.columns;o++)t.set(r,o,t.get(r,o)-t.get(e,o)*i)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;for(;r>=0;)if(0===t.maxRow(r))r--;else{let i=0,o=!1;for(;i<n&&!1===o;)1===t.get(r,i)?o=!0:i++;for(let n=0;n<r;n++){let o=t.get(n,i);for(let s=i;s<e;s++){let e=t.get(n,s)-o*t.get(r,s);t.set(n,s,e)}}r--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new _(this.rows*e,this.columns*n);for(let t=0;t<e;t++)for(let e=0;e<n;e++)r.setSubMatrix(this,this.rows*t,this.columns*e);return r}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){a(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return _.rowVector(this.getRow(t))}setRow(t,e){a(this,t),e=u(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){a(this,t),a(this,e);for(let n=0;n<this.columns;n++){let r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){l(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return _.columnVector(this.getColumn(t))}setColumn(t,e){l(this,t),e=h(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l(this,t),l(this,e);for(let n=0;n<this.rows;n++){let r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=h(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){a(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){m(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){m(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){if(a(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){a(this,t),m(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){if(a(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){a(this,t),m(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l(this,t),m(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l(this,t),m(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=_.checkMatrix(t);let e=this.rows,n=this.columns,r=t.columns,i=new _(e,r),o=new Float64Array(n);for(let s=0;s<r;s++){for(let e=0;e<n;e++)o[e]=t.get(e,s);for(let t=0;t<e;t++){let e=0;for(let r=0;r<n;r++)e+=this.get(t,r)*o[r];i.set(t,s,e)}}return i}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=_.eye(this.rows),n=this;for(let r=t;r>=1;r/=2)1&r&&(e=e.mmul(n)),n=n.mmul(n);return e}strassen2x2(t){t=_.checkMatrix(t);let e=new _(2,2);const n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),l=this.get(1,1),u=t.get(1,1),h=(n+l)*(r+u),c=(s+l)*r,f=n*(o-u),p=l*(a-r),d=(n+i)*u,g=h+p-d+(i-l)*(a+u),m=f+d,w=c+p,y=h-c+f+(s-n)*(r+o);return e.set(0,0,g),e.set(0,1,m),e.set(1,0,w),e.set(1,1,y),e}strassen3x3(t){t=_.checkMatrix(t);let e=new _(3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),l=this.get(2,0),u=this.get(2,1),h=this.get(2,2),c=t.get(0,0),f=t.get(0,1),p=t.get(0,2),d=t.get(1,0),g=t.get(1,1),m=t.get(1,2),w=t.get(2,0),y=t.get(2,1),v=t.get(2,2),b=(n-o)*(-f+g),x=(-n+o+s)*(c-f+g),M=(o+s)*(-c+f),E=n*c,S=(-n+l+u)*(c-p+m),k=(-n+l)*(p-m),N=(l+u)*(-c+p),A=(-i+u+h)*(g+w-y),C=(i-h)*(g-y),R=i*w,I=(u+h)*(-w+y),P=(-i+s+a)*(m+w-v),z=(i-a)*(m-v),O=(s+a)*(-w+v),T=E+R+r*d,j=(n+r+i-o-s-u-h)*g+x+M+E+A+R+I,D=E+S+N+(n+r+i-s-a-l-u)*m+R+P+O,$=b+s*(-c+f+d-g-m-w+v)+x+E+R+P+z,V=b+x+M+E+a*y,F=R+P+z+O+o*p,L=E+S+k+u*(-c+p+d-g-m-w+y)+A+C+R,q=A+C+R+I+l*f,U=E+S+k+N+h*v;return e.set(0,0,T),e.set(0,1,j),e.set(0,2,D),e.set(1,0,$),e.set(1,1,V),e.set(1,2,F),e.set(2,0,L),e.set(2,1,q),e.set(2,2,U),e}mmulStrassen(t){t=_.checkMatrix(t);let e=this.clone(),n=e.rows,r=e.columns,i=t.rows,o=t.columns;function s(t,e,n){let r=t.rows,i=t.columns;if(r===e&&i===n)return t;{let r=w.zeros(e,n);return r=r.setSubMatrix(t,0,0),r}}r!==i&&console.warn(`Multiplying ${n} x ${r} and ${i} x ${o} matrix: dimensions do not match.`);let a=Math.max(n,i),l=Math.max(r,o);return e=s(e,a,l),function t(e,n,r,i){if(r<=512||i<=512)return e.mmul(n);r%2==1&&i%2==1?(e=s(e,r+1,i+1),n=s(n,r+1,i+1)):r%2==1?(e=s(e,r+1,i),n=s(n,r+1,i)):i%2==1&&(e=s(e,r,i+1),n=s(n,r,i+1));let o=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),l=e.subMatrix(0,o-1,0,a-1),u=n.subMatrix(0,o-1,0,a-1),h=e.subMatrix(0,o-1,a,e.columns-1),c=n.subMatrix(0,o-1,a,n.columns-1),f=e.subMatrix(o,e.rows-1,0,a-1),p=n.subMatrix(o,n.rows-1,0,a-1),d=e.subMatrix(o,e.rows-1,a,e.columns-1),g=n.subMatrix(o,n.rows-1,a,n.columns-1),m=t(w.add(l,d),w.add(u,g),o,a),y=t(w.add(f,d),u,o,a),v=t(l,w.sub(c,g),o,a),_=t(d,w.sub(p,u),o,a),b=t(w.add(l,h),g,o,a),x=t(w.sub(f,l),w.add(u,c),o,a),M=t(w.sub(h,d),w.add(p,g),o,a),E=w.add(m,_);E.sub(b),E.add(M);let S=w.add(v,b),k=w.add(y,_),N=w.sub(m,y);N.add(v),N.add(x);let A=w.zeros(2*E.rows,2*E.columns);return A=A.setSubMatrix(E,0,0),A=A.setSubMatrix(S,E.rows,0),A=A.setSubMatrix(k,0,E.columns),A=A.setSubMatrix(N,E.rows,E.columns),A.subMatrix(0,r-1,0,i-1)}(e,t=s(t,a,l),a,l)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:n=0,max:r=1}=t;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(n>=r)throw new RangeError("min must be smaller than max");let i=new _(this.rows,this.columns);for(let t=0;t<this.rows;t++){const o=this.getRow(t);o.length>0&&e(o,{min:n,max:r,output:o}),i.setRow(t,o)}return i}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:n=0,max:r=1}=t;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(n>=r)throw new RangeError("min must be smaller than max");let i=new _(this.rows,this.columns);for(let t=0;t<this.columns;t++){const o=this.getColumn(t);o.length&&e(o,{min:n,max:r,output:o}),i.setColumn(t,o)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let t=this.get(e,n),r=this.get(e,this.columns-1-n);this.set(e,n,r),this.set(e,this.columns-1-n,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let t=this.get(n,e),r=this.get(this.rows-1-n,e);this.set(n,e,r),this.set(this.rows-1-n,e,t)}return this}kroneckerProduct(t){t=_.checkMatrix(t);let e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new _(e*r,n*i);for(let s=0;s<e;s++)for(let e=0;e<n;e++)for(let n=0;n<r;n++)for(let a=0;a<i;a++)o.set(r*s+n,i*e+a,this.get(s,e)*t.get(n,a));return o}kroneckerSum(t){if(t=_.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,r=this.kroneckerProduct(_.eye(n,n)),i=_.eye(e,e).kroneckerProduct(t);return r.add(i)}transpose(){let t=new _(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t=y){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=y){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){p(this,t,e,n,r);let i=new _(e-t+1,r-n+1);for(let o=t;o<=e;o++)for(let e=n;e<=r;e++)i.set(o-t,e-n,this.get(o,e));return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new _(t.length,n-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=n;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new _(n-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=n;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){if((t=_.checkMatrix(t)).isEmpty())return this;p(this,e,e+t.rows-1,n,n+t.columns-1);for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)this.set(e+r,n+i,t.get(r,i));return this}selection(t,e){c(this,t),f(this,e);let n=new _(t.length,e.length);for(let r=0;r<t.length;r++){let i=t[r];for(let t=0;t<e.length;t++){let o=e[t];n.set(r,t,this.get(i,o))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){return this.constructor.copy(this,new _(this.rows,this.columns))}static copy(t,e){for(const[n,r,i]of t.entries())e.set(n,r,i);return e}sum(t){switch(t){case"row":return function(t){let e=d(t.rows);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]+=t.get(n,r);return e}(this);case"column":return function(t){let e=d(t.columns);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]+=t.get(n,r);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=d(t.rows,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]*=t.get(n,r);return e}(this);case"column":return function(t){let e=d(t.columns,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]*=t.get(n,r);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e*=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(e,n={}){if("object"==typeof e&&(n=e,e=void 0),"object"!=typeof n)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:i=this.mean(e)}=n;if("boolean"!=typeof r)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,o=[];for(let s=0;s<r;s++){let r=0,a=0,l=0;for(let e=0;e<i;e++)l=t.get(s,e)-n[s],r+=l,a+=l*l;e?o.push((a-r*r/i)/(i-1)):o.push((a-r*r/i)/i)}return o}(this,r,i);case"column":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,o=[];for(let s=0;s<i;s++){let i=0,a=0,l=0;for(let e=0;e<r;e++)l=t.get(e,s)-n[s],i+=l,a+=l*l;e?o.push((a-i*i/r)/(r-1)):o.push((a-i*i/r)/r)}return o}(this,r,i);case void 0:if("number"!=typeof i)throw new TypeError("mean must be a number");return function(t,e,n){const r=t.rows,i=t.columns,o=r*i;let s=0,a=0,l=0;for(let e=0;e<r;e++)for(let r=0;r<i;r++)l=t.get(e,r)-n,s+=l,a+=l*l;return e?(a-s*s/o)/(o-1):(a-s*s/o)/o}(this,r,i);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(let t=0;t<n.length;t++)n[t]=Math.sqrt(n[t]);return n}center(e,n={}){if("object"==typeof e&&(n=e,e=void 0),"object"!=typeof n)throw new TypeError("options must be an object");const{center:r=this.mean(e)}=n;switch(e){case"row":if(!t.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[n])}(this,r),this;case"column":if(!t.isAnyArray(r))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[r])}(this,r),this;case void 0:if("number"!=typeof r)throw new TypeError("center must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e)}(this,r),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,n={}){if("object"==typeof e&&(n=e,e=void 0),"object"!=typeof n)throw new TypeError("options must be an object");let r=n.scale;switch(e){case"row":if(void 0===r)r=function(t){const e=[];for(let n=0;n<t.rows;n++){let r=0;for(let e=0;e<t.columns;e++)r+=t.get(n,e)**2/(t.columns-1);e.push(Math.sqrt(r))}return e}(this);else if(!t.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[n])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let n=0;n<t.columns;n++){let r=0;for(let e=0;e<t.rows;e++)r+=t.get(e,n)**2/(t.rows-1);e.push(Math.sqrt(r))}return e}(this);else if(!t.isAnyArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[r])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let n=0;for(let r=0;r<t.columns;r++)for(let i=0;i<t.rows;i++)n+=t.get(i,r)**2/e;return Math.sqrt(n)}(this);else if("number"!=typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e)}(this,r),this;default:throw new Error(`invalid option: ${e}`)}}toString(t){return i(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function y(t,e){return t-e}function v(t){return t.every(t=>"number"==typeof t)}w.prototype.klass="Matrix","undefined"!=typeof Symbol&&(w.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return i(this)}),w.random=w.rand,w.randomInt=w.randInt,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct;class _ extends w{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<t;n++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(e,n){if(super(),_.isMatrix(e))this.#t(e.rows,e.columns),_.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#t(e,n);else{if(!t.isAnyArray(e))throw new TypeError("First argument must be a positive number or an array");{const t=e;if("number"!=typeof(n=(e=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<e;r++){if(t[r].length!==n)throw new RangeError("Inconsistent array dimensions");if(!v(t[r]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[r]))}this.rows=e,this.columns=n}}}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}removeRow(t){return a(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),a(this,t,!0),e=Float64Array.from(u(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){l(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns-1);for(let r=0;r<t;r++)n[r]=this.data[e][r];for(let r=t+1;r<this.columns;r++)n[r-1]=this.data[e][r];this.data[e]=n}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),l(this,t,!0),e=h(this,e);for(let n=0;n<this.rows;n++){const r=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)r[i]=this.data[n][i];for(r[i++]=e[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},t.add=function(t,n){return new e(t).add(n)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},t.sub=function(t,n){return new e(t).sub(n)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},t.mul=function(t,n){return new e(t).mul(n)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},t.div=function(t,n){return new e(t).div(n)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},t.mod=function(t,n){return new e(t).mod(n)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},t.and=function(t,n){return new e(t).and(n)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},t.or=function(t,n){return new e(t).or(n)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},t.xor=function(t,n){return new e(t).xor(n)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},t.leftShift=function(t,n){return new e(t).leftShift(n)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},t.signPropagatingRightShift=function(t,n){return new e(t).signPropagatingRightShift(n)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},t.rightShift=function(t,n){return new e(t).rightShift(n)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,n){return new e(t).pow(n)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t.get(e,n));return this}}(w,_);class b extends w{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return _.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),_.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=_.copy(t,new _(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new _(t,t);else if(this.#e=new _(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new b(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())t.set(e,n,r);return t}toMatrix(){return new _(this)}get(t,e){return this.#e.get(t,e)}set(t,e,n){return this.#e.set(t,e,n),this.#e.set(e,t,n),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const n=e.slice();return n.splice(t,1),this.#e.addRow(t,n),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[n,r]of t.entries())r||e.push(n);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let n=0,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=++r);return e}static fromCompact(t){const e=t.length,n=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const r=new b(n);for(let i=0,o=0,s=0;s<e;s++)r.set(i,o,t[s]),++i>=n&&(i=++o);return r}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield[t,e,n],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield n,++e>=this.diagonalSize&&(e=++t)}}}b.prototype.klassType="SymmetricMatrix";class x extends b{static isDistanceMatrix(t){return b.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,n){return t===e&&(n=0),super.set(t,e,n)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new b(this)}clone(){const t=new x(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())e!==n&&t.set(e,n,r);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let n=1,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=1+ ++r);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const r=new this(n);for(let i=1,o=0,s=0;s<e;s++)r.set(i,o,t[s]),++i>=n&&(i=1+ ++o);return r}}x.prototype.klassSubType="DistanceMatrix";class M extends w{constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}}class E extends M{constructor(t,e,n){c(t,e),f(t,n),super(t,e.length,n.length),this.rowIndices=e,this.columnIndices=n}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class S extends w{constructor(t,e={}){const{rows:n=1}=e;if(t.length%n!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=t.length/n,this.data=t}set(t,e,n){let r=this._calculateIndex(t,e);return this.data[r]=n,this}get(t,e){let n=this._calculateIndex(t,e);return this.data[n]}_calculateIndex(t,e){return t*this.columns+e}}class k extends w{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}}class N{constructor(t){let e,n,r,i,o,s,a,l,u,h=(t=k.checkMatrix(t)).clone(),c=h.rows,f=h.columns,p=new Float64Array(c),d=1;for(e=0;e<c;e++)p[e]=e;for(l=new Float64Array(c),n=0;n<f;n++){for(e=0;e<c;e++)l[e]=h.get(e,n);for(e=0;e<c;e++){for(u=Math.min(e,n),o=0,r=0;r<u;r++)o+=h.get(e,r)*l[r];l[e]-=o,h.set(e,n,l[e])}for(i=n,e=n+1;e<c;e++)Math.abs(l[e])>Math.abs(l[i])&&(i=e);if(i!==n){for(r=0;r<f;r++)s=h.get(i,r),h.set(i,r,h.get(n,r)),h.set(n,r,s);a=p[i],p[i]=p[n],p[n]=a,d=-d}if(n<c&&0!==h.get(n,n))for(e=n+1;e<c;e++)h.set(e,n,h.get(e,n)/h.get(n,n))}this.LU=h,this.pivotVector=p,this.pivotSign=d}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(0===t.get(n,n))return!0;return!1}solve(t){t=_.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let n,r,i,o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(n=i+1;n<a;n++)for(r=0;r<o;r++)s.set(n,r,s.get(n,r)-s.get(i,r)*e.get(n,i));for(i=a-1;i>=0;i--){for(r=0;r<o;r++)s.set(i,r,s.get(i,r)/e.get(i,i));for(n=0;n<i;n++)for(r=0;r<o;r++)s.set(n,r,s.get(n,r)-s.get(i,r)*e.get(n,i))}return s}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let r=0;r<n;r++)e*=t.get(r,r);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new _(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i>e?r.set(i,e,t.get(i,e)):i===e?r.set(i,e,1):r.set(i,e,0);return r}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new _(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i<=e?r.set(i,e,t.get(i,e)):r.set(i,e,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function A(t,e){let n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}class C{constructor(t){let e,n,r,i,o=(t=k.checkMatrix(t)).clone(),s=t.rows,a=t.columns,l=new Float64Array(a);for(r=0;r<a;r++){let t=0;for(e=r;e<s;e++)t=A(t,o.get(e,r));if(0!==t){for(o.get(r,r)<0&&(t=-t),e=r;e<s;e++)o.set(e,r,o.get(e,r)/t);for(o.set(r,r,o.get(r,r)+1),n=r+1;n<a;n++){for(i=0,e=r;e<s;e++)i+=o.get(e,r)*o.get(e,n);for(i=-i/o.get(r,r),e=r;e<s;e++)o.set(e,n,o.get(e,n)+i*o.get(e,r))}}l[r]=-t}this.QR=o,this.Rdiag=l}solve(t){t=_.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r,i,o,s,a=t.columns,l=t.clone(),u=e.columns;for(o=0;o<u;o++)for(i=0;i<a;i++){for(s=0,r=o;r<n;r++)s+=e.get(r,o)*l.get(r,i);for(s=-s/e.get(o,o),r=o;r<n;r++)l.set(r,i,l.get(r,i)+s*e.get(r,o))}for(o=u-1;o>=0;o--){for(i=0;i<a;i++)l.set(o,i,l.get(o,i)/this.Rdiag[o]);for(r=0;r<o;r++)for(i=0;i<a;i++)l.set(r,i,l.get(r,i)-l.get(o,i)*e.get(r,o))}return l.subMatrix(0,u-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,n=this.QR,r=n.columns,i=new _(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)t<e?i.set(t,e,n.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,n,r,i=this.QR,o=i.rows,s=i.columns,a=new _(o,s);for(n=s-1;n>=0;n--){for(t=0;t<o;t++)a.set(t,n,0);for(a.set(n,n,1),e=n;e<s;e++)if(0!==i.get(n,n)){for(r=0,t=n;t<o;t++)r+=i.get(t,n)*a.get(t,e);for(r=-r/i.get(n,n),t=n;t<o;t++)a.set(t,e,a.get(t,e)+r*i.get(t,n))}}return a}}class R{constructor(t,e={}){if((t=k.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,r=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=e;let a,l=Boolean(i),u=Boolean(o),h=!1;if(n<r)if(s){a=t.transpose(),n=a.rows,r=a.columns,h=!0;let e=l;l=u,u=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let c=Math.min(n,r),f=Math.min(n+1,r),p=new Float64Array(f),d=new _(n,c),g=new _(r,r),m=new Float64Array(r),w=new Float64Array(n),y=new Float64Array(f);for(let t=0;t<f;t++)y[t]=t;let v=Math.min(n-1,r),b=Math.max(0,Math.min(r-2,n)),x=Math.max(v,b);for(let t=0;t<x;t++){if(t<v){p[t]=0;for(let e=t;e<n;e++)p[t]=A(p[t],a.get(e,t));if(0!==p[t]){a.get(t,t)<0&&(p[t]=-p[t]);for(let e=t;e<n;e++)a.set(e,t,a.get(e,t)/p[t]);a.set(t,t,a.get(t,t)+1)}p[t]=-p[t]}for(let e=t+1;e<r;e++){if(t<v&&0!==p[t]){let r=0;for(let i=t;i<n;i++)r+=a.get(i,t)*a.get(i,e);r=-r/a.get(t,t);for(let i=t;i<n;i++)a.set(i,e,a.get(i,e)+r*a.get(i,t))}m[e]=a.get(t,e)}if(l&&t<v)for(let e=t;e<n;e++)d.set(e,t,a.get(e,t));if(t<b){m[t]=0;for(let e=t+1;e<r;e++)m[t]=A(m[t],m[e]);if(0!==m[t]){m[t+1]<0&&(m[t]=0-m[t]);for(let e=t+1;e<r;e++)m[e]/=m[t];m[t+1]+=1}if(m[t]=-m[t],t+1<n&&0!==m[t]){for(let e=t+1;e<n;e++)w[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<r;n++)w[e]+=m[n]*a.get(e,n);for(let e=t+1;e<r;e++){let r=-m[e]/m[t+1];for(let i=t+1;i<n;i++)a.set(i,e,a.get(i,e)+r*w[i])}}if(u)for(let e=t+1;e<r;e++)g.set(e,t,m[e])}}let M=Math.min(r,n+1);if(v<r&&(p[v]=a.get(v,v)),n<M&&(p[M-1]=0),b+1<M&&(m[b]=a.get(b,M-1)),m[M-1]=0,l){for(let t=v;t<c;t++){for(let e=0;e<n;e++)d.set(e,t,0);d.set(t,t,1)}for(let t=v-1;t>=0;t--)if(0!==p[t]){for(let e=t+1;e<c;e++){let r=0;for(let i=t;i<n;i++)r+=d.get(i,t)*d.get(i,e);r=-r/d.get(t,t);for(let i=t;i<n;i++)d.set(i,e,d.get(i,e)+r*d.get(i,t))}for(let e=t;e<n;e++)d.set(e,t,-d.get(e,t));d.set(t,t,1+d.get(t,t));for(let e=0;e<t-1;e++)d.set(e,t,0)}else{for(let e=0;e<n;e++)d.set(e,t,0);d.set(t,t,1)}}if(u)for(let t=r-1;t>=0;t--){if(t<b&&0!==m[t])for(let e=t+1;e<r;e++){let n=0;for(let i=t+1;i<r;i++)n+=g.get(i,t)*g.get(i,e);n=-n/g.get(t+1,t);for(let i=t+1;i<r;i++)g.set(i,e,g.get(i,e)+n*g.get(i,t))}for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}let E=M-1,S=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(p[t]+Math.abs(p[t+1]));if(Math.abs(m[t])<=e||Number.isNaN(m[t])){m[t]=0;break}}if(t===M-2)e=4;else{let n;for(n=M-1;n>=t&&n!==t;n--){let e=(n!==M?Math.abs(m[n]):0)+(n!==t+1?Math.abs(m[n-1]):0);if(Math.abs(p[n])<=S*e){p[n]=0;break}}n===t?e=3:n===M-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=m[M-2];m[M-2]=0;for(let n=M-2;n>=t;n--){let i=A(p[n],e),o=p[n]/i,s=e/i;if(p[n]=i,n!==t&&(e=-s*m[n-1],m[n-1]=o*m[n-1]),u)for(let t=0;t<r;t++)i=o*g.get(t,n)+s*g.get(t,M-1),g.set(t,M-1,-s*g.get(t,n)+o*g.get(t,M-1)),g.set(t,n,i)}break}case 2:{let e=m[t-1];m[t-1]=0;for(let r=t;r<M;r++){let i=A(p[r],e),o=p[r]/i,s=e/i;if(p[r]=i,e=-s*m[r],m[r]=o*m[r],l)for(let e=0;e<n;e++)i=o*d.get(e,r)+s*d.get(e,t-1),d.set(e,t-1,-s*d.get(e,r)+o*d.get(e,t-1)),d.set(e,r,i)}break}case 3:{const e=Math.max(Math.abs(p[M-1]),Math.abs(p[M-2]),Math.abs(m[M-2]),Math.abs(p[t]),Math.abs(m[t])),i=p[M-1]/e,o=p[M-2]/e,s=m[M-2]/e,a=p[t]/e,h=m[t]/e,c=((o+i)*(o-i)+s*s)/2,f=i*s*(i*s);let w=0;0===c&&0===f||(w=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),w=f/(c+w));let y=(a+i)*(a-i)+w,v=a*h;for(let e=t;e<M-1;e++){let i=A(y,v);0===i&&(i=Number.MIN_VALUE);let o=y/i,s=v/i;if(e!==t&&(m[e-1]=i),y=o*p[e]+s*m[e],m[e]=o*m[e]-s*p[e],v=s*p[e+1],p[e+1]=o*p[e+1],u)for(let t=0;t<r;t++)i=o*g.get(t,e)+s*g.get(t,e+1),g.set(t,e+1,-s*g.get(t,e)+o*g.get(t,e+1)),g.set(t,e,i);if(i=A(y,v),0===i&&(i=Number.MIN_VALUE),o=y/i,s=v/i,p[e]=i,y=o*m[e]+s*p[e+1],p[e+1]=-s*m[e]+o*p[e+1],v=s*m[e+1],m[e+1]=o*m[e+1],l&&e<n-1)for(let t=0;t<n;t++)i=o*d.get(t,e)+s*d.get(t,e+1),d.set(t,e+1,-s*d.get(t,e)+o*d.get(t,e+1)),d.set(t,e,i)}m[M-2]=y;break}case 4:if(p[t]<=0&&(p[t]=p[t]<0?-p[t]:0,u))for(let e=0;e<=E;e++)g.set(e,t,-g.get(e,t));for(;t<E&&!(p[t]>=p[t+1]);){let e=p[t];if(p[t]=p[t+1],p[t+1]=e,u&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);if(l&&t<n-1)for(let r=0;r<n;r++)e=d.get(r,t+1),d.set(r,t+1,d.get(r,t)),d.set(r,t,e);t++}M--}}if(h){let t=g;g=d,d=t}this.m=n,this.n=r,this.s=p,this.U=d,this.V=g}solve(t){let e=t,n=this.threshold,r=this.s.length,i=_.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=n?i.set(t,t,0):i.set(t,t,1/this.s[t]);let o=this.U,s=this.rightSingularVectors,a=s.mmul(i),l=s.rows,u=o.rows,h=_.zeros(l,u);for(let t=0;t<l;t++)for(let e=0;e<u;e++){let n=0;for(let i=0;i<r;i++)n+=a.get(t,i)*o.get(e,i);h.set(t,e,n)}return h.mmul(e)}solveForDiagonal(t){return this.solve(_.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,r=t.columns,i=new _(n,this.s.length);for(let o=0;o<n;o++)for(let n=0;n<r;n++)Math.abs(this.s[n])>e&&i.set(o,n,t.get(o,n)/this.s[n]);let o=this.U,s=o.rows,a=o.columns,l=new _(n,s);for(let t=0;t<n;t++)for(let e=0;e<s;e++){let n=0;for(let r=0;r<a;r++)n+=i.get(t,r)*o.get(e,r);l.set(t,e,n)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return _.diag(this.s)}}function I(t,e,n=!1){return t=k.checkMatrix(t),e=k.checkMatrix(e),n?new R(t).solve(e):t.isSquare()?new N(t).solve(e):new C(t).solve(e)}function P(t,e){let n=[];for(let r=0;r<t;r++)r!==e&&n.push(r);return n}function z(t,e,n,r=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);{let t=e.addRow(n,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<r&&t.set(e,0,0);return t.to1DArray()}}class O{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=k.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let r,i,o=t.columns,s=new _(o,o),a=new Float64Array(o),l=new Float64Array(o),u=t,h=!1;if(h=!!n||t.isSymmetric(),h){for(r=0;r<o;r++)for(i=0;i<o;i++)s.set(r,i,u.get(r,i));!function(t,e,n,r){let i,o,s,a,l,u,h,c;for(l=0;l<t;l++)n[l]=r.get(t-1,l);for(a=t-1;a>0;a--){for(c=0,s=0,u=0;u<a;u++)c+=Math.abs(n[u]);if(0===c)for(e[a]=n[a-1],l=0;l<a;l++)n[l]=r.get(a-1,l),r.set(a,l,0),r.set(l,a,0);else{for(u=0;u<a;u++)n[u]/=c,s+=n[u]*n[u];for(i=n[a-1],o=Math.sqrt(s),i>0&&(o=-o),e[a]=c*o,s-=i*o,n[a-1]=i-o,l=0;l<a;l++)e[l]=0;for(l=0;l<a;l++){for(i=n[l],r.set(l,a,i),o=e[l]+r.get(l,l)*i,u=l+1;u<=a-1;u++)o+=r.get(u,l)*n[u],e[u]+=r.get(u,l)*i;e[l]=o}for(i=0,l=0;l<a;l++)e[l]/=s,i+=e[l]*n[l];for(h=i/(s+s),l=0;l<a;l++)e[l]-=h*n[l];for(l=0;l<a;l++){for(i=n[l],o=e[l],u=l;u<=a-1;u++)r.set(u,l,r.get(u,l)-(i*e[u]+o*n[u]));n[l]=r.get(a-1,l),r.set(a,l,0)}}n[a]=s}for(a=0;a<t-1;a++){if(r.set(t-1,a,r.get(a,a)),r.set(a,a,1),s=n[a+1],0!==s){for(u=0;u<=a;u++)n[u]=r.get(u,a+1)/s;for(l=0;l<=a;l++){for(o=0,u=0;u<=a;u++)o+=r.get(u,a+1)*r.get(u,l);for(u=0;u<=a;u++)r.set(u,l,r.get(u,l)-o*n[u])}}for(u=0;u<=a;u++)r.set(u,a+1,0)}for(l=0;l<t;l++)n[l]=r.get(t-1,l),r.set(t-1,l,0);r.set(t-1,t-1,1),e[0]=0}(o,l,a,s),function(t,e,n,r){let i,o,s,a,l,u,h,c,f,p,d,g,m,w,y,v;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;let _=0,b=0,x=Number.EPSILON;for(u=0;u<t;u++){for(b=Math.max(b,Math.abs(n[u])+Math.abs(e[u])),h=u;h<t&&!(Math.abs(e[h])<=x*b);)h++;if(h>u)do{for(i=n[u],c=(n[u+1]-i)/(2*e[u]),f=A(c,1),c<0&&(f=-f),n[u]=e[u]/(c+f),n[u+1]=e[u]*(c+f),p=n[u+1],o=i-n[u],s=u+2;s<t;s++)n[s]-=o;for(_+=o,c=n[h],d=1,g=d,m=d,w=e[u+1],y=0,v=0,s=h-1;s>=u;s--)for(m=g,g=d,v=y,i=d*e[s],o=d*c,f=A(c,e[s]),e[s+1]=y*f,y=e[s]/f,d=c/f,c=d*n[s]-y*i,n[s+1]=o+y*(d*i+y*n[s]),l=0;l<t;l++)o=r.get(l,s+1),r.set(l,s+1,y*r.get(l,s)+d*o),r.set(l,s,d*r.get(l,s)-y*o);c=-y*v*m*w*e[u]/p,e[u]=y*c,n[u]=d*c}while(Math.abs(e[u])>x*b);n[u]=n[u]+_,e[u]=0}for(s=0;s<t-1;s++){for(l=s,c=n[s],a=s+1;a<t;a++)n[a]<c&&(l=a,c=n[a]);if(l!==s)for(n[l]=n[s],n[s]=c,a=0;a<t;a++)c=r.get(a,s),r.set(a,s,r.get(a,l)),r.set(a,l,c)}}(o,l,a,s)}else{let t=new _(o,o),e=new Float64Array(o);for(i=0;i<o;i++)for(r=0;r<o;r++)t.set(r,i,u.get(r,i));!function(t,e,n,r){let i,o,s,a,l,u,h,c=0,f=t-1;for(u=c+1;u<=f-1;u++){for(h=0,a=u;a<=f;a++)h+=Math.abs(e.get(a,u-1));if(0!==h){for(s=0,a=f;a>=u;a--)n[a]=e.get(a,u-1)/h,s+=n[a]*n[a];for(o=Math.sqrt(s),n[u]>0&&(o=-o),s-=n[u]*o,n[u]=n[u]-o,l=u;l<t;l++){for(i=0,a=f;a>=u;a--)i+=n[a]*e.get(a,l);for(i/=s,a=u;a<=f;a++)e.set(a,l,e.get(a,l)-i*n[a])}for(a=0;a<=f;a++){for(i=0,l=f;l>=u;l--)i+=n[l]*e.get(a,l);for(i/=s,l=u;l<=f;l++)e.set(a,l,e.get(a,l)-i*n[l])}n[u]=h*n[u],e.set(u,u-1,h*o)}}for(a=0;a<t;a++)for(l=0;l<t;l++)r.set(a,l,a===l?1:0);for(u=f-1;u>=c+1;u--)if(0!==e.get(u,u-1)){for(a=u+1;a<=f;a++)n[a]=e.get(a,u-1);for(l=u;l<=f;l++){for(o=0,a=u;a<=f;a++)o+=n[a]*r.get(a,l);for(o=o/n[u]/e.get(u,u-1),a=u;a<=f;a++)r.set(a,l,r.get(a,l)+o*n[a])}}}(o,t,e,s),function(t,e,n,r,i){let o,s,a,l,u,h,c,f,p,d,g,m,w,y,v,_=t-1,b=0,x=t-1,M=Number.EPSILON,E=0,S=0,k=0,N=0,A=0,C=0,R=0,I=0;for(o=0;o<t;o++)for((o<b||o>x)&&(n[o]=i.get(o,o),e[o]=0),s=Math.max(o-1,0);s<t;s++)S+=Math.abs(i.get(o,s));for(;_>=b;){for(l=_;l>b&&(C=Math.abs(i.get(l-1,l-1))+Math.abs(i.get(l,l)),0===C&&(C=S),!(Math.abs(i.get(l,l-1))<M*C));)l--;if(l===_)i.set(_,_,i.get(_,_)+E),n[_]=i.get(_,_),e[_]=0,_--,I=0;else if(l===_-1){if(c=i.get(_,_-1)*i.get(_-1,_),k=(i.get(_-1,_-1)-i.get(_,_))/2,N=k*k+c,R=Math.sqrt(Math.abs(N)),i.set(_,_,i.get(_,_)+E),i.set(_-1,_-1,i.get(_-1,_-1)+E),f=i.get(_,_),N>=0){for(R=k>=0?k+R:k-R,n[_-1]=f+R,n[_]=n[_-1],0!==R&&(n[_]=f-c/R),e[_-1]=0,e[_]=0,f=i.get(_,_-1),C=Math.abs(f)+Math.abs(R),k=f/C,N=R/C,A=Math.sqrt(k*k+N*N),k/=A,N/=A,s=_-1;s<t;s++)R=i.get(_-1,s),i.set(_-1,s,N*R+k*i.get(_,s)),i.set(_,s,N*i.get(_,s)-k*R);for(o=0;o<=_;o++)R=i.get(o,_-1),i.set(o,_-1,N*R+k*i.get(o,_)),i.set(o,_,N*i.get(o,_)-k*R);for(o=b;o<=x;o++)R=r.get(o,_-1),r.set(o,_-1,N*R+k*r.get(o,_)),r.set(o,_,N*r.get(o,_)-k*R)}else n[_-1]=f+k,n[_]=f+k,e[_-1]=R,e[_]=-R;_-=2,I=0}else{if(f=i.get(_,_),p=0,c=0,l<_&&(p=i.get(_-1,_-1),c=i.get(_,_-1)*i.get(_-1,_)),10===I){for(E+=f,o=b;o<=_;o++)i.set(o,o,i.get(o,o)-f);C=Math.abs(i.get(_,_-1))+Math.abs(i.get(_-1,_-2)),f=p=.75*C,c=-.4375*C*C}if(30===I&&(C=(p-f)/2,C=C*C+c,C>0)){for(C=Math.sqrt(C),p<f&&(C=-C),C=f-c/((p-f)/2+C),o=b;o<=_;o++)i.set(o,o,i.get(o,o)-C);E+=C,f=p=c=.964}for(I+=1,u=_-2;u>=l&&(R=i.get(u,u),A=f-R,C=p-R,k=(A*C-c)/i.get(u+1,u)+i.get(u,u+1),N=i.get(u+1,u+1)-R-A-C,A=i.get(u+2,u+1),C=Math.abs(k)+Math.abs(N)+Math.abs(A),k/=C,N/=C,A/=C,u!==l)&&!(Math.abs(i.get(u,u-1))*(Math.abs(N)+Math.abs(A))<M*(Math.abs(k)*(Math.abs(i.get(u-1,u-1))+Math.abs(R)+Math.abs(i.get(u+1,u+1)))));)u--;for(o=u+2;o<=_;o++)i.set(o,o-2,0),o>u+2&&i.set(o,o-3,0);for(a=u;a<=_-1&&(y=a!==_-1,a!==u&&(k=i.get(a,a-1),N=i.get(a+1,a-1),A=y?i.get(a+2,a-1):0,f=Math.abs(k)+Math.abs(N)+Math.abs(A),0!==f&&(k/=f,N/=f,A/=f)),0!==f);a++)if(C=Math.sqrt(k*k+N*N+A*A),k<0&&(C=-C),0!==C){for(a!==u?i.set(a,a-1,-C*f):l!==u&&i.set(a,a-1,-i.get(a,a-1)),k+=C,f=k/C,p=N/C,R=A/C,N/=k,A/=k,s=a;s<t;s++)k=i.get(a,s)+N*i.get(a+1,s),y&&(k+=A*i.get(a+2,s),i.set(a+2,s,i.get(a+2,s)-k*R)),i.set(a,s,i.get(a,s)-k*f),i.set(a+1,s,i.get(a+1,s)-k*p);for(o=0;o<=Math.min(_,a+3);o++)k=f*i.get(o,a)+p*i.get(o,a+1),y&&(k+=R*i.get(o,a+2),i.set(o,a+2,i.get(o,a+2)-k*A)),i.set(o,a,i.get(o,a)-k),i.set(o,a+1,i.get(o,a+1)-k*N);for(o=b;o<=x;o++)k=f*r.get(o,a)+p*r.get(o,a+1),y&&(k+=R*r.get(o,a+2),r.set(o,a+2,r.get(o,a+2)-k*A)),r.set(o,a,r.get(o,a)-k),r.set(o,a+1,r.get(o,a+1)-k*N)}}}if(0===S)return;for(_=t-1;_>=0;_--)if(k=n[_],N=e[_],0===N)for(l=_,i.set(_,_,1),o=_-1;o>=0;o--){for(c=i.get(o,o)-k,A=0,s=l;s<=_;s++)A+=i.get(o,s)*i.get(s,_);if(e[o]<0)R=c,C=A;else if(l=o,0===e[o]?i.set(o,_,0!==c?-A/c:-A/(M*S)):(f=i.get(o,o+1),p=i.get(o+1,o),N=(n[o]-k)*(n[o]-k)+e[o]*e[o],h=(f*C-R*A)/N,i.set(o,_,h),i.set(o+1,_,Math.abs(f)>Math.abs(R)?(-A-c*h)/f:(-C-p*h)/R)),h=Math.abs(i.get(o,_)),M*h*h>1)for(s=o;s<=_;s++)i.set(s,_,i.get(s,_)/h)}else if(N<0)for(l=_-1,Math.abs(i.get(_,_-1))>Math.abs(i.get(_-1,_))?(i.set(_-1,_-1,N/i.get(_,_-1)),i.set(_-1,_,-(i.get(_,_)-k)/i.get(_,_-1))):(v=T(0,-i.get(_-1,_),i.get(_-1,_-1)-k,N),i.set(_-1,_-1,v[0]),i.set(_-1,_,v[1])),i.set(_,_-1,0),i.set(_,_,1),o=_-2;o>=0;o--){for(d=0,g=0,s=l;s<=_;s++)d+=i.get(o,s)*i.get(s,_-1),g+=i.get(o,s)*i.get(s,_);if(c=i.get(o,o)-k,e[o]<0)R=c,A=d,C=g;else if(l=o,0===e[o]?(v=T(-d,-g,c,N),i.set(o,_-1,v[0]),i.set(o,_,v[1])):(f=i.get(o,o+1),p=i.get(o+1,o),m=(n[o]-k)*(n[o]-k)+e[o]*e[o]-N*N,w=2*(n[o]-k)*N,0===m&&0===w&&(m=M*S*(Math.abs(c)+Math.abs(N)+Math.abs(f)+Math.abs(p)+Math.abs(R))),v=T(f*A-R*d+N*g,f*C-R*g-N*d,m,w),i.set(o,_-1,v[0]),i.set(o,_,v[1]),Math.abs(f)>Math.abs(R)+Math.abs(N)?(i.set(o+1,_-1,(-d-c*i.get(o,_-1)+N*i.get(o,_))/f),i.set(o+1,_,(-g-c*i.get(o,_)-N*i.get(o,_-1))/f)):(v=T(-A-p*i.get(o,_-1),-C-p*i.get(o,_),R,N),i.set(o+1,_-1,v[0]),i.set(o+1,_,v[1]))),h=Math.max(Math.abs(i.get(o,_-1)),Math.abs(i.get(o,_))),M*h*h>1)for(s=o;s<=_;s++)i.set(s,_-1,i.get(s,_-1)/h),i.set(s,_,i.get(s,_)/h)}for(o=0;o<t;o++)if(o<b||o>x)for(s=o;s<t;s++)r.set(o,s,i.get(o,s));for(s=t-1;s>=b;s--)for(o=b;o<=x;o++){for(R=0,a=b;a<=Math.min(s,x);a++)R+=r.get(o,a)*i.get(a,s);r.set(o,s,R)}}(o,l,a,s,t)}this.n=o,this.e=l,this.d=a,this.V=s}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,n=this.n,r=this.e,i=this.d,o=new _(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o.set(t,e,0);o.set(t,t,i[t]),r[t]>0?o.set(t,t+1,r[t]):r[t]<0&&o.set(t,t-1,r[t])}return o}}function T(t,e,n,r){let i,o;return Math.abs(n)>Math.abs(r)?(i=r/n,o=n+i*r,[(t+i*e)/o,(e-i*t)/o]):(i=n/r,o=r+i*n,[(i*t+e)/o,(i*e-t)/o])}class j{constructor(t){if(!(t=k.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,n,r,i=t,o=i.rows,s=new _(o,o),a=!0;for(n=0;n<o;n++){let t=0;for(r=0;r<n;r++){let o=0;for(e=0;e<r;e++)o+=s.get(r,e)*s.get(n,e);o=(i.get(n,r)-o)/s.get(r,r),s.set(n,r,o),t+=o*o}for(t=i.get(n,n)-t,a&&=t>0,s.set(n,n,Math.sqrt(Math.max(t,0))),r=n+1;r<o;r++)s.set(n,r,0)}this.L=s,this.positiveDefinite=a}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=k.checkMatrix(t);let e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let r,i,o,s=t.columns,a=t.clone();for(o=0;o<n;o++)for(i=0;i<s;i++){for(r=0;r<o;r++)a.set(o,i,a.get(o,i)-a.get(r,i)*e.get(o,r));a.set(o,i,a.get(o,i)/e.get(o,o))}for(o=n-1;o>=0;o--)for(i=0;i<s;i++){for(r=o+1;r<n;r++)a.set(o,i,a.get(o,i)-a.get(r,i)*e.get(r,o));a.set(o,i,a.get(o,i)/e.get(o,o))}return a}get lowerTriangularMatrix(){return this.L}}class D{constructor(e,n={}){e=k.checkMatrix(e);let{Y:r}=n;const{scaleScores:i=!1,maxIterations:o=1e3,terminationCriteria:s=1e-10}=n;let a;if(r){if(r=t.isAnyArray(r)&&"number"==typeof r[0]?_.columnVector(r):k.checkMatrix(r),r.rows!==e.rows)throw new Error("Y should have the same number of rows as X");a=r.getColumnVector(0)}else a=e.getColumnVector(0);let l,u,h,c,f=1;for(let t=0;t<o&&f>s;t++)h=e.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),h=h.div(h.norm()),l=e.mmul(h).div(h.transpose().mmul(h).get(0,0)),t>0&&(f=l.clone().sub(c).pow(2).sum()),c=l.clone(),r?(u=r.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),u=u.div(u.norm()),a=r.mmul(u).div(u.transpose().mmul(u).get(0,0))):a=l;if(r){let t=e.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));t=t.div(t.norm());let n=e.clone().sub(l.clone().mmul(t.transpose())),i=a.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),o=r.clone().sub(l.clone().mulS(i.get(0,0)).mmul(u.transpose()));this.t=l,this.p=t.transpose(),this.w=h.transpose(),this.q=u,this.u=a,this.s=l.transpose().mmul(l),this.xResidual=n,this.yResidual=o,this.betas=i}else this.w=h.transpose(),this.s=l.transpose().mmul(l).sqrt(),this.t=i?l.clone().div(this.s.get(0,0)):l,this.xResidual=e.sub(l.mmul(h.transpose()))}}return oo.AbstractMatrix=w,oo.CHO=j,oo.CholeskyDecomposition=j,oo.DistanceMatrix=x,oo.EVD=O,oo.EigenvalueDecomposition=O,oo.LU=N,oo.LuDecomposition=N,oo.Matrix=_,oo.MatrixColumnSelectionView=class extends M{constructor(t,e){f(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},oo.MatrixColumnView=class extends M{constructor(t,e){l(t,e),super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}},oo.MatrixFlipColumnView=class extends M{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},oo.MatrixFlipRowView=class extends M{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},oo.MatrixRowSelectionView=class extends M{constructor(t,e){c(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},oo.MatrixRowView=class extends M{constructor(t,e){a(t,e),super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}},oo.MatrixSelectionView=E,oo.MatrixSubView=class extends M{constructor(t,e,n,r,i){p(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},oo.MatrixTransposeView=class extends M{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}},oo.NIPALS=D,oo.Nipals=D,oo.QR=C,oo.QrDecomposition=C,oo.SVD=R,oo.SingularValueDecomposition=R,oo.SymmetricMatrix=b,oo.WrapperMatrix1D=S,oo.WrapperMatrix2D=k,oo.correlation=function(e,n=e,r={}){e=new _(e);let i=!1;if("object"!=typeof n||_.isMatrix(n)||t.isAnyArray(n)?n=new _(n):(r=n,n=e,i=!0),e.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0,scale:s=!0}=r;o&&(e.center("column"),i||n.center("column")),s&&(e.scale("column"),i||n.scale("column"));const a=e.standardDeviation("column",{unbiased:!0}),l=i?a:n.standardDeviation("column",{unbiased:!0}),u=e.transpose().mmul(n);for(let t=0;t<u.rows;t++)for(let n=0;n<u.columns;n++)u.set(t,n,u.get(t,n)*(1/(a[t]*l[n]))*(1/(e.rows-1)));return u},oo.covariance=function(e,n=e,r={}){e=new _(e);let i=!1;if("object"!=typeof n||_.isMatrix(n)||t.isAnyArray(n)?n=new _(n):(r=n,n=e,i=!0),e.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:o=!0}=r;o&&(e=e.center("column"),i||(n=n.center("column")));const s=e.transpose().mmul(n);for(let t=0;t<s.rows;t++)for(let n=0;n<s.columns;n++)s.set(t,n,s.get(t,n)*(1/(e.rows-1)));return s},oo.default=_,oo.determinant=function t(e){if((e=_.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let n,r,i,o;if(2===e.columns)return n=e.get(0,0),r=e.get(0,1),i=e.get(1,0),o=e.get(1,1),n*o-r*i;if(3===e.columns){let o,s,a;return o=new E(e,[1,2],[1,2]),s=new E(e,[1,2],[0,2]),a=new E(e,[1,2],[0,1]),n=e.get(0,0),r=e.get(0,1),i=e.get(0,2),n*t(o)-r*t(s)+i*t(a)}return new N(e).determinant}throw Error("determinant can only be calculated for a square matrix")},oo.inverse=function(t,e=!1){return t=k.checkMatrix(t),e?new R(t).inverse():I(t,_.eye(t.rows))},oo.linearDependencies=function(t,e={}){const{thresholdValue:n=1e-9,thresholdError:r=1e-9}=e;let i=(t=_.checkMatrix(t)).rows,o=new _(i,i);for(let e=0;e<i;e++){let s=_.columnVector(t.getRow(e)),a=t.subMatrixRow(P(i,e)).transpose(),l=new R(a).solve(s),u=_.sub(s,a.mmul(l)).abs().max();o.setRow(e,z(u,l,e,n,r))}return o},oo.pseudoInverse=function(t,e=Number.EPSILON){if((t=_.checkMatrix(t)).isEmpty())return t.transpose();let n=new R(t,{autoTranspose:!0}),r=n.leftSingularVectors,i=n.rightSingularVectors,o=n.diagonal;for(let t=0;t<o.length;t++)Math.abs(o[t])>e?o[t]=1/o[t]:o[t]=0;return i.mmul(_.diag(o).mmul(r.transpose()))},oo.solve=I,oo.wrap=function(e,n){if(t.isAnyArray(e))return e[0]&&t.isAnyArray(e[0])?new k(e):new S(e,n);throw new Error("the argument is not an array")},oo}var fo=co(),po=ro(fo);const go=fo.EVD,mo=fo.Matrix,wo=fo.MatrixTransposeView,yo=fo.NIPALS,vo=fo.SVD;po.Matrix?po.Matrix:fo.Matrix;const _o=fo.inverse;var bo,xo,Mo,Eo={exports:{}},So=Eo.exports;function ko(){return bo||(bo=1,t=Eo,function(){var e,n,r,i,o,s,a,l,u,h,c,f,p,d,g;r=Math.floor,h=Math.min,n=function(t,e){return t<e?-1:t>e?1:0},u=function(t,e,i,o,s){var a;if(null==i&&(i=0),null==s&&(s=n),i<0)throw new Error("lo must be non-negative");for(null==o&&(o=t.length);i<o;)s(e,t[a=r((i+o)/2)])<0?o=a:i=a+1;return[].splice.apply(t,[i,i-i].concat(e)),e},s=function(t,e,r){return null==r&&(r=n),t.push(e),d(t,0,t.length-1,r)},o=function(t,e){var r,i;return null==e&&(e=n),r=t.pop(),t.length?(i=t[0],t[0]=r,g(t,0,e)):i=r,i},l=function(t,e,r){var i;return null==r&&(r=n),i=t[0],t[0]=e,g(t,0,r),i},a=function(t,e,r){var i;return null==r&&(r=n),t.length&&r(t[0],e)<0&&(e=(i=[t[0],e])[0],t[0]=i[1],g(t,0,r)),e},i=function(t,e){var i,o,s,a,l,u;for(null==e&&(e=n),l=[],o=0,s=(a=function(){u=[];for(var e=0,n=r(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)u.push(e);return u}.apply(this).reverse()).length;o<s;o++)i=a[o],l.push(g(t,i,e));return l},p=function(t,e,r){var i;if(null==r&&(r=n),-1!==(i=t.indexOf(e)))return d(t,0,i,r),g(t,i,r)},c=function(t,e,r){var o,s,l,u,h;if(null==r&&(r=n),!(s=t.slice(0,e)).length)return s;for(i(s,r),l=0,u=(h=t.slice(e)).length;l<u;l++)o=h[l],a(s,o,r);return s.sort(r).reverse()},f=function(t,e,r){var s,a,l,c,f,p,d,g,m;if(null==r&&(r=n),10*e<=t.length){if(!(l=t.slice(0,e).sort(r)).length)return l;for(a=l[l.length-1],c=0,p=(d=t.slice(e)).length;c<p;c++)r(s=d[c],a)<0&&(u(l,s,0,null,r),l.pop(),a=l[l.length-1]);return l}for(i(t,r),m=[],f=0,g=h(e,t.length);0<=g?f<g:f>g;0<=g?++f:--f)m.push(o(t,r));return m},d=function(t,e,r,i){var o,s,a;for(null==i&&(i=n),o=t[r];r>e&&i(o,s=t[a=r-1>>1])<0;)t[r]=s,r=a;return t[r]=o},g=function(t,e,r){var i,o,s,a,l;for(null==r&&(r=n),o=t.length,l=e,s=t[e],i=2*e+1;i<o;)(a=i+1)<o&&!(r(t[i],t[a])<0)&&(i=a),t[e]=t[i],i=2*(e=i)+1;return t[e]=s,d(t,l,e,r)},e=function(){function t(t){this.cmp=null!=t?t:n,this.nodes=[]}return t.push=s,t.pop=o,t.replace=l,t.pushpop=a,t.heapify=i,t.updateItem=p,t.nlargest=c,t.nsmallest=f,t.prototype.push=function(t){return s(this.nodes,t,this.cmp)},t.prototype.pop=function(){return o(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return l(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return a(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return i(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return p(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),t.exports=e}.call(So)),Eo.exports;var t}var No=ro(Mo?xo:(Mo=1,xo=ko()));class Ao{constructor(){this.children=[],this.height=0,this.size=1,this.index=-1,this.isLeaf=!1}cut(t){if("number"!=typeof t)throw new TypeError("threshold must be a number");if(t<0)throw new RangeError("threshold must be a positive number");let e=[this];const n=[];for(;e.length>0;){const r=e.shift();t>=r.height?n.push(r):e=e.concat(r.children)}return n}group(t){if(!Number.isInteger(t)||t<1)throw new RangeError("groups must be a positive integer");const e=new No((t,e)=>e.height-t.height);for(e.push(this);e.size()<t;){const t=e.pop();if(0===t.children.length)break;t.children.forEach(t=>e.push(t))}const n=new Ao;return n.children=e.toArray(),n.height=this.height,n}traverse(t){!function t(e,n){if(n(e),e.children)for(const r of e.children)t(r,n)}(this,t)}indices(){const t=[];return this.traverse(e=>{e.isLeaf&&t.push(e.index)}),t}}function Co(t,e){return Math.min(t,e)}function Ro(t,e){return Math.max(t,e)}function Io(t,e,n,r,i){return r/(r+i)*t+i/(r+i)*e}function Po(t,e){return(t+e)/2}function zo(t,e,n,r,i){return r/(r+i)*t+i/(r+i)*e+-r*i/(r+i)**2*n}function Oo(t,e,n){return t/2+e/2-n/4}function To(t,e,n,r,i,o){return(r+o)/(r+i+o)*t+(i+o)/(r+i+o)*e+-o/(r+i+o)*n}function jo(t,e,n,r,i,o){const s=(r+o)/(r+i+o),a=(i+o)/(r+i+o),l=-o/(r+i+o);return Math.sqrt(s*t*t+a*e*e+l*n*n)}function Do(t,e={}){const{distanceFunction:n=eo,method:r="complete",isDistanceMatrix:i=!1}=e;let o;i||(t=no(t,n));let s=new mo(t);const a=s.rows;if("string"==typeof r)switch(r.toLowerCase()){case"single":o=Co;break;case"complete":o=Ro;break;case"average":case"upgma":o=Io;break;case"wpgma":o=Po;break;case"centroid":case"upgmc":o=zo;break;case"median":case"wpgmc":o=Oo;break;case"ward":o=To;break;case"ward2":o=jo;break;default:throw new RangeError(`unknown clustering method: ${r}`)}else if("function"!=typeof r)throw new TypeError("method must be a string or function");let l=[];for(let t=0;t<a;t++){const e=new Ao;e.isLeaf=!0,e.index=t,l.push(e)}for(let t=0;t<a-1;t++){const[t,e,n]=$o(s),r=l[t],i=l[e],a=new Ao;a.size=r.size+i.size,a.children.push(r,i),a.height=n;const u=[a],h=new mo(s.rows-1,s.rows-1),c=n=>Vo(n,Math.min(t,e),Math.max(t,e));for(let a=1;a<h.rows;a++){const f=c(a),p=l[f];u.push(p);for(let l=0;l<a;l++)if(0===l){const u=o(s.get(t,f),s.get(f,e),n,r.size,i.size,p.size);h.set(a,l,u),h.set(l,a,u)}else{const t=s.get(f,c(l));h.set(a,l,t),h.set(l,a,t)}}l=u,s=h}return l[0]}function $o(t){let e=1/0,n=0,r=0;for(let i=1;i<t.rows;i++)for(let o=0;o<i;o++)t.get(i,o)<e&&(e=t.get(i,o),n=i,r=o);return[n,r,e]}function Vo(t,e,n){return(t-=1)>=e&&t++,t>=n&&t++,t}var Fo,Lo=Object.freeze({__proto__:null,additiveSymmetric:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r])*(t[r]+e[r])/(t[r]*e[r]);return n},avg:function(t,e){let n=0,r=0,i=0;for(let o=0;o<t.length;o++)i=Math.abs(t[o]-e[o]),r+=i,n<i&&(n=i);return(n+r)/2},bhattacharyya:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.sqrt(t[r]*e[r]);return-Math.log(n)},canberra:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.abs(t[r]-e[r])/(t[r]+e[r]);return n},chebyshev:function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)r=Math.abs(t[i]-e[i]),n<r&&(n=r);return n},clark:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(Math.abs(t[r]-e[r])/(t[r]+e[r]))**2;return Math.sqrt(n)},czekanowski:function(t,e){return 1-function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)n+=Math.min(t[i],e[i]),r+=t[i]+e[i];return 2*n/r}(t,e)},dice:function(t,e){let n=0,r=0,i=0;for(let o=0;o<t.length;o++)n+=t[o]*t[o],r+=e[o]*e[o],i+=(t[o]-e[o])*(t[o]-e[o]);return i/(n+r)},divergence:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r])/((t[r]+e[r])*(t[r]+e[r]));return 2*n},euclidean:eo,fidelity:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.sqrt(t[r]*e[r]);return n},gower:function(t,e){const n=t.length;let r=0;for(let n=0;n<t.length;n++)r+=Math.abs(t[n]-e[n]);return r/n},harmonicMean:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r]/(t[r]+e[r]);return 2*n},hellinger:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.sqrt(t[r]*e[r]);return 2*Math.sqrt(1-n)},innerProduct:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[r];return n},intersection:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.min(t[r],e[r]);return 1-n},jaccard:function(t,e){return 1-function(t,e){let n=0,r=0,i=0;for(let o=0;o<t.length;o++)n+=t[o]*e[o],r+=t[o]*t[o],i+=e[o]*e[o];return n/(r+i-n)}(t,e)},jeffreys:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*Math.log(t[r]/e[r]);return n},jensenDifference:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]*Math.log(t[r])+e[r]*Math.log(e[r]))/2-(t[r]+e[r])/2*Math.log((t[r]+e[r])/2);return n},jensenShannon:function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)n+=t[i]*Math.log(2*t[i]/(t[i]+e[i])),r+=e[i]*Math.log(2*e[i]/(t[i]+e[i]));return(n+r)/2},kdivergence:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*Math.log(2*t[r]/(t[r]+e[r]));return n},kulczynski:function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)n+=Math.abs(t[i]-e[i]),r+=Math.min(t[i],e[i]);return n/r},kullbackLeibler:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*Math.log(t[r]/e[r]);return n},kumarJohnson:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]*t[r]-e[r]*e[r])**2/(2*(t[r]*e[r])**1.5);return n},lorentzian:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.log(Math.abs(t[r]-e[r])+1);return n},manhattan:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.abs(t[r]-e[r]);return n},matusita:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=Math.sqrt(t[r]*e[r]);return Math.sqrt(2-2*n)},minkowski:function(t,e,n){let r=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i])**n;return r**(1/n)},motyka:function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)n+=Math.min(t[i],e[i]),r+=t[i]+e[i];return 1-n/r},neyman:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r])/t[r];return n},pearson:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r])/e[r];return n},probabilisticSymmetric:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r])/(t[r]+e[r]);return 2*n},ruzicka:function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)n+=Math.min(t[i],e[i]),r+=Math.max(t[i],e[i]);return n/r},soergel:function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)n+=Math.abs(t[i]-e[i]),r+=Math.max(t[i],e[i]);return n/r},sorensen:function(t,e){let n=0,r=0;for(let i=0;i<t.length;i++)n+=Math.abs(t[i]-e[i]),r+=t[i]+e[i];return n/r},squared:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r])/(t[r]+e[r]);return n},squaredChord:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(Math.sqrt(t[r])-Math.sqrt(e[r]))**2;return n},squaredEuclidean:to,taneja:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=(t[r]+e[r])/2*Math.log((t[r]+e[r])/(2*Math.sqrt(t[r]*e[r])));return n},tanimoto:function(t,e,n){if(n)return 1-function(t,e,n){if(n){let n=0,r=0;for(let i=0;i<t.length;i++)n+=t[i]&&e[i],r+=t[i]||e[i];return 0===r?1:n/r}{let n=0,r=0,i=0;for(let o=0;o<t.length;o++)n+=t[o],r+=e[o],i+=Math.min(t[o],e[o]);return 1-(n+r-2*i)/(n+r-i)}}(t,e,n);{let n=0,r=0,i=0;for(let o=0;o<t.length;o++)n+=t[o],r+=e[o],i+=Math.min(t[o],e[o]);return(n+r-2*i)/(n+r-i)}},topsoe:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*Math.log(2*t[r]/(t[r]+e[r]))+e[r]*Math.log(2*e[r]/(t[r]+e[r]));return n},waveHedges:function(t,e){let n=0;for(let r=0;r<t.length;r++)n+=1-Math.min(t[r],e[r])/Math.max(t[r],e[r]);return n}}),qo={};!function(){if(Fo)return qo;function t(t){if("number"!=typeof t)throw new TypeError("Expected a number")}Fo=1,qo.ascending=(e,n)=>(t(e),t(n),Number.isNaN(e)?-1:Number.isNaN(n)?1:e-n),qo.descending=(e,n)=>(t(e),t(n),Number.isNaN(e)?1:Number.isNaN(n)?-1:n-e)}();const Uo=async function(t){const e=t.split(/\r?\n/),n=e[0].split(","),r=[];r.headers=n;for(let t=1;t<e.length-1;t++){const i={},o=e[t].split(",");for(let t=0;t<n.length;t++)i[n[t]]=Bo(o[t]);r.push(i)}return r},Bo=function(t){return isNaN(t)?t:Number(t)},Ho=function(t){return t.filter(t=>"number"==typeof t)},Xo=function(t){return t.filter(t=>"number"!=typeof t)},Go=function(t){return t.map(t=>{const e={};for(const n in t)"number"==typeof t[n]&&(e[n]=t[n]);return e})},Wo=function(t){return t.map(t=>{const e={};for(const n in t)"number"!=typeof t[n]&&(e[n]=t[n]);return e})},Yo=function(t){if(null==t)throw new Error("No data passed to function.");if(!Array.isArray(t)||"object"!=typeof t[0]||null===t[0])throw new Error("First argument must be an array of objects");const e=t;if(!t.columns){const t=new Set;for(const n of e)for(const e of Object.keys(n))t.add(e);e.columns=[...t]}return e.columns.forEach(t=>{Object.getOwnPropertyDescriptor(e,t)||Object.defineProperty(e,t,{get:function(){return this.map(e=>e[t])},set:function(e){if(!e)throw new Error(`No data passed to set ${t} column.`);if(e.length!==this.length)throw new Error(`Data length (${e.length}) different from column ${t} length (${this.length}).`);this.forEach((n,r)=>n[t]=e[r])}})}),e},Ko=async function(t){const e=await Promise.resolve().then(function(){return qr}),n=JSON.parse(JSON.stringify(t)),r=Yo(n);return r.columns.forEach(t=>{const n=r[t],i=e.mean(n),o=e.deviation(n);r[t]=n.map(t=>null!=t?(t-i)/o:t)}),r},Qo=async function(t,e){const n=document.getElementById(e);n.innerHTML="";const r=t.split("\n");for(const t of r){const e=t.split(","),r=document.createElement("tr");for(const t of e){const e=document.createElement("td");e.textContent=t,r.appendChild(e)}n.appendChild(r)}},Jo=async function(t={}){const{text:e="No text provided",divid:n="",width:r=460,height:i=150,border:o="2px solid",color:s="red"}=t;if(document.getElementById(n)){console.log("textbox div provided in function parameters.");const t=document.getElementById(n);t.id=n,t.style.display="block",t.style.overflow="auto",t.style.width=r+"px",t.style.height=i+"px",t.style.border=o+" "+s,t.style.resize="both",t.style.boxSizing="border-box",t.style.margin="8px 0",Qo(e,n)}else if(document.getElementById("textboxDiv"))console.log("textbox div exists. updating contents..."),Qo(e,"textboxDiv");else{const t=n||"textboxDiv";console.log(`textbox div NOT provided or not found. creating element with id: ${t}`);const a=document.createElement("table");a.id=t,document.body.appendChild(a),Qo(e,t),a.style.display="block",a.style.overflow="auto",a.style.width=r+"px",a.style.height=i+"px",a.style.border=o+" "+s,a.style.resize="both",a.style.boxSizing="border-box",a.style.margin="8px 0"}return document.getElementById(n||"textboxDiv")},Zo={data:{divNum:1,iris:{json:t,csv:null},file:{json:null,csv:null}}},ts=t=>t[0].map((e,n)=>t.map(t=>t[n]));function es(t,e){return t.map(t=>e[t].length>12?e[t].slice(0,6)+"..."+e[t].slice(-3):e[t])}async function ns(e={}){console.log("RUNNING hclust_plot()-------------------------------");const{divid:n="",matrix:r=t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:i=t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:o=Object.keys(t[0]).slice(0,-1),width:s=400,height:a=1200,clusterCols:l=!0,clusterRows:u=!0,clusteringDistanceRows:h="euclidean",clusteringDistanceCols:c="euclidean",clusteringMethodCols:f="complete",clusteringMethodRows:p="complete",marginTop:d=(l?85:53),marginLeft:g=(u?250:80),colPadding:m=(l?12:0),rowPadding:w=(u?75:0),dendogram_font:v="10px",colDendoColor:x="blue",rowDendoColor:M="red",heatmapColor:E="green",heatmapColorScale:S=[0,8],tooltip_decimal:k=2,tooltip_fontFamily:N="monospace",tooltip_fontSize:A="12px"}=e,C=d,I=0,z=g,O=0,T=Qt("svg"),j=r,D=xr(new Do(no(ts(j),Lo[c]),{method:f,isDistanceMatrix:!0}));_r()(D);const $=xr(new Do(no(j,Lo[h]),{method:p,isDistanceMatrix:!0}));_r()($);let V=l?D.leaves().map(t=>t.data.index):b(j[0].length),F=u?$.leaves().map(t=>t.data.index):b(j.length);const L=ts(V.map(t=>ts(F.map(t=>j[t]))[t]));let q=o?es(V,o):Array.from(new Array(j[0].length),(t,e)=>e+1),U=i?es(F,i):Array.from(new Array(j[0].length),(t,e)=>e+1);y(q.map(t=>t.length));const B=y(U.map(t=>String(t).length)),H=Fr().domain(S).range(["#fff",`${E}`]);let X=Ir().domain(q).range([0,s-z-O]),G=Ir().domain(U).range([0,a-C]);T.attr("width",s).attr("height",a),T.append("rect").attr("x",0).attr("y",0).attr("width",s).attr("height",a).attr("fill","#ffffff");const W=T.append("g").attr("transform",`translate(${z+O}, ${C+I})`),Y=W.append("g").call(R(X)).style("font-size",v);Y.selectAll(".tick").selectAll("line").remove(),Y.selectAll("text").style("text-anchor","start").attr("dx","2px").attr("dy","1.1em").attr("transform","rotate(-90)").attr("class","xa").style("fill","#000");let K=W.append("g").call(P(G)).style("font-size",v).attr("id","ya");K.selectAll(".tick").selectAll("line").remove(),K.selectAll("text").attr("dx","2px").attr("dy","0.3em").attr("class","yaa").style("fill","#000");const Q=W.append("g").attr("class","gPoints"),J=Zi().style("border","solid 3px black").style("background-color","white").style("border-radius","10px").style("float","left").style("color","#000").style("font-family",N).html((t,e)=>`\n          <div style='float: right; color: #000;'>\n           value:${e.value.toFixed(k)} <br/>\n           row:${U[e.n]}, col:${q[e.t]} \n        </div>`),Z=await async function(t){let e=[];return b(t.length).map(n=>{const r=b(t[0].length).map(e=>({t:e,n:n,value:t[n][e]}));e=[...e,...r]}),e}(L);T.call(J),Q.selectAll().data(Z).enter().append("rect").attr("x",t=>X(q[t.t])).attr("y",t=>G(U[t.n])).attr("width",s/j[0].length).attr("height",a/j.length).attr("fill",t=>H(t.value)).on("mouseover",J.show).on("mouseout",J.hide);const tt=Zi().style("border","solid 3px black").style("background-color","white").style("border-radius","9px").style("float","left").style("color","#000").style("font-family",N).style("font-size",A).html((t,e)=>`\n<div style='float: right; color: #000;'>\n   Height:${e.source.data.height.toFixed(3)} <br/>\n</div>`);if(1==l){function et(t){const e=m;return e-t.data.height/nt*e}const nt=D.data.height-m+5,rt=D.descendants().reverse(),it=rt.filter(t=>!t.children);it.sort((t,e)=>t.x-e.x);const ot=(s-z)/it.length;it.forEach((t,e)=>t.x=e*ot+ot/2),rt.forEach(t=>{t.children&&(t.x=_(t.children,t=>t.x))}),T.call(tt),D.links().forEach((t,e)=>{var n;T.append("path").attr("class","link").attr("stroke",t.source.color||`${x}`).attr("stroke-width","3px").attr("fill","none").attr("transform",`translate(${z}, ${m})`).attr("d",(n=t,"M"+n.source.x+","+et(n.source)+"H"+n.target.x+"V"+et(n.target))).on("mouseover",tt.show).on("mouseout",tt.hide)})}if(1==u){function st(t){const e=z-w;return e-t.data.height/at*e}const at=$.data.height+2;_r()($);const lt=$.descendants().reverse(),ut=lt.filter(t=>!t.children);ut.sort((t,e)=>t.x-e.x);const ht=(a-C)/ut.length;ut.forEach((t,e)=>t.x=e*ht+ht/2),lt.forEach(t=>{t.children&&(t.x=_(t.children,t=>t.x))}),T.call(tt),$.links().forEach((t,e)=>{var n;T.append("path").attr("class","link").attr("stroke",t.source.color||`${M}`).attr("stroke-width","3px").attr("fill","none").attr("transform",`translate(${B},${C})`).attr("d",(n=t,"M"+st(n.source)+","+n.source.x+"V"+n.target.x+"H"+st(n.target))).on("mouseover",tt.show).on("mouseout",tt.hide)}),T.selectAll("path").data($.links())}if(document.getElementById(n)){const ct=document.getElementById(n);ct.innerHTML="",ct.appendChild(T.node()),console.log("hclust div provided in function parameters.",ct,n)}else if(!document.getElementById("childDiv")){const ft=Zo.data.divNum,pt=document.createElement("div");pt.id=n||"hclust_plot"+ft,console.log("div  NOT provided in function options or doesn't exist... created a new div with id: ",pt.id,"and appended to document body!"),document.body.appendChild(pt),pt.appendChild(T.node()),Zo.data.divNum=ft+1}return T.node()}async function rs(e={}){console.log("RUNNING hclust_UI()-------------------------------"),console.log("hclust UI div num",Zo.data.divNum);const{divid:n=""}=e;let r=document.getElementById(n);document.getElementById(n)?console.log("hclust_UI() div ID provided, loading div:",r):(console.log("hclust_UI() div NOT provided. creating div...",r),r=document.createElement("div"),r.id="loadUI"+Zo.data.divNum,r.style.alignContent="center",document.body.appendChild(r),console.log("hclust_UI() div NOT provided. creating div...",r));const i=document.createElement("button");i.id="irisDataButton"+Zo.data.divNum,i.textContent="Load Iris Data",r.appendChild(i),console.log("hclustUI: irisDataButton:",document.getElementById(i.id));const o=document.createElement("input");o.id="fileInput"+Zo.data.divNum,o.setAttribute("type","file"),r.appendChild(o),r.append(document.createElement("br")),r.append(document.createElement("br"));const s=document.createElement("div");s.id="hcplotDiv"+Zo.data.divNum,r.appendChild(s),console.log("hclustUI: plotDiv:",document.getElementById(s.id));const a=document.createElement("div");a.id="textBoxDiv"+Zo.data.divNum,a.style.alignContent="center",r.appendChild(a),console.log("hclustUI: textBoxDiv:",document.getElementById(a.id)),o.addEventListener("change",t=>{console.log(Zo.data.divNum,"fileInput button clicked!");const e=t.target.files;for(const n of e){const e=new FileReader;e.onload=e=>{const n=t.target.files[0];if(n){const t=new FileReader;t.onload=async function(t){const e=t.target.result,n=await Uo(e);console.log("hclustDt.data.divNum",Zo.data.divNum);if(n.map(Object.values).headers=n.headers,Zo.data.file=[],Zo.data.file.json=n,Zo.data.file.csv=e,!document.getElementById("rowCluster"+Zo.data.divNum)){console.log("*********",!document.getElementById("rowCluster"+Zo.data.divNum));const t=document.createElement("button");t.id="rowCluster"+Zo.data.divNum,t.textContent="Cluster by Rows",r.appendChild(t),console.log("hclustUI: rowCluster:",document.getElementById(t.id));const e=document.createElement("button");e.id="colCluster"+Zo.data.divNum,e.textContent="Cluster by Columns",r.appendChild(e),r.append(document.createElement("br")),r.append(document.createElement("br"))}console.log("load iris data button for Hclust clicked!"),ns({matrix:Zo.data.file.json.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:Zo.data.file.json.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(Zo.data.file.json[0]).slice(0,-1),divid:s.id,clusterCols:!1,clusterRows:!1})},t.onerror=function(){displayError("Error reading the file.")},t.readAsText(n)}},e.readAsText(n)}}),document.getElementById(i.id).addEventListener("click",async function(){let e=!1,n=!1;if(!document.getElementById("rowCluster"+Zo.data.divNum)){console.log("*********",!document.getElementById("rowCluster"+Zo.data.divNum));const t=document.createElement("button");t.id="rowCluster"+Zo.data.divNum,t.textContent="Cluster by Rows",r.appendChild(t),console.log("hclustUI: rowCluster:",document.getElementById(t.id));const e=document.createElement("button");e.id="colCluster"+Zo.data.divNum,e.textContent="Cluster by Columns",r.appendChild(e),r.append(document.createElement("br")),r.append(document.createElement("br"))}console.log("load iris data button for Hclust clicked!"),ns({matrix:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:s.id,clusterCols:n,clusterRows:e}),document.getElementById("rowCluster"+Zo.data.divNum).addEventListener("click",async function(){console.log(document.getElementById("rowCluster"+Zo.data.divNum)),console.log("clusterRows",e),0==e?e=!0:1==e&&(e=!1),console.log("clusterRows",e),ns({matrix:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:s.id,clusterCols:n,clusterRows:e})}),document.getElementById("colCluster"+Zo.data.divNum).addEventListener("click",async function(){console.log(document.getElementById("colCluster"+Zo.data.divNum)),console.log("clusterCols",n),0==n?n=!0:1==n&&(n=!1),console.log("clusterCols",n),ns({matrix:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:s.id,clusterCols:n,clusterRows:e})})}),console.log(`rowCluster${Zo.data.divNum}`),console.log(document.getElementById(`rowCluster${Zo.data.divNum}`)),Zo.data.divNum+=1}class is{constructor(t,e={},n){if(this.U=null,this.S=null,n)return this.center=n.center,this.scale=n.scale,this.means=n.means,this.stdevs=n.stdevs,this.U=mo.checkMatrix(n.U),this.S=n.S,this.R=n.R,void(this.excludedFeatures=n.excludedFeatures||[]);let r;r=(Array.isArray(t),new mo(t));const{isCovarianceMatrix:i=!1,method:o="SVD",nCompNIPALS:s=2,center:a=!0,scale:l=!1,ignoreZeroVariance:u=!1}=e;if(this.center=a,this.scale=l,this.means=null,this.stdevs=null,this.excludedFeatures=[],i)this._computeFromCovarianceMatrix(r);else switch(this._adjust(r,u),o){case"covarianceMatrix":{const t=new wo(r).mmul(r).div(r.rows-1);this._computeFromCovarianceMatrix(t);break}case"NIPALS":this._computeWithNIPALS(r,s);break;case"SVD":{const t=new vo(r,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=t.rightSingularVectors;const e=t.diagonal,n=[];for(const t of e)n.push(t*t/(r.rows-1));this.S=n;break}default:throw new Error(`unknown method: ${o}`)}}static load(t){if("string"!=typeof t.name)throw new TypeError("model must have a name property");if("PCA"!==t.name)throw new RangeError(`invalid model: ${t.name}`);return new is(void 0,void 0,t)}predict(t,e={}){const{nComponents:n=this.U.columns}=e;let r;if(r=(Array.isArray(t),new mo(t)),this.center&&(r.subRowVector(this.means),this.scale)){for(let t of this.excludedFeatures)r.removeColumn(t);r.divRowVector(this.stdevs)}let i=r.mmul(this.U);return i.subMatrix(0,i.rows-1,0,n-1)}invert(t){let e=(t=mo.checkMatrix(t)).mmul(this.U.transpose());return this.center&&(this.scale&&e.mulRowVector(this.stdevs),e.addRowVector(this.means)),e}getExplainedVariance(){let t=0;if(this.S)for(const e of this.S)t+=e;return this.S?this.S.map(e=>e/t):[]}getCumulativeVariance(){let t=this.getExplainedVariance();for(let e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(t=>Math.sqrt(t))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S,excludedFeatures:this.excludedFeatures}}_adjust(t,e){if(this.center){const n=t.mean("column"),r=this.scale?t.standardDeviation("column",{mean:n}):null;if(this.means=n,t.subRowVector(n),this.scale){for(let n=0;n<r.length;n++)if(0===r[n]){if(!e)throw new RangeError(`Cannot scale the dataset (standard deviation is zero at index ${n}`);t.removeColumn(n),r.splice(n,1),this.excludedFeatures.push(n),n--}this.stdevs=r,t.divRowVector(r)}}}_computeFromCovarianceMatrix(t){const e=new go(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix,this.U.flipRows(),this.S=e.realEigenvalues,this.S.reverse()}_computeWithNIPALS(t,e){this.U=new mo(e,t.columns),this.S=[];let n=t;for(let t=0;t<e;t++){let e=new yo(n);this.U.setRow(t,e.w.transpose()),this.S.push(Math.pow(e.s.get(0,0),2)),n=e.xResidual}this.U=this.U.transpose()}}const os={data:{divNum:1,iris:{json:t,csv:null},file:{json:null,csv:null}}};function ss(t,e,n){const r=Jt(".points").filter(t=>t.group!==e),i=Jt(".keyRects").filter(t=>t===e),o=Jt(".points").filter(t=>t.group===e),s=Jt(".keyRects").filter(t=>t!==e);r.transition().attr("opacity",.1),s.transition().attr("opacity",.1),o.transition().attr("opacity",n),i.transition().attr("opacity",n)}async function as(e={}){console.log("RUNNING: pca_plot() function----------");const{divid:n="",data:r=t,width:i=600,height:o=300,colors:s=["red","blue","green","orange","purple","pink","yellow"]}=e;let l=n?document.getElementById(n):null;if(l)console.log("div provided in function parameters:",n),l.innerHTML="";else{const t=os.data.divNum;l=document.createElement("div"),l.id=n||"pca_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",l.id,"and appended to document body!"),document.body.appendChild(l),os.data.divNum=t+1}const u=await async function(t){const e=Go(t);let n=(await Ko(e)).map(Object.values);return new is(n,{center:!0,scale:!0}).predict(n).toJSON().map((e,n)=>({group:t[n]?.species,name:"id_"+n,PC1:e[0],PC2:e[1]}))}(r),h=[...new Set(u.map(t=>t.group))],c=Rr(s).domain(h),f=25,p=170,d=45,g=45,m=v(u,t=>t.PC1),w=y(u,t=>t.PC1),_=w-m,b=m-.1*_,x=w+.1*_,M=Fr().domain([b,x]).range([g,i-p]),E=Fr().domain(a(u,t=>t.PC2)).range([o-d,f]),S=Qt("svg").style("background","white").style("overflow","visible");S.attr("id","svgid"),S.append("text").attr("x",i/2-g).attr("y",f/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("PCA Plot");const k=S.attr("width",i).attr("height",o).append("g");k.append("g").call(t=>t.attr("transform",`translate(0,${o-d+5})`).call(I(M).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-p).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("PC1"))),k.append("g").call(t=>t.attr("transform",`translate(${g-5},0)`).call(P(E).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",f-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("PC2"))),k.append("rect").attr("id","background").attr("x",g).attr("y",f).attr("width",i-g-p).attr("height",o-f-d).attr("fill","white").on("click",(t,e)=>ss(0,e,.7));const N=k.append("g").attr("class","gPoints").style("isolation","isolate"),A=Zi().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n          <div style='line-height: 1.5;'>\n            <div><strong>Name:</strong> ${e.name}</div>\n            <div><strong>PC1:</strong> ${e.PC1.toFixed(2)}</div>\n            <div><strong>PC2:</strong> ${e.PC2.toFixed(2)}</div>\n          </div>`);S.call(A),N.selectAll("circle").data(u).enter().append("circle").attr("class","points").attr("cx",t=>M(t.PC1)).attr("cy",t=>E(t.PC2)).attr("fill",t=>c(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",A.show).on("mouseout",A.hide);const C=k.append("g").selectAll("rect").data(h);C.enter().append("rect").attr("class","keyRects").attr("x",i-g-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>c(t)).on("click",(t,e)=>ss(0,e,.7)),C.enter().append("text").attr("x",t=>i-g-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","11px").on("click",(t,e)=>ss(0,e,.7)),l.appendChild(S.node())}async function ls(e={}){console.log("RUNNING pca_UI()-------------------------------");const{divid:n="",data:r=t,width:i=600,height:o=300,colors:s=["red","blue","green","orange","purple","pink","yellow"],loadIrisOnStart:a=!1}=e,l=os.data.divNum;let u=n?document.getElementById(n):null;u?(console.log("div provided in function parameters:",n),u.innerHTML=""):(u=document.createElement("div"),u.id=n||"pca_UI"+l,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",u.id,"and appended to document body!"),document.body.appendChild(u));const h=document.createElement("div");h.id="loadingMessage_"+l,h.style.display="none",h.style.padding="10px",h.style.margin="10px 0",h.style.backgroundColor="#e3f2fd",h.style.border="1px solid #2196F3",h.style.borderRadius="4px",h.textContent="Processing data...";const c=document.createElement("div");c.id="errorMessage_"+l,c.style.display="none",c.style.padding="10px",c.style.margin="10px 0",c.style.backgroundColor="#ffebee",c.style.border="1px solid #f44336",c.style.borderRadius="4px",c.style.color="#c62828";const f=document.createElement("button");f.id="irisDataButton_"+l,f.textContent="Load Iris Data",f.setAttribute("aria-label","Load built-in iris dataset"),f.style.marginRight="10px",f.style.padding="5px 10px";const p=document.createElement("input");p.id="fileInput_"+l,p.setAttribute("type","file"),p.setAttribute("accept",".csv"),p.setAttribute("aria-label","Upload CSV file for PCA analysis");const d=document.createElement("label");d.setAttribute("for",p.id),d.textContent="Or upload CSV file: ",d.style.marginLeft="10px",u.appendChild(f),u.appendChild(d),u.appendChild(p),u.appendChild(document.createElement("br")),u.appendChild(h),u.appendChild(c),u.appendChild(document.createElement("br"));const g=document.createElement("div");g.id="pcaplotDiv_"+l,u.appendChild(g);const m=document.createElement("div");m.id="textBoxDiv_"+l,m.style.alignContent="center",u.appendChild(m);const w=t=>{c.textContent=t,c.style.display="block",h.style.display="none"},y=async(t,e)=>{try{h.style.display="block",c.style.display="none";const n=Go(t);if(0===n.length||0===Object.keys(n[0]).length)throw new Error("No numeric columns found in data. PCA requires numeric data.");g.innerHTML="",m.innerHTML="",await as({data:t,divid:g.id,width:i,height:o,colors:s}),await Jo({text:e,divid:m.id}),h.style.display="none"}catch(t){console.error("Error rendering data:",t),w(`Error: ${t.message}`)}},v=async t=>{const e=t.target.files[0];if(!e)return;if(console.log(l,"fileInput button clicked!"),!e.name.endsWith(".csv"))return void w("Please upload a CSV file.");const n=new FileReader;n.onload=async function(t){try{const e=t.target.result;if(!e||0===e.trim().length)throw new Error("File is empty.");const n=await Uo(e);if(!n||0===n.length)throw new Error("No valid data found in CSV file.");os.data.file.json=n,os.data.file.csv=e,await y(n,e)}catch(t){console.error("Error processing file:",t),w(`Error processing file: ${t.message}`)}},n.onerror=function(){w("Error reading the file. Please try again.")},n.readAsText(e)};p.removeEventListener("change",v),p.addEventListener("change",v);const _=async function(){console.log(l,"load iris data button clicked!"),await y(os.data.iris.json,os.data.iris.csv)};return f.removeEventListener("click",_),f.addEventListener("click",_),a&&await y(os.data.iris.json,os.data.iris.csv),os.data.divNum+=1,u}async function us(t={}){const{divid:e,data:n=[],width:r=600,height:i=300,colors:o=["red","blue","green","orange","purple","pink","yellow"],perplexity:s=30,learningRate:a=10,iterations:l=1e3}=t;console.log("t-SNE plot - not yet implemented"),console.log("Options:",{divid:e,width:r,height:i,colors:o,perplexity:s,learningRate:a,iterations:l})}const hs=async(t={})=>{console.log("t-SNE UI - not yet implemented"),console.log("Options:",t)};var cs,fs,ps={},ds={},gs={},ms={};function ws(){if(cs)return ms;cs=1;var t=ms&&ms.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function e(t,e){return Math.floor(e()*t)}function n(t){for(var e=[],n=0;n<t;n++)e.push(void 0);return e}function r(t,e){return n(t).map(function(){return e})}function i(t){return r(t,0)}function o(t){return t.reduce(function(t,e){return t+e})}return Object.defineProperty(ms,"__esModule",{value:!0}),ms.reshape2d=ms.rejectionSample=ms.max2d=ms.max=ms.mean=ms.sum=ms.linear=ms.ones=ms.zeros=ms.filled=ms.range=ms.empty=ms.norm=ms.tauRand=ms.tauRandInt=void 0,ms.tauRandInt=e,ms.tauRand=function(t){return t()},ms.norm=function(e){var n,r,i=0;try{for(var o=t(e),s=o.next();!s.done;s=o.next()){var a=s.value;i+=Math.pow(a,2)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return Math.sqrt(i)},ms.empty=n,ms.range=function(t){return n(t).map(function(t,e){return e})},ms.filled=r,ms.zeros=i,ms.ones=function(t){return r(t,1)},ms.linear=function(t,e,r){return n(r).map(function(n,i){return t+i*((e-t)/(r-1))})},ms.sum=o,ms.mean=function(t){return o(t)/t.length},ms.max=function(t){for(var e=0,n=0;n<t.length;n++)e=t[n]>e?t[n]:e;return e},ms.max2d=function(t){for(var e=0,n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)e=t[n][r]>e?t[n][r]:e;return e},ms.rejectionSample=function(t,n,r){for(var o=i(t),s=0;s<t;s++)for(var a=!0;a;){for(var l=e(n,r),u=!1,h=0;h<s;h++)if(l===o[h]){u=!0;break}u||(a=!1),o[s]=l}return o},ms.reshape2d=function(t,e,n){var r=[],i=0;if(t.length!==e*n)throw new Error("Array dimensions must match input length.");for(var o=0;o<e;o++){for(var s=[],a=0;a<n;a++)s.push(t[i]),i+=1;r.push(s)}return r},ms}function ys(){if(fs)return gs;fs=1;var t=gs&&gs.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),e=gs&&gs.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=gs&&gs.__importStar||function(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var i in n)"default"!==i&&Object.hasOwnProperty.call(n,i)&&t(r,n,i);return e(r,n),r};Object.defineProperty(gs,"__esModule",{value:!0}),gs.smallestFlagged=gs.deheapSort=gs.buildCandidates=gs.uncheckedHeapPush=gs.heapPush=gs.rejectionSample=gs.makeHeap=void 0;var r=n(ws());function i(t,e){var n=function(n){return r.empty(t).map(function(){return r.filled(e,n)})},i=[];return i.push(n(-1)),i.push(n(1/0)),i.push(n(0)),i}function o(t,e,n,r,i){e=Math.floor(e);var o=t[0][e],a=t[1][e];if(t[2][e],n>=a[0])return 0;for(var l=0;l<o.length;l++)if(r===o[l])return 0;return s(t,e,n,r,i)}function s(t,e,n,r,i){var o=t[0][e],s=t[1][e],a=t[2][e];if(n>=s[0])return 0;s[0]=n,o[0]=r,a[0]=i;for(var l=0,u=0;;){var h=2*l+1,c=h+1,f=t[0][0].length;if(h>=f)break;if(c>=f){if(!(s[h]>n))break;u=h}else if(s[h]>=s[c]){if(!(n<s[h]))break;u=h}else{if(!(n<s[c]))break;u=c}s[l]=s[u],o[l]=o[u],a[l]=a[u],l=u}return s[l]=n,o[l]=r,a[l]=i,1}function a(t,e,n,r){for(;2*r+1<n;){var i=2*r+1,o=i+1,s=r;if(t[s]<t[i]&&(s=i),o<n&&t[s]<t[o]&&(s=o),s===r)break;var a=t[r];t[r]=t[s],t[s]=a;var l=e[r];e[r]=e[s],e[s]=l,r=s}}return gs.makeHeap=i,gs.rejectionSample=function(t,e,n){for(var i=r.zeros(t),o=0;o<t;o++){for(var s=!0,a=0;s;){a=r.tauRandInt(e,n);for(var l=!1,u=0;u<o;u++)if(a===i[u]){l=!0;break}l||(s=!1)}i[o]=a}return i},gs.heapPush=o,gs.uncheckedHeapPush=s,gs.buildCandidates=function(t,e,n,s,a){for(var l=i(e,s),u=0;u<e;u++)for(var h=0;h<n;h++)if(!(t[0][u][h]<0)){var c=t[0][u][h],f=t[2][u][h],p=r.tauRand(a);o(l,u,p,c,f),o(l,c,p,u,f),t[2][u][h]=0}return l},gs.deheapSort=function(t){for(var e=t[0],n=t[1],r=0;r<e.length;r++)for(var i=e[r],o=n[r],s=0;s<i.length-1;s++){var l=i.length-s-1,u=o.length-s-1,h=i[0];i[0]=i[l],i[l]=h;var c=o[0];o[0]=o[u],o[u]=c,a(o,i,u,0)}return{indices:e,weights:n}},gs.smallestFlagged=function(t,e){for(var n=t[0][e],r=t[1][e],i=t[2][e],o=1/0,s=-1,a=0;a>n.length;a++)1===i[a]&&r[a]<o&&(o=r[a],s=a);return s>=0?(i[s]=0,Math.floor(n[s])):-1},gs}var vs,_s={};function bs(){if(vs)return _s;vs=1;var t,e=_s&&_s.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),n=_s&&_s.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=_s&&_s.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&e(r,t,i);return n(r,t),r},i=_s&&_s.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=_s&&_s.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(_s,"__esModule",{value:!0}),_s.getCSR=_s.normalize=_s.eliminateZeros=_s.multiplyScalar=_s.maximum=_s.subtract=_s.add=_s.pairwiseMultiply=_s.identity=_s.transpose=_s.SparseMatrix=void 0;var s=r(ws()),a=function(){function t(t,e,n,r){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==n.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=r[0],this.nCols=r[1];for(var i=0;i<n.length;i++){var o=t[i],s=e[i];this.checkDims(o,s);var a=this.makeKey(o,s);this.entries.set(a,{value:n[i],row:o,col:s})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,n){this.checkDims(t,e);var r=this.makeKey(t,e);this.entries.has(r)?this.entries.get(r).value=n:this.entries.set(r,{value:n,row:t,col:e})},t.prototype.get=function(t,e,n){void 0===n&&(n=0),this.checkDims(t,e);var r=this.makeKey(t,e);return this.entries.has(r)?this.entries.get(r).value:n},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach(function(t){e.push(t)}),t&&e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].row})},t.prototype.getCols=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].col})},t.prototype.getValues=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].value})},t.prototype.forEach=function(t){this.entries.forEach(function(e){return t(e.value,e.row,e.col)})},t.prototype.map=function(e){var n=[];this.entries.forEach(function(t){n.push(e(t.value,t.row,t.col))});var r=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),n,r)},t.prototype.toArray=function(){var t=this,e=s.empty(this.nRows).map(function(){return s.zeros(t.nCols)});return this.entries.forEach(function(t){e[t.row][t.col]=t.value}),e},t}();_s.SparseMatrix=a,_s.transpose=function(t){var e=[],n=[],r=[];t.forEach(function(t,i,o){e.push(i),n.push(o),r.push(t)});var i=[t.nCols,t.nRows];return new a(n,e,r,i)},_s.identity=function(t){for(var e=i(t,1)[0],n=new a([],[],[],t),r=0;r<e;r++)n.set(r,r,1);return n},_s.pairwiseMultiply=function(t,e){return u(t,e,function(t,e){return t*e})},_s.add=function(t,e){return u(t,e,function(t,e){return t+e})},_s.subtract=function(t,e){return u(t,e,function(t,e){return t-e})},_s.maximum=function(t,e){return u(t,e,function(t,e){return t>e?t:e})},_s.multiplyScalar=function(t,e){return t.map(function(t){return t*e})},_s.eliminateZeros=function(t){for(var e=new Set,n=t.getValues(),r=t.getRows(),i=t.getCols(),o=0;o<n.length;o++)0===n[o]&&e.add(o);var s=function(t,n){return!e.has(n)},l=n.filter(s),u=r.filter(s),h=i.filter(s);return new a(u,h,l,t.getDims())},_s.normalize=function(t,e){var n,r;void 0===e&&(e="l2");var i=l[e],s=new Map;t.forEach(function(t,e,n){var r=s.get(e)||[];r.push(n),s.set(e,r)});var u=new a([],[],[],t.getDims()),h=function(e){for(var n=s.get(e).sort(),r=n.map(function(n){return t.get(e,n)}),o=i(r),a=0;a<o.length;a++)u.set(e,n[a],o[a])};try{for(var c=o(s.keys()),f=c.next();!f.done;f=c.next()){h(f.value)}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return u};var l=((t={}).max=function(t){for(var e=-1/0,n=0;n<t.length;n++)e=t[n]>e?t[n]:e;return t.map(function(t){return t/e})},t.l1=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return t.map(function(t){return t/e})},t.l2=function(t){for(var e=0,n=0;n<t.length;n++)e+=Math.pow(t[n],2);return t.map(function(t){return Math.sqrt(Math.pow(t,2)/e)})},t);function u(t,e,n){for(var r=new Set,i=[],o=[],s=[],l=function(r,a){i.push(r),o.push(a);var l=n(t.get(r,a),e.get(r,a));s.push(l)},u=t.getValues(),h=t.getRows(),c=t.getCols(),f=0;f<u.length;f++){var p=(w=h[f])+":"+(y=c[f]);r.add(p),l(w,y)}var d=e.getValues(),g=e.getRows(),m=e.getCols();for(f=0;f<d.length;f++){var w,y;p=(w=g[f])+":"+(y=m[f]);r.has(p)||l(w,y)}var v=[t.nRows,t.nCols];return new a(i,o,s,v)}return _s.getCSR=function(t){var e=[];t.forEach(function(t,n,r){e.push({value:t,row:n,col:r})}),e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row});for(var n=[],r=[],i=[],o=-1,s=0;s<e.length;s++){var a=e[s],l=a.row,u=a.col,h=a.value;l!==o&&(o=l,i.push(s)),n.push(u),r.push(h)}return{indices:n,values:r,indptr:i}},_s}var xs,Ms,Es={},Ss={};function ks(){if(xs)return Ss;xs=1;var t=Ss&&Ss.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),e=Ss&&Ss.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=Ss&&Ss.__importStar||function(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var i in n)"default"!==i&&Object.hasOwnProperty.call(n,i)&&t(r,n,i);return e(r,n),r},r=Ss&&Ss.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=Ss&&Ss.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(r(arguments[e]));return t},o=Ss&&Ss.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.searchFlatTree=Ss.makeLeafArray=Ss.makeForest=Ss.FlatTree=void 0;var s=n(ws()),a=function(t,e,n,r){this.hyperplanes=t,this.offsets=e,this.children=n,this.indices=r};function l(t,e,n,r,i){if(void 0===n&&(n=30),e.length>n){var o=function(t,e,n){var r=t[0].length,i=s.tauRandInt(e.length,n),o=s.tauRandInt(e.length,n);o=(o+=i===o?1:0)%e.length;for(var a=e[i],l=e[o],u=0,h=s.zeros(r),c=0;c<h.length;c++)h[c]=t[a][c]-t[l][c],u-=h[c]*(t[a][c]+t[l][c])/2;var f=0,p=0,d=s.zeros(e.length);for(c=0;c<e.length;c++){for(var g=u,m=0;m<r;m++)g+=h[m]*t[e[c]][m];0===g?(d[c]=s.tauRandInt(2,n),0===d[c]?f+=1:p+=1):g>0?(d[c]=0,f+=1):(d[c]=1,p+=1)}var w=s.zeros(f),y=s.zeros(p);f=0,p=0;for(c=0;c<d.length;c++)0===d[c]?(w[f]=e[c],f+=1):(y[p]=e[c],p+=1);return{indicesLeft:w,indicesRight:y,hyperplane:h,offset:u}}(t,e,i),a=o.indicesLeft,u=o.indicesRight,h=o.hyperplane,c=o.offset;return{leftChild:l(t,a,n,r+1,i),rightChild:l(t,u,n,r+1,i),isLeaf:!1,hyperplane:h,offset:c}}return{indices:e,isLeaf:!0}}function u(t,e,n,r,o,s,a){var l;if(t.isLeaf)return r[s][0]=-a,(l=o[a]).splice.apply(l,i([0,t.indices.length],t.indices)),{nodeNum:s,leafNum:a+=1};e[s]=t.hyperplane,n[s]=t.offset,r[s][0]=s+1;var h=s,c=u(t.leftChild,e,n,r,o,s+1,a);return s=c.nodeNum,a=c.leafNum,r[h][1]=s+1,{nodeNum:(c=u(t.rightChild,e,n,r,o,s+1,a)).nodeNum,leafNum:c.leafNum}}function h(t){return t.isLeaf?1:1+h(t.leftChild)+h(t.rightChild)}function c(t){return t.isLeaf?1:c(t.leftChild)+c(t.rightChild)}function f(t,e,n,r){for(var i=e,o=0;o<n.length;o++)i+=t[o]*n[o];return 0===i?s.tauRandInt(2,r):i>0?0:1}return Ss.FlatTree=a,Ss.makeForest=function(t,e,n,r){var i=Math.max(10,e),o=s.range(n).map(function(e,n){return function(t,e,n,r){void 0===e&&(e=30);var i=s.range(t.length),o=l(t,i,e,n,r);return o}(t,i,n,r)}),f=o.map(function(t){return function(t,e){var n=h(t),r=c(t),i=s.range(n).map(function(){return s.zeros(t.hyperplane?t.hyperplane.length:0)}),o=s.zeros(n),l=s.range(n).map(function(){return[-1,-1]}),f=s.range(r).map(function(){return s.range(e).map(function(){return-1})});return u(t,i,o,l,f,0,0),new a(i,o,l,f)}(t,i)});return f},Ss.makeLeafArray=function(t){var e,n;if(t.length>0){var r=[];try{for(var s=o(t),a=s.next();!a.done;a=s.next()){var l=a.value;r.push.apply(r,i(l.indices))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return r}return[[-1]]},Ss.searchFlatTree=function(t,e,n){for(var r=0;e.children[r][0]>0;){r=0===f(e.hyperplanes[r],e.offsets[r],t,n)?e.children[r][0]:e.children[r][1]}var i=-1*e.children[r][0];return e.indices[i]},Ss}const Ns=Object.prototype.toString;function As(t){return Ns.call(t).endsWith("Array]")}function Cs(t,e,n){let r=0;const i=n(e);for(let e=0;e<t.x.length;e++)r+=Math.abs(t.y[e]-i(t.x[e]));return r}function Rs(t,e,n,r,i){let o=n*r*r,s=mo.eye(e.length,e.length,o);const a=i(e);let l=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)l[e]=a(t.x[e]);let u=function(t,e,n,r,i){const o=n.length,s=t.x.length;let a=new Array(o);for(let l=0;l<o;l++){a[l]=new Array(s);let o=n.slice();o[l]+=r;let u=i(o);for(let n=0;n<s;n++)a[l][n]=e[n]-u(t.x[n])}return new mo(a)}(t,l,e,r,i),h=function(t,e){const n=t.x.length;let r=new Array(n);for(let i=0;i<n;i++)r[i]=[t.y[i]-e[i]];return new mo(r)}(t,l),c=_o(s.add(u.mmul(u.transpose())));return(e=(e=new mo([e])).sub(c.mmul(u).mmul(h).mul(r).transpose())).to1DArray()}var Is,Ps,zs=io(Object.freeze({__proto__:null,default:function(t,e,n={}){let{maxIterations:r=100,gradientDifference:i=.1,damping:o=0,errorTolerance:s=.01,minValues:a,maxValues:l,initialValues:u}=n;if(o<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!As(t.x)||t.x.length<2||!As(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let h=u||new Array(e.length).fill(1),c=h.length;if(l=l||new Array(c).fill(Number.MAX_SAFE_INTEGER),a=a||new Array(c).fill(Number.MIN_SAFE_INTEGER),l.length!==a.length)throw new Error("minValues and maxValues must be the same size");if(!As(h))throw new Error("initialValues must be an array");let f,p=Cs(t,h,e),d=p<=s;for(f=0;f<r&&!d;f++){h=Rs(t,h,o,i,e);for(let t=0;t<c;t++)h[t]=Math.min(Math.max(a[t],h[t]),l[t]);if(p=Cs(t,h,e),isNaN(p))break;d=p<=s}return{parameterValues:h,parameterError:p,iterations:f}}}));function Os(){if(Is)return ds;Is=1;var t=ds&&ds.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),e=ds&&ds.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=ds&&ds.__importStar||function(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var i in n)"default"!==i&&Object.hasOwnProperty.call(n,i)&&t(r,n,i);return e(r,n),r},r=ds&&ds.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}l((r=r.apply(t,e||[])).next())})},i=ds&&ds.__generator||function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=ds&&ds.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=ds&&ds.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=ds&&ds.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ds,"__esModule",{value:!0}),ds.initTransform=ds.resetLocalConnectivity=ds.fastIntersection=ds.findABParams=ds.cosine=ds.euclidean=ds.UMAP=void 0;var l=n(ys()),u=n(bs()),h=n(function(){if(Ms)return Es;Ms=1;var t=Es&&Es.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),e=Es&&Es.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=Es&&Es.__importStar||function(n){if(n&&n.__esModule)return n;var r={};if(null!=n)for(var i in n)"default"!==i&&Object.hasOwnProperty.call(n,i)&&t(r,n,i);return e(r,n),r},r=Es&&Es.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Es,"__esModule",{value:!0}),Es.initializeSearch=Es.makeInitializedNNSearch=Es.makeInitializations=Es.makeNNDescent=void 0;var i=n(ys()),o=n(bs()),s=n(ks()),a=n(ws());return Es.makeNNDescent=function(t,e){return function(n,r,o,s,l,u,h,c){void 0===s&&(s=10),void 0===l&&(l=50),void 0===u&&(u=.001),void 0===h&&(h=.5),void 0===c&&(c=!0);for(var f=n.length,p=i.makeHeap(n.length,o),d=0;d<n.length;d++)for(var g=i.rejectionSample(o,n.length,e),m=0;m<g.length;m++){var w=t(n[d],n[g[m]]);i.heapPush(p,d,w,g[m],1),i.heapPush(p,g[m],w,d,1)}if(c)for(var y=0;y<r.length;y++)for(d=0;d<r[y].length&&!(r[y][d]<0);d++)for(m=d+1;m<r[y].length&&!(r[y][m]<0);m++)w=t(n[r[y][d]],n[r[y][m]]),i.heapPush(p,r[y][d],w,r[y][m],1),i.heapPush(p,r[y][m],w,r[y][d],1);for(y=0;y<s;y++){var v=i.buildCandidates(p,f,o,l,e),_=0;for(d=0;d<f;d++)for(m=0;m<l;m++){var b=Math.floor(v[0][d][m]);if(!(b<0||a.tauRand(e)<h))for(var x=0;x<l;x++){var M=Math.floor(v[0][d][x]),E=v[2][d][m],S=v[2][d][x];M<0||!E&&!S||(w=t(n[b],n[M]),_+=i.heapPush(p,b,w,M,1),_+=i.heapPush(p,M,w,b,1))}}if(_<=u*o*n.length)break}return i.deheapSort(p)}},Es.makeInitializations=function(t){return{initFromRandom:function(e,n,r,o,s){for(var l=0;l<r.length;l++)for(var u=a.rejectionSample(e,n.length,s),h=0;h<u.length;h++)if(!(u[h]<0)){var c=t(n[u[h]],r[l]);i.heapPush(o,l,c,u[h],1)}},initFromTree:function(e,n,r,o,a){for(var l=0;l<r.length;l++)for(var u=s.searchFlatTree(r[l],e,a),h=0;h<u.length;h++){if(u[h]<0)return;var c=t(n[u[h]],r[l]);i.heapPush(o,l,c,u[h],1)}}}},Es.makeInitializedNNSearch=function(t){return function(e,n,s,a){for(var l,u,h=o.getCSR(n),c=h.indices,f=h.indptr,p=0;p<a.length;p++)for(var d=new Set(s[0][p]);;){var g=i.smallestFlagged(s,p);if(-1===g)break;var m=c.slice(f[g],f[g+1]);try{for(var w=(l=void 0,r(m)),y=w.next();!y.done;y=w.next()){var v=y.value;if(v!==g&&-1!==v&&!d.has(v)){var _=t(e[v],a[p]);i.uncheckedHeapPush(s,p,_,v,1),d.add(v)}}}catch(t){l={error:t}}finally{try{y&&!y.done&&(u=w.return)&&u.call(w)}finally{if(l)throw l.error}}}return s}},Es.initializeSearch=function(t,e,n,o,s,a,l){var u,h,c=i.makeHeap(n.length,o);if(s(o,e,n,c,l),t)try{for(var f=r(t),p=f.next();!p.done;p=f.next())a(p.value,e,n,c,l)}catch(t){u={error:t}}finally{try{p&&!p.done&&(h=f.return)&&h.call(f)}finally{if(u)throw u.error}}return c},Es}()),c=n(ks()),f=n(ws()),p=a(zs),d=1e-5,g=.001,m=function(){function t(t){var e=this;void 0===t&&(t={}),this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=w,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new y;var n=function(n){void 0!==t[n]&&(e[n]=t[n])};n("distanceFn"),n("learningRate"),n("localConnectivity"),n("minDist"),n("nComponents"),n("nEpochs"),n("nNeighbors"),n("negativeSampleRate"),n("random"),n("repulsionStrength"),n("setOpMixRatio"),n("spread"),n("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),r(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return n.sent(),[2,this.embedding]}})})},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var n=this.initializeSimplicialSetEmbedding(),r=n.head,i=n.tail,o=n.epochsPerSample;return this.optimizationState.head=r,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=o,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=h.makeInitializations(this.distanceFn),e=t.initFromTree,n=t.initFromRandom;this.initFromTree=e,this.initFromRandom=n,this.search=h.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,n=this.knnDistances,r=[t.length,t.length],i=new u.SparseMatrix([],[],[],r),o=0;o<e.length;o++)for(var s=e[o],a=n[o],l=0;l<s.length;l++){var h=s[l],c=a[l];c>0&&i.set(o,h,c)}var f=u.transpose(i);return u.maximum(i,f)},t.prototype.transform=function(t){var e=this,n=this.X;if(void 0===n||0===n.length)throw new Error("No data has been fit.");var r=Math.floor(this.nNeighbors*this.transformQueueSize);r=Math.min(n.length,r);var i=h.initializeSearch(this.rpForest,n,t,r,this.initFromRandom,this.initFromTree,this.random),o=this.search(n,this.searchGraph,i,t),s=l.deheapSort(o),a=s.indices,c=s.weights;a=a.map(function(t){return t.slice(0,e.nNeighbors)}),c=c.map(function(t){return t.slice(0,e.nNeighbors)});var p=Math.max(0,this.localConnectivity-1),d=this.smoothKNNDistance(c,this.nNeighbors,p),g=d.sigmas,m=d.rhos,w=this.computeMembershipStrengths(a,c,g,m),y=w.rows,v=w.cols,_=w.vals,b=[t.length,n.length],x=new u.SparseMatrix(y,v,_,b),M=u.normalize(x,"l1"),S=u.getCSR(M),k=t.length,N=E(f.reshape2d(S.indices,k,this.nNeighbors),f.reshape2d(S.values,k,this.nNeighbors),this.embedding),A=this.nEpochs?this.nEpochs/3:x.nRows<=1e4?100:30,C=x.getValues().reduce(function(t,e){return e>t?e:t},0);x=x.map(function(t){return t<C/A?0:t}),x=u.eliminateZeros(x);var R=this.makeEpochsPerSample(x.getValues(),A),I=x.getRows(),P=x.getCols();return this.assignOptimizationStateParameters({headEmbedding:N,tailEmbedding:this.embedding,head:I,tail:P,currentEpoch:0,nEpochs:A,nVertices:x.getDims()[1],epochsPerSample:R}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var n=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,n)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,n=this.distanceFn,r=this.nNeighbors,i=h.makeNNDescent(n,this.random),o=5+Math.floor(.5===(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),s=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=c.makeForest(t,r,o,this.random);var a=i(t,c.makeLeafArray(this.rpForest),r,s);return{knnIndices:a.indices,knnDistances:a.weights}},t.prototype.fuzzySimplicialSet=function(t,e,n){void 0===n&&(n=1);var r=this,i=r.knnIndices,o=void 0===i?[]:i,s=r.knnDistances,a=void 0===s?[]:s,l=r.localConnectivity,h=this.smoothKNNDistance(a,e,l),c=h.sigmas,f=h.rhos,p=this.computeMembershipStrengths(o,a,c,f),d=p.rows,g=p.cols,m=p.vals,w=[t.length,t.length],y=new u.SparseMatrix(d,g,m,w),v=u.transpose(y),_=u.pairwiseMultiply(y,v),b=u.subtract(u.add(y,v),_),x=u.multiplyScalar(b,n),M=u.multiplyScalar(_,1-n);return u.add(x,M)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,n,r){void 0===r&&(r=1);var i=x(t,e,r,n);return M(i=u.eliminateZeros(i))},t.prototype.smoothKNNDistance=function(t,e,n,r,i){void 0===n&&(n=1),void 0===r&&(r=64),void 0===i&&(i=1);for(var o=Math.log(e)/Math.log(2)*i,s=f.zeros(t.length),a=f.zeros(t.length),l=0;l<t.length;l++){var u=0,h=1/0,c=1,p=t[l],m=p.filter(function(t){return t>0});if(m.length>=n){var w=Math.floor(n),y=n-w;w>0?(s[l]=m[w-1],y>d&&(s[l]+=y*(m[w]-m[w-1]))):s[l]=y*m[0]}else m.length>0&&(s[l]=f.max(m));for(var v=0;v<r;v++){for(var _=0,b=1;b<t[l].length;b++){var x=t[l][b]-s[l];_+=x>0?Math.exp(-x/c):1}if(Math.abs(_-o)<d)break;_>o?c=(u+(h=c))/2:(u=c,h===1/0?c*=2:c=(u+h)/2)}if(a[l]=c,s[l]>0){var M=f.mean(p);a[l]<g*M&&(a[l]=g*M)}else{var E=f.mean(t.map(f.mean));a[l]<g*E&&(a[l]=g*E)}}return{sigmas:a,rhos:s}},t.prototype.computeMembershipStrengths=function(t,e,n,r){for(var i=t.length,o=t[0].length,s=f.zeros(i*o),a=f.zeros(i*o),l=f.zeros(i*o),u=0;u<i;u++)for(var h=0;h<o;h++){var c=0;-1!==t[u][h]&&(c=t[u][h]===u?0:e[u][h]-r[u]<=0?1:Math.exp(-(e[u][h]-r[u])/n[u]),s[u*o+h]=u,a[u*o+h]=t[u][h],l[u*o+h]=c)}return{rows:s,cols:a,vals:l}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),n=this.nComponents,r=this.graph.getValues(),i=0,o=0;o<r.length;o++){var s=r[o];i<r[o]&&(i=s)}var a=this.graph.map(function(t){return t<i/e?0:t});this.embedding=f.zeros(a.nRows).map(function(){return f.zeros(n).map(function(){return 20*f.tauRand(t.random)-10})});var l=[],u=[],h=[],c=a.getAll();for(o=0;o<c.length;o++){var p=c[o];p.value&&(l.push(p.value),h.push(p.row),u.push(p.col))}return{head:u,tail:h,epochsPerSample:this.makeEpochsPerSample(l,e)}},t.prototype.makeEpochsPerSample=function(t,e){var n=f.filled(t.length,-1),r=f.max(t),i=t.map(function(t){return t/r*e});return i.forEach(function(t,r){t>0&&(n[r]=e/i[r])}),n},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,n=t.learningRate,r=t.negativeSampleRate,i=this.optimizationState,o=i.epochsPerSample,a=i.headEmbedding,l=i.tailEmbedding,u=a[0].length,h=a.length===l.length,c=o.map(function(t){return t/r}),f=s(c),p=s(o);this.assignOptimizationStateParameters({epochOfNextSample:p,epochOfNextNegativeSample:f,epochsPerNegativeSample:c,moveOther:h,initialAlpha:n,alpha:n,gamma:e,dim:u})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,n=this.optimizationState,r=n.head,i=n.tail,o=n.epochsPerSample,s=this.getNEpochs(),a=this.graph.nCols,l=b(this.spread,this.minDist),u=l.a,h=l.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:r,tail:i,epochsPerSample:o,a:u,b:h,nEpochs:s,nVertices:a})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,n=e.head,r=e.tail,i=e.headEmbedding,o=e.tailEmbedding,s=e.epochsPerSample,a=e.epochOfNextSample,l=e.epochOfNextNegativeSample,u=e.epochsPerNegativeSample,h=e.moveOther,c=e.initialAlpha,p=e.alpha,d=e.gamma,g=e.a,m=e.b,w=e.dim,y=e.nEpochs,b=e.nVertices,x=0;x<s.length;x++)if(!(a[x]>t)){var M=n[x],E=r[x],S=i[M],k=o[E],N=_(S,k),A=0;N>0&&(A=-2*g*m*Math.pow(N,m-1),A/=g*Math.pow(N,m)+1);for(var C=0;C<w;C++){var R=v(A*(S[C]-k[C]),4);S[C]+=R*p,h&&(k[C]+=-R*p)}a[x]+=s[x];for(var I=Math.floor((t-l[x])/u[x]),P=0;P<I;P++){var z=f.tauRandInt(b,this.random),O=o[z],T=_(S,O),j=0;if(T>0)j=2*d*m,j/=(.001+T)*(g*Math.pow(T,m)+1);else if(M===z)continue;for(C=0;C<w;C++){R=4;j>0&&(R=v(j*(S[C]-O[C]),4)),S[C]+=R*p}}l[x]+=I*u[x]}return e.alpha=c*(1-t/y),e.currentEpoch+=1,i},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise(function(n,o){var s=function(){return r(e,void 0,void 0,function(){var e,r,a,l,u,h;return i(this,function(i){try{if(e=this.optimizationState,r=e.nEpochs,a=e.currentEpoch,this.embedding=this.optimizeLayoutStep(a),l=this.optimizationState.currentEpoch,u=!1===t(l),h=l===r,u||h)return[2,n(h)];setTimeout(function(){return s()},0)}catch(t){o(t)}return[2]})})};setTimeout(function(){return s()},0)})},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,n=[];!e;){var r=this.optimizationState,i=r.nEpochs,o=r.currentEpoch;n=this.optimizeLayoutStep(o);var s=this.optimizationState.currentEpoch,a=!1===t(s);e=s===i||a}return n},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();function w(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return Math.sqrt(n)}ds.UMAP=m,ds.euclidean=w,ds.cosine=function(t,e){for(var n=0,r=0,i=0,o=0;o<t.length;o++)n+=t[o]*e[o],r+=Math.pow(t[o],2),i+=Math.pow(e[o],2);return 0===r&&0===i?0:0===r||0===i?1:1-n/Math.sqrt(r*i)};var y=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function v(t,e){return t>e?e:t<-e?-e:t}function _(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n}function b(t,e){var n=f.linear(0,3*t,300).map(function(t){return t<e?1:t}),r=f.zeros(n.length).map(function(r,i){return n[i]>=e?Math.exp(-(n[i]-e)/t):r}),i={x:n,y:r},s={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},a=p.default(i,function(t){var e=o(t,2),n=e[0],r=e[1];return function(t){return 1/(1+n*Math.pow(t,2*r))}},s).parameterValues,l=o(a,2);return{a:l[0],b:l[1]}}function x(t,e,n,r){return void 0===n&&(n=1),void 0===r&&(r=5),t.map(function(t,i,o){return-1===e[i]||-1===e[o]?t*Math.exp(-n):e[i]!==e[o]?t*Math.exp(-r):t})}function M(t){t=u.normalize(t,"max");var e=u.transpose(t),n=u.pairwiseMultiply(e,t);return t=u.add(t,u.subtract(e,n)),u.eliminateZeros(t)}function E(t,e,n){for(var r=f.zeros(t.length).map(function(t){return f.zeros(n[0].length)}),i=0;i<t.length;i++)for(var o=0;o<t[0].length;o++)for(var s=0;s<n[0].length;s++){var a=t[i][o];r[i][s]+=e[i][o]*n[a][s]}return r}return ds.findABParams=b,ds.fastIntersection=x,ds.resetLocalConnectivity=M,ds.initTransform=E,ds}var Ts=(Ps||(Ps=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Os();Object.defineProperty(t,"UMAP",{enumerable:!0,get:function(){return e.UMAP}})}(ps)),ps);console.log(t);const js={data:{divNum:1}};async function Ds(e={}){console.log("RUNNING: umap_plot() function----------");const{divid:n="",data:r=t,width:i=600,height:o=300,colors:s=["red","blue","green","orange","purple","pink","yellow"],nNeighbors:l=15,minDist:u=.1,nComponents:h=2}=e;let c=n?document.getElementById(n):null;if(c)console.log("div provided in function parameters:",n),c.innerHTML="";else{const t=js.data.divNum;c=document.createElement("div"),c.id=n||"umap_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",c.id),document.body.appendChild(c),js.data.divNum=t+1}const f=r[0]||{},p=Object.keys(f),d=p.filter(t=>"number"==typeof f[t]),g=p.find(t=>"number"!=typeof f[t]),m=r.map(t=>d.map(e=>t[e])),w=g?r.map(t=>t[g]):r.map((t,e)=>`row${e}`),_=Vs(m),b=new Ts.UMAP({nComponents:h,nNeighbors:l,minDist:u,random:Math.random}).fit(_).map((t,e)=>({group:w[e],name:g?String(w[e])+"_"+e:"id_"+e,UMAP1:t[0],UMAP2:t[1]})),x=[...new Set(b.map(t=>t.group))],M=Rr(s).domain(x),E=25,S=170,k=45,N=45,A=v(b,t=>t.UMAP1),C=y(b,t=>t.UMAP1),R=C-A,z=A-.1*R,O=C+.1*R,T=Fr().domain([z,O]).range([N,i-S]),j=Fr().domain(a(b,t=>t.UMAP2)).range([o-k,E]),D=Qt("svg").style("background","white").style("overflow","visible");D.attr("id","svgid_umap"),D.append("text").attr("x",i/2-N).attr("y",E/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("UMAP Plot");const $=D.attr("width",i).attr("height",o).append("g");$.append("g").call(t=>t.attr("transform",`translate(0,${o-k+5})`).call(I(T).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-S).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("UMAP1"))),$.append("g").call(t=>t.attr("transform",`translate(${N-5},0)`).call(P(j).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",E-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("UMAP2"))),$.append("rect").attr("id","background").attr("x",N).attr("y",E).attr("width",i-N-S).attr("height",o-E-k).attr("fill","white").on("click",(t,e)=>q(null,e,.7));const V=$.append("g").attr("class","gPoints").style("isolation","isolate"),F=Zi().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n      <div style='line-height: 1.5;'>\n        <div><strong>Name:</strong> ${e.name}</div>\n        <div><strong>UMAP1:</strong> ${e.UMAP1.toFixed(2)}</div>\n        <div><strong>UMAP2:</strong> ${e.UMAP2.toFixed(2)}</div>\n      </div>`);D.call(F),V.selectAll("circle").data(b).enter().append("circle").attr("class","points").attr("cx",t=>T(t.UMAP1)).attr("cy",t=>j(t.UMAP2)).attr("fill",t=>M(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",F.show).on("mouseout",F.hide);const L=$.append("g").selectAll("rect").data(x);function q(t,e,n){const r=Jt(".points").filter(t=>t.group!==e),i=Jt(".keyRects").filter(t=>t===e),o=Jt(".points").filter(t=>t.group===e),s=Jt(".keyRects").filter(t=>t!==e);r.transition().attr("opacity",.1),s.transition().attr("opacity",.1),o.transition().attr("opacity",n),i.transition().attr("opacity",n)}L.enter().append("rect").attr("class","keyRects").attr("x",i-N-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>M(t)).on("click",(t,e)=>q(null,e,.7)),L.enter().append("text").attr("x",t=>i-N-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","11px").on("click",(t,e)=>q(null,e,.7)),c.appendChild(D.node())}const $s=async(t={})=>{console.log("UMAP UI - not yet implemented"),console.log("Options:",t)};function Vs(t){const e=t.length,n=t[0].length,r=Array(n).fill(0),i=Array(n).fill(0);for(const e of t)for(let t=0;t<n;t++)r[t]+=e[t];for(let t=0;t<n;t++)r[t]/=e;for(const e of t)for(let t=0;t<n;t++)i[t]+=(e[t]-r[t])**2;for(let t=0;t<n;t++)i[t]=Math.sqrt(i[t]/(e-1))||1;return t.map(t=>t.map((t,e)=>(t-r[e])/i[e]))}const{points:Fs}=function(t,e={}){const{X:n,y:r}=function(t){return{X:t.map(t=>[t.sepal_length,t.sepal_width,t.petal_length,t.petal_width]),y:t.map(t=>t.species)}}(t),i=Vs(n),o=new Ts.UMAP({nComponents:e.nComponents??2,nNeighbors:e.nNeighbors??15,minDist:e.minDist??.1,random:e.random??Math.random}).fit(i),s=o.map((e,n)=>({x:e[0],y:e[1],species:r[n],original:t[n]}));return{embedding:o,labels:r,points:s}}(t);console.log(Fs.slice(0,5));async function Ls(e={}){console.log("RUNNING heatmap_plot()----------------------");const{divid:n="",matrix:r=t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:i=t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:o=Object.keys(t[0]).slice(0,-1),height:s=1800,width:a=400,color:l="red",marginLeft:u=80,marginRight:h=10}=e,c=Fr().domain([0,8]).range(["#fff",`${l}`]),f=53,p=10,d=u,g=h,m=Qt("svg"),w=Zi().style("border","solid 2px black").style("background-color","white").style("color","#000").style("border-radius","6px").style("float","left").style("font-family","monospace").style("font-size","10px").html((t,e)=>`\n        <div style='float: right; color: #000;'>\n           val:${e.value.toFixed(0)} <br/>\n             row:${i[e.n]}, col:${o[e.t]} \n        </div>`);m.call(w);let y=Ir().domain(i).range([0,s-f-p]),v=Ir().domain(o).range([0,a-d-g]);Jt("text").nodes().map(t=>t.getComputedTextLength()),m.attr("width",a).attr("height",s),m.append("rect").attr("x",0).attr("y",0).attr("width",a).attr("height",s).attr("fill","#ffffff");const _=m.append("g").attr("transform",`translate(${d+g}, ${f+p})`),x=_.append("g").call(R(v));x.selectAll(".tick").selectAll("line").remove(),x.selectAll("text").style("text-anchor","start").attr("dx","1px").attr("dy","1.1em").attr("transform","rotate(-90)").style("fill","#000");let M=_.append("g").call(P(y));M.selectAll(".tick").selectAll("line").remove(),M.selectAll("text").attr("dx","14px").attr("dy","0.3em").style("fill","#000");if(_.append("g").attr("class","gPoints").selectAll().data(await async function(t){let e=[];return b(t.length).map(n=>{const r=b(t[0].length).map(e=>({t:e,n:n,value:t[n][e]}));e=[...e,...r]}),e}(r)).enter().append("rect").attr("x",t=>v(o[t.t])).attr("y",t=>y(i[t.n])).attr("width",a/r[0].length).attr("height",s/r.length).attr("fill",t=>c(t.value)).on("mouseover",w.show).on("mouseout",w.hide),document.getElementById(n)){const t=document.getElementById(n);t.innerHTML="",t.appendChild(m.node())}else if(!document.getElementById("childDiv")){const t=document.createElement("div");document.body.appendChild(t),t.appendChild(m.node())}return m.node()}const qs="0.1.0";export{Yo as asDataFrame,Bo as convertStrToNumber,Qo as createTableFromCSV,Uo as csvToJson,Zo as hclustDt,rs as hclust_UI,ns as hclust_plot,Ls as heatmap_plot,t as irisData,os as pcaDt,ls as pca_UI,as as pca_plot,Go as removeNonNumberValues,Ho as removeNonNumbers,Wo as removeNumberValues,Xo as removeNumbers,Ko as scale,Jo as textBox,hs as tsne_UI,us as tsne_plot,$s as umap_UI,Ds as umap_plot,qs as version};
//# sourceMappingURL=sdk.mjs.map
