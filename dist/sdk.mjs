const t=[{sepal_length:5.1,sepal_width:3.5,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.7,sepal_width:3.2,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:4.6,sepal_width:3.1,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.6,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:5.4,sepal_width:3.9,petal_length:1.7,petal_width:.4,species:"setosa"},{sepal_length:4.6,sepal_width:3.4,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5,sepal_width:3.4,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:4.4,sepal_width:2.9,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5.4,sepal_width:3.7,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3.4,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3,petal_length:1.4,petal_width:.1,species:"setosa"},{sepal_length:4.3,sepal_width:3,petal_length:1.1,petal_width:.1,species:"setosa"},{sepal_length:5.8,sepal_width:4,petal_length:1.2,petal_width:.2,species:"setosa"},{sepal_length:5.7,sepal_width:4.4,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:5.4,sepal_width:3.9,petal_length:1.3,petal_width:.4,species:"setosa"},{sepal_length:5.1,sepal_width:3.5,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5.7,sepal_width:3.8,petal_length:1.7,petal_width:.3,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.5,petal_width:.3,species:"setosa"},{sepal_length:5.4,sepal_width:3.4,petal_length:1.7,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.7,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:4.6,sepal_width:3.6,petal_length:1,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.3,petal_length:1.7,petal_width:.5,species:"setosa"},{sepal_length:4.8,sepal_width:3.4,petal_length:1.9,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.4,petal_length:1.6,petal_width:.4,species:"setosa"},{sepal_length:5.2,sepal_width:3.5,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5.2,sepal_width:3.4,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.7,sepal_width:3.2,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.8,sepal_width:3.1,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:5.4,sepal_width:3.4,petal_length:1.5,petal_width:.4,species:"setosa"},{sepal_length:5.2,sepal_width:4.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5.5,sepal_width:4.2,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.1,petal_length:1.5,petal_width:.1,species:"setosa"},{sepal_length:5,sepal_width:3.2,petal_length:1.2,petal_width:.2,species:"setosa"},{sepal_length:5.5,sepal_width:3.5,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:4.9,sepal_width:3.6,petal_length:1.4,petal_width:.1,species:"setosa"},{sepal_length:4.4,sepal_width:3,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:5.1,sepal_width:3.4,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.5,petal_length:1.3,petal_width:.3,species:"setosa"},{sepal_length:4.5,sepal_width:2.3,petal_length:1.3,petal_width:.3,species:"setosa"},{sepal_length:4.4,sepal_width:3.2,petal_length:1.3,petal_width:.2,species:"setosa"},{sepal_length:5,sepal_width:3.5,petal_length:1.6,petal_width:.6,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.9,petal_width:.4,species:"setosa"},{sepal_length:4.8,sepal_width:3,petal_length:1.4,petal_width:.3,species:"setosa"},{sepal_length:5.1,sepal_width:3.8,petal_length:1.6,petal_width:.2,species:"setosa"},{sepal_length:4.6,sepal_width:3.2,petal_length:1.4,petal_width:.2,species:"setosa"},{sepal_length:5.3,sepal_width:3.7,petal_length:1.5,petal_width:.2,species:"setosa"},{sepal_length:7,sepal_width:3.2,petal_length:4.7,petal_width:1.4,species:"versicolor"},{sepal_length:6.4,sepal_width:3.2,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:6.9,sepal_width:3.1,petal_length:4.9,petal_width:1.5,species:"versicolor"},{sepal_length:5.5,sepal_width:2.3,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:6.5,sepal_width:2.8,petal_length:4.6,petal_width:1.5,species:"versicolor"},{sepal_length:5.7,sepal_width:2.8,petal_length:4.5,petal_width:1.3,species:"versicolor"},{sepal_length:6.3,sepal_width:3.3,petal_length:4.7,petal_width:1.6,species:"versicolor"},{sepal_length:4.9,sepal_width:2.4,petal_length:3.3,petal_width:1,species:"versicolor"},{sepal_length:6.6,sepal_width:2.9,petal_length:4.6,petal_width:1.3,species:"versicolor"},{sepal_length:5.2,sepal_width:2.7,petal_length:3.9,petal_width:1.4,species:"versicolor"},{sepal_length:5,sepal_width:2,petal_length:3.5,petal_width:1,species:"versicolor"},{sepal_length:5.9,sepal_width:3,petal_length:4.2,petal_width:1.5,species:"versicolor"},{sepal_length:6,sepal_width:2.2,petal_length:4,petal_width:1,species:"versicolor"},{sepal_length:6.1,sepal_width:2.9,petal_length:4.7,petal_width:1.4,species:"versicolor"},{sepal_length:5.6,sepal_width:2.9,petal_length:3.6,petal_width:1.3,species:"versicolor"},{sepal_length:6.7,sepal_width:3.1,petal_length:4.4,petal_width:1.4,species:"versicolor"},{sepal_length:5.6,sepal_width:3,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.8,sepal_width:2.7,petal_length:4.1,petal_width:1,species:"versicolor"},{sepal_length:6.2,sepal_width:2.2,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.6,sepal_width:2.5,petal_length:3.9,petal_width:1.1,species:"versicolor"},{sepal_length:5.9,sepal_width:3.2,petal_length:4.8,petal_width:1.8,species:"versicolor"},{sepal_length:6.1,sepal_width:2.8,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:6.3,sepal_width:2.5,petal_length:4.9,petal_width:1.5,species:"versicolor"},{sepal_length:6.1,sepal_width:2.8,petal_length:4.7,petal_width:1.2,species:"versicolor"},{sepal_length:6.4,sepal_width:2.9,petal_length:4.3,petal_width:1.3,species:"versicolor"},{sepal_length:6.6,sepal_width:3,petal_length:4.4,petal_width:1.4,species:"versicolor"},{sepal_length:6.8,sepal_width:2.8,petal_length:4.8,petal_width:1.4,species:"versicolor"},{sepal_length:6.7,sepal_width:3,petal_length:5,petal_width:1.7,species:"versicolor"},{sepal_length:6,sepal_width:2.9,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:5.7,sepal_width:2.6,petal_length:3.5,petal_width:1,species:"versicolor"},{sepal_length:5.5,sepal_width:2.4,petal_length:3.8,petal_width:1.1,species:"versicolor"},{sepal_length:5.5,sepal_width:2.4,petal_length:3.7,petal_width:1,species:"versicolor"},{sepal_length:5.8,sepal_width:2.7,petal_length:3.9,petal_width:1.2,species:"versicolor"},{sepal_length:6,sepal_width:2.7,petal_length:5.1,petal_width:1.6,species:"versicolor"},{sepal_length:5.4,sepal_width:3,petal_length:4.5,petal_width:1.5,species:"versicolor"},{sepal_length:6,sepal_width:3.4,petal_length:4.5,petal_width:1.6,species:"versicolor"},{sepal_length:6.7,sepal_width:3.1,petal_length:4.7,petal_width:1.5,species:"versicolor"},{sepal_length:6.3,sepal_width:2.3,petal_length:4.4,petal_width:1.3,species:"versicolor"},{sepal_length:5.6,sepal_width:3,petal_length:4.1,petal_width:1.3,species:"versicolor"},{sepal_length:5.5,sepal_width:2.5,petal_length:4,petal_width:1.3,species:"versicolor"},{sepal_length:5.5,sepal_width:2.6,petal_length:4.4,petal_width:1.2,species:"versicolor"},{sepal_length:6.1,sepal_width:3,petal_length:4.6,petal_width:1.4,species:"versicolor"},{sepal_length:5.8,sepal_width:2.6,petal_length:4,petal_width:1.2,species:"versicolor"},{sepal_length:5,sepal_width:2.3,petal_length:3.3,petal_width:1,species:"versicolor"},{sepal_length:5.6,sepal_width:2.7,petal_length:4.2,petal_width:1.3,species:"versicolor"},{sepal_length:5.7,sepal_width:3,petal_length:4.2,petal_width:1.2,species:"versicolor"},{sepal_length:5.7,sepal_width:2.9,petal_length:4.2,petal_width:1.3,species:"versicolor"},{sepal_length:6.2,sepal_width:2.9,petal_length:4.3,petal_width:1.3,species:"versicolor"},{sepal_length:5.1,sepal_width:2.5,petal_length:3,petal_width:1.1,species:"versicolor"},{sepal_length:6.3,sepal_width:3.3,petal_length:6,petal_width:2.5,species:"virginica"},{sepal_length:5.8,sepal_width:2.7,petal_length:5.1,petal_width:1.9,species:"virginica"},{sepal_length:7.1,sepal_width:3,petal_length:5.9,petal_width:2.1,species:"virginica"},{sepal_length:6.3,sepal_width:2.9,petal_length:5.6,petal_width:1.8,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.8,petal_width:2.2,species:"virginica"},{sepal_length:7.6,sepal_width:3,petal_length:6.6,petal_width:2.1,species:"virginica"},{sepal_length:4.9,sepal_width:2.5,petal_length:4.5,petal_width:1.7,species:"virginica"},{sepal_length:7.3,sepal_width:2.9,petal_length:6.3,petal_width:1.8,species:"virginica"},{sepal_length:6.7,sepal_width:2.5,petal_length:5.8,petal_width:1.8,species:"virginica"},{sepal_length:7.2,sepal_width:3.6,petal_length:6.1,petal_width:2.5,species:"virginica"},{sepal_length:6.5,sepal_width:3.2,petal_length:5.1,petal_width:2,species:"virginica"},{sepal_length:6.4,sepal_width:2.7,petal_length:5.3,petal_width:1.9,species:"virginica"},{sepal_length:6.8,sepal_width:3,petal_length:5.5,petal_width:2.1,species:"virginica"},{sepal_length:5.7,sepal_width:2.5,petal_length:5,petal_width:2,species:"virginica"},{sepal_length:5.8,sepal_width:2.8,petal_length:5.1,petal_width:2.4,species:"virginica"},{sepal_length:6.4,sepal_width:3.2,petal_length:5.3,petal_width:2.3,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.5,petal_width:1.8,species:"virginica"},{sepal_length:7.7,sepal_width:3.8,petal_length:6.7,petal_width:2.2,species:"virginica"},{sepal_length:7.7,sepal_width:2.6,petal_length:6.9,petal_width:2.3,species:"virginica"},{sepal_length:6,sepal_width:2.2,petal_length:5,petal_width:1.5,species:"virginica"},{sepal_length:6.9,sepal_width:3.2,petal_length:5.7,petal_width:2.3,species:"virginica"},{sepal_length:5.6,sepal_width:2.8,petal_length:4.9,petal_width:2,species:"virginica"},{sepal_length:7.7,sepal_width:2.8,petal_length:6.7,petal_width:2,species:"virginica"},{sepal_length:6.3,sepal_width:2.7,petal_length:4.9,petal_width:1.8,species:"virginica"},{sepal_length:6.7,sepal_width:3.3,petal_length:5.7,petal_width:2.1,species:"virginica"},{sepal_length:7.2,sepal_width:3.2,petal_length:6,petal_width:1.8,species:"virginica"},{sepal_length:6.2,sepal_width:2.8,petal_length:4.8,petal_width:1.8,species:"virginica"},{sepal_length:6.1,sepal_width:3,petal_length:4.9,petal_width:1.8,species:"virginica"},{sepal_length:6.4,sepal_width:2.8,petal_length:5.6,petal_width:2.1,species:"virginica"},{sepal_length:7.2,sepal_width:3,petal_length:5.8,petal_width:1.6,species:"virginica"},{sepal_length:7.4,sepal_width:2.8,petal_length:6.1,petal_width:1.9,species:"virginica"},{sepal_length:7.9,sepal_width:3.8,petal_length:6.4,petal_width:2,species:"virginica"},{sepal_length:6.4,sepal_width:2.8,petal_length:5.6,petal_width:2.2,species:"virginica"},{sepal_length:6.3,sepal_width:2.8,petal_length:5.1,petal_width:1.5,species:"virginica"},{sepal_length:6.1,sepal_width:2.6,petal_length:5.6,petal_width:1.4,species:"virginica"},{sepal_length:7.7,sepal_width:3,petal_length:6.1,petal_width:2.3,species:"virginica"},{sepal_length:6.3,sepal_width:3.4,petal_length:5.6,petal_width:2.4,species:"virginica"},{sepal_length:6.4,sepal_width:3.1,petal_length:5.5,petal_width:1.8,species:"virginica"},{sepal_length:6,sepal_width:3,petal_length:4.8,petal_width:1.8,species:"virginica"},{sepal_length:6.9,sepal_width:3.1,petal_length:5.4,petal_width:2.1,species:"virginica"},{sepal_length:6.7,sepal_width:3.1,petal_length:5.6,petal_width:2.4,species:"virginica"},{sepal_length:6.9,sepal_width:3.1,petal_length:5.1,petal_width:2.3,species:"virginica"},{sepal_length:5.8,sepal_width:2.7,petal_length:5.1,petal_width:1.9,species:"virginica"},{sepal_length:6.8,sepal_width:3.2,petal_length:5.9,petal_width:2.3,species:"virginica"},{sepal_length:6.7,sepal_width:3.3,petal_length:5.7,petal_width:2.5,species:"virginica"},{sepal_length:6.7,sepal_width:3,petal_length:5.2,petal_width:2.3,species:"virginica"},{sepal_length:6.3,sepal_width:2.5,petal_length:5,petal_width:1.9,species:"virginica"},{sepal_length:6.5,sepal_width:3,petal_length:5.2,petal_width:2,species:"virginica"},{sepal_length:6.2,sepal_width:3.4,petal_length:5.4,petal_width:2.3,species:"virginica"},{sepal_length:5.9,sepal_width:3,petal_length:5.1,petal_width:1.8,species:"virginica"}],e=[{f1:-.1583,f2:-.0026,f3:.0185,f4:-.0088,label:"spiral_A"},{f1:-.002,f2:.0338,f3:-.0175,f4:.0011,label:"spiral_B"},{f1:-.0292,f2:.0303,f3:.0255,f4:.0309,label:"spiral_A"},{f1:.0269,f2:-.0214,f3:-.047,f4:.0647,label:"spiral_B"},{f1:.1164,f2:.0046,f3:.0068,f4:-.0152,label:"spiral_A"},{f1:-.0126,f2:-.0374,f3:.0521,f4:.0183,label:"spiral_B"},{f1:-.0142,f2:.0685,f3:-.0026,f4:.0972,label:"spiral_A"},{f1:-.0253,f2:-.0724,f3:-.0023,f4:-.0374,label:"spiral_B"},{f1:.012,f2:.031,f3:.028,f4:.0824,label:"spiral_A"},{f1:-.0407,f2:-.0699,f3:.0299,f4:-.0159,label:"spiral_B"},{f1:.0131,f2:.0362,f3:-.0362,f4:-.0023,label:"spiral_A"},{f1:-.0196,f2:.0128,f3:-.0387,f4:-.0377,label:"spiral_B"},{f1:-.0154,f2:-.0503,f3:-.0107,f4:-.0793,label:"spiral_A"},{f1:.0314,f2:-.0332,f3:.033,f4:-.088,label:"spiral_B"},{f1:-.032,f2:-.0347,f3:.0485,f4:-.0976,label:"spiral_A"},{f1:-.0457,f2:-.076,f3:.0129,f4:.0337,label:"spiral_B"},{f1:.0024,f2:-.0372,f3:-.0226,f4:-.0011,label:"spiral_A"},{f1:-.0215,f2:-.0491,f3:-.0032,f4:-.0044,label:"spiral_B"},{f1:.0559,f2:.0144,f3:-.0136,f4:-.0191,label:"spiral_A"},{f1:-.0736,f2:-.0645,f3:-.0635,f4:-.0238,label:"spiral_B"},{f1:.0804,f2:-.0366,f3:.0817,f4:.0269,label:"spiral_A"},{f1:-.0241,f2:-.0046,f3:-.0238,f4:-.0141,label:"spiral_B"},{f1:.0107,f2:.0372,f3:.0713,f4:.0128,label:"spiral_A"},{f1:.0264,f2:-.0034,f3:-.0102,f4:-.0068,label:"spiral_B"},{f1:-.0074,f2:.0012,f3:.0296,f4:-.0305,label:"spiral_A"},{f1:-.0436,f2:.0153,f3:-.0226,f4:-.0355,label:"spiral_B"},{f1:-.0151,f2:.0596,f3:.0148,f4:.0406,label:"spiral_A"},{f1:-.0472,f2:-.0069,f3:.0236,f4:-7e-4,label:"spiral_B"},{f1:.0191,f2:-.0249,f3:-.0096,f4:-.0505,label:"spiral_A"},{f1:-.0166,f2:-.0521,f3:-.0563,f4:-.04,label:"spiral_B"},{f1:-.0783,f2:.0683,f3:.0916,f4:-.0263,label:"spiral_A"},{f1:.0073,f2:.0651,f3:-.0938,f4:-.0359,label:"spiral_B"},{f1:-.0028,f2:.0721,f3:.0581,f4:-.032,label:"spiral_A"},{f1:-.1109,f2:-.0378,f3:-.0744,f4:.0247,label:"spiral_B"},{f1:.0075,f2:.133,f3:.0818,f4:-.0126,label:"spiral_A"},{f1:-.1046,f2:-.0772,f3:-.1078,f4:.0253,label:"spiral_B"},{f1:-.0353,f2:.0352,f3:.0611,f4:-.0418,label:"spiral_A"},{f1:-.0637,f2:-.1045,f3:-.0942,f4:-.0267,label:"spiral_B"},{f1:.063,f2:.0249,f3:.0929,f4:.041,label:"spiral_A"},{f1:-.0451,f2:-.082,f3:-.0115,f4:.0847,label:"spiral_B"},{f1:-.038,f2:.0494,f3:.0498,f4:-.084,label:"spiral_A"},{f1:.0041,f2:-.0837,f3:-.0335,f4:.0529,label:"spiral_B"},{f1:.0098,f2:.0451,f3:-.024,f4:-.0951,label:"spiral_A"},{f1:-.0448,f2:-.1259,f3:-.0579,f4:.0673,label:"spiral_B"},{f1:-.0055,f2:.0513,f3:-.0468,f4:-.0395,label:"spiral_A"},{f1:-.0305,f2:-.0264,f3:-.0401,f4:.0658,label:"spiral_B"},{f1:-.0446,f2:.1255,f3:.0728,f4:-.0855,label:"spiral_A"},{f1:-.0261,f2:-.1211,f3:-.011,f4:.0584,label:"spiral_B"},{f1:.0363,f2:.0645,f3:.0304,f4:-.0923,label:"spiral_A"},{f1:-.0107,f2:-.0731,f3:.006,f4:.1316,label:"spiral_B"},{f1:-.0342,f2:.0926,f3:.0045,f4:-.1308,label:"spiral_A"},{f1:.0256,f2:-.1183,f3:-.0164,f4:.0554,label:"spiral_B"},{f1:-.0071,f2:.0331,f3:.0624,f4:-.0479,label:"spiral_A"},{f1:-.0057,f2:.0347,f3:.0046,f4:.1197,label:"spiral_B"},{f1:-.0623,f2:.115,f3:-.0222,f4:-.1076,label:"spiral_A"},{f1:.0818,f2:-.134,f3:.0525,f4:.104,label:"spiral_B"},{f1:-.01,f2:.0807,f3:.0276,f4:-.085,label:"spiral_A"},{f1:.03,f2:-.0731,f3:.0172,f4:.1475,label:"spiral_B"},{f1:.0482,f2:.1813,f3:-.0418,f4:-.0562,label:"spiral_A"},{f1:-.0265,f2:-.0461,f3:.0819,f4:.1058,label:"spiral_B"},{f1:.0215,f2:.0478,f3:-.072,f4:-.149,label:"spiral_A"},{f1:.004,f2:-.0976,f3:.0123,f4:.053,label:"spiral_B"},{f1:-.0516,f2:.0636,f3:-.0869,f4:-.0543,label:"spiral_A"},{f1:.09,f2:-.1127,f3:.1219,f4:.1187,label:"spiral_B"},{f1:.0049,f2:.0978,f3:-.0898,f4:-.0678,label:"spiral_A"},{f1:.0612,f2:-.0982,f3:.1226,f4:.0831,label:"spiral_B"},{f1:-.0474,f2:.1088,f3:-.1307,f4:-.0696,label:"spiral_A"},{f1:.0575,f2:-.1104,f3:.0672,f4:1e-4,label:"spiral_B"},{f1:-.0627,f2:.0972,f3:-.0813,f4:-.1088,label:"spiral_A"},{f1:.0506,f2:-.082,f3:.1313,f4:.0641,label:"spiral_B"},{f1:-.0825,f2:.1055,f3:-.0664,f4:-.0145,label:"spiral_A"},{f1:.0569,f2:-.0431,f3:.1923,f4:.0146,label:"spiral_B"},{f1:-.1007,f2:.1172,f3:-.0541,f4:-.0081,label:"spiral_A"},{f1:.0435,f2:-.0975,f3:.0488,f4:-.0083,label:"spiral_B"},{f1:-.1381,f2:.1231,f3:-.0997,f4:-.0397,label:"spiral_A"},{f1:.0842,f2:-.0789,f3:.1388,f4:-.0021,label:"spiral_B"},{f1:-.0965,f2:.0601,f3:-.0981,f4:.0253,label:"spiral_A"},{f1:.0997,f2:-.098,f3:.1992,f4:-.0432,label:"spiral_B"},{f1:-.1023,f2:.1041,f3:-.1042,f4:-.0033,label:"spiral_A"},{f1:.1855,f2:-.1203,f3:.098,f4:-.0168,label:"spiral_B"},{f1:-.0971,f2:.1009,f3:-.1243,f4:.0722,label:"spiral_A"},{f1:.0983,f2:-.1244,f3:.0974,f4:-.0067,label:"spiral_B"},{f1:-.0907,f2:.114,f3:-.139,f4:.0548,label:"spiral_A"},{f1:.1273,f2:-.1453,f3:.1466,f4:-.0732,label:"spiral_B"},{f1:-.1318,f2:.1509,f3:-.0106,f4:.0775,label:"spiral_A"},{f1:.1435,f2:.0204,f3:.174,f4:-.082,label:"spiral_B"},{f1:-.1101,f2:.0674,f3:-.1069,f4:.0729,label:"spiral_A"},{f1:.1892,f2:.0235,f3:.144,f4:-.0666,label:"spiral_B"},{f1:-.1681,f2:.1007,f3:-.1144,f4:.1768,label:"spiral_A"},{f1:.0887,f2:-.1153,f3:.1382,f4:-.154,label:"spiral_B"},{f1:-.2004,f2:.0046,f3:-.0953,f4:.0449,label:"spiral_A"},{f1:.1848,f2:-.0829,f3:.0908,f4:-.1319,label:"spiral_B"},{f1:-.1087,f2:.0839,f3:-.083,f4:.0974,label:"spiral_A"},{f1:.1125,f2:-.0175,f3:.0433,f4:-.1623,label:"spiral_B"},{f1:-.1158,f2:.0607,f3:-.0224,f4:.0996,label:"spiral_A"},{f1:.0961,f2:-.0025,f3:.0108,f4:-.1265,label:"spiral_B"},{f1:-.1051,f2:.0714,f3:-.0923,f4:.1794,label:"spiral_A"},{f1:.126,f2:-5e-4,f3:.0292,f4:-.1624,label:"spiral_B"},{f1:-.1274,f2:.0409,f3:-.0543,f4:.1503,label:"spiral_A"},{f1:.1423,f2:.0147,f3:.0443,f4:-.2052,label:"spiral_B"},{f1:-.1387,f2:-.0475,f3:-.0238,f4:.2145,label:"spiral_A"},{f1:.078,f2:-.0212,f3:.046,f4:-.0975,label:"spiral_B"},{f1:-.1461,f2:.0022,f3:.0468,f4:.1817,label:"spiral_A"},{f1:.1407,f2:-.0384,f3:-.002,f4:-.1764,label:"spiral_B"},{f1:-.1923,f2:-.041,f3:.0655,f4:.234,label:"spiral_A"},{f1:.1846,f2:.1284,f3:-.0173,f4:-.115,label:"spiral_B"},{f1:-.2149,f2:-.0213,f3:.0127,f4:.2641,label:"spiral_A"},{f1:.1677,f2:.0502,f3:-.033,f4:-.1378,label:"spiral_B"},{f1:-.2018,f2:-.0324,f3:-.0219,f4:.1022,label:"spiral_A"},{f1:.176,f2:.0761,f3:-.1294,f4:-.2284,label:"spiral_B"},{f1:-.1479,f2:-.0583,f3:.1388,f4:.1984,label:"spiral_A"},{f1:.1429,f2:.047,f3:-.08,f4:-.1328,label:"spiral_B"},{f1:-.2559,f2:-.0483,f3:.1868,f4:.2027,label:"spiral_A"},{f1:.2404,f2:.075,f3:-.158,f4:-.1645,label:"spiral_B"},{f1:-.206,f2:-.0422,f3:.2189,f4:.0787,label:"spiral_A"},{f1:.179,f2:.0596,f3:-.1196,f4:-.1541,label:"spiral_B"},{f1:-.138,f2:-.1447,f3:.1774,f4:.0962,label:"spiral_A"},{f1:.1499,f2:.1641,f3:-.1576,f4:-.1002,label:"spiral_B"},{f1:-.1886,f2:-.0682,f3:.183,f4:.0349,label:"spiral_A"},{f1:.1371,f2:.1808,f3:-.1463,f4:-.0941,label:"spiral_B"},{f1:-.1974,f2:-.1063,f3:.1641,f4:.0757,label:"spiral_A"},{f1:.1758,f2:.1568,f3:-.1885,f4:-.0425,label:"spiral_B"},{f1:-.1762,f2:-.0969,f3:.1671,f4:.0167,label:"spiral_A"},{f1:.1145,f2:.1004,f3:-.1931,f4:.001,label:"spiral_B"},{f1:-.0974,f2:-.2296,f3:.2609,f4:.0127,label:"spiral_A"},{f1:.1903,f2:.1002,f3:-.2028,f4:.0101,label:"spiral_B"},{f1:-.1145,f2:-.138,f3:.1676,f4:.0468,label:"spiral_A"},{f1:.0294,f2:.2006,f3:-.2602,f4:.0442,label:"spiral_B"},{f1:-.1264,f2:-.2369,f3:.2045,f4:-.0804,label:"spiral_A"},{f1:.1252,f2:.2004,f3:-.1543,f4:.088,label:"spiral_B"},{f1:-.1251,f2:-.1935,f3:.1409,f4:-.0747,label:"spiral_A"},{f1:.226,f2:.1346,f3:-.0995,f4:.1139,label:"spiral_B"},{f1:-.1521,f2:-.1755,f3:.171,f4:-.0658,label:"spiral_A"},{f1:.1259,f2:.2706,f3:-.1842,f4:.1014,label:"spiral_B"},{f1:-.0628,f2:-.1695,f3:.1937,f4:-.1562,label:"spiral_A"},{f1:.0932,f2:.2079,f3:-.1775,f4:.1202,label:"spiral_B"},{f1:-.1184,f2:-.1552,f3:.1889,f4:-.1324,label:"spiral_A"},{f1:.0568,f2:.1645,f3:-.1795,f4:.1719,label:"spiral_B"},{f1:-.0282,f2:-.1679,f3:.1398,f4:-.1041,label:"spiral_A"},{f1:.0597,f2:.2173,f3:-.0992,f4:.193,label:"spiral_B"},{f1:-.0885,f2:-.1983,f3:.1536,f4:-.1624,label:"spiral_A"},{f1:.1385,f2:.2954,f3:-.1626,f4:.1971,label:"spiral_B"},{f1:-.0494,f2:-.2112,f3:.067,f4:-.1695,label:"spiral_A"},{f1:.1457,f2:.2058,f3:-.1138,f4:.244,label:"spiral_B"},{f1:-.0615,f2:-.285,f3:.0979,f4:-.1718,label:"spiral_A"},{f1:.0032,f2:.222,f3:-.0827,f4:.2127,label:"spiral_B"},{f1:-.0467,f2:-.2514,f3:.0231,f4:-.2495,label:"spiral_A"},{f1:.0312,f2:.2322,f3:-.0813,f4:.2376,label:"spiral_B"},{f1:-.0571,f2:-.2484,f3:.0544,f4:-.2559,label:"spiral_A"},{f1:.0499,f2:.2984,f3:-.0275,f4:.2295,label:"spiral_B"},{f1:.0247,f2:-.2858,f3:.0067,f4:-.2526,label:"spiral_A"},{f1:.0348,f2:.2214,f3:.0479,f4:.2716,label:"spiral_B"},{f1:.1201,f2:-.2441,f3:-.0932,f4:-.2177,label:"spiral_A"},{f1:.0075,f2:.2409,f3:.0608,f4:.2032,label:"spiral_B"},{f1:.0402,f2:-.2093,f3:-.0554,f4:-.2549,label:"spiral_A"},{f1:-.0447,f2:.277,f3:.0767,f4:.257,label:"spiral_B"},{f1:.058,f2:-.2485,f3:-.1662,f4:-.2722,label:"spiral_A"},{f1:-.0526,f2:.1787,f3:.1407,f4:.2455,label:"spiral_B"},{f1:.0365,f2:-.2015,f3:-.1982,f4:-.2285,label:"spiral_A"},{f1:-.0648,f2:.2561,f3:.1968,f4:.2392,label:"spiral_B"},{f1:.0522,f2:-.2284,f3:-.2388,f4:-.17,label:"spiral_A"},{f1:-.0918,f2:.1942,f3:.2087,f4:.1572,label:"spiral_B"},{f1:.0922,f2:-.2988,f3:-.1622,f4:-.1911,label:"spiral_A"},{f1:-.1314,f2:.2922,f3:.1406,f4:.1911,label:"spiral_B"},{f1:.0926,f2:-.2775,f3:-.1966,f4:-.2089,label:"spiral_A"},{f1:-.1868,f2:.1936,f3:.1755,f4:.2006,label:"spiral_B"},{f1:.1854,f2:-.1826,f3:-.3396,f4:-.1573,label:"spiral_A"},{f1:-.1129,f2:.2403,f3:.2626,f4:.1203,label:"spiral_B"},{f1:.1656,f2:-.2294,f3:-.2729,f4:-.1932,label:"spiral_A"},{f1:-.1179,f2:.2463,f3:.2489,f4:.0898,label:"spiral_B"},{f1:.154,f2:-.271,f3:-.2929,f4:-.089,label:"spiral_A"},{f1:-.1918,f2:.2121,f3:.2657,f4:.1095,label:"spiral_B"},{f1:.1549,f2:-.2312,f3:-.3164,f4:.003,label:"spiral_A"},{f1:-.1692,f2:.1515,f3:.2887,f4:.0738,label:"spiral_B"},{f1:.1784,f2:-.1897,f3:-.2746,f4:-.0249,label:"spiral_A"},{f1:-.1885,f2:.233,f3:.3402,f4:-.023,label:"spiral_B"},{f1:.2761,f2:-.1997,f3:-.3114,f4:.0943,label:"spiral_A"},{f1:-.2262,f2:.2034,f3:.2394,f4:.0258,label:"spiral_B"},{f1:.227,f2:-.217,f3:-.2455,f4:.0521,label:"spiral_A"},{f1:-.2864,f2:.2254,f3:.2628,f4:-.1017,label:"spiral_B"},{f1:.2354,f2:-.2409,f3:-.3006,f4:.0935,label:"spiral_A"},{f1:-.2367,f2:.2297,f3:.2183,f4:-.141,label:"spiral_B"},{f1:.3052,f2:-.1745,f3:-.2697,f4:.1837,label:"spiral_A"},{f1:-.281,f2:.1191,f3:.1998,f4:-.1919,label:"spiral_B"},{f1:.2707,f2:-.1419,f3:-.1748,f4:.2259,label:"spiral_A"},{f1:-.2653,f2:.2174,f3:.2584,f4:-.1014,label:"spiral_B"},{f1:.2537,f2:-.1042,f3:-.2079,f4:.216,label:"spiral_A"},{f1:-.2236,f2:.1028,f3:.2509,f4:-.202,label:"spiral_B"},{f1:.2714,f2:-.0972,f3:-.2601,f4:.2176,label:"spiral_A"},{f1:-.3105,f2:.0439,f3:.1794,f4:-.2054,label:"spiral_B"},{f1:.306,f2:-.054,f3:-.1425,f4:.3067,label:"spiral_A"},{f1:-.323,f2:.0918,f3:.1529,f4:-.2492,label:"spiral_B"},{f1:.3319,f2:-.062,f3:-.2103,f4:.3056,label:"spiral_A"},{f1:-.2929,f2:.0958,f3:.1433,f4:-.3032,label:"spiral_B"},{f1:.3344,f2:.0822,f3:-.1231,f4:.3036,label:"spiral_A"},{f1:-.2561,f2:.0586,f3:.1583,f4:-.2889,label:"spiral_B"},{f1:.3863,f2:-.0272,f3:-.0965,f4:.3238,label:"spiral_A"},{f1:-.3016,f2:.0708,f3:.1009,f4:-.3494,label:"spiral_B"},{f1:.3318,f2:.0431,f3:-.0079,f4:.3889,label:"spiral_A"},{f1:-.3504,f2:.0486,f3:.0503,f4:-.2813,label:"spiral_B"},{f1:.3319,f2:.0129,f3:.0894,f4:.3587,label:"spiral_A"},{f1:-.2997,f2:.0096,f3:.0153,f4:-.319,label:"spiral_B"},{f1:.3842,f2:.0142,f3:.0573,f4:.3153,label:"spiral_A"},{f1:-.2965,f2:.0611,f3:-.1224,f4:-.3321,label:"spiral_B"},{f1:.2702,f2:.0219,f3:.1139,f4:.3543,label:"spiral_A"},{f1:-.3223,f2:-.0369,f3:-.1183,f4:-.3367,label:"spiral_B"},{f1:.3119,f2:.0894,f3:.1855,f4:.2537,label:"spiral_A"},{f1:-.4125,f2:-.1006,f3:-.1693,f4:-.3171,label:"spiral_B"},{f1:.3383,f2:.0817,f3:.1846,f4:.3163,label:"spiral_A"},{f1:-.2622,f2:-.0846,f3:-.1184,f4:-.2702,label:"spiral_B"},{f1:.3154,f2:.1523,f3:.2449,f4:.2442,label:"spiral_A"},{f1:-.3634,f2:-.1161,f3:-.2115,f4:-.2011,label:"spiral_B"},{f1:.3909,f2:.1011,f3:.2472,f4:.24,label:"spiral_A"},{f1:-.2528,f2:-.1411,f3:-.2478,f4:-.2938,label:"spiral_B"},{f1:.3329,f2:.1142,f3:.2949,f4:.1785,label:"spiral_A"},{f1:-.3418,f2:-.1137,f3:-.2782,f4:-.192,label:"spiral_B"},{f1:.3473,f2:.164,f3:.2923,f4:.168,label:"spiral_A"},{f1:-.2857,f2:-.1433,f3:-.3743,f4:-.1338,label:"spiral_B"},{f1:.286,f2:.1915,f3:.3295,f4:.1797,label:"spiral_A"},{f1:-.3106,f2:-.2479,f3:-.3072,f4:-.1629,label:"spiral_B"},{f1:.2909,f2:.1748,f3:.3634,f4:.0703,label:"spiral_A"},{f1:-.3761,f2:-.2047,f3:-.3953,f4:-.1321,label:"spiral_B"},{f1:.2543,f2:.2762,f3:.4232,f4:-.0059,label:"spiral_A"},{f1:-.2479,f2:-.2129,f3:-.3842,f4:-.1447,label:"spiral_B"},{f1:.2505,f2:.3071,f3:.3236,f4:.0047,label:"spiral_A"},{f1:-.2628,f2:-.3,f3:-.3587,f4:-.0204,label:"spiral_B"},{f1:.3549,f2:.3183,f3:.3837,f4:-.0911,label:"spiral_A"},{f1:-.2586,f2:-.2515,f3:-.379,f4:.0715,label:"spiral_B"},{f1:.2806,f2:.3007,f3:.3126,f4:-.1253,label:"spiral_A"},{f1:-.2004,f2:-.3059,f3:-.3325,f4:.0678,label:"spiral_B"},{f1:.1929,f2:.4044,f3:.3608,f4:-.1471,label:"spiral_A"},{f1:-.235,f2:-.3277,f3:-.3355,f4:.1558,label:"spiral_B"},{f1:.1753,f2:.3381,f3:.363,f4:-.2214,label:"spiral_A"},{f1:-.2467,f2:-.3476,f3:-.3238,f4:.1935,label:"spiral_B"},{f1:.0951,f2:.2919,f3:.2929,f4:-.2862,label:"spiral_A"},{f1:-.2363,f2:-.4077,f3:-.33,f4:.124,label:"spiral_B"},{f1:.204,f2:.2977,f3:.2539,f4:-.2404,label:"spiral_A"},{f1:-.1686,f2:-.3469,f3:-.2657,f4:.3582,label:"spiral_B"},{f1:.1239,f2:.3838,f3:.2577,f4:-.224,label:"spiral_A"},{f1:-.0688,f2:-.3729,f3:-.2526,f4:.278,label:"spiral_B"},{f1:.1554,f2:.4296,f3:.2255,f4:-.3753,label:"spiral_A"},{f1:-.131,f2:-.3959,f3:-.2253,f4:.3666,label:"spiral_B"},{f1:.0689,f2:.4142,f3:.1516,f4:-.2617,label:"spiral_A"},{f1:-.0899,f2:-.3791,f3:-.1455,f4:.3327,label:"spiral_B"},{f1:9e-4,f2:.3716,f3:.0939,f4:-.4058,label:"spiral_A"},{f1:-.0963,f2:-.3841,f3:-.1138,f4:.3514,label:"spiral_B"},{f1:.0187,f2:.3651,f3:.049,f4:-.328,label:"spiral_A"},{f1:-.0075,f2:-.3926,f3:-.1016,f4:.4797,label:"spiral_B"},{f1:.0243,f2:.432,f3:.0461,f4:-.4745,label:"spiral_A"},{f1:-.0281,f2:-.396,f3:-.1122,f4:.389,label:"spiral_B"},{f1:-.0128,f2:.3896,f3:-.028,f4:-.4314,label:"spiral_A"},{f1:-.0178,f2:-.461,f3:.0218,f4:.4791,label:"spiral_B"},{f1:-.0397,f2:.4244,f3:-.1035,f4:-.392,label:"spiral_A"},{f1:.0011,f2:-.4085,f3:.0352,f4:.3803,label:"spiral_B"},{f1:-.031,f2:.4027,f3:-.1946,f4:-.4976,label:"spiral_A"},{f1:.0386,f2:-.3889,f3:.1513,f4:.4284,label:"spiral_B"},{f1:-.1711,f2:.4384,f3:-.1716,f4:-.4539,label:"spiral_A"},{f1:.1716,f2:-.3778,f3:.1544,f4:.3073,label:"spiral_B"},{f1:-.0374,f2:.4192,f3:-.2226,f4:-.4033,label:"spiral_A"},{f1:.1472,f2:-.3868,f3:.208,f4:.3704,label:"spiral_B"},{f1:-.1079,f2:.3901,f3:-.2831,f4:-.3434,label:"spiral_A"},{f1:.1742,f2:-.4119,f3:.2812,f4:.3178,label:"spiral_B"},{f1:-.2022,f2:.3644,f3:-.308,f4:-.2989,label:"spiral_A"},{f1:.1761,f2:-.4354,f3:.3356,f4:.1526,label:"spiral_B"},{f1:-.1865,f2:.4157,f3:-.3302,f4:-.2155,label:"spiral_A"},{f1:.1871,f2:-.3853,f3:.3702,f4:.2164,label:"spiral_B"},{f1:-.2338,f2:.3801,f3:-.3329,f4:-.2834,label:"spiral_A"},{f1:.2425,f2:-.3657,f3:.3655,f4:.2105,label:"spiral_B"},{f1:-.3062,f2:.3838,f3:-.4021,f4:-.106,label:"spiral_A"},{f1:.2666,f2:-.3706,f3:.4294,f4:.1401,label:"spiral_B"},{f1:-.23,f2:.4049,f3:-.4995,f4:-.1255,label:"spiral_A"},{f1:.3176,f2:-.3221,f3:.4623,f4:.1463,label:"spiral_B"},{f1:-.2704,f2:.2862,f3:-.4699,f4:-.0534,label:"spiral_A"},{f1:.3153,f2:-.2794,f3:.4914,f4:.01,label:"spiral_B"},{f1:-.3832,f2:.3519,f3:-.4051,f4:-.0116,label:"spiral_A"},{f1:.2821,f2:-.3114,f3:.4124,f4:.0625,label:"spiral_B"},{f1:-.4303,f2:.2742,f3:-.4243,f4:.0198,label:"spiral_A"},{f1:.2566,f2:-.3081,f3:.4618,f4:-.0313,label:"spiral_B"},{f1:-.3475,f2:.2863,f3:-.4023,f4:.1116,label:"spiral_A"},{f1:.3986,f2:-.3263,f3:.4754,f4:-.1044,label:"spiral_B"},{f1:-.4141,f2:.2706,f3:-.4954,f4:.0998,label:"spiral_A"},{f1:.3884,f2:-.2997,f3:.4533,f4:-.1821,label:"spiral_B"},{f1:-.3915,f2:.3205,f3:-.3574,f4:.2278,label:"spiral_A"},{f1:.4439,f2:-.2763,f3:.4191,f4:-.2424,label:"spiral_B"},{f1:-.4579,f2:.244,f3:-.4428,f4:.2576,label:"spiral_A"},{f1:.422,f2:-.2272,f3:.368,f4:-.3011,label:"spiral_B"},{f1:-.4429,f2:.2526,f3:-.3632,f4:.2997,label:"spiral_A"},{f1:.4237,f2:-.1056,f3:.3555,f4:-.3996,label:"spiral_B"},{f1:-.4617,f2:.1742,f3:-.3394,f4:.3669,label:"spiral_A"},{f1:.4815,f2:-.1422,f3:.371,f4:-.2745,label:"spiral_B"},{f1:-.4241,f2:.1184,f3:-.2962,f4:.4187,label:"spiral_A"},{f1:.45,f2:-.1242,f3:.2884,f4:-.4287,label:"spiral_B"},{f1:-.5065,f2:.1265,f3:-.2682,f4:.4403,label:"spiral_A"},{f1:.5119,f2:-.0891,f3:.1992,f4:-.3685,label:"spiral_B"},{f1:-.4439,f2:.1428,f3:-.1771,f4:.4597,label:"spiral_A"},{f1:.5155,f2:-.0588,f3:.1701,f4:-.4952,label:"spiral_B"},{f1:-.4868,f2:.0944,f3:-.1469,f4:.4761,label:"spiral_A"},{f1:.5362,f2:-.0742,f3:.0236,f4:-.4931,label:"spiral_B"},{f1:-.4828,f2:4e-4,f3:-.0511,f4:.5582,label:"spiral_A"},{f1:.5149,f2:-.0723,f3:-.0701,f4:-.4582,label:"spiral_B"},{f1:-.448,f2:.0351,f3:.1059,f4:.4914,label:"spiral_A"},{f1:.5057,f2:-.0244,f3:-.0587,f4:-.599,label:"spiral_B"},{f1:-.5114,f2:-.0205,f3:.0217,f4:.5626,label:"spiral_A"},{f1:.491,f2:.0582,f3:-.1315,f4:-.5318,label:"spiral_B"},{f1:-.5248,f2:-.0666,f3:.1988,f4:.4134,label:"spiral_A"},{f1:.422,f2:.0935,f3:-.1356,f4:-.5239,label:"spiral_B"},{f1:-.4282,f2:-.1217,f3:.2347,f4:.4589,label:"spiral_A"},{f1:.4915,f2:.1383,f3:-.3024,f4:-.4873,label:"spiral_B"},{f1:-.4722,f2:-.1998,f3:.305,f4:.4084,label:"spiral_A"},{f1:.4444,f2:.059,f3:-.2992,f4:-.4414,label:"spiral_B"},{f1:-.5601,f2:-.2286,f3:.2695,f4:.3311,label:"spiral_A"},{f1:.4504,f2:.1299,f3:-.32,f4:-.3926,label:"spiral_B"},{f1:-.5034,f2:-.1415,f3:.3684,f4:.3605,label:"spiral_A"},{f1:.4618,f2:.2526,f3:-.3783,f4:-.4011,label:"spiral_B"},{f1:-.4859,f2:-.2042,f3:.442,f4:.2453,label:"spiral_A"},{f1:.5165,f2:.2221,f3:-.4689,f4:-.2621,label:"spiral_B"},{f1:-.4064,f2:-.2667,f3:.4347,f4:.2047,label:"spiral_A"},{f1:.4047,f2:.2427,f3:-.4655,f4:-.2871,label:"spiral_B"},{f1:-.4504,f2:-.3406,f3:.5352,f4:.1743,label:"spiral_A"},{f1:.3637,f2:.3037,f3:-.3978,f4:-.154,label:"spiral_B"},{f1:-.4693,f2:-.2971,f3:.4661,f4:.1188,label:"spiral_A"},{f1:.4117,f2:.2998,f3:-.5245,f4:-.1837,label:"spiral_B"},{f1:-.4178,f2:-.3317,f3:.5404,f4:.0204,label:"spiral_A"},{f1:.4307,f2:.3488,f3:-.5634,f4:-.0616,label:"spiral_B"},{f1:-.3803,f2:-.351,f3:.5633,f4:.0505,label:"spiral_A"},{f1:.3767,f2:.3875,f3:-.5691,f4:.0578,label:"spiral_B"},{f1:-.3631,f2:-.3715,f3:.5139,f4:-.0654,label:"spiral_A"},{f1:.3992,f2:.4681,f3:-.4949,f4:.1006,label:"spiral_B"},{f1:-.3135,f2:-.4258,f3:.5313,f4:-.1697,label:"spiral_A"},{f1:.338,f2:.4025,f3:-.5213,f4:.1073,label:"spiral_B"},{f1:-.2276,f2:-.3548,f3:.569,f4:-.1961,label:"spiral_A"},{f1:.2476,f2:.4552,f3:-.5126,f4:.1942,label:"spiral_B"},{f1:-.2709,f2:-.4687,f3:.5063,f4:-.2735,label:"spiral_A"},{f1:.2718,f2:.3815,f3:-.4458,f4:.2783,label:"spiral_B"},{f1:-.1632,f2:-.4787,f3:.4927,f4:-.3298,label:"spiral_A"},{f1:.2787,f2:.5321,f3:-.4087,f4:.3566,label:"spiral_B"},{f1:-.1598,f2:-.5367,f3:.3952,f4:-.386,label:"spiral_A"},{f1:.1944,f2:.5475,f3:-.4457,f4:.3476,label:"spiral_B"},{f1:-.1613,f2:-.5397,f3:.3855,f4:-.4641,label:"spiral_A"},{f1:.1547,f2:.5272,f3:-.3043,f4:.3817,label:"spiral_B"},{f1:-.0972,f2:-.5955,f3:.2985,f4:-.4333,label:"spiral_A"},{f1:.0996,f2:.5997,f3:-.2156,f4:.5509,label:"spiral_B"},{f1:-.1393,f2:-.5449,f3:.2428,f4:-.4652,label:"spiral_A"},{f1:.0878,f2:.6296,f3:-.1984,f4:.5473,label:"spiral_B"},{f1:-.0929,f2:-.534,f3:.1726,f4:-.5825,label:"spiral_A"},{f1:.0927,f2:.5926,f3:-.1231,f4:.5395,label:"spiral_B"},{f1:-.075,f2:-.5458,f3:.118,f4:-.5513,label:"spiral_A"},{f1:.0445,f2:.5528,f3:-.1149,f4:.5201,label:"spiral_B"},{f1:-.0328,f2:-.6366,f3:.0095,f4:-.5705,label:"spiral_A"},{f1:.0625,f2:.6249,f3:-.0022,f4:.5712,label:"spiral_B"},{f1:.0398,f2:-.6214,f3:-.0647,f4:-.4972,label:"spiral_A"},{f1:-.0148,f2:.5805,f3:.0657,f4:.5515,label:"spiral_B"},{f1:.0367,f2:-.6532,f3:-.1551,f4:-.5909,label:"spiral_A"},{f1:-.1248,f2:.5653,f3:.1297,f4:.5959,label:"spiral_B"},{f1:.1252,f2:-.6046,f3:-.2155,f4:-.5294,label:"spiral_A"},{f1:-.0426,f2:.5569,f3:.162,f4:.5884,label:"spiral_B"},{f1:.0652,f2:-.6093,f3:-.2287,f4:-.5597,label:"spiral_A"},{f1:-.1232,f2:.6385,f3:.2714,f4:.5406,label:"spiral_B"},{f1:.1884,f2:-.5907,f3:-.3064,f4:-.5224,label:"spiral_A"},{f1:-.1632,f2:.597,f3:.3093,f4:.5092,label:"spiral_B"},{f1:.156,f2:-.5475,f3:-.3661,f4:-.4546,label:"spiral_A"},{f1:-.213,f2:.5694,f3:.4036,f4:.4589,label:"spiral_B"},{f1:.2784,f2:-.4897,f3:-.3297,f4:-.4733,label:"spiral_A"},{f1:-.2611,f2:.5706,f3:.4386,f4:.3829,label:"spiral_B"},{f1:.3303,f2:-.5713,f3:-.5862,f4:-.3235,label:"spiral_A"},{f1:-.2801,f2:.5619,f3:.5039,f4:.3304,label:"spiral_B"},{f1:.3358,f2:-.5293,f3:-.5811,f4:-.2219,label:"spiral_A"},{f1:-.288,f2:.5656,f3:.5338,f4:.3063,label:"spiral_B"},{f1:.3725,f2:-.4569,f3:-.5864,f4:-.2271,label:"spiral_A"},{f1:-.3154,f2:.521,f3:.5469,f4:.1339,label:"spiral_B"},{f1:.3624,f2:-.5319,f3:-.676,f4:-.0919,label:"spiral_A"},{f1:-.2822,f2:.4698,f3:.5772,f4:.1092,label:"spiral_B"},{f1:.4051,f2:-.4422,f3:-.5995,f4:-.0779,label:"spiral_A"},{f1:-.3905,f2:.3918,f3:.5318,f4:.0471,label:"spiral_B"},{f1:.4652,f2:-.4691,f3:-.6069,f4:.052,label:"spiral_A"},{f1:-.4942,f2:.4187,f3:.6633,f4:.0533,label:"spiral_B"},{f1:.4852,f2:-.4527,f3:-.6117,f4:.112,label:"spiral_A"},{f1:-.4478,f2:.3488,f3:.5784,f4:-.0343,label:"spiral_B"},{f1:.4423,f2:-.3569,f3:-.6436,f4:.1401,label:"spiral_A"},{f1:-.5014,f2:.3668,f3:.6418,f4:-.1313,label:"spiral_B"},{f1:.4993,f2:-.2822,f3:-.598,f4:.2758,label:"spiral_A"},{f1:-.5165,f2:.3514,f3:.6056,f4:-.1924,label:"spiral_B"},{f1:.5376,f2:-.3238,f3:-.5907,f4:.3794,label:"spiral_A"},{f1:-.5516,f2:.3699,f3:.536,f4:-.3222,label:"spiral_B"},{f1:.5844,f2:-.2266,f3:-.5038,f4:.3586,label:"spiral_A"},{f1:-.5816,f2:.3191,f3:.4717,f4:-.4199,label:"spiral_B"},{f1:.5587,f2:-.3046,f3:-.3695,f4:.4587,label:"spiral_A"},{f1:-.5545,f2:.2364,f3:.4873,f4:-.4669,label:"spiral_B"},{f1:.5982,f2:-.1614,f3:-.4031,f4:.4738,label:"spiral_A"},{f1:-.5839,f2:.2215,f3:.4123,f4:-.5182,label:"spiral_B"},{f1:.5971,f2:-.2063,f3:-.3342,f4:.5525,label:"spiral_A"},{f1:-.6316,f2:.2698,f3:.3587,f4:-.5398,label:"spiral_B"},{f1:.5689,f2:-.1222,f3:-.3285,f4:.5884,label:"spiral_A"},{f1:-.6368,f2:.1232,f3:.2652,f4:-.5929,label:"spiral_B"},{f1:.5828,f2:-.1193,f3:-.1963,f4:.5648,label:"spiral_A"},{f1:-.6602,f2:.0394,f3:.1533,f4:-.6462,label:"spiral_B"},{f1:.7246,f2:.0079,f3:-.1185,f4:.6129,label:"spiral_A"},{f1:-.6704,f2:.1261,f3:.042,f4:-.5577,label:"spiral_B"},{f1:.7056,f2:.0279,f3:-.0304,f4:.5957,label:"spiral_A"},{f1:-.6579,f2:-.0062,f3:.0581,f4:-.6155,label:"spiral_B"},{f1:.6689,f2:.033,f3:.0271,f4:.5888,label:"spiral_A"},{f1:-.6157,f2:-.0099,f3:-.0796,f4:-.6804,label:"spiral_B"},{f1:.7418,f2:.0438,f3:.133,f4:.6877,label:"spiral_A"},{f1:-.6962,f2:-.0708,f3:-.1342,f4:-.7155,label:"spiral_B"},{f1:.6955,f2:.0919,f3:.2097,f4:.6173,label:"spiral_A"},{f1:-.6298,f2:-.1038,f3:-.2386,f4:-.6433,label:"spiral_B"},{f1:.6598,f2:.1808,f3:.3564,f4:.5954,label:"spiral_A"},{f1:-.6221,f2:-.2323,f3:-.2619,f4:-.5913,label:"spiral_B"},{f1:.5973,f2:.2022,f3:.3792,f4:.6211,label:"spiral_A"},{f1:-.7072,f2:-.1868,f3:-.3685,f4:-.568,label:"spiral_B"},{f1:.642,f2:.2769,f3:.4488,f4:.5886,label:"spiral_A"},{f1:-.6286,f2:-.206,f3:-.4952,f4:-.4725,label:"spiral_B"},{f1:.6968,f2:.3033,f3:.572,f4:.4722,label:"spiral_A"},{f1:-.667,f2:-.2502,f3:-.5301,f4:-.4343,label:"spiral_B"},{f1:.5427,f2:.345,f3:.5865,f4:.3958,label:"spiral_A"},{f1:-.6737,f2:-.2822,f3:-.4841,f4:-.3299,label:"spiral_B"},{f1:.5532,f2:.3639,f3:.633,f4:.3564,label:"spiral_A"},{f1:-.6019,f2:-.414,f3:-.6231,f4:-.3843,label:"spiral_B"},{f1:.5819,f2:.3962,f3:.6847,f4:.231,label:"spiral_A"},{f1:-.6176,f2:-.3656,f3:-.6546,f4:-.2736,label:"spiral_B"},{f1:.6159,f2:.3799,f3:.7773,f4:.1182,label:"spiral_A"},{f1:-.5194,f2:-.4389,f3:-.6448,f4:-.1688,label:"spiral_B"},{f1:.5226,f2:.4553,f3:.7151,f4:.077,label:"spiral_A"},{f1:-.5223,f2:-.46,f3:-.6597,f4:-.0726,label:"spiral_B"},{f1:.4818,f2:.555,f3:.6818,f4:-.0134,label:"spiral_A"},{f1:-.4865,f2:-.4936,f3:-.7212,f4:-.0298,label:"spiral_B"},{f1:.5069,f2:.5123,f3:.6918,f4:-.1804,label:"spiral_A"},{f1:-.4408,f2:-.5078,f3:-.6758,f4:.0779,label:"spiral_B"},{f1:.4844,f2:.5838,f3:.6688,f4:-.1965,label:"spiral_A"},{f1:-.4862,f2:-.5525,f3:-.6823,f4:.2035,label:"spiral_B"},{f1:.4749,f2:.5212,f3:.6591,f4:-.287,label:"spiral_A"},{f1:-.3685,f2:-.5111,f3:-.6798,f4:.2661,label:"spiral_B"},{f1:.3774,f2:.6847,f3:.6908,f4:-.3091,label:"spiral_A"},{f1:-.391,f2:-.6129,f3:-.5803,f4:.3885,label:"spiral_B"},{f1:.3519,f2:.6513,f3:.6012,f4:-.4722,label:"spiral_A"},{f1:-.3394,f2:-.6874,f3:-.5732,f4:.4845,label:"spiral_B"},{f1:.2737,f2:.7466,f3:.5106,f4:-.5433,label:"spiral_A"},{f1:-.2799,f2:-.6459,f3:-.5667,f4:.5518,label:"spiral_B"},{f1:.1834,f2:.6888,f3:.4496,f4:-.6334,label:"spiral_A"},{f1:-.2253,f2:-.6838,f3:-.4299,f4:.6258,label:"spiral_B"},{f1:.28,f2:.7167,f3:.4672,f4:-.6035,label:"spiral_A"},{f1:-.2168,f2:-.7613,f3:-.4184,f4:.644,label:"spiral_B"},{f1:.1205,f2:.7952,f3:.2606,f4:-.7265,label:"spiral_A"},{f1:-.1221,f2:-.6726,f3:-.3365,f4:.6672,label:"spiral_B"},{f1:.1281,f2:.7661,f3:.2279,f4:-.7094,label:"spiral_A"},{f1:-.1125,f2:-.7345,f3:-.2468,f4:.7492,label:"spiral_B"},{f1:.0124,f2:.6767,f3:.1058,f4:-.6949,label:"spiral_A"},{f1:-.0547,f2:-.7574,f3:-.1237,f4:.7379,label:"spiral_B"},{f1:.0532,f2:.6983,f3:-.013,f4:-.7095,label:"spiral_A"},{f1:-.0451,f2:-.7594,f3:-.0472,f4:.7573,label:"spiral_B"},{f1:-.0085,f2:.6937,f3:-.1461,f4:-.8081,label:"spiral_A"},{f1:.0489,f2:-.7267,f3:.0644,f4:.7692,label:"spiral_B"},{f1:-.073,f2:.7513,f3:-.1118,f4:-.7478,label:"spiral_A"},{f1:.0466,f2:-.7731,f3:.0893,f4:.7561,label:"spiral_B"},{f1:-.1399,f2:.7667,f3:-.2603,f4:-.7354,label:"spiral_A"},{f1:.134,f2:-.724,f3:.1932,f4:.7529,label:"spiral_B"},{f1:-.212,f2:.7574,f3:-.3251,f4:-.7056,label:"spiral_A"},{f1:.1803,f2:-.813,f3:.3207,f4:.7251,label:"spiral_B"},{f1:-.2505,f2:.6789,f3:-.4338,f4:-.5972,label:"spiral_A"},{f1:.202,f2:-.7813,f3:.4702,f4:.6499,label:"spiral_B"},{f1:-.2756,f2:.7467,f3:-.54,f4:-.5225,label:"spiral_A"},{f1:.2423,f2:-.7421,f3:.4442,f4:.6352,label:"spiral_B"},{f1:-.31,f2:.7215,f3:-.4966,f4:-.497,label:"spiral_A"},{f1:.2818,f2:-.707,f3:.5869,f4:.5287,label:"spiral_B"},{f1:-.3954,f2:.6634,f3:-.6203,f4:-.4039,label:"spiral_A"},{f1:.3069,f2:-.723,f3:.6994,f4:.4422,label:"spiral_B"},{f1:-.3787,f2:.6198,f3:-.684,f4:-.2723,label:"spiral_A"},{f1:.3464,f2:-.6362,f3:.6464,f4:.3369,label:"spiral_B"},{f1:-.4072,f2:.5856,f3:-.7387,f4:-.2,label:"spiral_A"},{f1:.51,f2:-.6373,f3:.7106,f4:.2593,label:"spiral_B"},{f1:-.5692,f2:.6162,f3:-.7984,f4:-.129,label:"spiral_A"},{f1:.5554,f2:-.6268,f3:.759,f4:.2081,label:"spiral_B"},{f1:-.5966,f2:.5574,f3:-.8369,f4:-.0253,label:"spiral_A"},{f1:.5373,f2:-.5719,f3:.7956,f4:.0579,label:"spiral_B"},{f1:-.5168,f2:.6357,f3:-.8515,f4:.0626,label:"spiral_A"},{f1:.5928,f2:-.5162,f3:.7565,f4:-.0594,label:"spiral_B"},{f1:-.5673,f2:.4131,f3:-.8219,f4:.1052,label:"spiral_A"},{f1:.6862,f2:-.5229,f3:.7712,f4:-.1119,label:"spiral_B"},{f1:-.6764,f2:.4772,f3:-.7399,f4:.2778,label:"spiral_A"},{f1:.5821,f2:-.4637,f3:.8486,f4:-.166,label:"spiral_B"},{f1:-.7019,f2:.4267,f3:-.6761,f4:.3351,label:"spiral_A"},{f1:.7339,f2:-.4037,f3:.7608,f4:-.3279,label:"spiral_B"},{f1:-.6853,f2:.466,f3:-.6499,f4:.3742,label:"spiral_A"},{f1:.6752,f2:-.3936,f3:.6443,f4:-.4687,label:"spiral_B"},{f1:-.7023,f2:.361,f3:-.5756,f4:.4781,label:"spiral_A"},{f1:.744,f2:-.3253,f3:.6242,f4:-.5851,label:"spiral_B"},{f1:-.8002,f2:.3342,f3:-.5481,f4:.5762,label:"spiral_A"},{f1:.7154,f2:-.3528,f3:.4709,f4:-.5643,label:"spiral_B"},{f1:-.8233,f2:.2278,f3:-.4047,f4:.6395,label:"spiral_A"},{f1:.6918,f2:-.3389,f3:.4595,f4:-.6115,label:"spiral_B"},{f1:-.7869,f2:.2366,f3:-.4595,f4:.6751,label:"spiral_A"},{f1:.8249,f2:-.2727,f3:.4197,f4:-.7605,label:"spiral_B"},{f1:-.858,f2:.1192,f3:-.3111,f4:.8372,label:"spiral_A"},{f1:.7807,f2:-.1427,f3:.3004,f4:-.7058,label:"spiral_B"},{f1:-.7657,f2:.1785,f3:-.2487,f4:.7132,label:"spiral_A"},{f1:.8179,f2:-.0139,f3:.2316,f4:-.8032,label:"spiral_B"},{f1:-.8755,f2:.0672,f3:-.1342,f4:.8078,label:"spiral_A"},{f1:.8797,f2:-.0929,f3:.0981,f4:-.8522,label:"spiral_B"},{f1:-.8196,f2:-.0062,f3:-.0817,f4:.8627,label:"spiral_A"},{f1:.7477,f2:-.0384,f3:-.0055,f4:-.8662,label:"spiral_B"},{f1:-.7777,f2:-.1069,f3:.0706,f4:.8118,label:"spiral_A"},{f1:.7904,f2:.0471,f3:-.0606,f4:-.8108,label:"spiral_B"},{f1:-.8029,f2:-.0855,f3:.2296,f4:.8427,label:"spiral_A"},{f1:.755,f2:.0863,f3:-.2636,f4:-.87,label:"spiral_B"},{f1:-.8413,f2:-.0939,f3:.2491,f4:.7472,label:"spiral_A"},{f1:.9095,f2:.1684,f3:-.2795,f4:-.7847,label:"spiral_B"},{f1:-.8333,f2:-.1565,f3:.4361,f4:.7433,label:"spiral_A"},{f1:.8548,f2:.2608,f3:-.42,f4:-.7636,label:"spiral_B"},{f1:-.8492,f2:-.2795,f3:.4557,f4:.6625,label:"spiral_A"},{f1:.8827,f2:.2788,f3:-.5033,f4:-.7309,label:"spiral_B"},{f1:-.7626,f2:-.3152,f3:.5869,f4:.565,label:"spiral_A"},{f1:.8575,f2:.3011,f3:-.5519,f4:-.5656,label:"spiral_B"},{f1:-.7961,f2:-.3982,f3:.6207,f4:.4391,label:"spiral_A"},{f1:.8915,f2:.4662,f3:-.7041,f4:-.5551,label:"spiral_B"},{f1:-.7579,f2:-.4196,f3:.7101,f4:.4524,label:"spiral_A"},{f1:.7305,f2:.3943,f3:-.7167,f4:-.4216,label:"spiral_B"},{f1:-.7249,f2:-.5327,f3:.8139,f4:.3685,label:"spiral_A"},{f1:.672,f2:.4807,f3:-.8123,f4:-.3764,label:"spiral_B"},{f1:-.78,f2:-.497,f3:.7458,f4:.3192,label:"spiral_A"},{f1:.7673,f2:.4959,f3:-.7302,f4:-.3415,label:"spiral_B"},{f1:-.687,f2:-.5867,f3:.8655,f4:.1286,label:"spiral_A"},{f1:.6345,f2:.5237,f3:-.8757,f4:-.2317,label:"spiral_B"},{f1:-.6445,f2:-.4969,f3:.9652,f4:.0297,label:"spiral_A"},{f1:.6579,f2:.6292,f3:-.8803,f4:-.0631,label:"spiral_B"},{f1:-.6642,f2:-.6893,f3:.8962,f4:-.0822,label:"spiral_A"},{f1:.6477,f2:.6764,f3:-.8383,f4:.0585,label:"spiral_B"},{f1:-.5902,f2:-.6772,f3:.8838,f4:-.1616,label:"spiral_A"},{f1:.5114,f2:.6333,f3:-.9168,f4:.1472,label:"spiral_B"},{f1:-.5492,f2:-.6934,f3:.8006,f4:-.2605,label:"spiral_A"},{f1:.6077,f2:.7419,f3:-.8202,f4:.2522,label:"spiral_B"},{f1:-.5166,f2:-.7421,f3:.8188,f4:-.356,label:"spiral_A"},{f1:.4567,f2:.7427,f3:-.8302,f4:.364,label:"spiral_B"},{f1:-.4929,f2:-.7615,f3:.823,f4:-.4661,label:"spiral_A"},{f1:.3451,f2:.7698,f3:-.732,f4:.4123,label:"spiral_B"},{f1:-.3708,f2:-.8322,f3:.5865,f4:-.6405,label:"spiral_A"},{f1:.4594,f2:.7913,f3:-.6992,f4:.6255,label:"spiral_B"},{f1:-.3526,f2:-.7299,f3:.6824,f4:-.644,label:"spiral_A"},{f1:.329,f2:.96,f3:-.6219,f4:.6952,label:"spiral_B"},{f1:-.3255,f2:-.837,f3:.5755,f4:-.7186,label:"spiral_A"},{f1:.2549,f2:.9315,f3:-.5264,f4:.7337,label:"spiral_B"},{f1:-.1999,f2:-.827,f3:.4939,f4:-.7636,label:"spiral_A"},{f1:.1885,f2:.8096,f3:-.4853,f4:.7815,label:"spiral_B"},{f1:-.2153,f2:-.8982,f3:.3064,f4:-.8542,label:"spiral_A"},{f1:.1501,f2:.8852,f3:-.3062,f4:.817,label:"spiral_B"},{f1:-.1212,f2:-.9344,f3:.1938,f4:-.8839,label:"spiral_A"},{f1:.0883,f2:.8875,f3:-.2704,f4:.8071,label:"spiral_B"},{f1:-.078,f2:-.9772,f3:.1468,f4:-.9155,label:"spiral_A"},{f1:.0161,f2:.9857,f3:-.0891,f4:.9792,label:"spiral_B"},{f1:.0202,f2:-.9219,f3:.0628,f4:-.9225,label:"spiral_A"},{f1:.0012,f2:.8951,f3:-.066,f4:.9383,label:"spiral_B"},{f1:.0378,f2:-.9338,f3:-.0959,f4:-.8549,label:"spiral_A"},{f1:-.0745,f2:.9316,f3:.0263,f4:.89,label:"spiral_B"},{f1:.0745,f2:-.8662,f3:-.2521,f4:-.9215,label:"spiral_A"},{f1:-.1601,f2:.9244,f3:.2359,f4:.9369,label:"spiral_B"},{f1:.1113,f2:-.8502,f3:-.3037,f4:-.84,label:"spiral_A"},{f1:-.1289,f2:.9092,f3:.2434,f4:.851,label:"spiral_B"},{f1:.2384,f2:-.8912,f3:-.4434,f4:-.8647,label:"spiral_A"},{f1:-.2083,f2:.9427,f3:.5104,f4:.8542,label:"spiral_B"},{f1:.3005,f2:-.8781,f3:-.5532,f4:-.7929,label:"spiral_A"},{f1:-.2794,f2:.805,f3:.5526,f4:.7755,label:"spiral_B"},{f1:.2885,f2:-.7936,f3:-.6233,f4:-.6715,label:"spiral_A"},{f1:-.3226,f2:.913,f3:.61,f4:.6857,label:"spiral_B"},{f1:.3685,f2:-.9032,f3:-.8025,f4:-.6732,label:"spiral_A"},{f1:-.3851,f2:.8807,f3:.7468,f4:.6485,label:"spiral_B"},{f1:.4651,f2:-.8545,f3:-.8481,f4:-.5505,label:"spiral_A"},{f1:-.4493,f2:.8176,f3:.71,f4:.4618,label:"spiral_B"},{f1:.4649,f2:-.724,f3:-.8264,f4:-.4744,label:"spiral_A"},{f1:-.4918,f2:.8214,f3:.8359,f4:.3825,label:"spiral_B"},{f1:.5286,f2:-.8349,f3:-.8921,f4:-.2952,label:"spiral_A"},{f1:-.5098,f2:.7514,f3:.9492,f4:.3308,label:"spiral_B"},{f1:.5549,f2:-.7451,f3:-.8797,f4:-.146,label:"spiral_A"},{f1:-.5803,f2:.7421,f3:.9006,f4:.1749,label:"spiral_B"},{f1:.6831,f2:-.6394,f3:-.9795,f4:-.0326,label:"spiral_A"},{f1:-.7436,f2:.7053,f3:.9217,f4:.0946,label:"spiral_B"},{f1:.6842,f2:-.6833,f3:-.9714,f4:.0175,label:"spiral_A"},{f1:-.7048,f2:.6351,f3:.9768,f4:-.0792,label:"spiral_B"},{f1:.7722,f2:-.7109,f3:-.964,f4:.1617,label:"spiral_A"},{f1:-.7921,f2:.6625,f3:.9609,f4:-.2352,label:"spiral_B"},{f1:.7875,f2:-.539,f3:-.9038,f4:.2916,label:"spiral_A"},{f1:-.7696,f2:.5842,f3:.8899,f4:-.2934,label:"spiral_B"},{f1:.881,f2:-.5445,f3:-.9139,f4:.4227,label:"spiral_A"},{f1:-.7162,f2:.514,f3:.921,f4:-.3387,label:"spiral_B"},{f1:.7834,f2:-.523,f3:-.8009,f4:.5131,label:"spiral_A"},{f1:-.8117,f2:.488,f3:.8445,f4:-.5716,label:"spiral_B"},{f1:.9569,f2:-.4132,f3:-.7615,f4:.599,label:"spiral_A"},{f1:-.9157,f2:.441,f3:.8235,f4:-.6571,label:"spiral_B"},{f1:.93,f2:-.3891,f3:-.6423,f4:.6881,label:"spiral_A"},{f1:-.8445,f2:.4251,f3:.5873,f4:-.6841,label:"spiral_B"},{f1:.8979,f2:-.317,f3:-.6222,f4:.8376,label:"spiral_A"},{f1:-.9355,f2:.2205,f3:.5965,f4:-.8734,label:"spiral_B"},{f1:.8854,f2:-.2265,f3:-.524,f4:.9149,label:"spiral_A"},{f1:-.9475,f2:.2706,f3:.5041,f4:-.9089,label:"spiral_B"},{f1:.9644,f2:-.1977,f3:-.3747,f4:.8949,label:"spiral_A"},{f1:-.9608,f2:.1518,f3:.3703,f4:-.9403,label:"spiral_B"},{f1:.9905,f2:-.1339,f3:-.25,f4:.9289,label:"spiral_A"},{f1:-.9811,f2:.1617,f3:.221,f4:-.9002,label:"spiral_B"},{f1:.9708,f2:-.0555,f3:-.1919,f4:.9458,label:"spiral_A"},{f1:-1.0326,f2:-.0324,f3:.2273,f4:-.9779,label:"spiral_B"},{f1:1.0271,f2:.0064,f3:.0238,f4:.9834,label:"spiral_A"},{f1:-1.0322,f2:.0547,f3:.0505,f4:-1.0499,label:"spiral_B"}];function r(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function n(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function i(t){let e,i,o;function l(t,r,n=0,s=t.length){if(n<s){if(0!==e(r,r))return s;do{const e=n+s>>>1;i(t[e],r)<0?n=e+1:s=e}while(n<s)}return n}return 2!==t.length?(e=r,i=(e,n)=>r(t(e),n),o=(e,r)=>t(e)-r):(e=t===r||t===n?t:s,i=t,o=t),{left:l,center:function(t,e,r=0,n=t.length){const i=l(t,e,r,n-1);return i>r&&o(t[i-1],e)>-o(t[i],e)?i-1:i},right:function(t,r,n=0,s=t.length){if(n<s){if(0!==e(r,r))return s;do{const e=n+s>>>1;i(t[e],r)<=0?n=e+1:s=e}while(n<s)}return n}}}function s(){return 0}const o=i(r).right;function l(t,e){let r,n=0,i=0,s=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(r=e-i,i+=r/++n,s+=r*(e-i));else{let o=-1;for(let l of t)null!=(l=e(l,++o,t))&&(l=+l)>=l&&(r=l-i,i+=r/++n,s+=r*(l-i))}if(n>1)return s/(n-1)}function a(t,e){let r,n;if(void 0===e)for(const e of t)null!=e&&(void 0===r?e>=e&&(r=n=e):(r>e&&(r=e),n<e&&(n=e)));else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&(void 0===r?s>=s&&(r=n=s):(r>s&&(r=s),n<s&&(n=s)))}return[r,n]}i(function(t){return null===t?NaN:+t}).center;class f extends Map{constructor(t,e=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,r]of t)this.set(e,r)}get(t){return super.get(u(this,t))}has(t){return super.has(u(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},r){const n=e(r);t.has(n)&&(r=t.get(n),t.delete(n));return r}(this,t))}}function u({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function h(t){return null!==t&&"object"==typeof t?t.valueOf():t}const c=Math.sqrt(50),p=Math.sqrt(10),d=Math.sqrt(2);function g(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),o=s>=c?10:s>=p?5:s>=d?2:1;let l,a,f;return i<0?(f=Math.pow(10,-i)/o,l=Math.round(t*f),a=Math.round(e*f),l/f<t&&++l,a/f>e&&--a,f=-f):(f=Math.pow(10,i)*o,l=Math.round(t/f),a=Math.round(e/f),l*f<t&&++l,a*f>e&&--a),a<l&&.5<=r&&r<2?g(t,e,2*r):[l,a,f]}function m(t,e,r){if(!((r=+r)>0))return[];if((t=+t)===(e=+e))return[t];const n=e<t,[i,s,o]=n?g(e,t,r):g(t,e,r);if(!(s>=i))return[];const l=s-i+1,a=new Array(l);if(n)if(o<0)for(let t=0;t<l;++t)a[t]=(s-t)/-o;else for(let t=0;t<l;++t)a[t]=(s-t)*o;else if(o<0)for(let t=0;t<l;++t)a[t]=(i+t)/-o;else for(let t=0;t<l;++t)a[t]=(i+t)*o;return a}function w(t,e,r){return g(t=+t,e=+e,r=+r)[2]}function _(t,e,r){r=+r;const n=(e=+e)<(t=+t),i=n?w(e,t,r):w(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function y(t,e){let r;if(void 0===e)for(const e of t)null!=e&&(r<e||void 0===r&&e>=e)&&(r=e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(r<i||void 0===r&&i>=i)&&(r=i)}return r}function b(t,e){let r;if(void 0===e)for(const e of t)null!=e&&(r>e||void 0===r&&e>=e)&&(r=e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(r>i||void 0===r&&i>=i)&&(r=i)}return r}function v(t,e){let r=0,n=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++r,n+=e);else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&(s=+s)>=s&&(++r,n+=s)}if(r)return n/r}function x(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=0|Math.max(0,Math.ceil((e-t)/r)),s=new Array(i);++n<i;)s[n]=t+n*r;return s}function M(t){return t}var A=1e-6;function k(t){return"translate("+t+",0)"}function S(t){return"translate(0,"+t+")"}function E(t){return e=>+t(e)}function N(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),r=>+t(r)+e}function B(){return!this.__axis}function C(t,e){var r=[],n=null,i=null,s=6,o=6,l=3,a="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,f=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",h=1===t||3===t?k:S;function c(c){var p=null==n?e.ticks?e.ticks.apply(e,r):e.domain():n,d=null==i?e.tickFormat?e.tickFormat.apply(e,r):M:i,g=Math.max(s,0)+l,m=e.range(),w=+m[0]+a,_=+m[m.length-1]+a,y=(e.bandwidth?N:E)(e.copy(),a),b=c.selection?c.selection():c,v=b.selectAll(".domain").data([null]),x=b.selectAll(".tick").data(p,e).order(),k=x.exit(),S=x.enter().append("g").attr("class","tick"),C=x.select("line"),R=x.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(S),C=C.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",f*s)),R=R.merge(S.append("text").attr("fill","currentColor").attr(u,f*g).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),c!==b&&(v=v.transition(c),x=x.transition(c),C=C.transition(c),R=R.transition(c),k=k.transition(c).attr("opacity",A).attr("transform",function(t){return isFinite(t=y(t))?h(t+a):this.getAttribute("transform")}),S.attr("opacity",A).attr("transform",function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:y(t))+a)})),k.remove(),v.attr("d",4===t||2===t?o?"M"+f*o+","+w+"H"+a+"V"+_+"H"+f*o:"M"+a+","+w+"V"+_:o?"M"+w+","+f*o+"V"+a+"H"+_+"V"+f*o:"M"+w+","+a+"H"+_),x.attr("opacity",1).attr("transform",function(t){return h(y(t)+a)}),C.attr(u+"2",f*s),R.attr(u,f*g).text(d),b.filter(B).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each(function(){this.__axis=y})}return c.scale=function(t){return arguments.length?(e=t,c):e},c.ticks=function(){return r=Array.from(arguments),c},c.tickArguments=function(t){return arguments.length?(r=null==t?[]:Array.from(t),c):r.slice()},c.tickValues=function(t){return arguments.length?(n=null==t?null:Array.from(t),c):n&&n.slice()},c.tickFormat=function(t){return arguments.length?(i=t,c):i},c.tickSize=function(t){return arguments.length?(s=o=+t,c):s},c.tickSizeInner=function(t){return arguments.length?(s=+t,c):s},c.tickSizeOuter=function(t){return arguments.length?(o=+t,c):o},c.tickPadding=function(t){return arguments.length?(l=+t,c):l},c.offset=function(t){return arguments.length?(a=+t,c):a},c}function R(t){return C(2,t)}function z(t){return C(3,t)}function I(t){return C(4,t)}var P={value:()=>{}};function O(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new j(n)}function j(t){this._=t}function T(t,e){for(var r,n=0,i=t.length;n<i;++n)if((r=t[n]).name===e)return r.value}function $(t,e,r){for(var n=0,i=t.length;n<i;++n)if(t[n].name===e){t[n]=P,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}j.prototype=O.prototype={constructor:j,on:function(t,e){var r,n,i=this._,s=(n=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,l=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<l;)if(r=(t=s[o]).type)i[r]=$(i[r],t.name,e);else if(null==e)for(r in i)i[r]=$(i[r],t.name,null);return this}for(;++o<l;)if((r=(t=s[o]).type)&&(r=T(i[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new j(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,i=new Array(r),s=0;s<r;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,r=(n=this._[t]).length;s<r;++s)n[s].value.apply(e,i)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],i=0,s=n.length;i<s;++i)n[i].value.apply(e,r)}};var F="http://www.w3.org/1999/xhtml",D={svg:"http://www.w3.org/2000/svg",xhtml:F,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function V(t){var e=t+="",r=e.indexOf(":");return r>=0&&"xmlns"!==(e=t.slice(0,r))&&(t=t.slice(r+1)),D.hasOwnProperty(e)?{space:D[e],local:t}:t}function L(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===F&&e.documentElement.namespaceURI===F?e.createElement(t):e.createElementNS(r,t)}}function q(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function U(t){var e=V(t);return(e.local?q:L)(e)}function H(){}function Y(t){return null==t?H:function(){return this.querySelector(t)}}function G(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function X(){return[]}function W(t){return null==t?X:function(){return this.querySelectorAll(t)}}function K(t){return function(){return this.matches(t)}}function Q(t){return function(e){return e.matches(t)}}var J=Array.prototype.find;function Z(){return this.firstElementChild}var tt=Array.prototype.filter;function et(){return Array.from(this.children)}function rt(t){return new Array(t.length)}function nt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function it(t,e,r,n,i,s){for(var o,l=0,a=e.length,f=s.length;l<f;++l)(o=e[l])?(o.__data__=s[l],n[l]=o):r[l]=new nt(t,s[l]);for(;l<a;++l)(o=e[l])&&(i[l]=o)}function st(t,e,r,n,i,s,o){var l,a,f,u=new Map,h=e.length,c=s.length,p=new Array(h);for(l=0;l<h;++l)(a=e[l])&&(p[l]=f=o.call(a,a.__data__,l,e)+"",u.has(f)?i[l]=a:u.set(f,a));for(l=0;l<c;++l)f=o.call(t,s[l],l,s)+"",(a=u.get(f))?(n[l]=a,a.__data__=s[l],u.delete(f)):r[l]=new nt(t,s[l]);for(l=0;l<h;++l)(a=e[l])&&u.get(p[l])===a&&(i[l]=a)}function ot(t){return t.__data__}function lt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function at(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ft(t){return function(){this.removeAttribute(t)}}function ut(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ht(t,e){return function(){this.setAttribute(t,e)}}function ct(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function pt(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function dt(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function gt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mt(t){return function(){this.style.removeProperty(t)}}function wt(t,e,r){return function(){this.style.setProperty(t,e,r)}}function _t(t,e,r){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function yt(t,e){return t.style.getPropertyValue(e)||gt(t).getComputedStyle(t,null).getPropertyValue(e)}function bt(t){return function(){delete this[t]}}function vt(t,e){return function(){this[t]=e}}function xt(t,e){return function(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function Mt(t){return t.trim().split(/^|\s+/)}function At(t){return t.classList||new kt(t)}function kt(t){this._node=t,this._names=Mt(t.getAttribute("class")||"")}function St(t,e){for(var r=At(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function Et(t,e){for(var r=At(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function Nt(t){return function(){St(this,t)}}function Bt(t){return function(){Et(this,t)}}function Ct(t,e){return function(){(e.apply(this,arguments)?St:Et)(this,t)}}function Rt(){this.textContent=""}function zt(t){return function(){this.textContent=t}}function It(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Pt(){this.innerHTML=""}function Ot(t){return function(){this.innerHTML=t}}function jt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Tt(){this.nextSibling&&this.parentNode.appendChild(this)}function $t(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ft(){return null}function Dt(){var t=this.parentNode;t&&t.removeChild(this)}function Vt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Lt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qt(t){return function(){var e=this.__on;if(e){for(var r,n=0,i=-1,s=e.length;n<s;++n)r=e[n],t.type&&r.type!==t.type||r.name!==t.name?e[++i]=r:this.removeEventListener(r.type,r.listener,r.options);++i?e.length=i:delete this.__on}}}function Ut(t,e,r){return function(){var n,i=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var o=0,l=i.length;o<l;++o)if((n=i[o]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=s,n.options=r),void(n.value=e);this.addEventListener(t.type,s,r),n={type:t.type,name:t.name,value:e,listener:s,options:r},i?i.push(n):this.__on=[n]}}function Ht(t,e,r){var n=gt(t),i=n.CustomEvent;"function"==typeof i?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Yt(t,e){return function(){return Ht(this,t,e)}}function Gt(t,e){return function(){return Ht(this,t,e.apply(this,arguments))}}nt.prototype={constructor:nt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},kt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Xt=[null];function Wt(t,e){this._groups=t,this._parents=e}function Kt(){return new Wt([[document.documentElement]],Xt)}function Qt(t){return"string"==typeof t?new Wt([[document.querySelector(t)]],[document.documentElement]):new Wt([[t]],Xt)}function Jt(t){return Qt(U(t).call(document.documentElement))}function Zt(t){return"string"==typeof t?new Wt([document.querySelectorAll(t)],[document.documentElement]):new Wt([G(t)],Xt)}function te(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ee(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function re(){}Wt.prototype=Kt.prototype={constructor:Wt,select:function(t){"function"!=typeof t&&(t=Y(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var s,o,l=e[i],a=l.length,f=n[i]=new Array(a),u=0;u<a;++u)(s=l[u])&&(o=t.call(s,s.__data__,u,l))&&("__data__"in s&&(o.__data__=s.__data__),f[u]=o);return new Wt(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return G(t.apply(this,arguments))}}(t):W(t);for(var e=this._groups,r=e.length,n=[],i=[],s=0;s<r;++s)for(var o,l=e[s],a=l.length,f=0;f<a;++f)(o=l[f])&&(n.push(t.call(o,o.__data__,f,l)),i.push(o));return new Wt(n,i)},selectChild:function(t){return this.select(null==t?Z:function(t){return function(){return J.call(this.children,t)}}("function"==typeof t?t:Q(t)))},selectChildren:function(t){return this.selectAll(null==t?et:function(t){return function(){return tt.call(this.children,t)}}("function"==typeof t?t:Q(t)))},filter:function(t){"function"!=typeof t&&(t=K(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var s,o=e[i],l=o.length,a=n[i]=[],f=0;f<l;++f)(s=o[f])&&t.call(s,s.__data__,f,o)&&a.push(s);return new Wt(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,ot);var r,n=e?st:it,i=this._parents,s=this._groups;"function"!=typeof t&&(r=t,t=function(){return r});for(var o=s.length,l=new Array(o),a=new Array(o),f=new Array(o),u=0;u<o;++u){var h=i[u],c=s[u],p=c.length,d=lt(t.call(h,h&&h.__data__,u,i)),g=d.length,m=a[u]=new Array(g),w=l[u]=new Array(g);n(h,c,m,w,f[u]=new Array(p),d,e);for(var _,y,b=0,v=0;b<g;++b)if(_=m[b]){for(b>=v&&(v=b+1);!(y=w[v])&&++v<g;);_._next=y||null}}return(l=new Wt(l,i))._enter=a,l._exit=f,l},enter:function(){return new Wt(this._enter||this._groups.map(rt),this._parents)},exit:function(){return new Wt(this._exit||this._groups.map(rt),this._parents)},join:function(t,e,r){var n=this.enter(),i=this,s=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==r?s.remove():r(s),n&&i?n.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,i=r.length,s=n.length,o=Math.min(i,s),l=new Array(i),a=0;a<o;++a)for(var f,u=r[a],h=n[a],c=u.length,p=l[a]=new Array(c),d=0;d<c;++d)(f=u[d]||h[d])&&(p[d]=f);for(;a<i;++a)l[a]=r[a];return new Wt(l,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n,i=t[e],s=i.length-1,o=i[s];--s>=0;)(n=i[s])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(t){function e(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}t||(t=at);for(var r=this._groups,n=r.length,i=new Array(n),s=0;s<n;++s){for(var o,l=r[s],a=l.length,f=i[s]=new Array(a),u=0;u<a;++u)(o=l[u])&&(f[u]=o);f.sort(e)}return new Wt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i,s=e[r],o=0,l=s.length;o<l;++o)(i=s[o])&&t.call(i,i.__data__,o,s);return this},attr:function(t,e){var r=V(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==e?r.local?ut:ft:"function"==typeof e?r.local?dt:pt:r.local?ct:ht)(r,e))},style:function(t,e,r){return arguments.length>1?this.each((null==e?mt:"function"==typeof e?_t:wt)(t,e,null==r?"":r)):yt(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?bt:"function"==typeof e?xt:vt)(t,e)):this.node()[t]},classed:function(t,e){var r=Mt(t+"");if(arguments.length<2){for(var n=At(this.node()),i=-1,s=r.length;++i<s;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof e?Ct:e?Nt:Bt)(r,e))},text:function(t){return arguments.length?this.each(null==t?Rt:("function"==typeof t?It:zt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Pt:("function"==typeof t?jt:Ot)(t)):this.node().innerHTML},raise:function(){return this.each(Tt)},lower:function(){return this.each($t)},append:function(t){var e="function"==typeof t?t:U(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var r="function"==typeof t?t:U(t),n=null==e?Ft:"function"==typeof e?e:Y(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function(){return this.each(Dt)},clone:function(t){return this.select(t?Lt:Vt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,r){var n,i,s=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");return r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),{type:t,name:e}})}(t+""),o=s.length;if(!(arguments.length<2)){for(l=e?Ut:qt,n=0;n<o;++n)this.each(l(s[n],e,r));return this}var l=this.node().__on;if(l)for(var a,f=0,u=l.length;f<u;++f)for(n=0,a=l[f];n<o;++n)if((i=s[n]).type===a.type&&i.name===a.name)return a.value},dispatch:function(t,e){return this.each(("function"==typeof e?Gt:Yt)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n,i=t[e],s=0,o=i.length;s<o;++s)(n=i[s])&&(yield n)}};var ne=.7,ie=1/ne,se="\\s*([+-]?\\d+)\\s*",oe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",le="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ae=/^#([0-9a-f]{3,8})$/,fe=new RegExp(`^rgb\\(${se},${se},${se}\\)$`),ue=new RegExp(`^rgb\\(${le},${le},${le}\\)$`),he=new RegExp(`^rgba\\(${se},${se},${se},${oe}\\)$`),ce=new RegExp(`^rgba\\(${le},${le},${le},${oe}\\)$`),pe=new RegExp(`^hsl\\(${oe},${le},${le}\\)$`),de=new RegExp(`^hsla\\(${oe},${le},${le},${oe}\\)$`),ge={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function me(){return this.rgb().formatHex()}function we(){return this.rgb().formatRgb()}function _e(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=ae.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?ye(e):3===r?new xe(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?be(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?be(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=fe.exec(t))?new xe(e[1],e[2],e[3],1):(e=ue.exec(t))?new xe(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=he.exec(t))?be(e[1],e[2],e[3],e[4]):(e=ce.exec(t))?be(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=pe.exec(t))?Ne(e[1],e[2]/100,e[3]/100,1):(e=de.exec(t))?Ne(e[1],e[2]/100,e[3]/100,e[4]):ge.hasOwnProperty(t)?ye(ge[t]):"transparent"===t?new xe(NaN,NaN,NaN,0):null}function ye(t){return new xe(t>>16&255,t>>8&255,255&t,1)}function be(t,e,r,n){return n<=0&&(t=e=r=NaN),new xe(t,e,r,n)}function ve(t,e,r,n){return 1===arguments.length?((i=t)instanceof re||(i=_e(i)),i?new xe((i=i.rgb()).r,i.g,i.b,i.opacity):new xe):new xe(t,e,r,null==n?1:n);var i}function xe(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function Me(){return`#${Ee(this.r)}${Ee(this.g)}${Ee(this.b)}`}function Ae(){const t=ke(this.opacity);return`${1===t?"rgb(":"rgba("}${Se(this.r)}, ${Se(this.g)}, ${Se(this.b)}${1===t?")":`, ${t})`}`}function ke(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Se(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ee(t){return((t=Se(t))<16?"0":"")+t.toString(16)}function Ne(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Re(t,e,r,n)}function Be(t){if(t instanceof Re)return new Re(t.h,t.s,t.l,t.opacity);if(t instanceof re||(t=_e(t)),!t)return new Re;if(t instanceof Re)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,l=s-i,a=(s+i)/2;return l?(o=e===s?(r-n)/l+6*(r<n):r===s?(n-e)/l+2:(e-r)/l+4,l/=a<.5?s+i:2-s-i,o*=60):l=a>0&&a<1?0:o,new Re(o,l,a,t.opacity)}function Ce(t,e,r,n){return 1===arguments.length?Be(t):new Re(t,e,r,null==n?1:n)}function Re(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function ze(t){return(t=(t||0)%360)<0?t+360:t}function Ie(t){return Math.max(0,Math.min(1,t||0))}function Pe(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)}te(re,_e,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:me,formatHex:me,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Be(this).formatHsl()},formatRgb:we,toString:we}),te(xe,ve,ee(re,{brighter(t){return t=null==t?ie:Math.pow(ie,t),new xe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ne:Math.pow(ne,t),new xe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new xe(Se(this.r),Se(this.g),Se(this.b),ke(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Me,formatHex:Me,formatHex8:function(){return`#${Ee(this.r)}${Ee(this.g)}${Ee(this.b)}${Ee(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Ae,toString:Ae})),te(Re,Ce,ee(re,{brighter(t){return t=null==t?ie:Math.pow(ie,t),new Re(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ne:Math.pow(ne,t),new Re(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new xe(Pe(t>=240?t-240:t+120,i,n),Pe(t,i,n),Pe(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Re(ze(this.h),Ie(this.s),Ie(this.l),ke(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ke(this.opacity);return`${1===t?"hsl(":"hsla("}${ze(this.h)}, ${100*Ie(this.s)}%, ${100*Ie(this.l)}%${1===t?")":`, ${t})`}`}}));var Oe=t=>()=>t;function je(t){return 1===(t=+t)?Te:function(e,r){return r-e?function(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}(e,r,t):Oe(isNaN(e)?r:e)}}function Te(t,e){var r=e-t;return r?function(t,e){return function(r){return t+r*e}}(t,r):Oe(isNaN(t)?e:t)}var $e=function t(e){var r=je(e);function n(t,e){var n=r((t=ve(t)).r,(e=ve(e)).r),i=r(t.g,e.g),s=r(t.b,e.b),o=Te(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=s(e),t.opacity=o(e),t+""}}return n.gamma=t,n}(1);function Fe(t,e){e||(e=[]);var r,n=t?Math.min(e.length,t.length):0,i=e.slice();return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function De(t,e){var r,n=e?e.length:0,i=t?Math.min(n,t.length):0,s=new Array(i),o=new Array(n);for(r=0;r<i;++r)s[r]=Ge(t[r],e[r]);for(;r<n;++r)o[r]=e[r];return function(t){for(r=0;r<i;++r)o[r]=s[r](t);return o}}function Ve(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Le(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function qe(t,e){var r,n={},i={};for(r in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)r in t?n[r]=Ge(t[r],e[r]):i[r]=e[r];return function(t){for(r in n)i[r]=n[r](t);return i}}var Ue=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,He=new RegExp(Ue.source,"g");function Ye(t,e){var r,n,i,s=Ue.lastIndex=He.lastIndex=0,o=-1,l=[],a=[];for(t+="",e+="";(r=Ue.exec(t))&&(n=He.exec(e));)(i=n.index)>s&&(i=e.slice(s,i),l[o]?l[o]+=i:l[++o]=i),(r=r[0])===(n=n[0])?l[o]?l[o]+=n:l[++o]=n:(l[++o]=null,a.push({i:o,x:Le(r,n)})),s=He.lastIndex;return s<e.length&&(i=e.slice(s),l[o]?l[o]+=i:l[++o]=i),l.length<2?a[0]?function(t){return function(e){return t(e)+""}}(a[0].x):function(t){return function(){return t}}(e):(e=a.length,function(t){for(var r,n=0;n<e;++n)l[(r=a[n]).i]=r.x(t);return l.join("")})}function Ge(t,e){var r,n,i=typeof e;return null==e||"boolean"===i?Oe(e):("number"===i?Le:"string"===i?(r=_e(e))?(e=r,$e):Ye:e instanceof _e?$e:e instanceof Date?Ve:(n=e,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(e)?De:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?qe:Le:Fe))(t,e)}function Xe(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}var We,Ke=180/Math.PI,Qe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Je(t,e,r,n,i,s){var o,l,a;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(a=t*r+e*n)&&(r-=t*a,n-=e*a),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,a/=l),t*n<e*r&&(t=-t,e=-e,a=-a,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*Ke,skewX:Math.atan(a)*Ke,scaleX:o,scaleY:l}}function Ze(t,e,r,n){function i(t){return t.length?t.pop()+" ":""}return function(s,o){var l=[],a=[];return s=t(s),o=t(o),function(t,n,i,s,o,l){if(t!==i||n!==s){var a=o.push("translate(",null,e,null,r);l.push({i:a-4,x:Le(t,i)},{i:a-2,x:Le(n,s)})}else(i||s)&&o.push("translate("+i+e+s+r)}(s.translateX,s.translateY,o.translateX,o.translateY,l,a),function(t,e,r,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:r.push(i(r)+"rotate(",null,n)-2,x:Le(t,e)})):e&&r.push(i(r)+"rotate("+e+n)}(s.rotate,o.rotate,l,a),function(t,e,r,s){t!==e?s.push({i:r.push(i(r)+"skewX(",null,n)-2,x:Le(t,e)}):e&&r.push(i(r)+"skewX("+e+n)}(s.skewX,o.skewX,l,a),function(t,e,r,n,s,o){if(t!==r||e!==n){var l=s.push(i(s)+"scale(",null,",",null,")");o.push({i:l-4,x:Le(t,r)},{i:l-2,x:Le(e,n)})}else 1===r&&1===n||s.push(i(s)+"scale("+r+","+n+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,l,a),s=o=null,function(t){for(var e,r=-1,n=a.length;++r<n;)l[(e=a[r]).i]=e.x(t);return l.join("")}}}var tr,er,rr=Ze(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Qe:Je(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),nr=Ze(function(t){return null==t?Qe:(We||(We=document.createElementNS("http://www.w3.org/2000/svg","g")),We.setAttribute("transform",t),(t=We.transform.baseVal.consolidate())?Je((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Qe)},", ",")",")"),ir=0,sr=0,or=0,lr=0,ar=0,fr=0,ur="object"==typeof performance&&performance.now?performance:Date,hr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function cr(){return ar||(hr(pr),ar=ur.now()+fr)}function pr(){ar=0}function dr(){this._call=this._time=this._next=null}function gr(t,e,r){var n=new dr;return n.restart(t,e,r),n}function mr(){cr(),++ir;for(var t,e=tr;e;)(t=ar-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ir}function wr(){ar=(lr=ur.now())+fr,ir=sr=0;try{mr()}finally{ir=0,function(){var t,e,r=tr,n=1/0;for(;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:tr=e);er=t,yr(n)}(),ar=0}}function _r(){var t=ur.now(),e=t-lr;e>1e3&&(fr-=e,lr=t)}function yr(t){ir||(sr&&(sr=clearTimeout(sr)),t-ar>24?(t<1/0&&(sr=setTimeout(wr,t-ur.now()-fr)),or&&(or=clearInterval(or))):(or||(lr=ur.now(),or=setInterval(_r,1e3)),ir=1,hr(wr)))}function br(t,e,r){var n=new dr;return e=null==e?0:+e,n.restart(r=>{n.stop(),t(r+e)},e,r),n}dr.prototype=gr.prototype={constructor:dr,restart:function(t,e,r){if("function"!=typeof t)throw new TypeError("callback is not a function");r=(null==r?cr():+r)+(null==e?0:+e),this._next||er===this||(er?er._next=this:tr=this,er=this),this._call=t,this._time=r,yr()},stop:function(){this._call&&(this._call=null,this._time=1/0,yr())}};var vr=O("start","end","cancel","interrupt"),xr=[];function Mr(t,e,r,n,i,s){var o=t.__transition;if(o){if(r in o)return}else t.__transition={};!function(t,e,r){var n,i=t.__transition;function s(t){r.state=1,r.timer.restart(o,r.delay,r.time),r.delay<=t&&o(t-r.delay)}function o(s){var f,u,h,c;if(1!==r.state)return a();for(f in i)if((c=i[f]).name===r.name){if(3===c.state)return br(o);4===c.state?(c.state=6,c.timer.stop(),c.on.call("interrupt",t,t.__data__,c.index,c.group),delete i[f]):+f<e&&(c.state=6,c.timer.stop(),c.on.call("cancel",t,t.__data__,c.index,c.group),delete i[f])}if(br(function(){3===r.state&&(r.state=4,r.timer.restart(l,r.delay,r.time),l(s))}),r.state=2,r.on.call("start",t,t.__data__,r.index,r.group),2===r.state){for(r.state=3,n=new Array(h=r.tween.length),f=0,u=-1;f<h;++f)(c=r.tween[f].value.call(t,t.__data__,r.index,r.group))&&(n[++u]=c);n.length=u+1}}function l(e){for(var i=e<r.duration?r.ease.call(null,e/r.duration):(r.timer.restart(a),r.state=5,1),s=-1,o=n.length;++s<o;)n[s].call(t,i);5===r.state&&(r.on.call("end",t,t.__data__,r.index,r.group),a())}function a(){for(var n in r.state=6,r.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=r,r.timer=gr(s,0,r.time)}(t,r,{name:e,index:n,group:i,on:vr,tween:xr,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:0})}function Ar(t,e){var r=Sr(t,e);if(r.state>0)throw new Error("too late; already scheduled");return r}function kr(t,e){var r=Sr(t,e);if(r.state>3)throw new Error("too late; already running");return r}function Sr(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function Er(t,e){var r,n,i,s=t.__transition,o=!0;if(s){for(i in e=null==e?null:e+"",s)(r=s[i]).name===e?(n=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(n?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete s[i]):o=!1;o&&delete t.__transition}}function Nr(t,e){var r,n;return function(){var i=kr(this,t),s=i.tween;if(s!==r)for(var o=0,l=(n=r=s).length;o<l;++o)if(n[o].name===e){(n=n.slice()).splice(o,1);break}i.tween=n}}function Br(t,e,r){var n,i;if("function"!=typeof r)throw new Error;return function(){var s=kr(this,t),o=s.tween;if(o!==n){i=(n=o).slice();for(var l={name:e,value:r},a=0,f=i.length;a<f;++a)if(i[a].name===e){i[a]=l;break}a===f&&i.push(l)}s.tween=i}}function Cr(t,e,r){var n=t._id;return t.each(function(){var t=kr(this,n);(t.value||(t.value={}))[e]=r.apply(this,arguments)}),function(t){return Sr(t,n).value[e]}}function Rr(t,e){var r;return("number"==typeof e?Le:e instanceof _e?$e:(r=_e(e))?(e=r,$e):Ye)(t,e)}function zr(t){return function(){this.removeAttribute(t)}}function Ir(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pr(t,e,r){var n,i,s=r+"";return function(){var o=this.getAttribute(t);return o===s?null:o===n?i:i=e(n=o,r)}}function Or(t,e,r){var n,i,s=r+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===n?i:i=e(n=o,r)}}function jr(t,e,r){var n,i,s;return function(){var o,l,a=r(this);if(null!=a)return(o=this.getAttribute(t))===(l=a+"")?null:o===n&&l===i?s:(i=l,s=e(n=o,a));this.removeAttribute(t)}}function Tr(t,e,r){var n,i,s;return function(){var o,l,a=r(this);if(null!=a)return(o=this.getAttributeNS(t.space,t.local))===(l=a+"")?null:o===n&&l===i?s:(i=l,s=e(n=o,a));this.removeAttributeNS(t.space,t.local)}}function $r(t,e){var r,n;function i(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&function(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}(t,i)),r}return i._value=e,i}function Fr(t,e){var r,n;function i(){var i=e.apply(this,arguments);return i!==n&&(r=(n=i)&&function(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}(t,i)),r}return i._value=e,i}function Dr(t,e){return function(){Ar(this,t).delay=+e.apply(this,arguments)}}function Vr(t,e){return e=+e,function(){Ar(this,t).delay=e}}function Lr(t,e){return function(){kr(this,t).duration=+e.apply(this,arguments)}}function qr(t,e){return e=+e,function(){kr(this,t).duration=e}}var Ur=Kt.prototype.constructor;function Hr(t){return function(){this.style.removeProperty(t)}}var Yr=0;function Gr(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function Xr(){return++Yr}var Wr=Kt.prototype;function Kr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Gr.prototype={constructor:Gr,select:function(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=Y(t));for(var n=this._groups,i=n.length,s=new Array(i),o=0;o<i;++o)for(var l,a,f=n[o],u=f.length,h=s[o]=new Array(u),c=0;c<u;++c)(l=f[c])&&(a=t.call(l,l.__data__,c,f))&&("__data__"in l&&(a.__data__=l.__data__),h[c]=a,Mr(h[c],e,r,c,h,Sr(l,r)));return new Gr(s,this._parents,e,r)},selectAll:function(t){var e=this._name,r=this._id;"function"!=typeof t&&(t=W(t));for(var n=this._groups,i=n.length,s=[],o=[],l=0;l<i;++l)for(var a,f=n[l],u=f.length,h=0;h<u;++h)if(a=f[h]){for(var c,p=t.call(a,a.__data__,h,f),d=Sr(a,r),g=0,m=p.length;g<m;++g)(c=p[g])&&Mr(c,e,r,g,p,d);s.push(p),o.push(a)}return new Gr(s,o,e,r)},selectChild:Wr.selectChild,selectChildren:Wr.selectChildren,filter:function(t){"function"!=typeof t&&(t=K(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var s,o=e[i],l=o.length,a=n[i]=[],f=0;f<l;++f)(s=o[f])&&t.call(s,s.__data__,f,o)&&a.push(s);return new Gr(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,i=r.length,s=Math.min(n,i),o=new Array(n),l=0;l<s;++l)for(var a,f=e[l],u=r[l],h=f.length,c=o[l]=new Array(h),p=0;p<h;++p)(a=f[p]||u[p])&&(c[p]=a);for(;l<n;++l)o[l]=e[l];return new Gr(o,this._parents,this._name,this._id)},selection:function(){return new Ur(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,r=Xr(),n=this._groups,i=n.length,s=0;s<i;++s)for(var o,l=n[s],a=l.length,f=0;f<a;++f)if(o=l[f]){var u=Sr(o,e);Mr(o,t,r,f,l,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Gr(n,this._parents,t,r)},call:Wr.call,nodes:Wr.nodes,node:Wr.node,size:Wr.size,empty:Wr.empty,each:Wr.each,on:function(t,e){var r=this._id;return arguments.length<2?Sr(this.node(),r).on.on(t):this.each(function(t,e,r){var n,i,s=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?Ar:kr;return function(){var o=s(this,t),l=o.on;l!==n&&(i=(n=l).copy()).on(e,r),o.on=i}}(r,t,e))},attr:function(t,e){var r=V(t),n="transform"===r?nr:Rr;return this.attrTween(t,"function"==typeof e?(r.local?Tr:jr)(r,n,Cr(this,"attr."+t,e)):null==e?(r.local?Ir:zr)(r):(r.local?Or:Pr)(r,n,e))},attrTween:function(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;var n=V(t);return this.tween(r,(n.local?$r:Fr)(n,e))},style:function(t,e,r){var n="transform"==(t+="")?rr:Rr;return null==e?this.styleTween(t,function(t,e){var r,n,i;return function(){var s=yt(this,t),o=(this.style.removeProperty(t),yt(this,t));return s===o?null:s===r&&o===n?i:i=e(r=s,n=o)}}(t,n)).on("end.style."+t,Hr(t)):"function"==typeof e?this.styleTween(t,function(t,e,r){var n,i,s;return function(){var o=yt(this,t),l=r(this),a=l+"";return null==l&&(this.style.removeProperty(t),a=l=yt(this,t)),o===a?null:o===n&&a===i?s:(i=a,s=e(n=o,l))}}(t,n,Cr(this,"style."+t,e))).each(function(t,e){var r,n,i,s,o="style."+e,l="end."+o;return function(){var a=kr(this,t),f=a.on,u=null==a.value[o]?s||(s=Hr(e)):void 0;f===r&&i===u||(n=(r=f).copy()).on(l,i=u),a.on=n}}(this._id,t)):this.styleTween(t,function(t,e,r){var n,i,s=r+"";return function(){var o=yt(this,t);return o===s?null:o===n?i:i=e(n=o,r)}}(t,n,e),r).on("end.style."+t,null)},styleTween:function(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,function(t,e,r){var n,i;function s(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&function(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}(t,s,r)),n}return s._value=e,s}(t,e,null==r?"":r))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Cr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,r;function n(){var n=t.apply(this,arguments);return n!==r&&(e=(r=n)&&function(t){return function(e){this.textContent=t.call(this,e)}}(n)),e}return n._value=t,n}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n,i=Sr(this.node(),r).tween,s=0,o=i.length;s<o;++s)if((n=i[s]).name===t)return n.value;return null}return this.each((null==e?Nr:Br)(r,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Dr:Vr)(e,t)):Sr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Lr:qr)(e,t)):Sr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){kr(this,t).ease=e}}(e,t)):Sr(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var r=e.apply(this,arguments);if("function"!=typeof r)throw new Error;kr(this,t).ease=r}}(this._id,t))},end:function(){var t,e,r=this,n=r._id,i=r.size();return new Promise(function(s,o){var l={value:o},a={value:function(){0===--i&&s()}};r.each(function(){var r=kr(this,n),i=r.on;i!==t&&((e=(t=i).copy())._.cancel.push(l),e._.interrupt.push(l),e._.end.push(a)),r.on=e}),0===i&&s()})},[Symbol.iterator]:Wr[Symbol.iterator]};var Qr={time:null,delay:0,duration:250,ease:Kr};function Jr(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Zr(t,e){if(!isFinite(t)||0===t)return null;var r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"),n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function tn(t){return(t=Zr(Math.abs(t)))?t[1]:NaN}Kt.prototype.interrupt=function(t){return this.each(function(){Er(this,t)})},Kt.prototype.transition=function(t){var e,r;t instanceof Gr?(e=t._id,t=t._name):(e=Xr(),(r=Qr).time=cr(),t=null==t?null:t+"");for(var n=this._groups,i=n.length,s=0;s<i;++s)for(var o,l=n[s],a=l.length,f=0;f<a;++f)(o=l[f])&&Mr(o,t,e,f,l,r||Jr(o,e));return new Gr(n,this._parents,t,e)};var en,rn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function nn(t){if(!(e=rn.exec(t)))throw new Error("invalid format: "+t);var e;return new sn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function sn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function on(t,e){var r=Zr(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}nn.prototype=sn.prototype,sn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ln={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>on(100*t,e),r:on,s:function(t,e){var r=Zr(t,e);if(!r)return en=void 0,t.toPrecision(e);var n=r[0],i=r[1],s=i-(en=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Zr(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function an(t){return t}var fn,un,hn,cn=Array.prototype.map,pn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function dn(t){var e,r,n=void 0===t.grouping||void 0===t.thousands?an:(e=cn.call(t.grouping,Number),r=t.thousands+"",function(t,n){for(var i=t.length,s=[],o=0,l=e[0],a=0;i>0&&l>0&&(a+l+1>n&&(l=Math.max(1,n-a)),s.push(t.substring(i-=l,i+l)),!((a+=l+1)>n));)l=e[o=(o+1)%e.length];return s.reverse().join(r)}),i=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",l=void 0===t.numerals?an:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(cn.call(t.numerals,String)),a=void 0===t.percent?"%":t.percent+"",f=void 0===t.minus?"":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t,e){var r=(t=nn(t)).fill,h=t.align,c=t.sign,p=t.symbol,d=t.zero,g=t.width,m=t.comma,w=t.precision,_=t.trim,y=t.type;"n"===y?(m=!0,y="g"):ln[y]||(void 0===w&&(w=12),_=!0,y="g"),(d||"0"===r&&"="===h)&&(d=!0,r="0",h="=");var b=(e&&void 0!==e.prefix?e.prefix:"")+("$"===p?i:"#"===p&&/[boxX]/.test(y)?"0"+y.toLowerCase():""),v=("$"===p?s:/[%p]/.test(y)?a:"")+(e&&void 0!==e.suffix?e.suffix:""),x=ln[y],M=/[defgprs%]/.test(y);function A(t){var e,i,s,a=b,p=v;if("c"===y)p=x(t)+p,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:x(Math.abs(t),w),_&&(t=function(t){t:for(var e,r=t.length,n=1,i=-1;n<r;++n)switch(t[n]){case".":i=e=n;break;case"0":0===i&&(i=n),e=n;break;default:if(!+t[n])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&"+"!==c&&(A=!1),a=(A?"("===c?c:f:"-"===c||"("===c?"":c)+a,p=("s"!==y||isNaN(t)||void 0===en?"":pn[8+en/3])+p+(A&&"("===c?")":""),M)for(e=-1,i=t.length;++e<i;)if(48>(s=t.charCodeAt(e))||s>57){p=(46===s?o+t.slice(e+1):t.slice(e))+p,t=t.slice(0,e);break}}m&&!d&&(t=n(t,1/0));var k=a.length+t.length+p.length,S=k<g?new Array(g-k+1).join(r):"";switch(m&&d&&(t=n(S+t,S.length?g-p.length:1/0),S=""),h){case"<":t=a+t+p+S;break;case"=":t=a+S+t+p;break;case"^":t=S.slice(0,k=S.length>>1)+a+t+p+S.slice(k);break;default:t=S+a+t+p}return l(t)}return w=void 0===w?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w)),A.toString=function(){return t+""},A}return{format:h,formatPrefix:function(t,e){var r=3*Math.max(-8,Math.min(8,Math.floor(tn(e)/3))),n=Math.pow(10,-r),i=h(((t=nn(t)).type="f",t),{suffix:pn[8+r/3]});return function(t){return i(n*t)}}}}function gn(t){return Math.max(0,-tn(Math.abs(t)))}function mn(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(tn(e)/3)))-tn(Math.abs(t)))}function wn(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,tn(e)-tn(t))+1}function _n(t,e){return t.parent===e.parent?1:2}function yn(t,e){return t+e.x}function bn(t,e){return Math.max(t,e.y)}function vn(){var t=_n,e=1,r=1,n=!1;function i(i){var s,o=0;i.eachAfter(function(e){var r=e.children;r?(e.x=function(t){return t.reduce(yn,0)/t.length}(r),e.y=function(t){return 1+t.reduce(bn,0)}(r)):(e.x=s?o+=t(e,s):0,e.y=0,s=e)});var l=function(t){for(var e;e=t.children;)t=e[0];return t}(i),a=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),f=l.x-t(l,a)/2,u=a.x+t(a,l)/2;return i.eachAfter(n?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*r}:function(t){t.x=(t.x-f)/(u-f)*e,t.y=(1-(i.y?t.y/i.y:1))*r})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(n=!1,e=+t[0],r=+t[1],i):n?null:[e,r]},i.nodeSize=function(t){return arguments.length?(n=!0,e=+t[0],r=+t[1],i):n?[e,r]:null},i}function xn(t){var e=0,r=t.children,n=r&&r.length;if(n)for(;--n>=0;)e+=r[n].value;else e=1;t.value=e}function Mn(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=kn)):void 0===e&&(e=An);for(var r,n,i,s,o,l=new Nn(t),a=[l];r=a.pop();)if((i=e(r.data))&&(o=(i=Array.from(i)).length))for(r.children=i,s=o-1;s>=0;--s)a.push(n=i[s]=new Nn(i[s])),n.parent=r,n.depth=r.depth+1;return l.eachBefore(En)}function An(t){return t.children}function kn(t){return Array.isArray(t)?t[1]:null}function Sn(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function En(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Nn(t){this.data=t,this.depth=this.height=0,this.parent=null}function Bn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}fn=dn({thousands:",",grouping:[3],currency:["$",""]}),un=fn.format,hn=fn.formatPrefix,Nn.prototype=Mn.prototype={constructor:Nn,count:function(){return this.eachAfter(xn)},each:function(t,e){let r=-1;for(const n of this)t.call(e,n,++r,this);return this},eachAfter:function(t,e){for(var r,n,i,s=this,o=[s],l=[],a=-1;s=o.pop();)if(l.push(s),r=s.children)for(n=0,i=r.length;n<i;++n)o.push(r[n]);for(;s=l.pop();)t.call(e,s,++a,this);return this},eachBefore:function(t,e){for(var r,n,i=this,s=[i],o=-1;i=s.pop();)if(t.call(e,i,++o,this),r=i.children)for(n=r.length-1;n>=0;--n)s.push(r[n]);return this},find:function(t,e){let r=-1;for(const n of this)if(t.call(e,n,++r,this))return n},sum:function(t){return this.eachAfter(function(e){for(var r=+t(e.data)||0,n=e.children,i=n&&n.length;--i>=0;)r+=n[i].value;e.value=r})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,r=function(t,e){if(t===e)return t;var r=t.ancestors(),n=e.ancestors(),i=null;t=r.pop(),e=n.pop();for(;t===e;)i=t,t=r.pop(),e=n.pop();return i}(e,t),n=[e];e!==r;)e=e.parent,n.push(e);for(var i=n.length;t!==r;)n.splice(i,0,t),t=t.parent;return n},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(r){r!==t&&e.push({source:r.parent,target:r})}),e},copy:function(){return Mn(this).eachBefore(Sn)},[Symbol.iterator]:function*(){var t,e,r,n,i=this,s=[i];do{for(t=s.reverse(),s=[];i=t.pop();)if(yield i,e=i.children)for(r=0,n=e.length;r<n;++r)s.push(e[r])}while(s.length)}};const Cn=Symbol("implicit");function Rn(){var t=new f,e=[],r=[],n=Cn;function i(i){let s=t.get(i);if(void 0===s){if(n!==Cn)return n;t.set(i,s=e.push(i)-1)}return r[s%r.length]}return i.domain=function(r){if(!arguments.length)return e.slice();e=[],t=new f;for(const n of r)t.has(n)||t.set(n,e.push(n)-1);return i},i.range=function(t){return arguments.length?(r=Array.from(t),i):r.slice()},i.unknown=function(t){return arguments.length?(n=t,i):n},i.copy=function(){return Rn(e,r).unknown(n)},Bn.apply(i,arguments),i}function zn(){var t,e,r=Rn().unknown(void 0),n=r.domain,i=r.range,s=0,o=1,l=!1,a=0,f=0,u=.5;function h(){var r=n().length,h=o<s,c=h?o:s,p=h?s:o;t=(p-c)/Math.max(1,r-a+2*f),l&&(t=Math.floor(t)),c+=(p-c-t*(r-a))*u,e=t*(1-a),l&&(c=Math.round(c),e=Math.round(e));var d=x(r).map(function(e){return c+t*e});return i(h?d.reverse():d)}return delete r.unknown,r.domain=function(t){return arguments.length?(n(t),h()):n()},r.range=function(t){return arguments.length?([s,o]=t,s=+s,o=+o,h()):[s,o]},r.rangeRound=function(t){return[s,o]=t,s=+s,o=+o,l=!0,h()},r.bandwidth=function(){return e},r.step=function(){return t},r.round=function(t){return arguments.length?(l=!!t,h()):l},r.padding=function(t){return arguments.length?(a=Math.min(1,f=+t),h()):a},r.paddingInner=function(t){return arguments.length?(a=Math.min(1,t),h()):a},r.paddingOuter=function(t){return arguments.length?(f=+t,h()):f},r.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),h()):u},r.copy=function(){return zn(n(),[s,o]).round(l).paddingInner(a).paddingOuter(f).align(u)},Bn.apply(h(),arguments)}function In(t){return+t}var Pn=[0,1];function On(t){return t}function jn(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:(r=isNaN(e)?NaN:.5,function(){return r});var r}function Tn(t,e,r){var n=t[0],i=t[1],s=e[0],o=e[1];return i<n?(n=jn(i,n),s=r(o,s)):(n=jn(n,i),s=r(s,o)),function(t){return s(n(t))}}function $n(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),s=new Array(n),l=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<n;)i[l]=jn(t[l],t[l+1]),s[l]=r(e[l],e[l+1]);return function(e){var r=o(t,e,1,n)-1;return s[r](i[r](e))}}function Fn(){var t,e,r,n,i,s,o=Pn,l=Pn,a=Ge,f=On;function u(){var t,e,r,a=Math.min(o.length,l.length);return f!==On&&(t=o[0],e=o[a-1],t>e&&(r=t,t=e,e=r),f=function(r){return Math.max(t,Math.min(e,r))}),n=a>2?$n:Tn,i=s=null,h}function h(e){return null==e||isNaN(e=+e)?r:(i||(i=n(o.map(t),l,a)))(t(f(e)))}return h.invert=function(r){return f(e((s||(s=n(l,o.map(t),Le)))(r)))},h.domain=function(t){return arguments.length?(o=Array.from(t,In),u()):o.slice()},h.range=function(t){return arguments.length?(l=Array.from(t),u()):l.slice()},h.rangeRound=function(t){return l=Array.from(t),a=Xe,u()},h.clamp=function(t){return arguments.length?(f=!!t||On,u()):f!==On},h.interpolate=function(t){return arguments.length?(a=t,u()):a},h.unknown=function(t){return arguments.length?(r=t,h):r},function(r,n){return t=r,e=n,u()}}function Dn(t,e,r,n){var i,s=_(t,e,r);switch((n=nn(null==n?",f":n)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(i=mn(s,o))||(n.precision=i),hn(n,o);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=wn(s,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=gn(s))||(n.precision=i-2*("%"===n.type))}return un(n)}function Vn(){var t=Fn()(On,On);return t.copy=function(){return e=t,Vn().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},Bn.apply(t,arguments),function(t){var e=t.domain;return t.ticks=function(t){var r=e();return m(r[0],r[r.length-1],null==t?10:t)},t.tickFormat=function(t,r){var n=e();return Dn(n[0],n[n.length-1],null==t?10:t,r)},t.nice=function(r){null==r&&(r=10);var n,i,s=e(),o=0,l=s.length-1,a=s[o],f=s[l],u=10;for(f<a&&(i=a,a=f,f=i,i=o,o=l,l=i);u-- >0;){if((i=w(a,f,r))===n)return s[o]=a,s[l]=f,e(s);if(i>0)a=Math.floor(a/i)*i,f=Math.ceil(f/i)*i;else{if(!(i<0))break;a=Math.ceil(a*i)/i,f=Math.floor(f*i)/i}n=i}return t},t}(t)}function Ln(t,e,r){this.k=t,this.x=e,this.y=r}Ln.prototype={constructor:Ln,scale:function(t){return 1===t?this:new Ln(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Ln(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Ln.prototype;var qn=Object.freeze({__proto__:null,FormatSpecifier:sn,InternMap:f,Node:Nn,ZoomTransform:Ln,ascending:r,axisBottom:z,axisLeft:I,axisRight:R,bisect:o,bisectRight:o,bisector:i,cluster:vn,color:_e,create:Jt,creator:U,descending:n,deviation:function(t,e){const r=l(t,e);return r?Math.sqrt(r):r},dispatch:O,easeCubic:Kr,easeCubicInOut:Kr,extent:a,get format(){return un},formatLocale:dn,get formatPrefix(){return hn},formatSpecifier:nn,hierarchy:Mn,hsl:Ce,interpolate:Ge,interpolateDate:Ve,interpolateNumber:Le,interpolateNumberArray:Fe,interpolateObject:qe,interpolateRgb:$e,interpolateRound:Xe,interpolateString:Ye,interpolateTransformCss:rr,interpolateTransformSvg:nr,interrupt:Er,matcher:K,max:y,mean:v,min:b,namespace:V,namespaces:D,now:cr,precisionFixed:gn,precisionPrefix:mn,precisionRound:wn,range:x,rgb:ve,scaleBand:zn,scaleImplicit:Cn,scaleLinear:Vn,scaleOrdinal:Rn,select:Qt,selectAll:Zt,selection:Kt,selector:Y,selectorAll:W,style:yt,tickFormat:Dn,tickIncrement:w,tickStep:_,ticks:m,timeout:br,timer:gr,timerFlush:mr,variance:l,window:gt}),Un="$";function Hn(){}function Yn(t,e){var r=new Hn;if(t instanceof Hn)t.each(function(t,e){r.set(e,t)});else if(Array.isArray(t)){var n,i=-1,s=t.length;if(null==e)for(;++i<s;)r.set(i,t[i]);else for(;++i<s;)r.set(e(n=t[i],i,t),n)}else if(t)for(var o in t)r.set(o,t[o]);return r}function Gn(){}Hn.prototype=Yn.prototype={constructor:Hn,has:function(t){return Un+t in this},get:function(t){return this[Un+t]},set:function(t,e){return this[Un+t]=e,this},remove:function(t){var e=Un+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Un&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Un&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Un&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Un&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Un&&++t;return t},empty:function(){for(var t in this)if(t[0]===Un)return!1;return!0},each:function(t){for(var e in this)e[0]===Un&&t(this[e],e.slice(1),this)}};var Xn=Yn.prototype;Gn.prototype={constructor:Gn,has:Xn.has,add:function(t){return this[Un+(t+="")]=t,this},remove:Xn.remove,clear:Xn.clear,values:Xn.keys,size:Xn.size,empty:Xn.empty,each:Xn.each};var Wn="http://www.w3.org/1999/xhtml",Kn={svg:"http://www.w3.org/2000/svg",xhtml:Wn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qn(t){var e=t+="",r=e.indexOf(":");return r>=0&&"xmlns"!==(e=t.slice(0,r))&&(t=t.slice(r+1)),Kn.hasOwnProperty(e)?{space:Kn[e],local:t}:t}function Jn(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===Wn&&e.documentElement.namespaceURI===Wn?e.createElement(t):e.createElementNS(r,t)}}function Zn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ti(t){var e=Qn(t);return(e.local?Zn:Jn)(e)}function ei(){}function ri(t){return null==t?ei:function(){return this.querySelector(t)}}function ni(){return[]}function ii(t){return new Array(t.length)}function si(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}si.prototype={constructor:si,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function oi(t,e,r,n,i,s){for(var o,l=0,a=e.length,f=s.length;l<f;++l)(o=e[l])?(o.__data__=s[l],n[l]=o):r[l]=new si(t,s[l]);for(;l<a;++l)(o=e[l])&&(i[l]=o)}function li(t,e,r,n,i,s,o){var l,a,f,u={},h=e.length,c=s.length,p=new Array(h);for(l=0;l<h;++l)(a=e[l])&&(p[l]=f="$"+o.call(a,a.__data__,l,e),f in u?i[l]=a:u[f]=a);for(l=0;l<c;++l)(a=u[f="$"+o.call(t,s[l],l,s)])?(n[l]=a,a.__data__=s[l],u[f]=null):r[l]=new si(t,s[l]);for(l=0;l<h;++l)(a=e[l])&&u[p[l]]===a&&(i[l]=a)}function ai(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function fi(t){return function(){this.removeAttribute(t)}}function ui(t){return function(){this.removeAttributeNS(t.space,t.local)}}function hi(t,e){return function(){this.setAttribute(t,e)}}function ci(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function pi(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}}function di(t,e){return function(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function gi(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mi(t){return function(){this.style.removeProperty(t)}}function wi(t,e,r){return function(){this.style.setProperty(t,e,r)}}function _i(t,e,r){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function yi(t){return function(){delete this[t]}}function bi(t,e){return function(){this[t]=e}}function vi(t,e){return function(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}}function xi(t){return t.trim().split(/^|\s+/)}function Mi(t){return t.classList||new Ai(t)}function Ai(t){this._node=t,this._names=xi(t.getAttribute("class")||"")}function ki(t,e){for(var r=Mi(t),n=-1,i=e.length;++n<i;)r.add(e[n])}function Si(t,e){for(var r=Mi(t),n=-1,i=e.length;++n<i;)r.remove(e[n])}function Ei(t){return function(){ki(this,t)}}function Ni(t){return function(){Si(this,t)}}function Bi(t,e){return function(){(e.apply(this,arguments)?ki:Si)(this,t)}}function Ci(){this.textContent=""}function Ri(t){return function(){this.textContent=t}}function zi(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ii(){this.innerHTML=""}function Pi(t){return function(){this.innerHTML=t}}function Oi(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ji(){this.nextSibling&&this.parentNode.appendChild(this)}function Ti(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $i(){return null}function Fi(){var t=this.parentNode;t&&t.removeChild(this)}function Di(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Vi(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}Ai.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Li={};"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Li={mouseenter:"mouseover",mouseleave:"mouseout"}));function qi(t,e,r){return t=Ui(t,e,r),function(e){var r=e.relatedTarget;r&&(r===this||8&r.compareDocumentPosition(this))||t.call(this,e)}}function Ui(t,e,r){return function(n){try{t.call(this,this.__data__,e,r)}finally{}}}function Hi(t){return function(){var e=this.__on;if(e){for(var r,n=0,i=-1,s=e.length;n<s;++n)r=e[n],t.type&&r.type!==t.type||r.name!==t.name?e[++i]=r:this.removeEventListener(r.type,r.listener,r.capture);++i?e.length=i:delete this.__on}}}function Yi(t,e,r){var n=Li.hasOwnProperty(t.type)?qi:Ui;return function(i,s,o){var l,a=this.__on,f=n(e,s,o);if(a)for(var u=0,h=a.length;u<h;++u)if((l=a[u]).type===t.type&&l.name===t.name)return this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=f,l.capture=r),void(l.value=e);this.addEventListener(t.type,f,r),l={type:t.type,name:t.name,value:e,listener:f,capture:r},a?a.push(l):this.__on=[l]}}function Gi(t,e,r){var n=gi(t),i=n.CustomEvent;"function"==typeof i?i=new i(e,r):(i=n.document.createEvent("Event"),r?(i.initEvent(e,r.bubbles,r.cancelable),i.detail=r.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Xi(t,e){return function(){return Gi(this,t,e)}}function Wi(t,e){return function(){return Gi(this,t,e.apply(this,arguments))}}var Ki=[null];function Qi(t,e){this._groups=t,this._parents=e}function Ji(){return new Qi([[document.documentElement]],Ki)}function Zi(t){return"string"==typeof t?new Qi([[document.querySelector(t)]],[document.documentElement]):new Qi([[t]],Ki)}function ts(){var t=function(){return"n"},e=function(){return[0,0]},r=function(){return" "},n=document.body,i=h(),s=null,o=null,l=null;function a(t){s=function(t){var e=t.node();return e?"svg"===e.tagName.toLowerCase()?e:e.ownerSVGElement:null}(t),s&&(o=s.createSVGPoint(),n.appendChild(i))}a.show=function(){var i=Array.prototype.slice.call(arguments);i[i.length-1]instanceof SVGElement&&(l=i.pop());var s,o=r.apply(this,i),h=e.apply(this,i),p=t.apply(this,i),d=c(),g=u.length,m=document.documentElement.scrollTop||n.scrollTop,w=document.documentElement.scrollLeft||n.scrollLeft;for(d.html(o).style("opacity",1).style("pointer-events","all");g--;)d.classed(u[g],!1);return s=f.get(p).apply(this),d.classed(p,!0).style("top",s.top+h[0]+m+"px").style("left",s.left+h[1]+w+"px"),a},a.hide=function(){return c().style("opacity",0).style("pointer-events","none"),a},a.attr=function(t,e){if(arguments.length<2&&"string"==typeof t)return c().attr(t);var r=Array.prototype.slice.call(arguments);return Ji.prototype.attr.apply(c(),r),a},a.style=function(t,e){if(arguments.length<2&&"string"==typeof t)return c().style(t);var r=Array.prototype.slice.call(arguments);return Ji.prototype.style.apply(c(),r),a},a.direction=function(e){return arguments.length?(t=null==e?e:d(e),a):t},a.offset=function(t){return arguments.length?(e=null==t?t:d(t),a):e},a.html=function(t){return arguments.length?(r=null==t?t:d(t),a):r},a.rootElement=function(t){return arguments.length?(n=null==t?t:d(t),a):n},a.destroy=function(){return i&&(c().remove(),i=null),a};var f=Yn({n:function(){var t=p(this);return{top:t.n.y-i.offsetHeight,left:t.n.x-i.offsetWidth/2}},s:function(){var t=p(this);return{top:t.s.y,left:t.s.x-i.offsetWidth/2}},e:function(){var t=p(this);return{top:t.e.y-i.offsetHeight/2,left:t.e.x}},w:function(){var t=p(this);return{top:t.w.y-i.offsetHeight/2,left:t.w.x-i.offsetWidth}},nw:function(){var t=p(this);return{top:t.nw.y-i.offsetHeight,left:t.nw.x-i.offsetWidth}},ne:function(){var t=p(this);return{top:t.ne.y-i.offsetHeight,left:t.ne.x}},sw:function(){var t=p(this);return{top:t.sw.y,left:t.sw.x-i.offsetWidth}},se:function(){var t=p(this);return{top:t.se.y,left:t.se.x}}}),u=f.keys();function h(){var t=Zi(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function c(){return null==i&&(i=h(),n.appendChild(i)),Zi(i)}function p(t){for(var e=l||t;null==e.getScreenCTM&&null!=e.parentNode;)e=e.parentNode;var r={},n=e.getScreenCTM(),i=e.getBBox(),s=i.width,a=i.height,f=i.x,u=i.y;return o.x=f,o.y=u,r.nw=o.matrixTransform(n),o.x+=s,r.ne=o.matrixTransform(n),o.y+=a,r.se=o.matrixTransform(n),o.x-=s,r.sw=o.matrixTransform(n),o.y-=a/2,r.w=o.matrixTransform(n),o.x+=s,r.e=o.matrixTransform(n),o.x-=s/2,o.y-=a/2,r.n=o.matrixTransform(n),o.y+=a,r.s=o.matrixTransform(n),r}function d(t){return"function"==typeof t?t:function(){return t}}return a}function es(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n]);return r}function rs(t,e){return Math.sqrt(es(t,e))}function ns(t,e){const r=function(t){const e=[];for(let r=0;r<t;r++){const r=[];e.push(r);for(let e=0;e<t;e++)r.push(0)}return e}(t.length);for(let n=0;n<t.length;n++)for(let i=0;i<=n;i++)r[n][i]=e(t[n],t[i]),r[i][n]=r[n][i];return r}function is(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ss(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if("function"==typeof e){var r=function t(){var r=!1;try{r=this instanceof t}catch{}return r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})}),r}Qi.prototype=Ji.prototype={constructor:Qi,select:function(t){"function"!=typeof t&&(t=ri(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var s,o,l=e[i],a=l.length,f=n[i]=new Array(a),u=0;u<a;++u)(s=l[u])&&(o=t.call(s,s.__data__,u,l))&&("__data__"in s&&(o.__data__=s.__data__),f[u]=o);return new Qi(n,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?ni:function(){return this.querySelectorAll(t)}}(t));for(var e=this._groups,r=e.length,n=[],i=[],s=0;s<r;++s)for(var o,l=e[s],a=l.length,f=0;f<a;++f)(o=l[f])&&(n.push(t.call(o,o.__data__,f,l)),i.push(o));return new Qi(n,i)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var e=this._groups,r=e.length,n=new Array(r),i=0;i<r;++i)for(var s,o=e[i],l=o.length,a=n[i]=[],f=0;f<l;++f)(s=o[f])&&t.call(s,s.__data__,f,o)&&a.push(s);return new Qi(n,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),u=-1,this.each(function(t){d[++u]=t}),d;var r,n=e?li:oi,i=this._parents,s=this._groups;"function"!=typeof t&&(r=t,t=function(){return r});for(var o=s.length,l=new Array(o),a=new Array(o),f=new Array(o),u=0;u<o;++u){var h=i[u],c=s[u],p=c.length,d=t.call(h,h&&h.__data__,u,i),g=d.length,m=a[u]=new Array(g),w=l[u]=new Array(g);n(h,c,m,w,f[u]=new Array(p),d,e);for(var _,y,b=0,v=0;b<g;++b)if(_=m[b]){for(b>=v&&(v=b+1);!(y=w[v])&&++v<g;);_._next=y||null}}return(l=new Qi(l,i))._enter=a,l._exit=f,l},enter:function(){return new Qi(this._enter||this._groups.map(ii),this._parents)},exit:function(){return new Qi(this._exit||this._groups.map(ii),this._parents)},join:function(t,e,r){var n=this.enter(),i=this,s=this.exit();return n="function"==typeof t?t(n):n.append(t+""),null!=e&&(i=e(i)),null==r?s.remove():r(s),n&&i?n.merge(i).order():i},merge:function(t){for(var e=this._groups,r=t._groups,n=e.length,i=r.length,s=Math.min(n,i),o=new Array(n),l=0;l<s;++l)for(var a,f=e[l],u=r[l],h=f.length,c=o[l]=new Array(h),p=0;p<h;++p)(a=f[p]||u[p])&&(c[p]=a);for(;l<n;++l)o[l]=e[l];return new Qi(o,this._parents)},order:function(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n,i=t[e],s=i.length-1,o=i[s];--s>=0;)(n=i[s])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(t){function e(e,r){return e&&r?t(e.__data__,r.__data__):!e-!r}t||(t=ai);for(var r=this._groups,n=r.length,i=new Array(n),s=0;s<n;++s){for(var o,l=r[s],a=l.length,f=i[s]=new Array(a),u=0;u<a;++u)(o=l[u])&&(f[u]=o);f.sort(e)}return new Qi(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],i=0,s=n.length;i<s;++i){var o=n[i];if(o)return o}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var i,s=e[r],o=0,l=s.length;o<l;++o)(i=s[o])&&t.call(i,i.__data__,o,s);return this},attr:function(t,e){var r=Qn(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((null==e?r.local?ui:fi:"function"==typeof e?r.local?di:pi:r.local?ci:hi)(r,e))},style:function(t,e,r){return arguments.length>1?this.each((null==e?mi:"function"==typeof e?_i:wi)(t,e,null==r?"":r)):function(t,e){return t.style.getPropertyValue(e)||gi(t).getComputedStyle(t,null).getPropertyValue(e)}(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?yi:"function"==typeof e?vi:bi)(t,e)):this.node()[t]},classed:function(t,e){var r=xi(t+"");if(arguments.length<2){for(var n=Mi(this.node()),i=-1,s=r.length;++i<s;)if(!n.contains(r[i]))return!1;return!0}return this.each(("function"==typeof e?Bi:e?Ei:Ni)(r,e))},text:function(t){return arguments.length?this.each(null==t?Ci:("function"==typeof t?zi:Ri)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Ii:("function"==typeof t?Oi:Pi)(t)):this.node().innerHTML},raise:function(){return this.each(ji)},lower:function(){return this.each(Ti)},append:function(t){var e="function"==typeof t?t:ti(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var r="function"==typeof t?t:ti(t),n=null==e?$i:"function"==typeof e?e:ri(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function(){return this.each(Fi)},clone:function(t){return this.select(t?Vi:Di)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,r){var n,i,s=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");return r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),{type:t,name:e}})}(t+""),o=s.length;if(!(arguments.length<2)){for(l=e?Yi:Hi,null==r&&(r=!1),n=0;n<o;++n)this.each(l(s[n],e,r));return this}var l=this.node().__on;if(l)for(var a,f=0,u=l.length;f<u;++f)for(n=0,a=l[f];n<o;++n)if((i=s[n]).type===a.type&&i.name===a.name)return a.value},dispatch:function(t,e){return this.each(("function"==typeof e?Wi:Xi)(t,e))}};var os={};const ls=Object.prototype.toString;function as(t){const e=ls.call(t);return e.endsWith("Array]")&&!e.includes("Big")}var fs=ss(Object.freeze({__proto__:null,isAnyArray:as}));var us,hs=ss(Object.freeze({__proto__:null,default:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!as(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!as(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!as(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,s=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],l=n+1;l<s;l++)t[l]<o&&(o=t[l]);return o}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!as(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,s=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],l=n+1;l<s;l++)t[l]>o&&(o=t[l]);return o}(t);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=r.min,o=void 0===s?r.autoMinMax?n:0:s,l=r.max,a=void 0===l?r.autoMinMax?i:1:l;if(o>=a)throw new RangeError("min option must be smaller than max option");for(var f=(a-o)/(i-n),u=0;u<t.length;u++)e[u]=(t[u]-n)*f+o;return e}}));function cs(){if(us)return os;us=1,Object.defineProperty(os,"__esModule",{value:!0});var t=fs,e=hs;const r=" ".repeat(2),n=" ".repeat(4);function i(t,e={}){const{maxRows:i=15,maxColumns:o=10,maxNumSize:l=8,padMinus:a="auto"}=e;return`${t.constructor.name} {\n${r}[\n${n}${function(t,e,r,i,o){const{rows:l,columns:a}=t,f=Math.min(l,e),u=Math.min(a,r),h=[];if("auto"===o){o=!1;t:for(let e=0;e<f;e++)for(let r=0;r<u;r++)if(t.get(e,r)<0){o=!0;break t}}for(let e=0;e<f;e++){let r=[];for(let n=0;n<u;n++)r.push(s(t.get(e,n),i,o));h.push(`${r.join(" ")}`)}u!==a&&(h[h.length-1]+=` ... ${a-r} more columns`);f!==l&&h.push(`... ${l-e} more rows`);return h.join(`\n${n}`)}(t,i,o,l,a)}\n${r}]\n${r}rows: ${t.rows}\n${r}columns: ${t.columns}\n}`}function s(t,e,r){return(t>=0&&r?` ${o(t,e-1)}`:o(t,e)).padEnd(e)}function o(t,e){let r=t.toString();if(r.length<=e)return r;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function l(t,e,r){let n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function a(t,e,r){let n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function u(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function h(e,r){if(!t.isAnyArray(r))throw new TypeError("row indices must be an array");for(let t=0;t<r.length;t++)if(r[t]<0||r[t]>=e.rows)throw new RangeError("row indices are out of range")}function c(e,r){if(!t.isAnyArray(r))throw new TypeError("column indices must be an array");for(let t=0;t<r.length;t++)if(r[t]<0||r[t]>=e.columns)throw new RangeError("column indices are out of range")}function p(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(g("startRow",e),g("endRow",r),g("startColumn",n),g("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function d(t,e=0){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function g(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function m(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class w{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let n=new b(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r[i*e+t]);return n}static rowVector(t){let e=new b(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new b(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new b(t,e)}static ones(t,e){return new b(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{random:n=Math.random}=r;let i=new b(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw new TypeError("options must be an object");const{min:n=0,max:i=1e3,random:s=Math.random}=r;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(n>=i)throw new RangeError("min must be smaller than max");let o=i-n,l=new b(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=n+Math.round(s()*o);l.set(r,t,e)}return l}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let n=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<n;t++)i.set(t,t,r);return i}static diag(t,e,r){let n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);let i=Math.min(n,e,r),s=this.zeros(e,r);for(let e=0;e<i;e++)s.set(e,e,t[e]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new b(r,n);for(let s=0;s<r;s++)for(let r=0;r<n;r++)i.set(s,r,Math.min(t.get(s,r),e.get(s,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,n=t.columns,i=new this(r,n);for(let s=0;s<r;s++)for(let r=0;r<n;r++)i.set(s,r,Math.max(t.get(s,r),e.get(s,r)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new b(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let n=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(n,r)&&(n=i);if(0===t.get(n,r))r++;else{t.swapRows(e,n);let i=t.get(e,r);for(let n=r;n<t.columns;n++)t.set(e,n,t.get(e,n)/i);for(let n=e+1;n<t.rows;n++){let i=t.get(n,r)/t.get(e,r);t.set(n,r,0);for(let s=r+1;s<t.columns;s++)t.set(n,s,t.get(n,s)-t.get(e,s)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,n=r-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let i=0,s=!1;for(;i<r&&!1===s;)1===t.get(n,i)?s=!0:i++;for(let r=0;r<n;r++){let s=t.get(r,i);for(let o=i;o<e;o++){let e=t.get(r,o)-s*t.get(n,o);t.set(r,o,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let n=new b(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){l(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return b.rowVector(this.getRow(t))}setRow(t,e){l(this,t),e=f(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){l(this,t),l(this,e);for(let r=0;r<this.columns;r++){let n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){a(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return b.columnVector(this.getColumn(t))}setColumn(t,e){a(this,t),e=u(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){a(this,t),a(this,e);for(let r=0;r<this.rows;r++){let n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=u(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){l(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){a(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){m(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){m(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){l(this,t),m(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){if(l(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){l(this,t),m(this);let e=this.get(t,0),r=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){if(a(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){a(this,t),m(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){if(a(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){a(this,t),m(this);let e=this.get(0,t),r=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let n=0;n<e.length;n++)r+=e[n]*t[n];return r}mmul(t){t=b.checkMatrix(t);let e=this.rows,r=this.columns,n=t.columns,i=new b(e,n),s=new Float64Array(r);for(let o=0;o<n;o++){for(let e=0;e<r;e++)s[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let n=0;n<r;n++)e+=this.get(t,n)*s[n];i.set(t,o,e)}}return i}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=b.eye(this.rows),r=this;for(let n=t;n>=1;n/=2)1&n&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=b.checkMatrix(t);let e=new b(2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),s=t.get(0,1),o=this.get(1,0),l=t.get(1,0),a=this.get(1,1),f=t.get(1,1),u=(r+a)*(n+f),h=(o+a)*n,c=r*(s-f),p=a*(l-n),d=(r+i)*f,g=u+p-d+(i-a)*(l+f),m=c+d,w=h+p,_=u-h+c+(o-r)*(n+s);return e.set(0,0,g),e.set(0,1,m),e.set(1,0,w),e.set(1,1,_),e}strassen3x3(t){t=b.checkMatrix(t);let e=new b(3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),s=this.get(1,0),o=this.get(1,1),l=this.get(1,2),a=this.get(2,0),f=this.get(2,1),u=this.get(2,2),h=t.get(0,0),c=t.get(0,1),p=t.get(0,2),d=t.get(1,0),g=t.get(1,1),m=t.get(1,2),w=t.get(2,0),_=t.get(2,1),y=t.get(2,2),v=(r-s)*(-c+g),x=(-r+s+o)*(h-c+g),M=(s+o)*(-h+c),A=r*h,k=(-r+a+f)*(h-p+m),S=(-r+a)*(p-m),E=(a+f)*(-h+p),N=(-i+f+u)*(g+w-_),B=(i-u)*(g-_),C=i*w,R=(f+u)*(-w+_),z=(-i+o+l)*(m+w-y),I=(i-l)*(m-y),P=(o+l)*(-w+y),O=A+C+n*d,j=(r+n+i-s-o-f-u)*g+x+M+A+N+C+R,T=A+k+E+(r+n+i-o-l-a-f)*m+C+z+P,$=v+o*(-h+c+d-g-m-w+y)+x+A+C+z+I,F=v+x+M+A+l*_,D=C+z+I+P+s*p,V=A+k+S+f*(-h+p+d-g-m-w+_)+N+B+C,L=N+B+C+R+a*c,q=A+k+S+E+u*y;return e.set(0,0,O),e.set(0,1,j),e.set(0,2,T),e.set(1,0,$),e.set(1,1,F),e.set(1,2,D),e.set(2,0,V),e.set(2,1,L),e.set(2,2,q),e}mmulStrassen(t){t=b.checkMatrix(t);let e=this.clone(),r=e.rows,n=e.columns,i=t.rows,s=t.columns;function o(t,e,r){let n=t.rows,i=t.columns;if(n===e&&i===r)return t;{let n=w.zeros(e,r);return n=n.setSubMatrix(t,0,0),n}}n!==i&&console.warn(`Multiplying ${r} x ${n} and ${i} x ${s} matrix: dimensions do not match.`);let l=Math.max(r,i),a=Math.max(n,s);return e=o(e,l,a),function t(e,r,n,i){if(n<=512||i<=512)return e.mmul(r);n%2==1&&i%2==1?(e=o(e,n+1,i+1),r=o(r,n+1,i+1)):n%2==1?(e=o(e,n+1,i),r=o(r,n+1,i)):i%2==1&&(e=o(e,n,i+1),r=o(r,n,i+1));let s=parseInt(e.rows/2,10),l=parseInt(e.columns/2,10),a=e.subMatrix(0,s-1,0,l-1),f=r.subMatrix(0,s-1,0,l-1),u=e.subMatrix(0,s-1,l,e.columns-1),h=r.subMatrix(0,s-1,l,r.columns-1),c=e.subMatrix(s,e.rows-1,0,l-1),p=r.subMatrix(s,r.rows-1,0,l-1),d=e.subMatrix(s,e.rows-1,l,e.columns-1),g=r.subMatrix(s,r.rows-1,l,r.columns-1),m=t(w.add(a,d),w.add(f,g),s,l),_=t(w.add(c,d),f,s,l),y=t(a,w.sub(h,g),s,l),b=t(d,w.sub(p,f),s,l),v=t(w.add(a,u),g,s,l),x=t(w.sub(c,a),w.add(f,h),s,l),M=t(w.sub(u,d),w.add(p,g),s,l),A=w.add(m,b);A.sub(v),A.add(M);let k=w.add(y,v),S=w.add(_,b),E=w.sub(m,_);E.add(y),E.add(x);let N=w.zeros(2*A.rows,2*A.columns);return N=N.setSubMatrix(A,0,0),N=N.setSubMatrix(k,A.rows,0),N=N.setSubMatrix(S,0,A.columns),N=N.setSubMatrix(E,A.rows,A.columns),N.subMatrix(0,n-1,0,i-1)}(e,t=o(t,l,a),l,a)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:n=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(r>=n)throw new RangeError("min must be smaller than max");let i=new b(this.rows,this.columns);for(let t=0;t<this.rows;t++){const s=this.getRow(t);s.length>0&&e(s,{min:r,max:n,output:s}),i.setRow(t,s)}return i}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:r=0,max:n=1}=t;if(!Number.isFinite(r))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(r>=n)throw new RangeError("min must be smaller than max");let i=new b(this.rows,this.columns);for(let t=0;t<this.columns;t++){const s=this.getColumn(t);s.length&&e(s,{min:r,max:n,output:s}),i.setColumn(t,s)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),n=this.get(e,this.columns-1-r);this.set(e,r,n),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),n=this.get(this.rows-1-r,e);this.set(r,e,n),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=b.checkMatrix(t);let e=this.rows,r=this.columns,n=t.rows,i=t.columns,s=new b(e*n,r*i);for(let o=0;o<e;o++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)for(let l=0;l<i;l++)s.set(n*o+r,i*e+l,this.get(o,e)*t.get(r,l));return s}kroneckerSum(t){if(t=b.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,n=this.kroneckerProduct(b.eye(r,r)),i=b.eye(e,e).kroneckerProduct(t);return n.add(i)}transpose(){let t=new b(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=_){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=_){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){p(this,t,e,r,n);let i=new b(e-t+1,n-r+1);for(let s=t;s<=e;s++)for(let e=r;e<=n;e++)i.set(s-t,e-r,this.get(s,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let n=new b(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let s=e;s<=r;s++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,s-e,this.get(t[i],s))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let n=new b(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let s=e;s<=r;s++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(s-e,i,this.get(s,t[i]))}return n}setSubMatrix(t,e,r){if((t=b.checkMatrix(t)).isEmpty())return this;p(this,e,e+t.rows-1,r,r+t.columns-1);for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)this.set(e+n,r+i,t.get(n,i));return this}selection(t,e){h(this,t),c(this,e);let r=new b(t.length,e.length);for(let n=0;n<t.length;n++){let i=t[n];for(let t=0;t<e.length;t++){let s=e[t];r.set(n,t,this.get(i,s))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new b(this.rows,this.columns))}static copy(t,e){for(const[r,n,i]of t.entries())e.set(r,n,i);return e}sum(t){switch(t){case"row":return function(t){let e=d(t.rows);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]+=t.get(r,n);return e}(this);case"column":return function(t){let e=d(t.columns);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]+=t.get(r,n);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=d(t.rows,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[r]*=t.get(r,n);return e}(this);case"column":return function(t){let e=d(t.columns,1);for(let r=0;r<t.rows;++r)for(let n=0;n<t.columns;++n)e[n]*=t.get(r,n);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)e*=t.get(r,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:i=this.mean(e)}=r;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(e){case"row":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,s=[];for(let o=0;o<n;o++){let n=0,l=0,a=0;for(let e=0;e<i;e++)a=t.get(o,e)-r[o],n+=a,l+=a*a;e?s.push((l-n*n/i)/(i-1)):s.push((l-n*n/i)/i)}return s}(this,n,i);case"column":if(!t.isAnyArray(i))throw new TypeError("mean must be an array");return function(t,e,r){const n=t.rows,i=t.columns,s=[];for(let o=0;o<i;o++){let i=0,l=0,a=0;for(let e=0;e<n;e++)a=t.get(e,o)-r[o],i+=a,l+=a*a;e?s.push((l-i*i/n)/(n-1)):s.push((l-i*i/n)/n)}return s}(this,n,i);case void 0:if("number"!=typeof i)throw new TypeError("mean must be a number");return function(t,e,r){const n=t.rows,i=t.columns,s=n*i;let o=0,l=0,a=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++)a=t.get(e,n)-r,o+=a,l+=a*a;return e?(l-o*o/s)/(s-1):(l-o*o/s)/s}(this,n,i);default:throw new Error(`invalid option: ${e}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");const{center:n=this.mean(e)}=r;switch(e){case"row":if(!t.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[r])}(this,n),this;case"column":if(!t.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e[n])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)-e)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}scale(e,r={}){if("object"==typeof e&&(r=e,e=void 0),"object"!=typeof r)throw new TypeError("options must be an object");let n=r.scale;switch(e){case"row":if(void 0===n)n=function(t){const e=[];for(let r=0;r<t.rows;r++){let n=0;for(let e=0;e<t.columns;e++)n+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!t.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[r])}(this,n),this;case"column":if(void 0===n)n=function(t){const e=[];for(let r=0;r<t.columns;r++){let n=0;for(let e=0;e<t.rows;e++)n+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!t.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e[n])}(this,n),this;case void 0:if(void 0===n)n=function(t){const e=t.size-1;let r=0;for(let n=0;n<t.columns;n++)for(let i=0;i<t.rows;i++)r+=t.get(i,n)**2/e;return Math.sqrt(r)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)t.set(r,n,t.get(r,n)/e)}(this,n),this;default:throw new Error(`invalid option: ${e}`)}}toString(t){return i(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function _(t,e){return t-e}function y(t){return t.every(t=>"number"==typeof t)}w.prototype.klass="Matrix","undefined"!=typeof Symbol&&(w.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return i(this)}),w.random=w.rand,w.randomInt=w.randInt,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct;class b extends w{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(e,r){if(super(),b.isMatrix(e))this.#t(e.rows,e.columns),b.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#t(e,r);else{if(!t.isAnyArray(e))throw new TypeError("First argument must be a positive number or an array");{const t=e;if("number"!=typeof(r=(e=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<e;n++){if(t[n].length!==r)throw new RangeError("Inconsistent array dimensions");if(!y(t[n]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[n]))}this.rows=e,this.columns=r}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return l(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),l(this,t,!0),e=Float64Array.from(f(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){a(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let n=0;n<t;n++)r[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)r[n-1]=this.data[e][n];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),a(this,t,!0),e=u(this,e);for(let r=0;r<this.rows;r++){const n=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)n[i]=this.data[r][i];for(n[i++]=e[r];i<this.columns+1;i++)n[i]=this.data[r][i-1];this.data[r]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){return new e(t).add(r)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){return new e(t).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){return new e(t).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){return new e(t).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){return new e(t).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){return new e(t).and(r)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){return new e(t).or(r)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){return new e(t).xor(r)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){return new e(t).leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){return new e(t).signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){return new e(t).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,r){return new e(t).pow(r)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this}}(w,b);class v extends w{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return b.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),b.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=b.copy(t,new b(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new b(t,t);else if(this.#e=new b(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new v(this.diagonalSize);for(const[e,r,n]of this.upperRightEntries())t.set(e,r,n);return t}toMatrix(){return new b(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[r,n]of t.entries())n||e.push(r);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let r=0,n=0,i=0;i<e.length;i++)e[i]=this.get(n,r),++r>=t&&(r=++n);return e}static fromCompact(t){const e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const n=new v(r);for(let i=0,s=0,o=0;o<e;o++)n.set(i,s,t[o]),++i>=r&&(i=++s);return n}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}}v.prototype.klassType="SymmetricMatrix";class x extends v{static isDistanceMatrix(t){return v.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new v(this)}clone(){const t=new x(this.diagonalSize);for(const[e,r,n]of this.upperRightEntries())e!==r&&t.set(e,r,n);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let r=1,n=0,i=0;i<e.length;i++)e[i]=this.get(n,r),++r>=t&&(r=1+ ++n);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const n=new this(r);for(let i=1,s=0,o=0;o<e;o++)n.set(i,s,t[o]),++i>=r&&(i=1+ ++s);return n}}x.prototype.klassSubType="DistanceMatrix";class M extends w{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class A extends M{constructor(t,e,r){h(t,e),c(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class k extends w{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let n=this._calculateIndex(t,e);return this.data[n]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class S extends w{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}class E{constructor(t){let e,r,n,i,s,o,l,a,f,u=(t=S.checkMatrix(t)).clone(),h=u.rows,c=u.columns,p=new Float64Array(h),d=1;for(e=0;e<h;e++)p[e]=e;for(a=new Float64Array(h),r=0;r<c;r++){for(e=0;e<h;e++)a[e]=u.get(e,r);for(e=0;e<h;e++){for(f=Math.min(e,r),s=0,n=0;n<f;n++)s+=u.get(e,n)*a[n];a[e]-=s,u.set(e,r,a[e])}for(i=r,e=r+1;e<h;e++)Math.abs(a[e])>Math.abs(a[i])&&(i=e);if(i!==r){for(n=0;n<c;n++)o=u.get(i,n),u.set(i,n,u.get(r,n)),u.set(r,n,o);l=p[i],p[i]=p[r],p[r]=l,d=-d}if(r<h&&0!==u.get(r,r))for(e=r+1;e<h;e++)u.set(e,r,u.get(e,r)/u.get(r,r))}this.LU=u,this.pivotVector=p,this.pivotSign=d}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=b.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r,n,i,s=t.columns,o=t.subMatrixRow(this.pivotVector,0,s-1),l=e.columns;for(i=0;i<l;i++)for(r=i+1;r<l;r++)for(n=0;n<s;n++)o.set(r,n,o.get(r,n)-o.get(i,n)*e.get(r,i));for(i=l-1;i>=0;i--){for(n=0;n<s;n++)o.set(i,n,o.get(i,n)/e.get(i,i));for(r=0;r<i;r++)for(n=0;n<s;n++)o.set(r,n,o.get(r,n)-o.get(i,n)*e.get(r,i))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let n=0;n<r;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new b(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?n.set(i,e,t.get(i,e)):i===e?n.set(i,e,1):n.set(i,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,n=new b(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?n.set(i,e,t.get(i,e)):n.set(i,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function N(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class B{constructor(t){let e,r,n,i,s=(t=S.checkMatrix(t)).clone(),o=t.rows,l=t.columns,a=new Float64Array(l);for(n=0;n<l;n++){let t=0;for(e=n;e<o;e++)t=N(t,s.get(e,n));if(0!==t){for(s.get(n,n)<0&&(t=-t),e=n;e<o;e++)s.set(e,n,s.get(e,n)/t);for(s.set(n,n,s.get(n,n)+1),r=n+1;r<l;r++){for(i=0,e=n;e<o;e++)i+=s.get(e,n)*s.get(e,r);for(i=-i/s.get(n,n),e=n;e<o;e++)s.set(e,r,s.get(e,r)+i*s.get(e,n))}}a[n]=-t}this.QR=s,this.Rdiag=a}solve(t){t=b.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,i,s,o,l=t.columns,a=t.clone(),f=e.columns;for(s=0;s<f;s++)for(i=0;i<l;i++){for(o=0,n=s;n<r;n++)o+=e.get(n,s)*a.get(n,i);for(o=-o/e.get(s,s),n=s;n<r;n++)a.set(n,i,a.get(n,i)+o*e.get(n,s))}for(s=f-1;s>=0;s--){for(i=0;i<l;i++)a.set(s,i,a.get(s,i)/this.Rdiag[s]);for(n=0;n<s;n++)for(i=0;i<l;i++)a.set(n,i,a.get(n,i)-a.get(s,i)*e.get(n,s))}return a.subMatrix(0,f-1,0,l-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,n=r.columns,i=new b(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,n,i=this.QR,s=i.rows,o=i.columns,l=new b(s,o);for(r=o-1;r>=0;r--){for(t=0;t<s;t++)l.set(t,r,0);for(l.set(r,r,1),e=r;e<o;e++)if(0!==i.get(r,r)){for(n=0,t=r;t<s;t++)n+=i.get(t,r)*l.get(t,e);for(n=-n/i.get(r,r),t=r;t<s;t++)l.set(t,e,l.get(t,e)+n*i.get(t,r))}}return l}}class C{constructor(t,e={}){if((t=S.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=e;let l,a=Boolean(i),f=Boolean(s),u=!1;if(r<n)if(o){l=t.transpose(),r=l.rows,n=l.columns,u=!0;let e=a;a=f,f=e}else l=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else l=t.clone();let h=Math.min(r,n),c=Math.min(r+1,n),p=new Float64Array(c),d=new b(r,h),g=new b(n,n),m=new Float64Array(n),w=new Float64Array(r),_=new Float64Array(c);for(let t=0;t<c;t++)_[t]=t;let y=Math.min(r-1,n),v=Math.max(0,Math.min(n-2,r)),x=Math.max(y,v);for(let t=0;t<x;t++){if(t<y){p[t]=0;for(let e=t;e<r;e++)p[t]=N(p[t],l.get(e,t));if(0!==p[t]){l.get(t,t)<0&&(p[t]=-p[t]);for(let e=t;e<r;e++)l.set(e,t,l.get(e,t)/p[t]);l.set(t,t,l.get(t,t)+1)}p[t]=-p[t]}for(let e=t+1;e<n;e++){if(t<y&&0!==p[t]){let n=0;for(let i=t;i<r;i++)n+=l.get(i,t)*l.get(i,e);n=-n/l.get(t,t);for(let i=t;i<r;i++)l.set(i,e,l.get(i,e)+n*l.get(i,t))}m[e]=l.get(t,e)}if(a&&t<y)for(let e=t;e<r;e++)d.set(e,t,l.get(e,t));if(t<v){m[t]=0;for(let e=t+1;e<n;e++)m[t]=N(m[t],m[e]);if(0!==m[t]){m[t+1]<0&&(m[t]=0-m[t]);for(let e=t+1;e<n;e++)m[e]/=m[t];m[t+1]+=1}if(m[t]=-m[t],t+1<r&&0!==m[t]){for(let e=t+1;e<r;e++)w[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)w[e]+=m[r]*l.get(e,r);for(let e=t+1;e<n;e++){let n=-m[e]/m[t+1];for(let i=t+1;i<r;i++)l.set(i,e,l.get(i,e)+n*w[i])}}if(f)for(let e=t+1;e<n;e++)g.set(e,t,m[e])}}let M=Math.min(n,r+1);if(y<n&&(p[y]=l.get(y,y)),r<M&&(p[M-1]=0),v+1<M&&(m[v]=l.get(v,M-1)),m[M-1]=0,a){for(let t=y;t<h;t++){for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}for(let t=y-1;t>=0;t--)if(0!==p[t]){for(let e=t+1;e<h;e++){let n=0;for(let i=t;i<r;i++)n+=d.get(i,t)*d.get(i,e);n=-n/d.get(t,t);for(let i=t;i<r;i++)d.set(i,e,d.get(i,e)+n*d.get(i,t))}for(let e=t;e<r;e++)d.set(e,t,-d.get(e,t));d.set(t,t,1+d.get(t,t));for(let e=0;e<t-1;e++)d.set(e,t,0)}else{for(let e=0;e<r;e++)d.set(e,t,0);d.set(t,t,1)}}if(f)for(let t=n-1;t>=0;t--){if(t<v&&0!==m[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=g.get(i,t)*g.get(i,e);r=-r/g.get(t+1,t);for(let i=t+1;i<n;i++)g.set(i,e,g.get(i,e)+r*g.get(i,t))}for(let e=0;e<n;e++)g.set(e,t,0);g.set(t,t,1)}let A=M-1,k=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+k*Math.abs(p[t]+Math.abs(p[t+1]));if(Math.abs(m[t])<=e||Number.isNaN(m[t])){m[t]=0;break}}if(t===M-2)e=4;else{let r;for(r=M-1;r>=t&&r!==t;r--){let e=(r!==M?Math.abs(m[r]):0)+(r!==t+1?Math.abs(m[r-1]):0);if(Math.abs(p[r])<=k*e){p[r]=0;break}}r===t?e=3:r===M-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=m[M-2];m[M-2]=0;for(let r=M-2;r>=t;r--){let i=N(p[r],e),s=p[r]/i,o=e/i;if(p[r]=i,r!==t&&(e=-o*m[r-1],m[r-1]=s*m[r-1]),f)for(let t=0;t<n;t++)i=s*g.get(t,r)+o*g.get(t,M-1),g.set(t,M-1,-o*g.get(t,r)+s*g.get(t,M-1)),g.set(t,r,i)}break}case 2:{let e=m[t-1];m[t-1]=0;for(let n=t;n<M;n++){let i=N(p[n],e),s=p[n]/i,o=e/i;if(p[n]=i,e=-o*m[n],m[n]=s*m[n],a)for(let e=0;e<r;e++)i=s*d.get(e,n)+o*d.get(e,t-1),d.set(e,t-1,-o*d.get(e,n)+s*d.get(e,t-1)),d.set(e,n,i)}break}case 3:{const e=Math.max(Math.abs(p[M-1]),Math.abs(p[M-2]),Math.abs(m[M-2]),Math.abs(p[t]),Math.abs(m[t])),i=p[M-1]/e,s=p[M-2]/e,o=m[M-2]/e,l=p[t]/e,u=m[t]/e,h=((s+i)*(s-i)+o*o)/2,c=i*o*(i*o);let w=0;0===h&&0===c||(w=h<0?0-Math.sqrt(h*h+c):Math.sqrt(h*h+c),w=c/(h+w));let _=(l+i)*(l-i)+w,y=l*u;for(let e=t;e<M-1;e++){let i=N(_,y);0===i&&(i=Number.MIN_VALUE);let s=_/i,o=y/i;if(e!==t&&(m[e-1]=i),_=s*p[e]+o*m[e],m[e]=s*m[e]-o*p[e],y=o*p[e+1],p[e+1]=s*p[e+1],f)for(let t=0;t<n;t++)i=s*g.get(t,e)+o*g.get(t,e+1),g.set(t,e+1,-o*g.get(t,e)+s*g.get(t,e+1)),g.set(t,e,i);if(i=N(_,y),0===i&&(i=Number.MIN_VALUE),s=_/i,o=y/i,p[e]=i,_=s*m[e]+o*p[e+1],p[e+1]=-o*m[e]+s*p[e+1],y=o*m[e+1],m[e+1]=s*m[e+1],a&&e<r-1)for(let t=0;t<r;t++)i=s*d.get(t,e)+o*d.get(t,e+1),d.set(t,e+1,-o*d.get(t,e)+s*d.get(t,e+1)),d.set(t,e,i)}m[M-2]=_;break}case 4:if(p[t]<=0&&(p[t]=p[t]<0?-p[t]:0,f))for(let e=0;e<=A;e++)g.set(e,t,-g.get(e,t));for(;t<A&&!(p[t]>=p[t+1]);){let e=p[t];if(p[t]=p[t+1],p[t+1]=e,f&&t<n-1)for(let r=0;r<n;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);if(a&&t<r-1)for(let n=0;n<r;n++)e=d.get(n,t+1),d.set(n,t+1,d.get(n,t)),d.set(n,t,e);t++}M--}}if(u){let t=g;g=d,d=t}this.m=r,this.n=n,this.s=p,this.U=d,this.V=g}solve(t){let e=t,r=this.threshold,n=this.s.length,i=b.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i.set(t,t,0):i.set(t,t,1/this.s[t]);let s=this.U,o=this.rightSingularVectors,l=o.mmul(i),a=o.rows,f=s.rows,u=b.zeros(a,f);for(let t=0;t<a;t++)for(let e=0;e<f;e++){let r=0;for(let i=0;i<n;i++)r+=l.get(t,i)*s.get(e,i);u.set(t,e,r)}return u.mmul(e)}solveForDiagonal(t){return this.solve(b.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,n=t.columns,i=new b(r,this.s.length);for(let s=0;s<r;s++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e&&i.set(s,r,t.get(s,r)/this.s[r]);let s=this.U,o=s.rows,l=s.columns,a=new b(r,o);for(let t=0;t<r;t++)for(let e=0;e<o;e++){let r=0;for(let n=0;n<l;n++)r+=i.get(t,n)*s.get(e,n);a.set(t,e,r)}return a}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return b.diag(this.s)}}function R(t,e,r=!1){return t=S.checkMatrix(t),e=S.checkMatrix(e),r?new C(t).solve(e):t.isSquare()?new E(t).solve(e):new B(t).solve(e)}function z(t,e){let r=[];for(let n=0;n<t;n++)n!==e&&r.push(n);return r}function I(t,e,r,n=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}class P{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=S.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,i,s=t.columns,o=new b(s,s),l=new Float64Array(s),a=new Float64Array(s),f=t,u=!1;if(u=!!r||t.isSymmetric(),u){for(n=0;n<s;n++)for(i=0;i<s;i++)o.set(n,i,f.get(n,i));!function(t,e,r,n){let i,s,o,l,a,f,u,h;for(a=0;a<t;a++)r[a]=n.get(t-1,a);for(l=t-1;l>0;l--){for(h=0,o=0,f=0;f<l;f++)h+=Math.abs(r[f]);if(0===h)for(e[l]=r[l-1],a=0;a<l;a++)r[a]=n.get(l-1,a),n.set(l,a,0),n.set(a,l,0);else{for(f=0;f<l;f++)r[f]/=h,o+=r[f]*r[f];for(i=r[l-1],s=Math.sqrt(o),i>0&&(s=-s),e[l]=h*s,o-=i*s,r[l-1]=i-s,a=0;a<l;a++)e[a]=0;for(a=0;a<l;a++){for(i=r[a],n.set(a,l,i),s=e[a]+n.get(a,a)*i,f=a+1;f<=l-1;f++)s+=n.get(f,a)*r[f],e[f]+=n.get(f,a)*i;e[a]=s}for(i=0,a=0;a<l;a++)e[a]/=o,i+=e[a]*r[a];for(u=i/(o+o),a=0;a<l;a++)e[a]-=u*r[a];for(a=0;a<l;a++){for(i=r[a],s=e[a],f=a;f<=l-1;f++)n.set(f,a,n.get(f,a)-(i*e[f]+s*r[f]));r[a]=n.get(l-1,a),n.set(l,a,0)}}r[l]=o}for(l=0;l<t-1;l++){if(n.set(t-1,l,n.get(l,l)),n.set(l,l,1),o=r[l+1],0!==o){for(f=0;f<=l;f++)r[f]=n.get(f,l+1)/o;for(a=0;a<=l;a++){for(s=0,f=0;f<=l;f++)s+=n.get(f,l+1)*n.get(f,a);for(f=0;f<=l;f++)n.set(f,a,n.get(f,a)-s*r[f])}}for(f=0;f<=l;f++)n.set(f,l+1,0)}for(a=0;a<t;a++)r[a]=n.get(t-1,a),n.set(t-1,a,0);n.set(t-1,t-1,1),e[0]=0}(s,a,l,o),function(t,e,r,n){let i,s,o,l,a,f,u,h,c,p,d,g,m,w,_,y;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let b=0,v=0,x=Number.EPSILON;for(f=0;f<t;f++){for(v=Math.max(v,Math.abs(r[f])+Math.abs(e[f])),u=f;u<t&&!(Math.abs(e[u])<=x*v);)u++;if(u>f)do{for(i=r[f],h=(r[f+1]-i)/(2*e[f]),c=N(h,1),h<0&&(c=-c),r[f]=e[f]/(h+c),r[f+1]=e[f]*(h+c),p=r[f+1],s=i-r[f],o=f+2;o<t;o++)r[o]-=s;for(b+=s,h=r[u],d=1,g=d,m=d,w=e[f+1],_=0,y=0,o=u-1;o>=f;o--)for(m=g,g=d,y=_,i=d*e[o],s=d*h,c=N(h,e[o]),e[o+1]=_*c,_=e[o]/c,d=h/c,h=d*r[o]-_*i,r[o+1]=s+_*(d*i+_*r[o]),a=0;a<t;a++)s=n.get(a,o+1),n.set(a,o+1,_*n.get(a,o)+d*s),n.set(a,o,d*n.get(a,o)-_*s);h=-_*y*m*w*e[f]/p,e[f]=_*h,r[f]=d*h}while(Math.abs(e[f])>x*v);r[f]=r[f]+b,e[f]=0}for(o=0;o<t-1;o++){for(a=o,h=r[o],l=o+1;l<t;l++)r[l]<h&&(a=l,h=r[l]);if(a!==o)for(r[a]=r[o],r[o]=h,l=0;l<t;l++)h=n.get(l,o),n.set(l,o,n.get(l,a)),n.set(l,a,h)}}(s,a,l,o)}else{let t=new b(s,s),e=new Float64Array(s);for(i=0;i<s;i++)for(n=0;n<s;n++)t.set(n,i,f.get(n,i));!function(t,e,r,n){let i,s,o,l,a,f,u,h=0,c=t-1;for(f=h+1;f<=c-1;f++){for(u=0,l=f;l<=c;l++)u+=Math.abs(e.get(l,f-1));if(0!==u){for(o=0,l=c;l>=f;l--)r[l]=e.get(l,f-1)/u,o+=r[l]*r[l];for(s=Math.sqrt(o),r[f]>0&&(s=-s),o-=r[f]*s,r[f]=r[f]-s,a=f;a<t;a++){for(i=0,l=c;l>=f;l--)i+=r[l]*e.get(l,a);for(i/=o,l=f;l<=c;l++)e.set(l,a,e.get(l,a)-i*r[l])}for(l=0;l<=c;l++){for(i=0,a=c;a>=f;a--)i+=r[a]*e.get(l,a);for(i/=o,a=f;a<=c;a++)e.set(l,a,e.get(l,a)-i*r[a])}r[f]=u*r[f],e.set(f,f-1,u*s)}}for(l=0;l<t;l++)for(a=0;a<t;a++)n.set(l,a,l===a?1:0);for(f=c-1;f>=h+1;f--)if(0!==e.get(f,f-1)){for(l=f+1;l<=c;l++)r[l]=e.get(l,f-1);for(a=f;a<=c;a++){for(s=0,l=f;l<=c;l++)s+=r[l]*n.get(l,a);for(s=s/r[f]/e.get(f,f-1),l=f;l<=c;l++)n.set(l,a,n.get(l,a)+s*r[l])}}}(s,t,e,o),function(t,e,r,n,i){let s,o,l,a,f,u,h,c,p,d,g,m,w,_,y,b=t-1,v=0,x=t-1,M=Number.EPSILON,A=0,k=0,S=0,E=0,N=0,B=0,C=0,R=0;for(s=0;s<t;s++)for((s<v||s>x)&&(r[s]=i.get(s,s),e[s]=0),o=Math.max(s-1,0);o<t;o++)k+=Math.abs(i.get(s,o));for(;b>=v;){for(a=b;a>v&&(B=Math.abs(i.get(a-1,a-1))+Math.abs(i.get(a,a)),0===B&&(B=k),!(Math.abs(i.get(a,a-1))<M*B));)a--;if(a===b)i.set(b,b,i.get(b,b)+A),r[b]=i.get(b,b),e[b]=0,b--,R=0;else if(a===b-1){if(h=i.get(b,b-1)*i.get(b-1,b),S=(i.get(b-1,b-1)-i.get(b,b))/2,E=S*S+h,C=Math.sqrt(Math.abs(E)),i.set(b,b,i.get(b,b)+A),i.set(b-1,b-1,i.get(b-1,b-1)+A),c=i.get(b,b),E>=0){for(C=S>=0?S+C:S-C,r[b-1]=c+C,r[b]=r[b-1],0!==C&&(r[b]=c-h/C),e[b-1]=0,e[b]=0,c=i.get(b,b-1),B=Math.abs(c)+Math.abs(C),S=c/B,E=C/B,N=Math.sqrt(S*S+E*E),S/=N,E/=N,o=b-1;o<t;o++)C=i.get(b-1,o),i.set(b-1,o,E*C+S*i.get(b,o)),i.set(b,o,E*i.get(b,o)-S*C);for(s=0;s<=b;s++)C=i.get(s,b-1),i.set(s,b-1,E*C+S*i.get(s,b)),i.set(s,b,E*i.get(s,b)-S*C);for(s=v;s<=x;s++)C=n.get(s,b-1),n.set(s,b-1,E*C+S*n.get(s,b)),n.set(s,b,E*n.get(s,b)-S*C)}else r[b-1]=c+S,r[b]=c+S,e[b-1]=C,e[b]=-C;b-=2,R=0}else{if(c=i.get(b,b),p=0,h=0,a<b&&(p=i.get(b-1,b-1),h=i.get(b,b-1)*i.get(b-1,b)),10===R){for(A+=c,s=v;s<=b;s++)i.set(s,s,i.get(s,s)-c);B=Math.abs(i.get(b,b-1))+Math.abs(i.get(b-1,b-2)),c=p=.75*B,h=-.4375*B*B}if(30===R&&(B=(p-c)/2,B=B*B+h,B>0)){for(B=Math.sqrt(B),p<c&&(B=-B),B=c-h/((p-c)/2+B),s=v;s<=b;s++)i.set(s,s,i.get(s,s)-B);A+=B,c=p=h=.964}for(R+=1,f=b-2;f>=a&&(C=i.get(f,f),N=c-C,B=p-C,S=(N*B-h)/i.get(f+1,f)+i.get(f,f+1),E=i.get(f+1,f+1)-C-N-B,N=i.get(f+2,f+1),B=Math.abs(S)+Math.abs(E)+Math.abs(N),S/=B,E/=B,N/=B,f!==a)&&!(Math.abs(i.get(f,f-1))*(Math.abs(E)+Math.abs(N))<M*(Math.abs(S)*(Math.abs(i.get(f-1,f-1))+Math.abs(C)+Math.abs(i.get(f+1,f+1)))));)f--;for(s=f+2;s<=b;s++)i.set(s,s-2,0),s>f+2&&i.set(s,s-3,0);for(l=f;l<=b-1&&(_=l!==b-1,l!==f&&(S=i.get(l,l-1),E=i.get(l+1,l-1),N=_?i.get(l+2,l-1):0,c=Math.abs(S)+Math.abs(E)+Math.abs(N),0!==c&&(S/=c,E/=c,N/=c)),0!==c);l++)if(B=Math.sqrt(S*S+E*E+N*N),S<0&&(B=-B),0!==B){for(l!==f?i.set(l,l-1,-B*c):a!==f&&i.set(l,l-1,-i.get(l,l-1)),S+=B,c=S/B,p=E/B,C=N/B,E/=S,N/=S,o=l;o<t;o++)S=i.get(l,o)+E*i.get(l+1,o),_&&(S+=N*i.get(l+2,o),i.set(l+2,o,i.get(l+2,o)-S*C)),i.set(l,o,i.get(l,o)-S*c),i.set(l+1,o,i.get(l+1,o)-S*p);for(s=0;s<=Math.min(b,l+3);s++)S=c*i.get(s,l)+p*i.get(s,l+1),_&&(S+=C*i.get(s,l+2),i.set(s,l+2,i.get(s,l+2)-S*N)),i.set(s,l,i.get(s,l)-S),i.set(s,l+1,i.get(s,l+1)-S*E);for(s=v;s<=x;s++)S=c*n.get(s,l)+p*n.get(s,l+1),_&&(S+=C*n.get(s,l+2),n.set(s,l+2,n.get(s,l+2)-S*N)),n.set(s,l,n.get(s,l)-S),n.set(s,l+1,n.get(s,l+1)-S*E)}}}if(0===k)return;for(b=t-1;b>=0;b--)if(S=r[b],E=e[b],0===E)for(a=b,i.set(b,b,1),s=b-1;s>=0;s--){for(h=i.get(s,s)-S,N=0,o=a;o<=b;o++)N+=i.get(s,o)*i.get(o,b);if(e[s]<0)C=h,B=N;else if(a=s,0===e[s]?i.set(s,b,0!==h?-N/h:-N/(M*k)):(c=i.get(s,s+1),p=i.get(s+1,s),E=(r[s]-S)*(r[s]-S)+e[s]*e[s],u=(c*B-C*N)/E,i.set(s,b,u),i.set(s+1,b,Math.abs(c)>Math.abs(C)?(-N-h*u)/c:(-B-p*u)/C)),u=Math.abs(i.get(s,b)),M*u*u>1)for(o=s;o<=b;o++)i.set(o,b,i.get(o,b)/u)}else if(E<0)for(a=b-1,Math.abs(i.get(b,b-1))>Math.abs(i.get(b-1,b))?(i.set(b-1,b-1,E/i.get(b,b-1)),i.set(b-1,b,-(i.get(b,b)-S)/i.get(b,b-1))):(y=O(0,-i.get(b-1,b),i.get(b-1,b-1)-S,E),i.set(b-1,b-1,y[0]),i.set(b-1,b,y[1])),i.set(b,b-1,0),i.set(b,b,1),s=b-2;s>=0;s--){for(d=0,g=0,o=a;o<=b;o++)d+=i.get(s,o)*i.get(o,b-1),g+=i.get(s,o)*i.get(o,b);if(h=i.get(s,s)-S,e[s]<0)C=h,N=d,B=g;else if(a=s,0===e[s]?(y=O(-d,-g,h,E),i.set(s,b-1,y[0]),i.set(s,b,y[1])):(c=i.get(s,s+1),p=i.get(s+1,s),m=(r[s]-S)*(r[s]-S)+e[s]*e[s]-E*E,w=2*(r[s]-S)*E,0===m&&0===w&&(m=M*k*(Math.abs(h)+Math.abs(E)+Math.abs(c)+Math.abs(p)+Math.abs(C))),y=O(c*N-C*d+E*g,c*B-C*g-E*d,m,w),i.set(s,b-1,y[0]),i.set(s,b,y[1]),Math.abs(c)>Math.abs(C)+Math.abs(E)?(i.set(s+1,b-1,(-d-h*i.get(s,b-1)+E*i.get(s,b))/c),i.set(s+1,b,(-g-h*i.get(s,b)-E*i.get(s,b-1))/c)):(y=O(-N-p*i.get(s,b-1),-B-p*i.get(s,b),C,E),i.set(s+1,b-1,y[0]),i.set(s+1,b,y[1]))),u=Math.max(Math.abs(i.get(s,b-1)),Math.abs(i.get(s,b))),M*u*u>1)for(o=s;o<=b;o++)i.set(o,b-1,i.get(o,b-1)/u),i.set(o,b,i.get(o,b)/u)}for(s=0;s<t;s++)if(s<v||s>x)for(o=s;o<t;o++)n.set(s,o,i.get(s,o));for(o=t-1;o>=v;o--)for(s=v;s<=x;s++){for(C=0,l=v;l<=Math.min(o,x);l++)C+=n.get(s,l)*i.get(l,o);n.set(s,o,C)}}(s,a,l,o,t)}this.n=s,this.e=a,this.d=l,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,n=this.e,i=this.d,s=new b(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)s.set(t,e,0);s.set(t,t,i[t]),n[t]>0?s.set(t,t+1,n[t]):n[t]<0&&s.set(t,t-1,n[t])}return s}}function O(t,e,r,n){let i,s;return Math.abs(r)>Math.abs(n)?(i=n/r,s=r+i*n,[(t+i*e)/s,(e-i*t)/s]):(i=r/n,s=n+i*r,[(i*t+e)/s,(i*e-t)/s])}class j{constructor(t){if(!(t=S.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,r,n,i=t,s=i.rows,o=new b(s,s),l=!0;for(r=0;r<s;r++){let t=0;for(n=0;n<r;n++){let s=0;for(e=0;e<n;e++)s+=o.get(n,e)*o.get(r,e);s=(i.get(r,n)-s)/o.get(n,n),o.set(r,n,s),t+=s*s}for(t=i.get(r,r)-t,l&&=t>0,o.set(r,r,Math.sqrt(Math.max(t,0))),n=r+1;n<s;n++)o.set(r,n,0)}this.L=o,this.positiveDefinite=l}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=S.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,i,s,o=t.columns,l=t.clone();for(s=0;s<r;s++)for(i=0;i<o;i++){for(n=0;n<s;n++)l.set(s,i,l.get(s,i)-l.get(n,i)*e.get(s,n));l.set(s,i,l.get(s,i)/e.get(s,s))}for(s=r-1;s>=0;s--)for(i=0;i<o;i++){for(n=s+1;n<r;n++)l.set(s,i,l.get(s,i)-l.get(n,i)*e.get(n,s));l.set(s,i,l.get(s,i)/e.get(s,s))}return l}get lowerTriangularMatrix(){return this.L}}class T{constructor(e,r={}){e=S.checkMatrix(e);let{Y:n}=r;const{scaleScores:i=!1,maxIterations:s=1e3,terminationCriteria:o=1e-10}=r;let l;if(n){if(n=t.isAnyArray(n)&&"number"==typeof n[0]?b.columnVector(n):S.checkMatrix(n),n.rows!==e.rows)throw new Error("Y should have the same number of rows as X");l=n.getColumnVector(0)}else l=e.getColumnVector(0);let a,f,u,h,c=1;for(let t=0;t<s&&c>o;t++)u=e.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),u=u.div(u.norm()),a=e.mmul(u).div(u.transpose().mmul(u).get(0,0)),t>0&&(c=a.clone().sub(h).pow(2).sum()),h=a.clone(),n?(f=n.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),f=f.div(f.norm()),l=n.mmul(f).div(f.transpose().mmul(f).get(0,0))):l=a;if(n){let t=e.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0));t=t.div(t.norm());let r=e.clone().sub(a.clone().mmul(t.transpose())),i=l.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),s=n.clone().sub(a.clone().mulS(i.get(0,0)).mmul(f.transpose()));this.t=a,this.p=t.transpose(),this.w=u.transpose(),this.q=f,this.u=l,this.s=a.transpose().mmul(a),this.xResidual=r,this.yResidual=s,this.betas=i}else this.w=u.transpose(),this.s=a.transpose().mmul(a).sqrt(),this.t=i?a.clone().div(this.s.get(0,0)):a,this.xResidual=e.sub(a.mmul(u.transpose()))}}return os.AbstractMatrix=w,os.CHO=j,os.CholeskyDecomposition=j,os.DistanceMatrix=x,os.EVD=P,os.EigenvalueDecomposition=P,os.LU=E,os.LuDecomposition=E,os.Matrix=b,os.MatrixColumnSelectionView=class extends M{constructor(t,e){c(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},os.MatrixColumnView=class extends M{constructor(t,e){a(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},os.MatrixFlipColumnView=class extends M{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},os.MatrixFlipRowView=class extends M{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},os.MatrixRowSelectionView=class extends M{constructor(t,e){h(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},os.MatrixRowView=class extends M{constructor(t,e){l(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},os.MatrixSelectionView=A,os.MatrixSubView=class extends M{constructor(t,e,r,n,i){p(t,e,r,n,i),super(t,r-e+1,i-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},os.MatrixTransposeView=class extends M{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},os.NIPALS=T,os.Nipals=T,os.QR=B,os.QrDecomposition=B,os.SVD=C,os.SingularValueDecomposition=C,os.SymmetricMatrix=v,os.WrapperMatrix1D=k,os.WrapperMatrix2D=S,os.correlation=function(e,r=e,n={}){e=new b(e);let i=!1;if("object"!=typeof r||b.isMatrix(r)||t.isAnyArray(r)?r=new b(r):(n=r,r=e,i=!0),e.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=n;s&&(e.center("column"),i||r.center("column")),o&&(e.scale("column"),i||r.scale("column"));const l=e.standardDeviation("column",{unbiased:!0}),a=i?l:r.standardDeviation("column",{unbiased:!0}),f=e.transpose().mmul(r);for(let t=0;t<f.rows;t++)for(let r=0;r<f.columns;r++)f.set(t,r,f.get(t,r)*(1/(l[t]*a[r]))*(1/(e.rows-1)));return f},os.covariance=function(e,r=e,n={}){e=new b(e);let i=!1;if("object"!=typeof r||b.isMatrix(r)||t.isAnyArray(r)?r=new b(r):(n=r,r=e,i=!0),e.rows!==r.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=n;s&&(e=e.center("column"),i||(r=r.center("column")));const o=e.transpose().mmul(r);for(let t=0;t<o.rows;t++)for(let r=0;r<o.columns;r++)o.set(t,r,o.get(t,r)*(1/(e.rows-1)));return o},os.default=b,os.determinant=function t(e){if((e=b.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let r,n,i,s;if(2===e.columns)return r=e.get(0,0),n=e.get(0,1),i=e.get(1,0),s=e.get(1,1),r*s-n*i;if(3===e.columns){let s,o,l;return s=new A(e,[1,2],[1,2]),o=new A(e,[1,2],[0,2]),l=new A(e,[1,2],[0,1]),r=e.get(0,0),n=e.get(0,1),i=e.get(0,2),r*t(s)-n*t(o)+i*t(l)}return new E(e).determinant}throw Error("determinant can only be calculated for a square matrix")},os.inverse=function(t,e=!1){return t=S.checkMatrix(t),e?new C(t).inverse():R(t,b.eye(t.rows))},os.linearDependencies=function(t,e={}){const{thresholdValue:r=1e-9,thresholdError:n=1e-9}=e;let i=(t=b.checkMatrix(t)).rows,s=new b(i,i);for(let e=0;e<i;e++){let o=b.columnVector(t.getRow(e)),l=t.subMatrixRow(z(i,e)).transpose(),a=new C(l).solve(o),f=b.sub(o,l.mmul(a)).abs().max();s.setRow(e,I(f,a,e,r,n))}return s},os.pseudoInverse=function(t,e=Number.EPSILON){if((t=b.checkMatrix(t)).isEmpty())return t.transpose();let r=new C(t,{autoTranspose:!0}),n=r.leftSingularVectors,i=r.rightSingularVectors,s=r.diagonal;for(let t=0;t<s.length;t++)Math.abs(s[t])>e?s[t]=1/s[t]:s[t]=0;return i.mmul(b.diag(s).mmul(n.transpose()))},os.solve=R,os.wrap=function(e,r){if(t.isAnyArray(e))return e[0]&&t.isAnyArray(e[0])?new S(e):new k(e,r);throw new Error("the argument is not an array")},os}var ps=cs(),ds=is(ps);const gs=ps.EVD,ms=ps.Matrix,ws=ps.MatrixTransposeView,_s=ps.NIPALS,ys=ps.SVD;ds.Matrix?ds.Matrix:ps.Matrix;const bs=ps.inverse;var vs,xs,Ms,As={exports:{}},ks=As.exports;function Ss(){return vs||(vs=1,t=As,function(){var e,r,n,i,s,o,l,a,f,u,h,c,p,d,g;n=Math.floor,u=Math.min,r=function(t,e){return t<e?-1:t>e?1:0},f=function(t,e,i,s,o){var l;if(null==i&&(i=0),null==o&&(o=r),i<0)throw new Error("lo must be non-negative");for(null==s&&(s=t.length);i<s;)o(e,t[l=n((i+s)/2)])<0?s=l:i=l+1;return[].splice.apply(t,[i,i-i].concat(e)),e},o=function(t,e,n){return null==n&&(n=r),t.push(e),d(t,0,t.length-1,n)},s=function(t,e){var n,i;return null==e&&(e=r),n=t.pop(),t.length?(i=t[0],t[0]=n,g(t,0,e)):i=n,i},a=function(t,e,n){var i;return null==n&&(n=r),i=t[0],t[0]=e,g(t,0,n),i},l=function(t,e,n){var i;return null==n&&(n=r),t.length&&n(t[0],e)<0&&(e=(i=[t[0],e])[0],t[0]=i[1],g(t,0,n)),e},i=function(t,e){var i,s,o,l,a,f;for(null==e&&(e=r),a=[],s=0,o=(l=function(){f=[];for(var e=0,r=n(t.length/2);0<=r?e<r:e>r;0<=r?e++:e--)f.push(e);return f}.apply(this).reverse()).length;s<o;s++)i=l[s],a.push(g(t,i,e));return a},p=function(t,e,n){var i;if(null==n&&(n=r),-1!==(i=t.indexOf(e)))return d(t,0,i,n),g(t,i,n)},h=function(t,e,n){var s,o,a,f,u;if(null==n&&(n=r),!(o=t.slice(0,e)).length)return o;for(i(o,n),a=0,f=(u=t.slice(e)).length;a<f;a++)s=u[a],l(o,s,n);return o.sort(n).reverse()},c=function(t,e,n){var o,l,a,h,c,p,d,g,m;if(null==n&&(n=r),10*e<=t.length){if(!(a=t.slice(0,e).sort(n)).length)return a;for(l=a[a.length-1],h=0,p=(d=t.slice(e)).length;h<p;h++)n(o=d[h],l)<0&&(f(a,o,0,null,n),a.pop(),l=a[a.length-1]);return a}for(i(t,n),m=[],c=0,g=u(e,t.length);0<=g?c<g:c>g;0<=g?++c:--c)m.push(s(t,n));return m},d=function(t,e,n,i){var s,o,l;for(null==i&&(i=r),s=t[n];n>e&&i(s,o=t[l=n-1>>1])<0;)t[n]=o,n=l;return t[n]=s},g=function(t,e,n){var i,s,o,l,a;for(null==n&&(n=r),s=t.length,a=e,o=t[e],i=2*e+1;i<s;)(l=i+1)<s&&!(n(t[i],t[l])<0)&&(i=l),t[e]=t[i],i=2*(e=i)+1;return t[e]=o,d(t,a,e,n)},e=function(){function t(t){this.cmp=null!=t?t:r,this.nodes=[]}return t.push=o,t.pop=s,t.replace=a,t.pushpop=l,t.heapify=i,t.updateItem=p,t.nlargest=h,t.nsmallest=c,t.prototype.push=function(t){return o(this.nodes,t,this.cmp)},t.prototype.pop=function(){return s(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return a(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return l(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return i(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return p(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),t.exports=e}.call(ks)),As.exports;var t}var Es=is(Ms?xs:(Ms=1,xs=Ss()));class Ns{constructor(){this.children=[],this.height=0,this.size=1,this.index=-1,this.isLeaf=!1}cut(t){if("number"!=typeof t)throw new TypeError("threshold must be a number");if(t<0)throw new RangeError("threshold must be a positive number");let e=[this];const r=[];for(;e.length>0;){const n=e.shift();t>=n.height?r.push(n):e=e.concat(n.children)}return r}group(t){if(!Number.isInteger(t)||t<1)throw new RangeError("groups must be a positive integer");const e=new Es((t,e)=>e.height-t.height);for(e.push(this);e.size()<t;){const t=e.pop();if(0===t.children.length)break;t.children.forEach(t=>e.push(t))}const r=new Ns;return r.children=e.toArray(),r.height=this.height,r}traverse(t){!function t(e,r){if(r(e),e.children)for(const n of e.children)t(n,r)}(this,t)}indices(){const t=[];return this.traverse(e=>{e.isLeaf&&t.push(e.index)}),t}}function Bs(t,e){return Math.min(t,e)}function Cs(t,e){return Math.max(t,e)}function Rs(t,e,r,n,i){return n/(n+i)*t+i/(n+i)*e}function zs(t,e){return(t+e)/2}function Is(t,e,r,n,i){return n/(n+i)*t+i/(n+i)*e+-n*i/(n+i)**2*r}function Ps(t,e,r){return t/2+e/2-r/4}function Os(t,e,r,n,i,s){return(n+s)/(n+i+s)*t+(i+s)/(n+i+s)*e+-s/(n+i+s)*r}function js(t,e,r,n,i,s){const o=(n+s)/(n+i+s),l=(i+s)/(n+i+s),a=-s/(n+i+s);return Math.sqrt(o*t*t+l*e*e+a*r*r)}function Ts(t,e={}){const{distanceFunction:r=rs,method:n="complete",isDistanceMatrix:i=!1}=e;let s;i||(t=ns(t,r));let o=new ms(t);const l=o.rows;if("string"==typeof n)switch(n.toLowerCase()){case"single":s=Bs;break;case"complete":s=Cs;break;case"average":case"upgma":s=Rs;break;case"wpgma":s=zs;break;case"centroid":case"upgmc":s=Is;break;case"median":case"wpgmc":s=Ps;break;case"ward":s=Os;break;case"ward2":s=js;break;default:throw new RangeError(`unknown clustering method: ${n}`)}else if("function"!=typeof n)throw new TypeError("method must be a string or function");let a=[];for(let t=0;t<l;t++){const e=new Ns;e.isLeaf=!0,e.index=t,a.push(e)}for(let t=0;t<l-1;t++){const[t,e,r]=$s(o),n=a[t],i=a[e],l=new Ns;l.size=n.size+i.size,l.children.push(n,i),l.height=r;const f=[l],u=new ms(o.rows-1,o.rows-1),h=r=>Fs(r,Math.min(t,e),Math.max(t,e));for(let l=1;l<u.rows;l++){const c=h(l),p=a[c];f.push(p);for(let a=0;a<l;a++)if(0===a){const f=s(o.get(t,c),o.get(c,e),r,n.size,i.size,p.size);u.set(l,a,f),u.set(a,l,f)}else{const t=o.get(c,h(a));u.set(l,a,t),u.set(a,l,t)}}a=f,o=u}return a[0]}function $s(t){let e=1/0,r=0,n=0;for(let i=1;i<t.rows;i++)for(let s=0;s<i;s++)t.get(i,s)<e&&(e=t.get(i,s),r=i,n=s);return[r,n,e]}function Fs(t,e,r){return(t-=1)>=e&&t++,t>=r&&t++,t}var Ds,Vs=Object.freeze({__proto__:null,additiveSymmetric:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])*(t[n]+e[n])/(t[n]*e[n]);return r},avg:function(t,e){let r=0,n=0,i=0;for(let s=0;s<t.length;s++)i=Math.abs(t[s]-e[s]),n+=i,r<i&&(r=i);return(r+n)/2},bhattacharyya:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return-Math.log(r)},canberra:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.abs(t[n]-e[n])/(t[n]+e[n]);return r},chebyshev:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)n=Math.abs(t[i]-e[i]),r<n&&(r=n);return r},clark:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(Math.abs(t[n]-e[n])/(t[n]+e[n]))**2;return Math.sqrt(r)},czekanowski:function(t,e){return 1-function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.min(t[i],e[i]),n+=t[i]+e[i];return 2*r/n}(t,e)},dice:function(t,e){let r=0,n=0,i=0;for(let s=0;s<t.length;s++)r+=t[s]*t[s],n+=e[s]*e[s],i+=(t[s]-e[s])*(t[s]-e[s]);return i/(r+n)},divergence:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/((t[n]+e[n])*(t[n]+e[n]));return 2*r},euclidean:rs,fidelity:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return r},gower:function(t,e){const r=t.length;let n=0;for(let r=0;r<t.length;r++)n+=Math.abs(t[r]-e[r]);return n/r},harmonicMean:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*e[n]/(t[n]+e[n]);return 2*r},hellinger:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return 2*Math.sqrt(1-r)},innerProduct:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*e[n];return r},intersection:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.min(t[n],e[n]);return 1-r},jaccard:function(t,e){return 1-function(t,e){let r=0,n=0,i=0;for(let s=0;s<t.length;s++)r+=t[s]*e[s],n+=t[s]*t[s],i+=e[s]*e[s];return r/(n+i-r)}(t,e)},jeffreys:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*Math.log(t[n]/e[n]);return r},jensenDifference:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]*Math.log(t[n])+e[n]*Math.log(e[n]))/2-(t[n]+e[n])/2*Math.log((t[n]+e[n])/2);return r},jensenShannon:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=t[i]*Math.log(2*t[i]/(t[i]+e[i])),n+=e[i]*Math.log(2*e[i]/(t[i]+e[i]));return(r+n)/2},kdivergence:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*Math.log(2*t[n]/(t[n]+e[n]));return r},kulczynski:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i]),n+=Math.min(t[i],e[i]);return r/n},kullbackLeibler:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*Math.log(t[n]/e[n]);return r},kumarJohnson:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]*t[n]-e[n]*e[n])**2/(2*(t[n]*e[n])**1.5);return r},lorentzian:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.log(Math.abs(t[n]-e[n])+1);return r},manhattan:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.abs(t[n]-e[n]);return r},matusita:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=Math.sqrt(t[n]*e[n]);return Math.sqrt(2-2*r)},minkowski:function(t,e,r){let n=0;for(let i=0;i<t.length;i++)n+=Math.abs(t[i]-e[i])**r;return n**(1/r)},motyka:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.min(t[i],e[i]),n+=t[i]+e[i];return 1-r/n},neyman:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/t[n];return r},pearson:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/e[n];return r},probabilisticSymmetric:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/(t[n]+e[n]);return 2*r},ruzicka:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.min(t[i],e[i]),n+=Math.max(t[i],e[i]);return r/n},soergel:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i]),n+=Math.max(t[i],e[i]);return r/n},sorensen:function(t,e){let r=0,n=0;for(let i=0;i<t.length;i++)r+=Math.abs(t[i]-e[i]),n+=t[i]+e[i];return r/n},squared:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]-e[n])*(t[n]-e[n])/(t[n]+e[n]);return r},squaredChord:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(Math.sqrt(t[n])-Math.sqrt(e[n]))**2;return r},squaredEuclidean:es,taneja:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=(t[n]+e[n])/2*Math.log((t[n]+e[n])/(2*Math.sqrt(t[n]*e[n])));return r},tanimoto:function(t,e,r){if(r)return 1-function(t,e,r){if(r){let r=0,n=0;for(let i=0;i<t.length;i++)r+=t[i]&&e[i],n+=t[i]||e[i];return 0===n?1:r/n}{let r=0,n=0,i=0;for(let s=0;s<t.length;s++)r+=t[s],n+=e[s],i+=Math.min(t[s],e[s]);return 1-(r+n-2*i)/(r+n-i)}}(t,e,r);{let r=0,n=0,i=0;for(let s=0;s<t.length;s++)r+=t[s],n+=e[s],i+=Math.min(t[s],e[s]);return(r+n-2*i)/(r+n-i)}},topsoe:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=t[n]*Math.log(2*t[n]/(t[n]+e[n]))+e[n]*Math.log(2*e[n]/(t[n]+e[n]));return r},waveHedges:function(t,e){let r=0;for(let n=0;n<t.length;n++)r+=1-Math.min(t[n],e[n])/Math.max(t[n],e[n]);return r}}),Ls={};!function(){if(Ds)return Ls;function t(t){if("number"!=typeof t)throw new TypeError("Expected a number")}Ds=1,Ls.ascending=(e,r)=>(t(e),t(r),Number.isNaN(e)?-1:Number.isNaN(r)?1:e-r),Ls.descending=(e,r)=>(t(e),t(r),Number.isNaN(e)?1:Number.isNaN(r)?-1:r-e)}();function qs(t){return t.map(t=>{const e=String(t);return e.length>12?e.slice(0,12)+"...":e})}async function Us(e={}){console.log("RUNNING heatmap_plot()----------------------");const{divid:r="",data:n=t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:i=t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:s=Object.keys(t[0]).slice(0,-1),height:o=900,width:l=400,color:f=["#000080","#ffffff","#d73027"],marginTop:u=10,marginBottom:h=10,marginLeft:c=10,marginRight:p=10,colorScale:d=null,tooltip_decimal:g=2,tooltip_fontFamily:m="monospace",tooltip_fontSize:w="14px"}=e,_=n.flat().filter(t=>Number.isFinite(t));let b=d;if(!Array.isArray(b)||2!==b.length||!b.every(Number.isFinite)){const t=a(_);b=t[0]===t[1]?[t[0]??0,(t[1]??0)+1]:t}const v=(b[0]+b[1])/2,M=Vn().domain([b[0],v,b[1]]).range(f),A=(l-c-p)/n[0].length;console.log("cellWidth:",A);const k=Math.max(A/6,8);console.log("labelFontSizeBottom:",k);const S=Math.min(y(s.map(t=>String(t).length)),13);console.log("maxColLabelLength:",S);const E=Math.max(h,k*(.5*S)+5);console.log("dynamicBottomMargin:",E);const N=(o-u-E)/n.length;console.log("cellHeight:-------------------------",N);const B=Math.max(N/3,7);console.log("labelFontSizeRight:",B);const C=Math.min(y(i.map(t=>String(t).length)),13);console.log("maxRowLabelLength:",C);const I=Math.max(p,B*C*.6+5);console.log("dynamicRightMargin:",I);const P=u,O=c,j=o-P-E,T=l-O-I,$=qs(s),F=qs(i),D=x(n[0].length),V=x(n.length);let L=zn().domain(D).range([0,T]).padding(0),q=zn().domain(V).range([0,j]).padding(0);const U=Jt("svg");U.attr("width",l).attr("height",o),U.append("rect").attr("x",0).attr("y",0).attr("width",l).attr("height",o).attr("fill","#ffffff");const H=U.append("g").attr("transform",`translate(${O}, ${P})`),Y=H.append("g").attr("transform",`translate(0, ${j})`).call(z(L).tickFormat(t=>$[t])).style("font-size",k+"px");Y.selectAll(".tick").selectAll("line").remove(),Y.selectAll("text").style("text-anchor","end").attr("dx","-2px").attr("dy","0.3em").attr("class","xa").attr("transform","rotate(-90)").style("fill","#000");let G=H.append("g").attr("transform",`translate( ${T},0)`).call(R(q).tickFormat(t=>F[t])).attr("id","ya").style("font-size",B+"px");G.selectAll(".tick").selectAll("line").remove(),G.selectAll("text").attr("dx","3px").attr("dy","0.3em").attr("class","yaa").style("text-anchor","start").style("fill","#000");const X=ts().style("border","solid 3px black").style("background-color","white").style("color","#000").style("border-radius","10px").style("float","left").style("font-family",m).style("font-size",w).html((t,e)=>`\n        <div style='float: right; color: #000;'>\n           val:${e.value.toFixed(g)} <br/>\n             row:${i[e.n]}, col:${s[e.t]} \n        </div>`);U.call(X);const W=await async function(t){let e=[];return x(t.length).map(r=>{const n=x(t[0].length).map(e=>({t:e,n:r,value:t[r][e]}));e=[...e,...n]}),e}(n);H.append("g").attr("class","gPoints").selectAll().data(W).enter().append("rect").attr("x",t=>L(t.t)).attr("y",t=>q(t.n)).attr("width",L.bandwidth()).attr("height",q.bandwidth()).attr("fill",t=>M(t.value)).on("mouseover",X.show).on("mouseout",X.hide);const K=T+150,Q=b[0],J=b[1]-Q,Z="legend-gradient-"+Math.random().toString(36).substr(2,9),tt=U.append("defs").append("linearGradient").attr("id",Z).attr("x1","0%").attr("y1","100%").attr("x2","0%").attr("y2","0%");tt.append("stop").attr("offset","0%").attr("stop-color","#000080"),tt.append("stop").attr("offset","50%").attr("stop-color","#ffffff"),tt.append("stop").attr("offset","100%").attr("stop-color","#d73027"),H.append("rect").attr("x",K).attr("y",0).attr("width",30).attr("height",300).style("fill",`url(#${Z})`).style("stroke","#000").style("stroke-width","1px");const et=Vn().domain(b).range([300,0]),rt=[];for(let t=0;t<5;t++)rt.push(Q+t/4*J);const nt=R(et).tickValues(rt).tickFormat(un(".2f")),it=H.append("g").attr("transform",`translate(${K+30}, 0)`).call(nt).style("font-size","14px");if(it.selectAll("text").style("fill","#000"),it.selectAll("line").style("stroke","#000"),it.selectAll("path").style("stroke","#000"),document.getElementById(r)){console.log("plot div provided in function parameters.divid:",r);const t=document.getElementById(r);t.innerHTML="",t.appendChild(U.node())}else if(!document.getElementById("childDiv")){const t=document.createElement("div");document.body.appendChild(t),t.appendChild(U.node())}return U.node()}const Hs=async function(t){const e=t.split(/\r?\n/),r=e[0].split(","),n=[];n.headers=r;for(let t=1;t<e.length-1;t++){const i={},s=e[t].split(",");for(let t=0;t<r.length;t++)i[r[t]]=Ys(s[t]);n.push(i)}return n},Ys=function(t){return isNaN(t)?t:Number(t)},Gs=function(t){return t.filter(t=>"number"==typeof t)},Xs=function(t){return t.filter(t=>"number"!=typeof t)},Ws=function(t){return t.map(t=>{const e={};for(const r in t)"number"==typeof t[r]&&(e[r]=t[r]);return e})},Ks=function(t){return t.map(t=>{const e={};for(const r in t)"number"!=typeof t[r]&&(e[r]=t[r]);return e})},Qs=function(t){if(null==t)throw new Error("No data passed to function.");if(!Array.isArray(t)||"object"!=typeof t[0]||null===t[0])throw new Error("First argument must be an array of objects");const e=t;if(!t.columns){const t=new Set;for(const r of e)for(const e of Object.keys(r))t.add(e);e.columns=[...t]}return e.columns.forEach(t=>{Object.getOwnPropertyDescriptor(e,t)||Object.defineProperty(e,t,{get:function(){return this.map(e=>e[t])},set:function(e){if(!e)throw new Error(`No data passed to set ${t} column.`);if(e.length!==this.length)throw new Error(`Data length (${e.length}) different from column ${t} length (${this.length}).`);this.forEach((r,n)=>r[t]=e[n])}})}),e},Js=async function(t){const e=await Promise.resolve().then(function(){return qn}),r=JSON.parse(JSON.stringify(t)),n=Qs(r);return n.columns.forEach(t=>{const r=n[t],i=e.mean(r),s=e.deviation(r);n[t]=r.map(t=>null!=t?(t-i)/s:t)}),n},Zs=async function(t,e){const r=document.getElementById(e);r.innerHTML="";const n=t.split("\n");for(const t of n){const e=t.split(","),n=document.createElement("tr");for(const t of e){const e=document.createElement("td");e.textContent=t,n.appendChild(e)}r.appendChild(n)}},to=async function(t={}){const{text:e="No text provided",divid:r="",width:n=460,height:i=150,border:s="2px solid",color:o="red"}=t;if(document.getElementById(r)){console.log("textbox div provided in function parameters.");const t=document.getElementById(r);t.id=r,t.style.display="block",t.style.overflow="auto",t.style.width=n+"px",t.style.height=i+"px",t.style.border=s+" "+o,t.style.resize="both",t.style.boxSizing="border-box",t.style.margin="8px 0",Zs(e,r)}else if(document.getElementById("textboxDiv"))console.log("textbox div exists. updating contents..."),Zs(e,"textboxDiv");else{const t=r||"textboxDiv";console.log(`textbox div NOT provided or not found. creating element with id: ${t}`);const l=document.createElement("table");l.id=t,document.body.appendChild(l),Zs(e,t),l.style.display="block",l.style.overflow="auto",l.style.width=n+"px",l.style.height=i+"px",l.style.border=s+" "+o,l.style.resize="both",l.style.boxSizing="border-box",l.style.margin="8px 0"}return document.getElementById(r||"textboxDiv")},eo={data:{divNum:1,iris:{json:t,csv:null},file:{json:null,csv:null}}},ro=t=>t[0].map((e,r)=>t.map(t=>t[r]));function no(t,e){return t.map(t=>{const r=String(e[t]);return r.length>12?r.slice(0,12)+"...":r})}async function io(e={}){console.log("RUNNING hclust_plot()-------------------------------");const{divid:r="",data:n=t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:i=t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:s=Object.keys(t[0]).slice(0,-1),width:o=400,height:l=2e3,clusterCols:f=!0,clusterRows:u=!0,clusteringDistanceRows:h="euclidean",clusteringDistanceCols:c="euclidean",clusteringMethodCols:p="complete",clusteringMethodRows:d="complete",marginTop:g=(f?100:53),marginLeft:m=(u?200:80),colPadding:w=(f?60:0),rowPadding:_=(u?15:0),dendogram_font:b="14px",colDendoColor:M="black",rowDendoColor:A="black",heatmapColor:k="green",heatmapColorScale:S=null,tooltip_decimal:E=2,tooltip_fontFamily:N="monospace",tooltip_fontSize:B="14px"}=e,C=Mn(new Ts(ns(ro(n),Vs[c]),{method:p,isDistanceMatrix:!0}));vn()(C);const I=Mn(new Ts(ns(n,Vs[h]),{method:d,isDistanceMatrix:!0}));vn()(I);let P=f?C.leaves().map(t=>t.data.index):x(n[0].length),O=u?I.leaves().map(t=>t.data.index):x(n.length);const j=ro(P.map(t=>ro(O.map(t=>n[t]))[t]));let T=s?no(P,s):Array.from(new Array(n[0].length),(t,e)=>e+1),$=i?no(O,i):Array.from(new Array(n[0].length),(t,e)=>e+1);y(T.map(t=>t.length));const F=y($.map(t=>String(t).length)),D=n.flat().filter(t=>Number.isFinite(t));let V=S;if(!Array.isArray(V)||2!==V.length||!V.every(Number.isFinite)){const At=a(D);V=At[0]===At[1]?[At[0]??0,(At[1]??0)+1]:At}const L=(V[0]+V[1])/2,q=Vn().domain([V[0],L,V[1]]).range(["#000080","#ffffff","#d73027"]),U=(o-m-300)/n[0].length,H=Math.max(U/6,8),Y=Math.min(y(T.map(t=>String(t).length)),13),G=Math.max(140,H*Y*.5+5),X=(l-g-G)/n.length,W=Math.max(X/3,7),K=Math.min(y($.map(t=>String(t).length)),13),Q=Math.max(300,W*K*.6+170),J=g,Z=m,tt=Q,et=l-J-G,rt=o-Z-tt,nt=x(n[0].length),it=x(n.length);let st=zn().domain(nt).range([0,rt]).padding(0),ot=zn().domain(it).range([0,et]).padding(0);const lt=Jt("svg");lt.attr("width",o).attr("height",l),lt.append("rect").attr("x",0).attr("y",0).attr("width",o).attr("height",l).attr("fill","#ffffff");const at=lt.append("g").attr("transform",`translate(${Z}, ${J})`),ft=at.append("g").attr("transform",`translate(0, ${et})`).call(z(st).tickFormat(t=>T[t])).style("font-size",H+"px");ft.selectAll(".tick").selectAll("line").remove(),ft.selectAll("text").style("text-anchor","end").attr("dx","-2px").attr("dy","0.3em").attr("class","xa").attr("transform","rotate(-90)").style("fill","#000");let ut=at.append("g").attr("transform",`translate(${rt}, 0)`).call(R(ot).tickFormat(t=>$[t])).style("font-size",W+"px").attr("id","ya");ut.selectAll(".tick").selectAll("line").remove(),ut.selectAll("text").attr("dx","3px").attr("dy","0.3em").attr("class","yaa").style("text-anchor","start").style("fill","#000");const ht=ts().style("border","solid 3px black").style("background-color","white").style("border-radius","10px").style("float","left").style("color","#000").style("font-family",N).style("font-size",B).html((t,e)=>`\n          <div style='float: right; color: #000;'>\n           value:${e.value.toFixed(E)} <br/>\n           row:${$[e.n]}, col:${T[e.t]} \n        </div>`),ct=await async function(t){let e=[];return x(t.length).map(r=>{const n=x(t[0].length).map(e=>({t:e,n:r,value:t[r][e]}));e=[...e,...n]}),e}(j),pt=at.append("g").attr("class","gPoints");lt.call(ht),pt.selectAll().data(ct).enter().append("rect").attr("x",t=>st(t.t)).attr("y",t=>ot(t.n)).attr("width",st.bandwidth()).attr("height",ot.bandwidth()).attr("fill",t=>q(t.value)).on("mouseover",ht.show).on("mouseout",ht.hide);const dt=rt+150,gt=V[0],mt=V[1]-gt,wt="legend-gradient-"+Math.random().toString(36).substr(2,9),_t=lt.append("defs").append("linearGradient").attr("id",wt).attr("x1","0%").attr("y1","100%").attr("x2","0%").attr("y2","0%");_t.append("stop").attr("offset","0%").attr("stop-color","#000080"),_t.append("stop").attr("offset","50%").attr("stop-color","#ffffff"),_t.append("stop").attr("offset","100%").attr("stop-color","#d73027"),at.append("rect").attr("x",dt).attr("y",0).attr("width",30).attr("height",300).style("fill",`url(#${wt})`).style("stroke","#000").style("stroke-width","1px");const yt=Vn().domain(V).range([300,0]),bt=[];for(let kt=0;kt<5;kt++)bt.push(gt+kt/4*mt);const vt=R(yt).tickValues(bt).tickFormat(un(".2f")),xt=at.append("g").attr("transform",`translate(${dt+30}, 0)`).call(vt).style("font-size","14px");xt.selectAll("text").style("fill","#000"),xt.selectAll("line").style("stroke","#000"),xt.selectAll("path").style("stroke","#000");const Mt=ts().style("border","solid 3px black").style("background-color","white").style("border-radius","10px").style("float","left").style("color","#000").style("font-family",N).style("font-size",B).html((t,e)=>`\n<div style='float: right; color: #000;'>\n   Height:${e.source.data.height.toFixed(3)} <br/>\n</div>`);if(1==f){function St(t){const e=w;return t.data.height/Et*e}const Et=Math.max(C.data.height,1),Nt=C.descendants().reverse(),Bt=Nt.filter(t=>!t.children);Bt.sort((t,e)=>t.x-e.x);const Ct=(o-Z-tt)/Bt.length;Bt.forEach((t,e)=>t.x=e*Ct+Ct/2),Nt.forEach(t=>{t.children&&(t.x=v(t.children,t=>t.x))}),lt.call(Mt);const Rt=(o-Z-tt)/2,zt=w/2,It=J-w-5;C.links().forEach((t,e)=>{var r;lt.append("path").attr("class","link").attr("stroke",t.source.color||`${M}`).attr("stroke-width","3px").attr("fill","none").attr("transform",`translate(${Z}, ${It}) rotate(180, ${Rt}, ${zt})`).attr("d",(r=t,"M"+r.source.x+","+St(r.source)+"H"+r.target.x+"V"+St(r.target))).on("mouseover",Mt.show).on("mouseout",Mt.hide)})}if(1==u){function Pt(t){const e=Z-_;return e-t.data.height/Ot*e}const Ot=I.data.height+2;vn()(I);const jt=I.descendants().reverse(),Tt=jt.filter(t=>!t.children);Tt.sort((t,e)=>t.x-e.x);const $t=et/Tt.length;Tt.forEach((t,e)=>t.x=e*$t+$t/2),jt.forEach(t=>{t.children&&(t.x=v(t.children,t=>t.x))}),lt.call(Mt),I.links().forEach((t,e)=>{var r;lt.append("path").attr("class","link").attr("stroke",t.source.color||`${A}`).attr("stroke-width","3px").attr("fill","none").attr("transform",`translate(${F},${J})`).attr("d",(r=t,"M"+Pt(r.source)+","+r.source.x+"V"+r.target.x+"H"+Pt(r.target))).on("mouseover",Mt.show).on("mouseout",Mt.hide)}),lt.selectAll("path").data(I.links())}if(document.getElementById(r)){const Ft=document.getElementById(r);Ft.innerHTML="",Ft.appendChild(lt.node()),console.log("plot div provided in function parameters.divid:",r)}else if(!document.getElementById("childDiv")){const Dt=eo.data.divNum,Vt=document.createElement("div");Vt.id=r||"hclust_plot"+Dt,console.log("div  NOT provided in function options or doesn't exist... created a new div with id: ",Vt.id,"and appended to document body!"),document.body.appendChild(Vt),Vt.appendChild(lt.node()),eo.data.divNum=Dt+1}return lt.node()}async function so(e={}){console.log("RUNNING hclust_UI()-------------------------------"),console.log("hclust UI div num",eo.data.divNum);const{divid:r=""}=e;let n=document.getElementById(r);document.getElementById(r)?(console.log("hclust_UI() div ID provided, loading div:",n),await Us({data:newMatrix2,rownames:rowNames2,colnames:colNames2,width:width-marginLeft-dynamicRightMargin,height:height-marginTop-dynamicBottomMargin,divid:r})):(console.log("hclust_UI() div NOT provided. creating div...",n),n=document.createElement("div"),n.id="loadUI"+eo.data.divNum,n.style.alignContent="center",document.body.appendChild(n),console.log("hclust_UI() div NOT provided. creating div...",n));const i=document.createElement("button");i.id="irisDataButton"+eo.data.divNum,i.textContent="Load Iris Data",n.appendChild(i),console.log("hclustUI: irisDataButton:",document.getElementById(i.id));const s=document.createElement("input");s.id="fileInput"+eo.data.divNum,s.setAttribute("type","file"),n.appendChild(s),n.append(document.createElement("br")),n.append(document.createElement("br"));const o=document.createElement("div");o.id="hcplotDiv"+eo.data.divNum,n.appendChild(o),console.log("hclustUI: plotDiv:",document.getElementById(o.id));const l=document.createElement("div");l.id="textBoxDiv"+eo.data.divNum,l.style.alignContent="center",n.appendChild(l),console.log("hclustUI: textBoxDiv:",document.getElementById(l.id)),s.addEventListener("change",t=>{console.log(eo.data.divNum,"fileInput button clicked!");const e=t.target.files;for(const r of e){const e=new FileReader;e.onload=e=>{const r=t.target.files[0];if(r){const t=new FileReader;t.onload=async function(t){const e=t.target.result,r=await Hs(e);console.log("hclustDt.data.divNum",eo.data.divNum);if(r.map(Object.values).headers=r.headers,eo.data.file=[],eo.data.file.json=r,eo.data.file.csv=e,!document.getElementById("rowCluster"+eo.data.divNum)){console.log("*********",!document.getElementById("rowCluster"+eo.data.divNum));const t=document.createElement("button");t.id="rowCluster"+eo.data.divNum,t.textContent="Cluster by Rows",n.appendChild(t),console.log("hclustUI: rowCluster:",document.getElementById(t.id));const e=document.createElement("button");e.id="colCluster"+eo.data.divNum,e.textContent="Cluster by Columns",n.appendChild(e),n.append(document.createElement("br")),n.append(document.createElement("br"))}console.log("load iris data button for Hclust clicked!"),io({data:eo.data.file.json.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:eo.data.file.json.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(eo.data.file.json[0]).slice(0,-1),divid:o.id,clusterCols:!1,clusterRows:!1})},t.onerror=function(){displayError("Error reading the file.")},t.readAsText(r)}},e.readAsText(r)}}),document.getElementById(i.id).addEventListener("click",async function(){let e=!1,r=!1;if(!document.getElementById("rowCluster"+eo.data.divNum)){console.log("*********",!document.getElementById("rowCluster"+eo.data.divNum));const t=document.createElement("button");t.id="rowCluster"+eo.data.divNum,t.textContent="Cluster by Rows",n.appendChild(t),console.log("hclustUI: rowCluster:",document.getElementById(t.id));const e=document.createElement("button");e.id="colCluster"+eo.data.divNum,e.textContent="Cluster by Columns",n.appendChild(e),n.append(document.createElement("br")),n.append(document.createElement("br"))}console.log("load iris data button for Hclust clicked!"),io({data:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:o.id,clusterCols:r,clusterRows:e}),document.getElementById("rowCluster"+eo.data.divNum).addEventListener("click",async function(){console.log(document.getElementById("rowCluster"+eo.data.divNum)),console.log("clusterRows",e),0==e?e=!0:1==e&&(e=!1),console.log("clusterRows",e),io({data:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:o.id,clusterCols:r,clusterRows:e})}),document.getElementById("colCluster"+eo.data.divNum).addEventListener("click",async function(){console.log(document.getElementById("colCluster"+eo.data.divNum)),console.log("clusterCols",r),0==r?r=!0:1==r&&(r=!1),console.log("clusterCols",r),io({data:t.map(t=>Object.values(t)).map(t=>t.slice(0,-1)),rownames:t.map(t=>Object.values(t)).map((t,e)=>t[4]+e),colnames:Object.keys(t[0]).slice(0,-1),divid:o.id,clusterCols:r,clusterRows:e})})}),console.log(`rowCluster${eo.data.divNum}`),console.log(document.getElementById(`rowCluster${eo.data.divNum}`)),eo.data.divNum+=1}class oo{constructor(t,e={},r){if(this.U=null,this.S=null,r)return this.center=r.center,this.scale=r.scale,this.means=r.means,this.stdevs=r.stdevs,this.U=ms.checkMatrix(r.U),this.S=r.S,this.R=r.R,void(this.excludedFeatures=r.excludedFeatures||[]);let n;n=(Array.isArray(t),new ms(t));const{isCovarianceMatrix:i=!1,method:s="SVD",nCompNIPALS:o=2,center:l=!0,scale:a=!1,ignoreZeroVariance:f=!1}=e;if(this.center=l,this.scale=a,this.means=null,this.stdevs=null,this.excludedFeatures=[],i)this._computeFromCovarianceMatrix(n);else switch(this._adjust(n,f),s){case"covarianceMatrix":{const t=new ws(n).mmul(n).div(n.rows-1);this._computeFromCovarianceMatrix(t);break}case"NIPALS":this._computeWithNIPALS(n,o);break;case"SVD":{const t=new ys(n,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=t.rightSingularVectors;const e=t.diagonal,r=[];for(const t of e)r.push(t*t/(n.rows-1));this.S=r;break}default:throw new Error(`unknown method: ${s}`)}}static load(t){if("string"!=typeof t.name)throw new TypeError("model must have a name property");if("PCA"!==t.name)throw new RangeError(`invalid model: ${t.name}`);return new oo(void 0,void 0,t)}predict(t,e={}){const{nComponents:r=this.U.columns}=e;let n;if(n=(Array.isArray(t),new ms(t)),this.center&&(n.subRowVector(this.means),this.scale)){for(let t of this.excludedFeatures)n.removeColumn(t);n.divRowVector(this.stdevs)}let i=n.mmul(this.U);return i.subMatrix(0,i.rows-1,0,r-1)}invert(t){let e=(t=ms.checkMatrix(t)).mmul(this.U.transpose());return this.center&&(this.scale&&e.mulRowVector(this.stdevs),e.addRowVector(this.means)),e}getExplainedVariance(){let t=0;if(this.S)for(const e of this.S)t+=e;return this.S?this.S.map(e=>e/t):[]}getCumulativeVariance(){let t=this.getExplainedVariance();for(let e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(t=>Math.sqrt(t))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S,excludedFeatures:this.excludedFeatures}}_adjust(t,e){if(this.center){const r=t.mean("column"),n=this.scale?t.standardDeviation("column",{mean:r}):null;if(this.means=r,t.subRowVector(r),this.scale){for(let r=0;r<n.length;r++)if(0===n[r]){if(!e)throw new RangeError(`Cannot scale the dataset (standard deviation is zero at index ${r}`);t.removeColumn(r),n.splice(r,1),this.excludedFeatures.push(r),r--}this.stdevs=n,t.divRowVector(n)}}}_computeFromCovarianceMatrix(t){const e=new gs(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix,this.U.flipRows(),this.S=e.realEigenvalues,this.S.reverse()}_computeWithNIPALS(t,e){this.U=new ms(e,t.columns),this.S=[];let r=t;for(let t=0;t<e;t++){let e=new _s(r);this.U.setRow(t,e.w.transpose()),this.S.push(Math.pow(e.s.get(0,0),2)),r=e.xResidual}this.U=this.U.transpose()}}const lo={data:{divNum:1,iris:{json:t,csv:null},file:{json:null,csv:null}}};function ao(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),s=Zt(".points").filter(t=>t.group===e),o=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),o.transition().attr("opacity",.1),s.transition().attr("opacity",r),i.transition().attr("opacity",r)}async function fo(e={}){console.log("RUNNING: pca_plot() function----------");const{divid:r="",data:n=t,width:i=600,height:s=300,colors:o=["red","blue","green","orange","purple","pink","yellow"]}=e;let l=r?document.getElementById(r):null;if(l)console.log("div provided in function parameters:",r),l.innerHTML="";else{const t=lo.data.divNum;l=document.createElement("div"),l.id=r||"pca_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",l.id,"and appended to document body!"),document.body.appendChild(l),lo.data.divNum=t+1}const f=await async function(t){const e=Ws(t);let r=(await Js(e)).map(Object.values);const n=new oo(r,{center:!0,scale:!0}),i=t[0]||{},s=Object.keys(i).find(t=>"number"!=typeof i[t]);return n.predict(r).toJSON().map((e,r)=>({group:s?t[r]?.[s]:"row_"+r,name:"id_"+r,PC1:e[0],PC2:e[1]}))}(n),u=[...new Set(f.map(t=>t.group))],h=Rn(o).domain(u),c=25,p=170,d=45,g=45,m=b(f,t=>t.PC1),w=y(f,t=>t.PC1),_=w-m,v=m-.1*_,x=w+.1*_,M=Vn().domain([v,x]).range([g,i-p]),A=Vn().domain(a(f,t=>t.PC2)).range([s-d,c]),k=Jt("svg").style("background","white").style("overflow","visible");k.attr("id","svgid"),k.append("text").attr("x",i/2-g).attr("y",c/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("PCA Plot");const S=k.attr("width",i).attr("height",s).append("g");S.append("g").call(t=>t.attr("transform",`translate(0,${s-d+5})`).call(z(M).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-p).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("PC1"))),S.append("g").call(t=>t.attr("transform",`translate(${g-5},0)`).call(I(A).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",c-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("PC2"))),S.append("rect").attr("id","background").attr("x",g).attr("y",c).attr("width",i-g-p).attr("height",s-c-d).attr("fill","white").on("click",(t,e)=>ao(0,e,.7));const E=S.append("g").attr("class","gPoints").style("isolation","isolate"),N=ts().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n          <div style='line-height: 1.5;'>\n            <div><strong>Name:</strong> ${e.name}</div>\n            <div><strong>PC1:</strong> ${e.PC1.toFixed(2)}</div>\n            <div><strong>PC2:</strong> ${e.PC2.toFixed(2)}</div>\n          </div>`);k.call(N),E.selectAll("circle").data(f).enter().append("circle").attr("class","points").attr("cx",t=>M(t.PC1)).attr("cy",t=>A(t.PC2)).attr("fill",t=>h(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",N.show).on("mouseout",N.hide);const B=S.append("g").selectAll("rect").data(u);B.enter().append("rect").attr("class","keyRects").attr("x",i-g-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>h(t)).on("click",(t,e)=>ao(0,e,.7)),B.enter().append("text").attr("x",t=>i-g-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>ao(0,e,.7)),l.appendChild(k.node())}async function uo(e={}){console.log("RUNNING pca_UI()-------------------------------");const{divid:r="",data:n=t,width:i=600,height:s=300,colors:o=["red","blue","green","orange","purple","pink","yellow"],loadIrisOnStart:l=!1}=e,a=lo.data.divNum;let f=r?document.getElementById(r):null;f?(console.log("plot div provided in function parameters. divid:",r),f.innerHTML=""):(f=document.createElement("div"),f.id=r||"pca_UI"+a,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",f.id,"and appended to document body!"),document.body.appendChild(f));const u=document.createElement("div");u.id="loadingMessage_"+a,u.style.display="none",u.style.padding="10px",u.style.margin="10px 0",u.style.backgroundColor="#e3f2fd",u.style.border="1px solid #2196F3",u.style.borderRadius="4px",u.textContent="Processing data...";const h=document.createElement("div");h.id="errorMessage_"+a,h.style.display="none",h.style.padding="10px",h.style.margin="10px 0",h.style.backgroundColor="#ffebee",h.style.border="1px solid #f44336",h.style.borderRadius="4px",h.style.color="#c62828";const c=document.createElement("button");c.id="irisDataButton_"+a,c.textContent="Load Iris Data",c.setAttribute("aria-label","Load built-in iris dataset"),c.style.marginRight="10px",c.style.padding="5px 10px";const p=document.createElement("input");p.id="fileInput_"+a,p.setAttribute("type","file"),p.setAttribute("accept",".csv"),p.setAttribute("aria-label","Upload CSV file for PCA analysis");const d=document.createElement("label");d.setAttribute("for",p.id),d.textContent="Or upload CSV file: ",d.style.marginLeft="10px",f.appendChild(c),f.appendChild(d),f.appendChild(p),f.appendChild(document.createElement("br")),f.appendChild(u),f.appendChild(h),f.appendChild(document.createElement("br"));const g=document.createElement("div");g.id="pcaplotDiv_"+a,f.appendChild(g);const m=document.createElement("div");m.id="textBoxDiv_"+a,m.style.alignContent="center",f.appendChild(m);const w=t=>{h.textContent=t,h.style.display="block",u.style.display="none"},_=async(t,e)=>{try{u.style.display="block",h.style.display="none";const r=Ws(t);if(0===r.length||0===Object.keys(r[0]).length)throw new Error("No numeric columns found in data. PCA requires numeric data.");g.innerHTML="",m.innerHTML="",await fo({data:t,divid:g.id,width:i,height:s,colors:o}),await to({text:e,divid:m.id}),u.style.display="none"}catch(t){console.error("Error rendering data:",t),w(`Error: ${t.message}`)}},y=async t=>{const e=t.target.files[0];if(!e)return;if(console.log(a,"fileInput button clicked!"),!e.name.endsWith(".csv"))return void w("Please upload a CSV file.");const r=new FileReader;r.onload=async function(t){try{const e=t.target.result;if(!e||0===e.trim().length)throw new Error("File is empty.");const r=await Hs(e);if(!r||0===r.length)throw new Error("No valid data found in CSV file.");lo.data.file.json=r,lo.data.file.csv=e,await _(r,e)}catch(t){console.error("Error processing file:",t),w(`Error processing file: ${t.message}`)}},r.onerror=function(){w("Error reading the file. Please try again.")},r.readAsText(e)};p.removeEventListener("change",y),p.addEventListener("change",y);const b=async function(){console.log(a,"load iris data button clicked!"),await _(lo.data.iris.json,lo.data.iris.csv)};return c.removeEventListener("click",b),c.addEventListener("click",b),l&&await _(lo.data.iris.json,lo.data.iris.csv),lo.data.divNum+=1,f}var ho,co,po={},go={};var mo=(co||(co=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TSNE=void 0;var e=(ho||(ho=1,Object.defineProperty(go,"__esModule",{value:!0}),go.TSNE=void 0,go.TSNE=class{constructor(t){this.returnV=!1,this.vValue=0,this.iter=0,t=t||{},this.perplexity=this.getopt(t,"perplexity",30),this.dim=this.getopt(t,"dim",2),this.epsilon=this.getopt(t,"epsilon",10)}assert(t,e){if(!t)throw e||"Assertion failed"}getopt(t,e,r){return t.hasOwnProperty(e)?t[e]:r}gaussRandom(){if(this.returnV)return this.returnV=!1,this.vValue;const t=2*Math.random()-1,e=2*Math.random()-1,r=t*t+e*e;if(0===r||r>1)return this.gaussRandom();const n=Math.sqrt(-2*Math.log(r)/r);return this.vValue=e*n,this.returnV=!0,t*n}randn(t,e){return t+this.gaussRandom()*e}zeros(t){if(void 0===t||isNaN(t))return[];if("undefined"==typeof ArrayBuffer){const e=new Array(t);for(let r=0;r<t;r++)e[r]=0;return e}return new Float64Array(t)}randn2d(t,e,r){const n=void 0!==r,i=[];for(let s=0;s<t;s++){const t=[];for(let i=0;i<e;i++)n?t.push(r):t.push(this.randn(0,1e-4));i.push(t)}return i}L2(t,e){const r=t.length;let n=0;for(let i=0;i<r;i++){const r=t[i],s=e[i];n+=(r-s)*(r-s)}return n}xtod(t){const e=t.length,r=this.zeros(e*e);for(let n=0;n<e;n++)for(let i=n+1;i<e;i++){const s=this.L2(t[n],t[i]);r[n*e+i]=s,r[i*e+n]=s}return r}d2p(t,e,r){const n=Math.sqrt(t.length),i=Math.floor(n);this.assert(i===n,"D should have square number of elements.");const s=Math.log(e),o=this.zeros(i*i),l=this.zeros(i);for(let e=0;e<i;e++){let n=-1/0,a=1/0,f=1,u=!1;const h=50;let c=0;for(;!u;){let o=0;for(let r=0;r<i;r++){let n=Math.exp(-t[e*i+r]*f);e===r&&(n=0),l[r]=n,o+=n}let p=0;for(let t=0;t<i;t++){let e;e=0===o?0:l[t]/o,l[t]=e,e>1e-7&&(p-=e*Math.log(e))}p>s?(n=f,a===1/0?f*=2:f=(f+a)/2):(a=f,n===-1/0?f/=2:f=(f+n)/2),c++,Math.abs(p-s)<r&&(u=!0),c>=h&&(u=!0)}for(let t=0;t<i;t++)o[e*i+t]=l[t]}const a=this.zeros(i*i),f=2*i;for(let t=0;t<i;t++)for(let e=0;e<i;e++)a[t*i+e]=Math.max((o[t*i+e]+o[e*i+t])/f,1e-100);return a}sign(t){return t>0?1:t<0?-1:0}initDataRaw(t){const e=t.length,r=t[0].length;this.assert(e>0," X is empty? You must have some data!"),this.assert(r>0," X[0] is empty? Where is the data?");const n=this.xtod(t);this.P=this.d2p(n,this.perplexity,1e-4),this.N=e,this.initSolution()}initDataDist(t){const e=t.length;this.assert(e>0," X is empty? You must have some data!");const r=this.zeros(e*e);for(let n=0;n<e;n++)for(let i=n+1;i<e;i++){const s=t[n][i];r[n*e+i]=s,r[i*e+n]=s}this.P=this.d2p(r,this.perplexity,1e-4),this.N=e,this.initSolution()}initSolution(){this.Y=this.randn2d(this.N,this.dim),this.gains=this.randn2d(this.N,this.dim,1),this.ystep=this.randn2d(this.N,this.dim,0),this.iter=0}getSolution(){return this.Y}step(){this.iter+=1;const t=this.N,e=this.costGrad(this.Y),r=e.cost,n=e.grad,i=this.zeros(this.dim);for(let e=0;e<t;e++)for(let t=0;t<this.dim;t++){const r=n[e][t],s=this.ystep[e][t],o=this.gains[e][t];let l=this.sign(r)===this.sign(s)?.8*o:o+.2;l<.01&&(l=.01),this.gains[e][t]=l;const a=(this.iter<250?.5:.8)*s-this.epsilon*l*n[e][t];this.ystep[e][t]=a,this.Y[e][t]+=a,i[t]+=this.Y[e][t]}for(let e=0;e<t;e++)for(let r=0;r<this.dim;r++)this.Y[e][r]-=i[r]/t;return r}debugGrad(){const t=this.N,e=this.costGrad(this.Y);e.cost;const r=e.grad,n=1e-5;for(let e=0;e<t;e++)for(let t=0;t<this.dim;t++){const i=this.Y[e][t];this.Y[e][t]=i+n;const s=this.costGrad(this.Y);this.Y[e][t]=i-n;const o=this.costGrad(this.Y),l=r[e][t],a=(s.cost-o.cost)/(2*n);console.log(e+","+t+": gradcheck analytic: "+l+" vs. numerical: "+a),this.Y[e][t]=i}}costGrad(t){const e=this.N,r=this.dim,n=this.P,i=this.iter<100?4:1,s=this.zeros(e*e);let o=0;for(let n=0;n<e;n++)for(let i=n+1;i<e;i++){let l=0;for(let e=0;e<r;e++){const r=t[n][e]-t[i][e];l+=r*r}const a=1/(1+l);s[n*e+i]=a,s[i*e+n]=a,o+=2*a}const l=e*e,a=this.zeros(l);for(let t=0;t<l;t++)a[t]=Math.max(s[t]/o,1e-100);let f=0;const u=[];for(let o=0;o<e;o++){const l=new Array(r);for(let t=0;t<r;t++)l[t]=0;for(let u=0;u<e;u++){f+=-n[o*e+u]*Math.log(a[o*e+u]);const h=4*(i*n[o*e+u]-a[o*e+u])*s[o*e+u];for(let e=0;e<r;e++)l[e]+=h*(t[o][e]-t[u][e])}u.push(l)}return{cost:f,grad:u}}}),go);Object.defineProperty(t,"TSNE",{enumerable:!0,get:function(){return e.TSNE}})}(po)),po);const wo={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};async function _o(e={}){console.log("RUNNING: tsne_plot() function----------");const{divid:r="",data:n=t,width:i=600,height:s=300,colors:o=["red","blue","green","orange","purple","pink","yellow"],perplexity:l=30,epsilon:f=10,iterations:u=1e3}=e;let h=r?document.getElementById(r):null;if(h)console.log("plot div provided in function parameters. divid:",r),h.innerHTML="";else{const t=wo.data.divNum;h=document.createElement("div"),h.id=r||"tsne_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",h.id),document.body.appendChild(h),wo.data.divNum=t+1}const c=n[0]||{},p=Object.keys(c),d=p.filter(t=>"number"==typeof c[t]),g=p.find(t=>"number"!=typeof c[t]),m=n.map(t=>d.map(e=>t[e])),w=g?n.map(t=>t[g]):n.map((t,e)=>`row${e}`),_=function(t){const e=t.length,r=t[0].length,n=Array(r).fill(0),i=Array(r).fill(0);for(const e of t)for(let t=0;t<r;t++)n[t]+=e[t];for(let t=0;t<r;t++)n[t]/=e;for(const e of t)for(let t=0;t<r;t++)i[t]+=(e[t]-n[t])**2;for(let t=0;t<r;t++)i[t]=Math.sqrt(i[t]/(e-1))||1;return t.map(t=>t.map((t,e)=>(t-n[e])/i[e]))}(m),v=new mo.TSNE({dim:2,perplexity:l,earlyExaggeration:4,learningRate:f,nIter:u,metric:"euclidean"});v.initDataRaw(_),v.initSolution();for(let t=0;t<u;t++)v.step();const x=v.getSolution().map((t,e)=>({group:w[e],name:g?String(w[e])+"_"+e:"id_"+e,tSNE1:t[0],tSNE2:t[1]})),M=[...new Set(x.map(t=>t.group))],A=Rn(o).domain(M),k=25,S=170,E=45,N=45,B=b(x,t=>t.tSNE1),C=y(x,t=>t.tSNE1),R=C-B,P=B-.1*R,O=C+.1*R,j=Vn().domain([P,O]).range([N,i-S]),T=Vn().domain(a(x,t=>t.tSNE2)).range([s-E,k]),$=Jt("svg").style("background","white").style("overflow","visible");$.attr("id","svgid_tsne"),$.append("text").attr("x",i/2-N).attr("y",k/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("t-SNE Plot");const F=$.attr("width",i).attr("height",s).append("g");F.append("g").call(t=>t.attr("transform",`translate(0,${s-E+5})`).call(z(j).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-S).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("t-SNE 1"))),F.append("g").call(t=>t.attr("transform",`translate(${N-5},0)`).call(I(T).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",k-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("t-SNE 2"))),F.append("rect").attr("id","background").attr("x",N).attr("y",k).attr("width",i-N-S).attr("height",s-k-E).attr("fill","white").on("click",(t,e)=>q(null,e,.7));const D=F.append("g").attr("class","gPoints").style("isolation","isolate"),V=ts().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n      <div style='line-height: 1.5;'>\n        <div><strong>Name:</strong> ${e.name}</div>\n        <div><strong>t-SNE 1:</strong> ${e.tSNE1.toFixed(2)}</div>\n        <div><strong>t-SNE 2:</strong> ${e.tSNE2.toFixed(2)}</div>\n      </div>`);$.call(V),D.selectAll("circle").data(x).enter().append("circle").attr("class","points").attr("cx",t=>j(t.tSNE1)).attr("cy",t=>T(t.tSNE2)).attr("fill",t=>A(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",V.show).on("mouseout",V.hide);const L=F.append("g").selectAll("rect").data(M);function q(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),s=Zt(".points").filter(t=>t.group===e),o=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),o.transition().attr("opacity",.1),s.transition().attr("opacity",r),i.transition().attr("opacity",r)}L.enter().append("rect").attr("class","keyRects").attr("x",i-N-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>A(t)).on("click",(t,e)=>q(null,e,.7)),L.enter().append("text").attr("x",t=>i-N-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>q(null,e,.7)),h.appendChild($.node())}const yo=async(t={})=>{console.log("t-SNE UI - not yet implemented"),console.log("Options:",t)};var bo,vo,xo={},Mo={},Ao={},ko={};function So(){if(bo)return ko;bo=1;var t=ko&&ko.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function e(t,e){return Math.floor(e()*t)}function r(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e}function n(t,e){return r(t).map(function(){return e})}function i(t){return n(t,0)}function s(t){return t.reduce(function(t,e){return t+e})}return Object.defineProperty(ko,"__esModule",{value:!0}),ko.reshape2d=ko.rejectionSample=ko.max2d=ko.max=ko.mean=ko.sum=ko.linear=ko.ones=ko.zeros=ko.filled=ko.range=ko.empty=ko.norm=ko.tauRand=ko.tauRandInt=void 0,ko.tauRandInt=e,ko.tauRand=function(t){return t()},ko.norm=function(e){var r,n,i=0;try{for(var s=t(e),o=s.next();!o.done;o=s.next()){var l=o.value;i+=Math.pow(l,2)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return Math.sqrt(i)},ko.empty=r,ko.range=function(t){return r(t).map(function(t,e){return e})},ko.filled=n,ko.zeros=i,ko.ones=function(t){return n(t,1)},ko.linear=function(t,e,n){return r(n).map(function(r,i){return t+i*((e-t)/(n-1))})},ko.sum=s,ko.mean=function(t){return s(t)/t.length},ko.max=function(t){for(var e=0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return e},ko.max2d=function(t){for(var e=0,r=0;r<t.length;r++)for(var n=0;n<t[r].length;n++)e=t[r][n]>e?t[r][n]:e;return e},ko.rejectionSample=function(t,r,n){for(var s=i(t),o=0;o<t;o++)for(var l=!0;l;){for(var a=e(r,n),f=!1,u=0;u<o;u++)if(a===s[u]){f=!0;break}f||(l=!1),s[o]=a}return s},ko.reshape2d=function(t,e,r){var n=[],i=0;if(t.length!==e*r)throw new Error("Array dimensions must match input length.");for(var s=0;s<e;s++){for(var o=[],l=0;l<r;l++)o.push(t[i]),i+=1;n.push(o)}return n},ko}function Eo(){if(vo)return Ao;vo=1;var t=Ao&&Ao.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=Ao&&Ao.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=Ao&&Ao.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n};Object.defineProperty(Ao,"__esModule",{value:!0}),Ao.smallestFlagged=Ao.deheapSort=Ao.buildCandidates=Ao.uncheckedHeapPush=Ao.heapPush=Ao.rejectionSample=Ao.makeHeap=void 0;var n=r(So());function i(t,e){var r=function(r){return n.empty(t).map(function(){return n.filled(e,r)})},i=[];return i.push(r(-1)),i.push(r(1/0)),i.push(r(0)),i}function s(t,e,r,n,i){e=Math.floor(e);var s=t[0][e],l=t[1][e];if(t[2][e],r>=l[0])return 0;for(var a=0;a<s.length;a++)if(n===s[a])return 0;return o(t,e,r,n,i)}function o(t,e,r,n,i){var s=t[0][e],o=t[1][e],l=t[2][e];if(r>=o[0])return 0;o[0]=r,s[0]=n,l[0]=i;for(var a=0,f=0;;){var u=2*a+1,h=u+1,c=t[0][0].length;if(u>=c)break;if(h>=c){if(!(o[u]>r))break;f=u}else if(o[u]>=o[h]){if(!(r<o[u]))break;f=u}else{if(!(r<o[h]))break;f=h}o[a]=o[f],s[a]=s[f],l[a]=l[f],a=f}return o[a]=r,s[a]=n,l[a]=i,1}function l(t,e,r,n){for(;2*n+1<r;){var i=2*n+1,s=i+1,o=n;if(t[o]<t[i]&&(o=i),s<r&&t[o]<t[s]&&(o=s),o===n)break;var l=t[n];t[n]=t[o],t[o]=l;var a=e[n];e[n]=e[o],e[o]=a,n=o}}return Ao.makeHeap=i,Ao.rejectionSample=function(t,e,r){for(var i=n.zeros(t),s=0;s<t;s++){for(var o=!0,l=0;o;){l=n.tauRandInt(e,r);for(var a=!1,f=0;f<s;f++)if(l===i[f]){a=!0;break}a||(o=!1)}i[s]=l}return i},Ao.heapPush=s,Ao.uncheckedHeapPush=o,Ao.buildCandidates=function(t,e,r,o,l){for(var a=i(e,o),f=0;f<e;f++)for(var u=0;u<r;u++)if(!(t[0][f][u]<0)){var h=t[0][f][u],c=t[2][f][u],p=n.tauRand(l);s(a,f,p,h,c),s(a,h,p,f,c),t[2][f][u]=0}return a},Ao.deheapSort=function(t){for(var e=t[0],r=t[1],n=0;n<e.length;n++)for(var i=e[n],s=r[n],o=0;o<i.length-1;o++){var a=i.length-o-1,f=s.length-o-1,u=i[0];i[0]=i[a],i[a]=u;var h=s[0];s[0]=s[f],s[f]=h,l(s,i,f,0)}return{indices:e,weights:r}},Ao.smallestFlagged=function(t,e){for(var r=t[0][e],n=t[1][e],i=t[2][e],s=1/0,o=-1,l=0;l>r.length;l++)1===i[l]&&n[l]<s&&(s=n[l],o=l);return o>=0?(i[o]=0,Math.floor(r[o])):-1},Ao}var No,Bo={};function Co(){if(No)return Bo;No=1;var t,e=Bo&&Bo.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),r=Bo&&Bo.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=Bo&&Bo.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&e(n,t,i);return r(n,t),n},i=Bo&&Bo.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},s=Bo&&Bo.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.getCSR=Bo.normalize=Bo.eliminateZeros=Bo.multiplyScalar=Bo.maximum=Bo.subtract=Bo.add=Bo.pairwiseMultiply=Bo.identity=Bo.transpose=Bo.SparseMatrix=void 0;var o=n(So()),l=function(){function t(t,e,r,n){if(this.entries=new Map,this.nRows=0,this.nCols=0,t.length!==e.length||t.length!==r.length)throw new Error("rows, cols and values arrays must all have the same length");this.nRows=n[0],this.nCols=n[1];for(var i=0;i<r.length;i++){var s=t[i],o=e[i];this.checkDims(s,o);var l=this.makeKey(s,o);this.entries.set(l,{value:r[i],row:s,col:o})}}return t.prototype.makeKey=function(t,e){return t+":"+e},t.prototype.checkDims=function(t,e){if(!(t<this.nRows&&e<this.nCols))throw new Error("row and/or col specified outside of matrix dimensions")},t.prototype.set=function(t,e,r){this.checkDims(t,e);var n=this.makeKey(t,e);this.entries.has(n)?this.entries.get(n).value=r:this.entries.set(n,{value:r,row:t,col:e})},t.prototype.get=function(t,e,r){void 0===r&&(r=0),this.checkDims(t,e);var n=this.makeKey(t,e);return this.entries.has(n)?this.entries.get(n).value:r},t.prototype.getAll=function(t){void 0===t&&(t=!0);var e=[];return this.entries.forEach(function(t){e.push(t)}),t&&e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row}),e},t.prototype.getDims=function(){return[this.nRows,this.nCols]},t.prototype.getRows=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].row})},t.prototype.getCols=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].col})},t.prototype.getValues=function(){return Array.from(this.entries,function(t){var e=i(t,2);return e[0],e[1].value})},t.prototype.forEach=function(t){this.entries.forEach(function(e){return t(e.value,e.row,e.col)})},t.prototype.map=function(e){var r=[];this.entries.forEach(function(t){r.push(e(t.value,t.row,t.col))});var n=[this.nRows,this.nCols];return new t(this.getRows(),this.getCols(),r,n)},t.prototype.toArray=function(){var t=this,e=o.empty(this.nRows).map(function(){return o.zeros(t.nCols)});return this.entries.forEach(function(t){e[t.row][t.col]=t.value}),e},t}();Bo.SparseMatrix=l,Bo.transpose=function(t){var e=[],r=[],n=[];t.forEach(function(t,i,s){e.push(i),r.push(s),n.push(t)});var i=[t.nCols,t.nRows];return new l(r,e,n,i)},Bo.identity=function(t){for(var e=i(t,1)[0],r=new l([],[],[],t),n=0;n<e;n++)r.set(n,n,1);return r},Bo.pairwiseMultiply=function(t,e){return f(t,e,function(t,e){return t*e})},Bo.add=function(t,e){return f(t,e,function(t,e){return t+e})},Bo.subtract=function(t,e){return f(t,e,function(t,e){return t-e})},Bo.maximum=function(t,e){return f(t,e,function(t,e){return t>e?t:e})},Bo.multiplyScalar=function(t,e){return t.map(function(t){return t*e})},Bo.eliminateZeros=function(t){for(var e=new Set,r=t.getValues(),n=t.getRows(),i=t.getCols(),s=0;s<r.length;s++)0===r[s]&&e.add(s);var o=function(t,r){return!e.has(r)},a=r.filter(o),f=n.filter(o),u=i.filter(o);return new l(f,u,a,t.getDims())},Bo.normalize=function(t,e){var r,n;void 0===e&&(e="l2");var i=a[e],o=new Map;t.forEach(function(t,e,r){var n=o.get(e)||[];n.push(r),o.set(e,n)});var f=new l([],[],[],t.getDims()),u=function(e){for(var r=o.get(e).sort(),n=r.map(function(r){return t.get(e,r)}),s=i(n),l=0;l<s.length;l++)f.set(e,r[l],s[l])};try{for(var h=s(o.keys()),c=h.next();!c.done;c=h.next()){u(c.value)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}return f};var a=((t={}).max=function(t){for(var e=-1/0,r=0;r<t.length;r++)e=t[r]>e?t[r]:e;return t.map(function(t){return t/e})},t.l1=function(t){for(var e=0,r=0;r<t.length;r++)e+=t[r];return t.map(function(t){return t/e})},t.l2=function(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r],2);return t.map(function(t){return Math.sqrt(Math.pow(t,2)/e)})},t);function f(t,e,r){for(var n=new Set,i=[],s=[],o=[],a=function(n,l){i.push(n),s.push(l);var a=r(t.get(n,l),e.get(n,l));o.push(a)},f=t.getValues(),u=t.getRows(),h=t.getCols(),c=0;c<f.length;c++){var p=(w=u[c])+":"+(_=h[c]);n.add(p),a(w,_)}var d=e.getValues(),g=e.getRows(),m=e.getCols();for(c=0;c<d.length;c++){var w,_;p=(w=g[c])+":"+(_=m[c]);n.has(p)||a(w,_)}var y=[t.nRows,t.nCols];return new l(i,s,o,y)}return Bo.getCSR=function(t){var e=[];t.forEach(function(t,r,n){e.push({value:t,row:r,col:n})}),e.sort(function(t,e){return t.row===e.row?t.col-e.col:t.row-e.row});for(var r=[],n=[],i=[],s=-1,o=0;o<e.length;o++){var l=e[o],a=l.row,f=l.col,u=l.value;a!==s&&(s=a,i.push(o)),r.push(f),n.push(u)}return{indices:r,values:n,indptr:i}},Bo}var Ro,zo,Io={},Po={};function Oo(){if(Ro)return Po;Ro=1;var t=Po&&Po.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=Po&&Po.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=Po&&Po.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n},n=Po&&Po.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},i=Po&&Po.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},s=Po&&Po.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Po,"__esModule",{value:!0}),Po.searchFlatTree=Po.makeLeafArray=Po.makeForest=Po.FlatTree=void 0;var o=r(So()),l=function(t,e,r,n){this.hyperplanes=t,this.offsets=e,this.children=r,this.indices=n};function a(t,e,r,n,i){if(void 0===r&&(r=30),e.length>r){var s=function(t,e,r){var n=t[0].length,i=o.tauRandInt(e.length,r),s=o.tauRandInt(e.length,r);s=(s+=i===s?1:0)%e.length;for(var l=e[i],a=e[s],f=0,u=o.zeros(n),h=0;h<u.length;h++)u[h]=t[l][h]-t[a][h],f-=u[h]*(t[l][h]+t[a][h])/2;var c=0,p=0,d=o.zeros(e.length);for(h=0;h<e.length;h++){for(var g=f,m=0;m<n;m++)g+=u[m]*t[e[h]][m];0===g?(d[h]=o.tauRandInt(2,r),0===d[h]?c+=1:p+=1):g>0?(d[h]=0,c+=1):(d[h]=1,p+=1)}var w=o.zeros(c),_=o.zeros(p);c=0,p=0;for(h=0;h<d.length;h++)0===d[h]?(w[c]=e[h],c+=1):(_[p]=e[h],p+=1);return{indicesLeft:w,indicesRight:_,hyperplane:u,offset:f}}(t,e,i),l=s.indicesLeft,f=s.indicesRight,u=s.hyperplane,h=s.offset;return{leftChild:a(t,l,r,n+1,i),rightChild:a(t,f,r,n+1,i),isLeaf:!1,hyperplane:u,offset:h}}return{indices:e,isLeaf:!0}}function f(t,e,r,n,s,o,l){var a;if(t.isLeaf)return n[o][0]=-l,(a=s[l]).splice.apply(a,i([0,t.indices.length],t.indices)),{nodeNum:o,leafNum:l+=1};e[o]=t.hyperplane,r[o]=t.offset,n[o][0]=o+1;var u=o,h=f(t.leftChild,e,r,n,s,o+1,l);return o=h.nodeNum,l=h.leafNum,n[u][1]=o+1,{nodeNum:(h=f(t.rightChild,e,r,n,s,o+1,l)).nodeNum,leafNum:h.leafNum}}function u(t){return t.isLeaf?1:1+u(t.leftChild)+u(t.rightChild)}function h(t){return t.isLeaf?1:h(t.leftChild)+h(t.rightChild)}function c(t,e,r,n){for(var i=e,s=0;s<r.length;s++)i+=t[s]*r[s];return 0===i?o.tauRandInt(2,n):i>0?0:1}return Po.FlatTree=l,Po.makeForest=function(t,e,r,n){var i=Math.max(10,e),s=o.range(r).map(function(e,r){return function(t,e,r,n){void 0===e&&(e=30);var i=o.range(t.length),s=a(t,i,e,r,n);return s}(t,i,r,n)}),c=s.map(function(t){return function(t,e){var r=u(t),n=h(t),i=o.range(r).map(function(){return o.zeros(t.hyperplane?t.hyperplane.length:0)}),s=o.zeros(r),a=o.range(r).map(function(){return[-1,-1]}),c=o.range(n).map(function(){return o.range(e).map(function(){return-1})});return f(t,i,s,a,c,0,0),new l(i,s,a,c)}(t,i)});return c},Po.makeLeafArray=function(t){var e,r;if(t.length>0){var n=[];try{for(var o=s(t),l=o.next();!l.done;l=o.next()){var a=l.value;n.push.apply(n,i(a.indices))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n}return[[-1]]},Po.searchFlatTree=function(t,e,r){for(var n=0;e.children[n][0]>0;){n=0===c(e.hyperplanes[n],e.offsets[n],t,r)?e.children[n][0]:e.children[n][1]}var i=-1*e.children[n][0];return e.indices[i]},Po}const jo=Object.prototype.toString;function To(t){return jo.call(t).endsWith("Array]")}function $o(t,e,r){let n=0;const i=r(e);for(let e=0;e<t.x.length;e++)n+=Math.abs(t.y[e]-i(t.x[e]));return n}function Fo(t,e,r,n,i){let s=r*n*n,o=ms.eye(e.length,e.length,s);const l=i(e);let a=new Float64Array(t.x.length);for(let e=0;e<t.x.length;e++)a[e]=l(t.x[e]);let f=function(t,e,r,n,i){const s=r.length,o=t.x.length;let l=new Array(s);for(let a=0;a<s;a++){l[a]=new Array(o);let s=r.slice();s[a]+=n;let f=i(s);for(let r=0;r<o;r++)l[a][r]=e[r]-f(t.x[r])}return new ms(l)}(t,a,e,n,i),u=function(t,e){const r=t.x.length;let n=new Array(r);for(let i=0;i<r;i++)n[i]=[t.y[i]-e[i]];return new ms(n)}(t,a),h=bs(o.add(f.mmul(f.transpose())));return(e=(e=new ms([e])).sub(h.mmul(f).mmul(u).mul(n).transpose())).to1DArray()}var Do,Vo,Lo=ss(Object.freeze({__proto__:null,default:function(t,e,r={}){let{maxIterations:n=100,gradientDifference:i=.1,damping:s=0,errorTolerance:o=.01,minValues:l,maxValues:a,initialValues:f}=r;if(s<=0)throw new Error("The damping option must be a positive number");if(!t.x||!t.y)throw new Error("The data parameter must have x and y elements");if(!To(t.x)||t.x.length<2||!To(t.y)||t.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(t.x.length!==t.y.length)throw new Error("The data parameter elements must have the same size");let u=f||new Array(e.length).fill(1),h=u.length;if(a=a||new Array(h).fill(Number.MAX_SAFE_INTEGER),l=l||new Array(h).fill(Number.MIN_SAFE_INTEGER),a.length!==l.length)throw new Error("minValues and maxValues must be the same size");if(!To(u))throw new Error("initialValues must be an array");let c,p=$o(t,u,e),d=p<=o;for(c=0;c<n&&!d;c++){u=Fo(t,u,s,i,e);for(let t=0;t<h;t++)u[t]=Math.min(Math.max(l[t],u[t]),a[t]);if(p=$o(t,u,e),isNaN(p))break;d=p<=o}return{parameterValues:u,parameterError:p,iterations:c}}}));function qo(){if(Do)return Mo;Do=1;var t=Mo&&Mo.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=Mo&&Mo.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=Mo&&Mo.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n},n=Mo&&Mo.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,s){function o(t){try{a(n.next(t))}catch(t){s(t)}}function l(t){try{a(n.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(o,l)}a((n=n.apply(t,e||[])).next())})},i=Mo&&Mo.__generator||function(t,e){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function l(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},s=Mo&&Mo.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},o=Mo&&Mo.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t},l=Mo&&Mo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.initTransform=Mo.resetLocalConnectivity=Mo.fastIntersection=Mo.findABParams=Mo.cosine=Mo.euclidean=Mo.UMAP=void 0;var a=r(Eo()),f=r(Co()),u=r(function(){if(zo)return Io;zo=1;var t=Io&&Io.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),e=Io&&Io.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=Io&&Io.__importStar||function(r){if(r&&r.__esModule)return r;var n={};if(null!=r)for(var i in r)"default"!==i&&Object.hasOwnProperty.call(r,i)&&t(n,r,i);return e(n,r),n},n=Io&&Io.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Io,"__esModule",{value:!0}),Io.initializeSearch=Io.makeInitializedNNSearch=Io.makeInitializations=Io.makeNNDescent=void 0;var i=r(Eo()),s=r(Co()),o=r(Oo()),l=r(So());return Io.makeNNDescent=function(t,e){return function(r,n,s,o,a,f,u,h){void 0===o&&(o=10),void 0===a&&(a=50),void 0===f&&(f=.001),void 0===u&&(u=.5),void 0===h&&(h=!0);for(var c=r.length,p=i.makeHeap(r.length,s),d=0;d<r.length;d++)for(var g=i.rejectionSample(s,r.length,e),m=0;m<g.length;m++){var w=t(r[d],r[g[m]]);i.heapPush(p,d,w,g[m],1),i.heapPush(p,g[m],w,d,1)}if(h)for(var _=0;_<n.length;_++)for(d=0;d<n[_].length&&!(n[_][d]<0);d++)for(m=d+1;m<n[_].length&&!(n[_][m]<0);m++)w=t(r[n[_][d]],r[n[_][m]]),i.heapPush(p,n[_][d],w,n[_][m],1),i.heapPush(p,n[_][m],w,n[_][d],1);for(_=0;_<o;_++){var y=i.buildCandidates(p,c,s,a,e),b=0;for(d=0;d<c;d++)for(m=0;m<a;m++){var v=Math.floor(y[0][d][m]);if(!(v<0||l.tauRand(e)<u))for(var x=0;x<a;x++){var M=Math.floor(y[0][d][x]),A=y[2][d][m],k=y[2][d][x];M<0||!A&&!k||(w=t(r[v],r[M]),b+=i.heapPush(p,v,w,M,1),b+=i.heapPush(p,M,w,v,1))}}if(b<=f*s*r.length)break}return i.deheapSort(p)}},Io.makeInitializations=function(t){return{initFromRandom:function(e,r,n,s,o){for(var a=0;a<n.length;a++)for(var f=l.rejectionSample(e,r.length,o),u=0;u<f.length;u++)if(!(f[u]<0)){var h=t(r[f[u]],n[a]);i.heapPush(s,a,h,f[u],1)}},initFromTree:function(e,r,n,s,l){for(var a=0;a<n.length;a++)for(var f=o.searchFlatTree(n[a],e,l),u=0;u<f.length;u++){if(f[u]<0)return;var h=t(r[f[u]],n[a]);i.heapPush(s,a,h,f[u],1)}}}},Io.makeInitializedNNSearch=function(t){return function(e,r,o,l){for(var a,f,u=s.getCSR(r),h=u.indices,c=u.indptr,p=0;p<l.length;p++)for(var d=new Set(o[0][p]);;){var g=i.smallestFlagged(o,p);if(-1===g)break;var m=h.slice(c[g],c[g+1]);try{for(var w=(a=void 0,n(m)),_=w.next();!_.done;_=w.next()){var y=_.value;if(y!==g&&-1!==y&&!d.has(y)){var b=t(e[y],l[p]);i.uncheckedHeapPush(o,p,b,y,1),d.add(y)}}}catch(t){a={error:t}}finally{try{_&&!_.done&&(f=w.return)&&f.call(w)}finally{if(a)throw a.error}}}return o}},Io.initializeSearch=function(t,e,r,s,o,l,a){var f,u,h=i.makeHeap(r.length,s);if(o(s,e,r,h,a),t)try{for(var c=n(t),p=c.next();!p.done;p=c.next())l(p.value,e,r,h,a)}catch(t){f={error:t}}finally{try{p&&!p.done&&(u=c.return)&&u.call(c)}finally{if(f)throw f.error}}return h},Io}()),h=r(Oo()),c=r(So()),p=l(Lo),d=1e-5,g=.001,m=function(){function t(t){var e=this;void 0===t&&(t={}),this.learningRate=1,this.localConnectivity=1,this.minDist=.1,this.nComponents=2,this.nEpochs=0,this.nNeighbors=15,this.negativeSampleRate=5,this.random=Math.random,this.repulsionStrength=1,this.setOpMixRatio=1,this.spread=1,this.transformQueueSize=4,this.targetMetric="categorical",this.targetWeight=.5,this.targetNNeighbors=this.nNeighbors,this.distanceFn=w,this.isInitialized=!1,this.rpForest=[],this.embedding=[],this.optimizationState=new _;var r=function(r){void 0!==t[r]&&(e[r]=t[r])};r("distanceFn"),r("learningRate"),r("localConnectivity"),r("minDist"),r("nComponents"),r("nEpochs"),r("nNeighbors"),r("negativeSampleRate"),r("random"),r("repulsionStrength"),r("setOpMixRatio"),r("spread"),r("transformQueueSize")}return t.prototype.fit=function(t){return this.initializeFit(t),this.optimizeLayout(),this.embedding},t.prototype.fitAsync=function(t,e){return void 0===e&&(e=function(){return!0}),n(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return this.initializeFit(t),[4,this.optimizeLayoutAsync(e)];case 1:return r.sent(),[2,this.embedding]}})})},t.prototype.setSupervisedProjection=function(t,e){void 0===e&&(e={}),this.Y=t,this.targetMetric=e.targetMetric||this.targetMetric,this.targetWeight=e.targetWeight||this.targetWeight,this.targetNNeighbors=e.targetNNeighbors||this.targetNNeighbors},t.prototype.setPrecomputedKNN=function(t,e){this.knnIndices=t,this.knnDistances=e},t.prototype.initializeFit=function(t){if(t.length<=this.nNeighbors)throw new Error("Not enough data points ("+t.length+") to create nNeighbors: "+this.nNeighbors+".  Add more data points or adjust the configuration.");if(this.X===t&&this.isInitialized)return this.getNEpochs();if(this.X=t,!this.knnIndices&&!this.knnDistances){var e=this.nearestNeighbors(t);this.knnIndices=e.knnIndices,this.knnDistances=e.knnDistances}this.graph=this.fuzzySimplicialSet(t,this.nNeighbors,this.setOpMixRatio),this.makeSearchFns(),this.searchGraph=this.makeSearchGraph(t),this.processGraphForSupervisedProjection();var r=this.initializeSimplicialSetEmbedding(),n=r.head,i=r.tail,s=r.epochsPerSample;return this.optimizationState.head=n,this.optimizationState.tail=i,this.optimizationState.epochsPerSample=s,this.initializeOptimization(),this.prepareForOptimizationLoop(),this.isInitialized=!0,this.getNEpochs()},t.prototype.makeSearchFns=function(){var t=u.makeInitializations(this.distanceFn),e=t.initFromTree,r=t.initFromRandom;this.initFromTree=e,this.initFromRandom=r,this.search=u.makeInitializedNNSearch(this.distanceFn)},t.prototype.makeSearchGraph=function(t){for(var e=this.knnIndices,r=this.knnDistances,n=[t.length,t.length],i=new f.SparseMatrix([],[],[],n),s=0;s<e.length;s++)for(var o=e[s],l=r[s],a=0;a<o.length;a++){var u=o[a],h=l[a];h>0&&i.set(s,u,h)}var c=f.transpose(i);return f.maximum(i,c)},t.prototype.transform=function(t){var e=this,r=this.X;if(void 0===r||0===r.length)throw new Error("No data has been fit.");var n=Math.floor(this.nNeighbors*this.transformQueueSize);n=Math.min(r.length,n);var i=u.initializeSearch(this.rpForest,r,t,n,this.initFromRandom,this.initFromTree,this.random),s=this.search(r,this.searchGraph,i,t),o=a.deheapSort(s),l=o.indices,h=o.weights;l=l.map(function(t){return t.slice(0,e.nNeighbors)}),h=h.map(function(t){return t.slice(0,e.nNeighbors)});var p=Math.max(0,this.localConnectivity-1),d=this.smoothKNNDistance(h,this.nNeighbors,p),g=d.sigmas,m=d.rhos,w=this.computeMembershipStrengths(l,h,g,m),_=w.rows,y=w.cols,b=w.vals,v=[t.length,r.length],x=new f.SparseMatrix(_,y,b,v),M=f.normalize(x,"l1"),k=f.getCSR(M),S=t.length,E=A(c.reshape2d(k.indices,S,this.nNeighbors),c.reshape2d(k.values,S,this.nNeighbors),this.embedding),N=this.nEpochs?this.nEpochs/3:x.nRows<=1e4?100:30,B=x.getValues().reduce(function(t,e){return e>t?e:t},0);x=x.map(function(t){return t<B/N?0:t}),x=f.eliminateZeros(x);var C=this.makeEpochsPerSample(x.getValues(),N),R=x.getRows(),z=x.getCols();return this.assignOptimizationStateParameters({headEmbedding:E,tailEmbedding:this.embedding,head:R,tail:z,currentEpoch:0,nEpochs:N,nVertices:x.getDims()[1],epochsPerSample:C}),this.prepareForOptimizationLoop(),this.optimizeLayout()},t.prototype.processGraphForSupervisedProjection=function(){var t=this.Y,e=this.X;if(t){if(t.length!==e.length)throw new Error("Length of X and y must be equal");if("categorical"===this.targetMetric){var r=this.targetWeight<1?1/(1-this.targetWeight)*2.5:1e12;this.graph=this.categoricalSimplicialSetIntersection(this.graph,t,r)}}},t.prototype.step=function(){var t=this.optimizationState.currentEpoch;return t<this.getNEpochs()&&this.optimizeLayoutStep(t),this.optimizationState.currentEpoch},t.prototype.getEmbedding=function(){return this.embedding},t.prototype.nearestNeighbors=function(t){var e,r=this.distanceFn,n=this.nNeighbors,i=u.makeNNDescent(r,this.random),s=5+Math.floor(.5===(e=Math.pow(t.length,.5)/20)?0:Math.round(e)),o=Math.max(5,Math.floor(Math.round(function(t){return Math.log(t)/Math.log(2)}(t.length))));this.rpForest=h.makeForest(t,n,s,this.random);var l=i(t,h.makeLeafArray(this.rpForest),n,o);return{knnIndices:l.indices,knnDistances:l.weights}},t.prototype.fuzzySimplicialSet=function(t,e,r){void 0===r&&(r=1);var n=this,i=n.knnIndices,s=void 0===i?[]:i,o=n.knnDistances,l=void 0===o?[]:o,a=n.localConnectivity,u=this.smoothKNNDistance(l,e,a),h=u.sigmas,c=u.rhos,p=this.computeMembershipStrengths(s,l,h,c),d=p.rows,g=p.cols,m=p.vals,w=[t.length,t.length],_=new f.SparseMatrix(d,g,m,w),y=f.transpose(_),b=f.pairwiseMultiply(_,y),v=f.subtract(f.add(_,y),b),x=f.multiplyScalar(v,r),M=f.multiplyScalar(b,1-r);return f.add(x,M)},t.prototype.categoricalSimplicialSetIntersection=function(t,e,r,n){void 0===n&&(n=1);var i=x(t,e,n,r);return M(i=f.eliminateZeros(i))},t.prototype.smoothKNNDistance=function(t,e,r,n,i){void 0===r&&(r=1),void 0===n&&(n=64),void 0===i&&(i=1);for(var s=Math.log(e)/Math.log(2)*i,o=c.zeros(t.length),l=c.zeros(t.length),a=0;a<t.length;a++){var f=0,u=1/0,h=1,p=t[a],m=p.filter(function(t){return t>0});if(m.length>=r){var w=Math.floor(r),_=r-w;w>0?(o[a]=m[w-1],_>d&&(o[a]+=_*(m[w]-m[w-1]))):o[a]=_*m[0]}else m.length>0&&(o[a]=c.max(m));for(var y=0;y<n;y++){for(var b=0,v=1;v<t[a].length;v++){var x=t[a][v]-o[a];b+=x>0?Math.exp(-x/h):1}if(Math.abs(b-s)<d)break;b>s?h=(f+(u=h))/2:(f=h,u===1/0?h*=2:h=(f+u)/2)}if(l[a]=h,o[a]>0){var M=c.mean(p);l[a]<g*M&&(l[a]=g*M)}else{var A=c.mean(t.map(c.mean));l[a]<g*A&&(l[a]=g*A)}}return{sigmas:l,rhos:o}},t.prototype.computeMembershipStrengths=function(t,e,r,n){for(var i=t.length,s=t[0].length,o=c.zeros(i*s),l=c.zeros(i*s),a=c.zeros(i*s),f=0;f<i;f++)for(var u=0;u<s;u++){var h=0;-1!==t[f][u]&&(h=t[f][u]===f?0:e[f][u]-n[f]<=0?1:Math.exp(-(e[f][u]-n[f])/r[f]),o[f*s+u]=f,l[f*s+u]=t[f][u],a[f*s+u]=h)}return{rows:o,cols:l,vals:a}},t.prototype.initializeSimplicialSetEmbedding=function(){for(var t=this,e=this.getNEpochs(),r=this.nComponents,n=this.graph.getValues(),i=0,s=0;s<n.length;s++){var o=n[s];i<n[s]&&(i=o)}var l=this.graph.map(function(t){return t<i/e?0:t});this.embedding=c.zeros(l.nRows).map(function(){return c.zeros(r).map(function(){return 20*c.tauRand(t.random)-10})});var a=[],f=[],u=[],h=l.getAll();for(s=0;s<h.length;s++){var p=h[s];p.value&&(a.push(p.value),u.push(p.row),f.push(p.col))}return{head:f,tail:u,epochsPerSample:this.makeEpochsPerSample(a,e)}},t.prototype.makeEpochsPerSample=function(t,e){var r=c.filled(t.length,-1),n=c.max(t),i=t.map(function(t){return t/n*e});return i.forEach(function(t,n){t>0&&(r[n]=e/i[n])}),r},t.prototype.assignOptimizationStateParameters=function(t){Object.assign(this.optimizationState,t)},t.prototype.prepareForOptimizationLoop=function(){var t=this,e=t.repulsionStrength,r=t.learningRate,n=t.negativeSampleRate,i=this.optimizationState,s=i.epochsPerSample,l=i.headEmbedding,a=i.tailEmbedding,f=l[0].length,u=l.length===a.length,h=s.map(function(t){return t/n}),c=o(h),p=o(s);this.assignOptimizationStateParameters({epochOfNextSample:p,epochOfNextNegativeSample:c,epochsPerNegativeSample:h,moveOther:u,initialAlpha:r,alpha:r,gamma:e,dim:f})},t.prototype.initializeOptimization=function(){var t=this.embedding,e=this.embedding,r=this.optimizationState,n=r.head,i=r.tail,s=r.epochsPerSample,o=this.getNEpochs(),l=this.graph.nCols,a=v(this.spread,this.minDist),f=a.a,u=a.b;this.assignOptimizationStateParameters({headEmbedding:t,tailEmbedding:e,head:n,tail:i,epochsPerSample:s,a:f,b:u,nEpochs:o,nVertices:l})},t.prototype.optimizeLayoutStep=function(t){for(var e=this.optimizationState,r=e.head,n=e.tail,i=e.headEmbedding,s=e.tailEmbedding,o=e.epochsPerSample,l=e.epochOfNextSample,a=e.epochOfNextNegativeSample,f=e.epochsPerNegativeSample,u=e.moveOther,h=e.initialAlpha,p=e.alpha,d=e.gamma,g=e.a,m=e.b,w=e.dim,_=e.nEpochs,v=e.nVertices,x=0;x<o.length;x++)if(!(l[x]>t)){var M=r[x],A=n[x],k=i[M],S=s[A],E=b(k,S),N=0;E>0&&(N=-2*g*m*Math.pow(E,m-1),N/=g*Math.pow(E,m)+1);for(var B=0;B<w;B++){var C=y(N*(k[B]-S[B]),4);k[B]+=C*p,u&&(S[B]+=-C*p)}l[x]+=o[x];for(var R=Math.floor((t-a[x])/f[x]),z=0;z<R;z++){var I=c.tauRandInt(v,this.random),P=s[I],O=b(k,P),j=0;if(O>0)j=2*d*m,j/=(.001+O)*(g*Math.pow(O,m)+1);else if(M===I)continue;for(B=0;B<w;B++){C=4;j>0&&(C=y(j*(k[B]-P[B]),4)),k[B]+=C*p}}a[x]+=R*f[x]}return e.alpha=h*(1-t/_),e.currentEpoch+=1,i},t.prototype.optimizeLayoutAsync=function(t){var e=this;return void 0===t&&(t=function(){return!0}),new Promise(function(r,s){var o=function(){return n(e,void 0,void 0,function(){var e,n,l,a,f,u;return i(this,function(i){try{if(e=this.optimizationState,n=e.nEpochs,l=e.currentEpoch,this.embedding=this.optimizeLayoutStep(l),a=this.optimizationState.currentEpoch,f=!1===t(a),u=a===n,f||u)return[2,r(u)];setTimeout(function(){return o()},0)}catch(t){s(t)}return[2]})})};setTimeout(function(){return o()},0)})},t.prototype.optimizeLayout=function(t){void 0===t&&(t=function(){return!0});for(var e=!1,r=[];!e;){var n=this.optimizationState,i=n.nEpochs,s=n.currentEpoch;r=this.optimizeLayoutStep(s);var o=this.optimizationState.currentEpoch,l=!1===t(o);e=o===i||l}return r},t.prototype.getNEpochs=function(){var t=this.graph;if(this.nEpochs>0)return this.nEpochs;var e=t.nRows;return e<=2500?500:e<=5e3?400:e<=7500?300:200},t}();function w(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return Math.sqrt(r)}Mo.UMAP=m,Mo.euclidean=w,Mo.cosine=function(t,e){for(var r=0,n=0,i=0,s=0;s<t.length;s++)r+=t[s]*e[s],n+=Math.pow(t[s],2),i+=Math.pow(e[s],2);return 0===n&&0===i?0:0===n||0===i?1:1-r/Math.sqrt(n*i)};var _=function(){this.currentEpoch=0,this.headEmbedding=[],this.tailEmbedding=[],this.head=[],this.tail=[],this.epochsPerSample=[],this.epochOfNextSample=[],this.epochOfNextNegativeSample=[],this.epochsPerNegativeSample=[],this.moveOther=!0,this.initialAlpha=1,this.alpha=1,this.gamma=1,this.a=1.5769434603113077,this.b=.8950608779109733,this.dim=2,this.nEpochs=500,this.nVertices=0};function y(t,e){return t>e?e:t<-e?-e:t}function b(t,e){for(var r=0,n=0;n<t.length;n++)r+=Math.pow(t[n]-e[n],2);return r}function v(t,e){var r=c.linear(0,3*t,300).map(function(t){return t<e?1:t}),n=c.zeros(r.length).map(function(n,i){return r[i]>=e?Math.exp(-(r[i]-e)/t):n}),i={x:r,y:n},o={damping:1.5,initialValues:[.5,.5],gradientDifference:.1,maxIterations:100,errorTolerance:.01},l=p.default(i,function(t){var e=s(t,2),r=e[0],n=e[1];return function(t){return 1/(1+r*Math.pow(t,2*n))}},o).parameterValues,a=s(l,2);return{a:a[0],b:a[1]}}function x(t,e,r,n){return void 0===r&&(r=1),void 0===n&&(n=5),t.map(function(t,i,s){return-1===e[i]||-1===e[s]?t*Math.exp(-r):e[i]!==e[s]?t*Math.exp(-n):t})}function M(t){t=f.normalize(t,"max");var e=f.transpose(t),r=f.pairwiseMultiply(e,t);return t=f.add(t,f.subtract(e,r)),f.eliminateZeros(t)}function A(t,e,r){for(var n=c.zeros(t.length).map(function(t){return c.zeros(r[0].length)}),i=0;i<t.length;i++)for(var s=0;s<t[0].length;s++)for(var o=0;o<r[0].length;o++){var l=t[i][s];n[i][o]+=e[i][s]*r[l][o]}return n}return Mo.findABParams=v,Mo.fastIntersection=x,Mo.resetLocalConnectivity=M,Mo.initTransform=A,Mo}var Uo=(Vo||(Vo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=qo();Object.defineProperty(t,"UMAP",{enumerable:!0,get:function(){return e.UMAP}})}(xo)),xo);const Ho={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};async function Yo(e={}){console.log("RUNNING: umap_plot() function----------");const{divid:r="",data:n=t,width:i=600,height:s=300,colors:o=["red","blue","green","orange","purple","pink","yellow"],nNeighbors:l=15,minDist:f=.1,nComponents:u=2}=e;let h=r?document.getElementById(r):null;if(h)console.log("plot div provided in function parameters. divid:",r),h.innerHTML="";else{const t=Ho.data.divNum;h=document.createElement("div"),h.id=r||"umap_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",h.id),document.body.appendChild(h),Ho.data.divNum=t+1}const c=n[0]||{},p=Object.keys(c),d=p.filter(t=>"number"==typeof c[t]),g=p.find(t=>"number"!=typeof c[t]),m=n.map(t=>d.map(e=>t[e])),w=g?n.map(t=>t[g]):n.map((t,e)=>`row${e}`),_=function(t){const e=t.length,r=t[0].length,n=Array(r).fill(0),i=Array(r).fill(0);for(const e of t)for(let t=0;t<r;t++)n[t]+=e[t];for(let t=0;t<r;t++)n[t]/=e;for(const e of t)for(let t=0;t<r;t++)i[t]+=(e[t]-n[t])**2;for(let t=0;t<r;t++)i[t]=Math.sqrt(i[t]/(e-1))||1;return t.map(t=>t.map((t,e)=>(t-n[e])/i[e]))}(m),v=new Uo.UMAP({nComponents:u,nNeighbors:l,minDist:f,random:Math.random}).fit(_).map((t,e)=>({group:w[e],name:g?String(w[e])+"_"+e:"id_"+e,UMAP1:t[0],UMAP2:t[1]})),x=[...new Set(v.map(t=>t.group))],M=Rn(o).domain(x),A=25,k=170,S=45,E=45,N=b(v,t=>t.UMAP1),B=y(v,t=>t.UMAP1),C=B-N,R=N-.1*C,P=B+.1*C,O=Vn().domain([R,P]).range([E,i-k]),j=Vn().domain(a(v,t=>t.UMAP2)).range([s-S,A]),T=Jt("svg").style("background","white").style("overflow","visible");T.attr("id","svgid_umap"),T.append("text").attr("x",i/2-E).attr("y",A/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("UMAP Plot");const $=T.attr("width",i).attr("height",s).append("g");$.append("g").call(t=>t.attr("transform",`translate(0,${s-S+5})`).call(z(O).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-k).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text("UMAP1"))),$.append("g").call(t=>t.attr("transform",`translate(${E-5},0)`).call(I(j).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",A-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text("UMAP2"))),$.append("rect").attr("id","background").attr("x",E).attr("y",A).attr("width",i-E-k).attr("height",s-A-S).attr("fill","white").on("click",(t,e)=>L(null,e,.7));const F=$.append("g").attr("class","gPoints").style("isolation","isolate"),D=ts().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n      <div style='line-height: 1.5;'>\n        <div><strong>Name:</strong> ${e.name}</div>\n        <div><strong>UMAP1:</strong> ${e.UMAP1.toFixed(2)}</div>\n        <div><strong>UMAP2:</strong> ${e.UMAP2.toFixed(2)}</div>\n      </div>`);T.call(D),F.selectAll("circle").data(v).enter().append("circle").attr("class","points").attr("cx",t=>O(t.UMAP1)).attr("cy",t=>j(t.UMAP2)).attr("fill",t=>M(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",D.show).on("mouseout",D.hide);const V=$.append("g").selectAll("rect").data(x);function L(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),s=Zt(".points").filter(t=>t.group===e),o=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),o.transition().attr("opacity",.1),s.transition().attr("opacity",r),i.transition().attr("opacity",r)}V.enter().append("rect").attr("class","keyRects").attr("x",i-E-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>M(t)).on("click",(t,e)=>L(null,e,.7)),V.enter().append("text").attr("x",t=>i-E-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>L(null,e,.7)),h.appendChild(T.node())}const Go=async(t={})=>{console.log("UMAP UI - not yet implemented"),console.log("Options:",t)};const Xo={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};function Wo(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),s=Zt(".points").filter(t=>t.group===e),o=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),o.transition().attr("opacity",.1),s.transition().attr("opacity",r),i.transition().attr("opacity",r)}async function Ko(t={}){console.log("RUNNING: scatter_plot() function----------");const{divid:r="",data:n=e,width:i=600,height:s=460,colors:o=["red","blue","green","orange","purple","pink","yellow"],xCol:l=null,yCol:f=null}=t;let u=r?document.getElementById(r):null;if(u)console.log("div provided in function parameters:",r),u.innerHTML="";else{const t=Xo.data.divNum;u=document.createElement("div"),u.id=r||"scatter_plot"+t,console.log("div NOT provided within function options or doesn't exist... created a new div with id: ",u.id),document.body.appendChild(u),Xo.data.divNum=t+1}const h=n[0]||{},c=Object.keys(h),p=c.filter(t=>"number"==typeof h[t]),d=c.find(t=>"number"!=typeof h[t]),g=l||p[0]||c[0],m=f||p[1]||c[1];if(!g||!m)return void console.error("Need at least 2 columns for scatter plot");const w=n.map((t,e)=>({x:t[g],y:t[m],group:d?t[d]:"row_"+e,name:d?String(t[d])+"_"+e:"id_"+e,original:t})),_=[...new Set(w.map(t=>t.group))],v=Rn(o).domain(_),x=25,M=170,A=45,k=45,S=b(w,t=>t.x),E=y(w,t=>t.x),N=E-S,B=S-.1*N,C=E+.1*N,R=Vn().domain([B,C]).range([k,i-M]),P=Vn().domain(a(w,t=>t.y)).range([s-A,x]),O=Jt("svg").style("background","white").style("overflow","visible");O.attr("id","svgid_scatter"),O.append("text").attr("x",i/2-k).attr("y",x/2).attr("text-anchor","middle").style("font-size","16px").style("font-family","sans-serif").text("Scatter Plot");const j=O.attr("width",i).attr("height",s).append("g");j.append("g").call(t=>t.attr("transform",`translate(0,${s-A+5})`).call(z(R).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",i-M).attr("y",35).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","end").text(g))),j.append("g").call(t=>t.attr("transform",`translate(${k-5},0)`).call(I(P).ticks(6).tickSizeOuter(0)).call(t=>t.select(".domain").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick line").attr("stroke","#000").attr("stroke-width",1)).call(t=>t.selectAll(".tick text").attr("fill","#000").style("font-size","12px")).call(t=>t.append("text").attr("x",-25).attr("y",x-5).attr("fill","#000").attr("font-weight","bold").attr("text-anchor","start").text(m))),j.append("rect").attr("id","background").attr("x",k).attr("y",x).attr("width",i-k-M).attr("height",s-x-A).attr("fill","white").on("click",(t,e)=>Wo(0,e,.7));const T=j.append("g").attr("class","gPoints").style("isolation","isolate"),$=ts().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","12px").style("max-width","250px").style("width","auto").html((t,e)=>`\n      <div style='line-height: 1.5;'>\n        <div><strong>Name:</strong> ${e.name}</div>\n        <div><strong>${g}:</strong> ${e.x.toFixed(2)}</div>\n        <div><strong>${m}:</strong> ${e.y.toFixed(2)}</div>\n      </div>`);O.call($),T.selectAll("circle").data(w).enter().append("circle").attr("class","points").attr("cx",t=>R(t.x)).attr("cy",t=>P(t.y)).attr("fill",t=>v(t.group)).attr("opacity",.7).attr("r",4).on("mouseover",$.show).on("mouseout",$.hide);const F=j.append("g").selectAll("rect").data(_);F.enter().append("rect").attr("class","keyRects").attr("x",i-k-50).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>v(t)).on("click",(t,e)=>Wo(0,e,.7)),F.enter().append("text").attr("x",t=>i-k-30).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>Wo(0,e,.7)),u.appendChild(O.node())}const Qo=async(t={})=>{console.log("Scatter UI - not yet implemented"),console.log("Options:",t)},Jo={data:{divNum:1,iris:{json:t,csv:null},spiral:{json:e,csv:null},file:{json:null,csv:null}}};function Zo(t,e,r){const n=Zt(".points").filter(t=>t.group!==e),i=Zt(".keyRects").filter(t=>t===e),s=Zt(".points").filter(t=>t.group===e),o=Zt(".keyRects").filter(t=>t!==e);n.transition().attr("opacity",.1),o.transition().attr("opacity",.1),s.transition().attr("opacity",r),i.transition().attr("opacity",r)}async function tl(e={}){console.log("RUNNING: pairs_plot() function----------");const{divid:r="",data:n=t,width:i=1e3,height:s=1e3,colors:o=["red","blue","green","orange","purple","pink","yellow"]}=e;let l=r?document.getElementById(r):null;if(l)console.log("div provided in function parameters:",r),l.innerHTML="";else{const t=Jo.data.divNum;l=document.createElement("div"),l.id=r||"pairs_plot"+t,console.log("div NOT provided... created new div with id:",l.id),document.body.appendChild(l),Jo.data.divNum=t+1}const f=n[0]||{},u=Object.keys(f),h=u.filter(t=>"number"==typeof f[t]),c=u.find(t=>"number"!=typeof f[t]);if(h.length<2)return void(l.innerHTML='<div class="text-muted">Need at least 2 numeric columns for pairs plot</div>');const p=n.map((t,e)=>({values:h.map(e=>t[e]),group:c?t[c]:"row_"+e,name:c?String(t[c])+"_"+e:"id_"+e})),d=[...new Set(p.map(t=>t.group))],g=Rn(o).domain(d),m=.6,w=h.length,_=Math.min(180,(i-100)/w),y=60,b=150,v=60,x=_*w+v+b,M=_*w+y+40,A=Jt("svg").attr("width",x).attr("height",M).style("background","white");A.append("text").attr("x",x/2).attr("y",y/2).attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").text("Pairs Plot");const k=A.append("g").attr("transform",`translate(${v},${y})`);k.append("rect").attr("x",0).attr("y",0).attr("width",_*w).attr("height",_*w).attr("fill","transparent").attr("pointer-events","all").style("cursor","pointer").on("click",()=>function(t){Zt(".points").transition().attr("opacity",t),Zt(".keyRects").transition().attr("opacity",1)}(m));const S=ts().style("border","solid 2px navy").style("background-color","white").style("color","#000").style("border-radius","7px").style("padding","8px 12px").style("font-family","monospace").style("font-size","11px").html((t,e)=>{const r=e.xVar,n=e.yVar;return`\n        <div>\n          <strong>${e.group}</strong><br/>\n          ${r}: ${e.xVal.toFixed(2)}<br/>\n          ${n}: ${e.yVal.toFixed(2)}\n        </div>`});A.call(S);const E=h.map(t=>{const e=n.map(e=>e[t]);return Vn().domain(a(e)).range([_,0])});for(let t=0;t<w;t++)for(let e=0;e<w;e++){const r=k.append("g").attr("transform",`translate(${e*_},${t*_})`);if(r.append("rect").attr("width",_).attr("height",_).attr("fill","none").attr("stroke","#ccc"),t===e)r.append("text").attr("x",_/2).attr("y",_/2).attr("text-anchor","middle").attr("dominant-baseline","middle").style("font-size","11px").style("font-weight","bold").text(h[t]);else{const n=E[e],i=E[t];p.forEach(s=>{r.append("circle").datum({...s,xVar:h[e],yVar:h[t],xVal:s.values[e],yVal:s.values[t]}).attr("class","points").attr("cx",n(s.values[e])).attr("cy",i(s.values[t])).attr("r",2.5).attr("fill",g(s.group)).attr("opacity",m).on("mouseover",S.show).on("mouseout",S.hide)})}t===w-1&&r.append("text").attr("x",_/2).attr("y",_+15).attr("text-anchor","middle").style("font-size","9px").text(h[e]),0===e&&r.append("text").attr("x",-10).attr("y",_/2).attr("text-anchor","end").attr("dominant-baseline","middle").style("font-size","9px").text(h[t])}const N=A.append("g").attr("transform",`translate(${x-b+20},${y})`).selectAll("rect").data(d);N.enter().append("rect").attr("class","keyRects").attr("x",0).attr("y",(t,e)=>20*e).attr("width",12).attr("height",12).attr("fill",t=>g(t)).on("click",(t,e)=>Zo(0,e,m)),N.enter().append("text").attr("x",20).attr("y",(t,e)=>20*e).attr("dy","0.7em").text(t=>`${t}`).style("font-size","14px").on("click",(t,e)=>Zo(0,e,m)),l.appendChild(A.node())}async function el(e={}){const{divid:r="",data:n=t,width:i=1e3,height:s=1e3,colors:o=["red","blue","green","orange","purple","pink","yellow"]}=e;await tl({divid:r,data:n,width:i,height:s,colors:o})}const rl="0.1.0";export{Qs as asDataFrame,Ys as convertStrToNumber,Zs as createTableFromCSV,Hs as csvToJson,eo as hclustDt,so as hclust_UI,io as hclust_plot,Us as heatmap_plot,t as irisData,Jo as pairsDt,el as pairs_UI,tl as pairs_plot,lo as pcaDt,uo as pca_UI,fo as pca_plot,Ws as removeNonNumberValues,Gs as removeNonNumbers,Ks as removeNumberValues,Xs as removeNumbers,Js as scale,Xo as scatterDt,Qo as scatter_UI,Ko as scatter_plot,e as spiralData,to as textBox,wo as tsneDt,yo as tsne_UI,_o as tsne_plot,Ho as umapDt,Go as umap_UI,Yo as umap_plot,rl as version};
//# sourceMappingURL=sdk.mjs.map
